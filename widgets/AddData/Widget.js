// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/AddData/search/SearchContext":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(l,a){return l(null,{allowArcGISOnline:!0,arcgisOnlinePortal:null,orgId:null,portal:null,username:null,constructor:function(l){a.mixin(this,l)}})})},"widgets/AddData/search/util":function(){define(["dojo/_base/array"],function(l){return{checkMixedContent:function(a){"string"===typeof window.location.href&&0===window.location.href.indexOf("https://")&&"string"===typeof a&&0===a.indexOf("http://")&&
(a="https:"+a.substring("5"));return a},endsWith:function(a,l){return-1!==a.indexOf(l,a.length-l.length)},escapeForLucene:function(a){return a.replace(RegExp('(\\+|\\-|\\\x26|\\!|\\(|\\)|\\{|\\}|\\[|\\]|\\^|\\"|\\~|\\*|\\?|\\:|\\\\)',"g"),"\\$1")},findLayersAdded:function(a,n){var g=[],m=[],t=[],c={itemIds:m,layers:t};if(!a)return c;var u="string"===typeof n&&0<n.length;l.forEach(a.layerIds,function(c){g.push(c)});l.forEach(a.graphicsLayerIds,function(c){g.push(c)});l.forEach(g,function(c){(c=a.getLayer(c))&&
"string"===typeof c.xtnItemId&&0<c.xtnItemId.length&&(!u||c.xtnItemId===n)&&(t.push(c),-1===m.indexOf(c.xtnItemId)&&m.push(c.xtnItemId))});return c},setNodeText:function(a,l){a.innerHTML="";l&&a.appendChild(document.createTextNode(l))},setNodeTitle:function(a,l){a.title="";l&&a.setAttribute("title",l)},setNodeHTML:function(a,l){a.innerHTML="";l&&(a.innerHTML=l)}}})},"widgets/AddData/search/SearchPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SearchPane.html dojo/i18n!../nls/strings ./SearchBox ./BBoxOption ./ScopeOptions ./TypeOptions ./SortOptions ./ResultsPane ./Paging ./ResultCount".split(" "),
function(l,a,n,g,m,t,c,u,k,w){return l([t,c,u],{i18n:w,templateString:k,qDefaultFilter:null,qRequiredFilter:null,searchOnStart:!0,searchContext:null,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);n.forEach(this.getComponents(),function(c){c.searchPane=this},this)},startup:function(){this._started||(this.inherited(arguments),this.bindEvents(),this.searchOnStart&&this.search())},_onFilterPlaceholderChanged:function(){m.contains(this.filterPlaceholder,"opened")?(m.remove(this.filterPlaceholder,
"opened"),m.remove(this.filterWrapper,"show")):(this.filterWrapper.style.top=this.headerNode.clientHeight+"px",m.add(this.filterPlaceholder,"opened"),m.add(this.filterWrapper,"show"))},_onSearchBoxPlaceholderChanged:function(){},bindEvents:function(){this.own(g(this.filterPlaceholder,"click",a.hitch(this,this._onFilterPlaceholderChanged)))},buildQueryParams:function(c){var a=null;"string"===typeof this.qRequiredFilter&&0<this.qRequiredFilter.length&&(a=this.qRequiredFilter);var k={q:a,canSortByRelevance:!1};
n.forEach(this.getComponents(),function(a){a.appendQueryParams(k,c)});delete k.canSortByRelevance;null===k.q&&"string"===typeof this.qDefaultFilter&&0<this.qDefaultFilter.length&&(k.q=this.qDefaultFilter);return k},getComponents:function(){return[this.searchBox,this.bboxOption,this.scopeOptions,this.typeOptions,this.sortOptions,this.resultsPane,this.paging,this.resultCount]},resize:function(){this.contentNode.style.top=this.headerNode.clientHeight+1+"px"},search:function(){var c=this,a={},k=this.buildQueryParams(a);
if(null!==k&&null!==k.q){k&&null===k.sortField&&(k.sortOrder="desc");var g=this.searchContext.portal;a.scopeIsArcGISOnline&&this.searchContext.arcgisOnlinePortal&&(g=this.searchContext.arcgisOnlinePortal);null!==this._dfd&&this._dfd.cancel("Search aborted.",!1);var u=null;this._dfd=u=g.queryItems(k).then(function(a){u.isCanceled()||(a.queryParams||(a.queryParams={start:a.start,num:a.num},a.nextQueryParams||"undefined"===typeof a.nextStart||-1===a.nextStart||(a.nextQueryParams={start:a.nextStart})),
n.forEach(c.getComponents(),function(c){c.processResults(a)}))}).otherwise(function(c){console.warn("searchError",c)})}},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()}})})},"widgets/AddData/search/SearchBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys ./SearchComponent dojo/text!./templates/SearchBox.html dojo/i18n!../nls/strings".split(" "),function(l,a,n,g,m,t,c){return l([m],{i18n:c,templateString:t,postCreate:function(){this.inherited(arguments);
this._checkClearButton();this.own(n(this.searchTextBox,"keyup",a.hitch(this,function(c){this._checkClearButton();c.keyCode===g.ENTER&&this.search()})))},_checkClearButton:function(){},clearButtonClicked:function(){this.searchTextBox.value="";this._checkClearButton();this.search()},searchButtonClicked:function(){this.search()},appendQueryParams:function(c){var k=this.searchTextBox.value;null!==k&&(k=a.trim(k));null!==k&&0<k.length&&(c.canSortByRelevance=!0,k="("+k+")",c.q=null!==c.q&&0<c.q.length?
c.q+(" AND "+k):k)}})})},"widgets/AddData/search/SearchComponent":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin"],function(l,a,n,g){return l([a,n,g],{isSearchComponent:!0,searchPane:null,template:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments)},appendQueryParams:function(a,g){},processResults:function(a){},getConfig:function(){return this.searchPane&&this.searchPane.wabWidget&&this.searchPane.wabWidget.config?
this.searchPane.wabWidget.config:{}},getMap:function(){return this.searchPane&&this.searchPane.wabWidget?this.searchPane.wabWidget.map:null},search:function(){this.searchPane&&this.searchPane.search()}})})},"widgets/AddData/search/BBoxOption":function(){define(["dojo/_base/declare","./SearchComponent","dojo/text!./templates/BBoxOption.html","dojo/i18n!../nls/strings","dijit/form/CheckBox"],function(l,a,n,g){return l([a],{i18n:g,templateString:n,postCreate:function(){this.inherited(arguments);this.bboxToggle.set("checked",
!0)},bboxClicked:function(){this.search()},_getBBox:function(){var a;if(a=this.getMap())if(a=a.geographicExtent)return a.xmin+","+a.ymin+","+a.xmax+","+a.ymax;return null},appendQueryParams:function(a){if(this.bboxToggle.get("checked")){var g=this._getBBox();null!==g&&(a.canSortByRelevance=!0,a.bbox=g)}}})})},"widgets/AddData/search/ScopeOptions":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-class ./SearchComponent dojo/text!./templates/ScopeOptions.html dojo/i18n!../nls/strings ./util".split(" "),
function(l,a,n,g,m,t,c,u){return l([m],{i18n:c,templateString:t,curatedFilter:null,postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this.inherited(arguments),this.initOptions())},hideDropdown:function(){g.remove(this.scopePlaceholder,"opened");g.remove(this.btnGroup,"show")},initOptions:function(){var k=this.searchPane.searchContext,l="string"===typeof k.username&&0<k.username.length,m=this.getConfig().scopeOptions;this.curatedFilter=m.Curated.filter;var v=null,
k=function(k,g){var w=m[k];w&&w.allow?("string"===typeof w.label&&0<a.trim(w.label).length?u.setNodeText(g,a.trim(w.label)):l||"MyOrganization"!==k||u.setNodeText(g,c.search.scopeOptions.anonymousContent),m.defaultScope===k&&(v=g)):g.style.display="none"};k("MyContent",this.MyContentToggle);k("MyOrganization",this.MyOrganizationToggle);k("Curated",this.CuratedToggle);k("ArcGISOnline",this.ArcGISOnlineToggle);v||(m.MyOrganization.allow?v=this.MyOrganizationToggle:m.ArcGISOnline.allow?v=this.ArcGISOnlineToggle:
m.Curated.allow?v=this.CuratedToggle:m.MyContent.allow&&(v=this.MyContentToggle));v&&(g.add(v,"active"),this.scopePlaceholderText.innerHTML=v.innerHTML)},optionClicked:function(c){this.toggleClassName(c);this.hideDropdown();this.search()},scopePlaceholderClicked:function(c){c.preventDefault();g.contains(this.scopePlaceholder,"opened")?this.hideDropdown():this.showDropdown()},showDropdown:function(){g.add(this.scopePlaceholder,"opened");g.add(this.btnGroup,"show")},toggleClassName:function(c){n.forEach(this.btnGroup.children,
function(c){g.remove(c,"active")});g.add(c.target,"active");this.scopePlaceholderText.innerHTML=c.target.innerHTML},appendQueryParams:function(c,a){var k=null;n.some(this.btnGroup.children,function(d){if(g.contains(d,"active"))return k=d.getAttribute("data-option-name"),!0});"undefined"===typeof k&&(k=null);var l=null,m=this.curatedFilter,w=this.searchPane.searchContext,t=w.username,A=w.orgId,E=!0;w.portal&&w.portal.isPortal&&(E=!1);"MyContent"===k?"string"===typeof t&&0<t.length&&(l="(owner:"+u.escapeForLucene(t)+
")"):"MyOrganization"===k?E&&"string"===typeof A&&0<A.length&&(l="(orgid:"+u.escapeForLucene(A)+")"):"Curated"===k?"string"===typeof m&&0<m.length&&(l=m):"ArcGISOnline"===k&&w.allowArcGISOnline&&(a.scopeIsArcGISOnline=!0);null!==l&&0<l.length&&(l="("+l+")",c.q=null!==c.q&&0<c.q.length?c.q+(" AND "+l):l)}})})},"widgets/AddData/search/TypeOptions":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on ./SearchComponent dojo/text!./templates/TypeOptions.html dojo/i18n!../nls/strings esri/layers/VectorTileLayer dijit/TooltipDialog dijit/form/DropDownButton dijit/form/CheckBox".split(" "),
function(l,a,n,g,m,t,c,u){return l([m],{i18n:c,templateString:t,postCreate:function(){this.inherited(arguments);u&&u.supported()||(console.warn("AddData: Vector Tile is not supported."),this.vectorTileNode.style.display="none");this.own(g(this.tooltipDialog,"open",n.hitch(this,function(){this.tooltipDialog.domNode.className+=" "+this.searchPane.wabWidget.appConfig.theme.name})))},getOptionWidgets:function(){return[this.mapServiceToggle,this.featureServiceToggle,this.imageServiceToggle,this.vectorTileServiceToggle,
this.kmlToggle,this.wmsToggle]},optionClicked:function(){this.search()},appendQueryParams:function(c){var g=function(c,a){0<c.length&&(c+=" OR ");return c+a},k="",l="",u=!1;a.forEach(this.getOptionWidgets(),function(c){var a=c.focusNode.getAttribute("data-option-q");l=g(l,a);c.get("checked")&&(k=g(k,a),u=!0)});u||(k=l);null!==k&&0<k.length&&(k="("+k+")",c.q=null!==c.q&&0<c.q.length?c.q+(" AND "+k):k)}})})},"widgets/AddData/search/SortOptions":function(){define("dojo/_base/declare dojo/on dojo/dom-class ./SearchComponent dojo/text!./templates/SortOptions.html dojo/i18n!../nls/strings dijit/form/Select".split(" "),
function(l,a,n,g,m,t){return l([g],{i18n:t,templateString:m,sortField:null,sortOrder:null,postCreate:function(){this.inherited(arguments);this.updateSortOrderButton();var c=this;this.own(this.sortSelect.on("change",function(){var a=c.sortField=c.sortSelect.get("value");if(""===a)c.sortOrder=null;else if("title"===a||"owner"===a)c.sortOrder="asc";else if("avgrating"===a||"numviews"===a||"modified"===a)c.sortOrder="desc";c.updateSortOrderButton();c.search()}));this.own(a(this.sortSelect.dropDown,"open",
function(){var c=this.domNode.parentElement;c&&n.add(c,"add-data-widget-popup")}))},sortOrderClicked:function(){"asc"===this.sortOrder?(this.sortOrder="desc",this.updateSortOrderButton(),this.search()):"desc"===this.sortOrder&&(this.sortOrder="asc",this.updateSortOrderButton(),this.search())},updateSortOrderButton:function(){var c=this.sortOrderBtn;c.style.visibility=null!==this.sortField&&0<this.sortField.length?"visible":"hidden";"desc"===this.sortOrder?n.add(c,"descending"):n.remove(c,"descending")},
appendQueryParams:function(c){c.sortField=null;c.sortOrder=null;var a=this.sortField,k=this.sortOrder;null!==a&&0<a.length?(c.sortField=a,null!==k&&0<k.length&&(c.sortOrder=k)):c.canSortByRelevance||(c.sortField="numviews",c.sortOrder="desc")}})})},"widgets/AddData/search/ResultsPane":function(){define("dojo/_base/declare dojo/_base/array ./SearchComponent dojo/text!./templates/ResultsPane.html dojo/i18n!../nls/strings ./ItemCard ./util".split(" "),function(l,a,n,g,m,t,c){return l([n],{i18n:m,templateString:g,
postCreate:function(){this.inherited(arguments)},addItem:function(c){c.placeAt(this.itemsNode)},destroyItems:function(){this.noMatchNode.style.display="none";this.noMatchNode.innerHTML="";this.destroyDescendants(!1)},showNoMatch:function(){c.setNodeText(this.noMatchNode,m.search.resultsPane.noMatch);this.noMatchNode.style.display="block"},processResults:function(g){this.destroyItems();var k=g.results;if(k&&0<k.length){var l=c.findLayersAdded(this.getMap(),null).itemIds;a.forEach(g.results,function(c){this.addItem(new t({item:c,
canRemove:-1!==l.indexOf(c.id),resultsPane:this}))},this)}else this.showNoMatch()}})})},"widgets/AddData/search/ItemCard":function(){define("dojo/_base/declare dojo/_base/array dojo/date/locale dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemCard.html dojo/i18n!../nls/strings ./util ./LayerLoader".split(" "),function(l,a,n,g,m,t,c,u,k,w,G){return l([m,t,c],{i18n:k,templateString:u,canRemove:!1,item:null,resultsPane:null,_dfd:null,postCreate:function(){this.inherited(arguments)},
startup:function(){this._started||(this.inherited(arguments),this.render())},addClicked:function(){var c=this,l=this.addButton;if(!g.contains(l,"disabled"))if(g.add(l,"disabled"),this.canRemove){var m=this.resultsPane.getMap();w.setNodeText(c.messageNode,k.search.item.messages.removing);var u=w.findLayersAdded(m,this.item.id).layers;a.forEach(u,function(c){m.removeLayer(c)});this.canRemove=!1;w.setNodeText(c.messageNode,"");w.setNodeText(this.addButton,k.search.item.actions.add);g.remove(l,"disabled")}else w.setNodeText(c.messageNode,
k.search.item.messages.adding),(new G).addItem(this.item,this.resultsPane.getMap()).then(function(a){a?(c.canRemove=!0,w.setNodeText(c.messageNode,""),w.setNodeText(c.addButton,k.search.item.actions.remove)):w.setNodeText(c.messageNode,k.search.item.messages.addFailed);g.remove(l,"disabled")}).otherwise(function(a){console.warn("Add layer failed.");console.warn(a);w.setNodeText(c.messageNode,k.search.item.messages.addFailed);g.remove(l,"disabled");a&&"string"===typeof a.message&&0<a.message.length&&
console.log("")})},detailsClicked:function(){var c=this.item,c=w.checkMixedContent(c.portalUrl)+"/home/item.html?id\x3d"+encodeURIComponent(c.id);window.open(c)},formatDate:function(c){"number"===typeof c&&(c=new Date(c));return n.format(c,{selector:"date",datePattern:k.search.item.dateFormat})},render:function(){w.setNodeText(this.titleNode,this.item.title);w.setNodeTitle(this.titleNode,this.item.title);this._renderThumbnail();this._renderTypeOwnerDate();this.canRemove&&w.setNodeText(this.addButton,
k.search.item.actions.remove)},_renderThumbnail:function(){var c=this.thumbnailNode,a=this.item.thumbnailUrl;c.innerHTML="";var a=w.checkMixedContent(a),k=document.createElement("IMG");k.src=a||"widgets/AddData/images/placeholder_120x80.png";c.appendChild(k)},_renderTypeOwnerDate:function(){var c,a=this.item;c=k.search.item.types[a.type];if("undefined"===typeof c||null===c)c=a.type;c=k.search.item.typeByOwnerPattern.replace("{type}",c);c=c.replace("{owner}",a.owner);w.setNodeText(this.typeByOwnerNode,
c)}})})},"widgets/AddData/search/LayerLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/json dojo/i18n!../nls/strings ./util esri/lang esri/request esri/arcgis/utils esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/DynamicLayerInfo esri/layers/FeatureLayer esri/layers/ImageParameters esri/layers/ImageServiceParameters esri/layers/KMLLayer esri/layers/LayerDrawingOptions esri/layers/MosaicRule esri/layers/RasterFunction esri/layers/VectorTileLayer esri/layers/WMSLayer esri/dijit/PopupTemplate esri/InfoTemplate esri/renderers/jsonUtils jimu/utils".split(" "),
function(l,a,n,g,m,t,c,u,k,w,G,v,C,B,F,A,E,d,e,q,x,D,I,z,y,b,h,r){return l(null,{item:null,itemUrl:null,map:null,serviceUrl:null,constructor:function(f){a.mixin(this,f)},addItem:function(f,b){var p=new m;this.map=b;this.item=f;this.itemUrl=this._checkMixedContent(f.itemUrl);this.serviceUrl=this._checkMixedContent(f.url);if("Feature Service"===f.type)return this._addFeatureService();if("Image Service"===f.type)return this._addImageService();if("KML"===f.type)return this._addKML();if("Map Service"===
f.type)return this._addMapService();if("Vector Tile Service"===f.type)return this._addVectorTileService();if("WMS"===f.type)return this._addWMS();console.warn("Unsupported item type: ",f.type);p.resolve(null);return p},_addFeatureService:function(){var f=this,b=new m,h=this.serviceUrl,r=this.item,d={},e=null,c=[],q=[];f._readItemJsonData().then(function(b){(d=b||{},d.layers)&&0<d.layers.length&&n.forEach(d.layers,function(f){"undefined"!==typeof f.id&&null!==f.id&&(null===e&&(e=[]),e.push(f.id))});
return f._readRestInfo(h)}).then(function(b){b&&"string"===typeof b.type&&"Feature Layer"===b.type?(b=new A(h,{id:f._generateLayerId(),outFields:["*"]}),c.push(f._waitForLayer(b))):b&&b.layers&&0<b.layers.length&&n.forEach(b.layers,function(b){var p=!0;null!==e&&0<e.length&&(p=n.some(e,function(f){return f===b.id}));p&&(p=new A(h+"/"+b.id,{id:f._generateLayerId(),outFields:["*"]}),c.push(f._waitForLayer(p)))});return g(c)}).then(function(f){n.forEach(f,function(f){q.push(f)});q.reverse();return q}).then(function(){n.forEach(q,
function(b){var p=f._processFeatureLayer(b,r,d);b.arcgisProps={title:p.title};b._titleForLegend=p.title;k.isDefined(b.title)||(b.title=p.title);f._addLayer(b)})}).then(function(){b.resolve(q)}).otherwise(function(f){b.reject(f)});return b},_addImageService:function(){var f=this,b=new m;f._readItemJsonData().then(function(b){return f._newImageServiceLayer(b||{})}).then(function(p){f._addLayer(p);b.resolve(p)}).otherwise(function(f){b.reject(f)});return b},_addKML:function(){var b=this,p=new m;b._newKMLLayer().then(function(f){f&&
(f.title=b.item.title);b._addLayer(f);p.resolve(f)}).otherwise(function(b){p.reject(b)});return p},_addMapService:function(){var b=this,p=new m;b._readItemJsonData().then(function(f){return b._newMapServiceLayer(f||{})}).then(function(f){b._addLayer(f);p.resolve(f)}).otherwise(function(b){p.reject(b)});return p},_addVectorTileService:function(){var b=this,p=new m;b._newVectorTileLayer().then(function(f){b._addLayer(f);p.resolve(f)}).otherwise(function(b){p.reject(b)});return p},_addWMS:function(){var b=
this,p=new m;b._readItemJsonData().then(function(f){return b._newWMSLayer(f||{})}).then(function(f){f&&(f.title=b.item.title);b._addLayer(f);p.resolve(f)}).otherwise(function(b){p.reject(b)});return p},_addLayer:function(b){var f=this.item;b&&(b.xtnItemId=f.id,b.xtnAddData=!0,!b.arcgisProps&&f&&(b.arcgisProps={title:f.title},b._titleForLegend=f.title),k.isDefined(b.title)||(b.title=f.title),b._wabProperties={itemLayerInfo:{itemId:f.id,itemUrl:this.itemUrl,portalUrl:f.portalUrl}},this.map.addLayer(b))},
_checkMixedContent:function(b){return u.checkMixedContent(b)},_checkUrl:function(b){return G._checkUrl(b)},_checkVectorTileUrl:function(b,p){var f=new m;if(function(b,f){return-1!==b.indexOf(f,b.length-f.length)}(b,".json"))return p.styleUrl=b,f.resolve(b),f;var h={url:null,content:{},handleAs:"json",callbackParamName:"callback"};this.itemUrl?(h.url=this.itemUrl+"/resources/styles/root.json",w(h,{}).then(function(){p.styleUrl=h.url;f.resolve(h.url)}).otherwise(function(){h.url=b+"/resources/styles/root.json";
w(h,{}).then(function(){p.styleUrl=h.url;f.resolve(h.url)}).otherwise(function(){p.url=b;f.resolve(b)})})):(h.url=b+"/resources/styles/root.json",w(h,{}).then(function(){p.styleUrl=h.url;f.resolve(h.url)}).otherwise(function(){p.url=b;f.resolve(b)}));return f},_generateLayerId:function(){return this._generateLayerIds(1)[0]},_generateLayerIds:function(b){var f,h=[];for(f=0;f<b;f++)h.push(this._generateRandomId());return h},_generateRandomId:function(){var b=null,b="function"===typeof Date.now?Date.now():
(new Date).getTime(),p=(""+Math.random()).replace("0.","r");return(b+""+p).replace(/-/g,"")},_makeFeatureLayerTitle:function(b,p,h){var f,r,d;try{if(p&&h&&p===h||p&&h&&(f=h.indexOf(p),0===f&&(r=h.substring(f+p.length+1),13<=r.length&&(d=/^\d+$/,d.test(r)))))return p}catch(M){}return b.replace("{serviceName}",p).replace("{layerName}",h)},_newImageServiceLayer:function(b){var f=new m,h=this._generateLayerId(),r=this.serviceUrl,e={mapLayerId:h,bandIds:null,format:null,compressionQuality:null,opacity:1,
visibility:!0};k.isDefined(b.visibility)&&!1===b.visibility&&(e.visibility=!1);k.isDefined(b.opacity)&&(e.opacity=b.opacity);k.isDefined(b.minScale)&&!k.isDefined(e.minScale)&&(e.minScale=b.minScale);k.isDefined(b.maxScale)&&!k.isDefined(e.maxScale)&&(e.maxScale=b.maxScale);k.isDefined(b.refreshInterval)&&!k.isDefined(e.refreshInterval)&&(e.refreshInterval=b.refreshInterval);!b.popupInfo||e.popupInfo||e.disablePopup||(e.popupInfo=b.popupInfo);b.renderingRule&&!e.renderingRule&&(e.renderingRule=b.renderingRule,
b.renderingRule.functionName&&(e.renderingRule.rasterFunction=b.renderingRule.functionName));b.bandIds&&!e.bandIds&&(e.bandIds=b.bandIds);b.mosaicRule&&!e.mosaicRule&&(e.mosaicRule=b.mosaicRule);b.format&&!e.format&&(e.format=b.format);k.isDefined(b.compressionQuality)&&!k.isDefined(e.compressionQuality)&&(e.compressionQuality=b.compressionQuality);!b.layerDefinition||!b.layerDefinition.definitionExpression||k.isDefined(e.layerDefinition)&&k.isDefined(e.layerDefinition.definitionExpression)||(e.layerDefinition=
e.layerDefinition||{},e.layerDefinition.definitionExpression=b.layerDefinition.definitionExpression);b=new d;null!==e.bandIds&&(b.bandIds=e.bandIds);null!==e.format&&(b.format=e.format,null!==e.compressionQuality&&(b.compressionQuality=e.compressionQuality));e.renderingRule&&e.renderingRule.rasterFunction&&(h=new D(e.renderingRule),b.renderingRule=h);e.mosaicRule&&(h=new x(e.mosaicRule),b.mosaicRule=h);k.isDefined(e.noData)&&(b.noData=e.noData);k.isDefined(e.noDataInterpretation)&&(b.noDataInterpretation=
e.noDataInterpretation);k.isDefined(e.interpolation)&&(b.interpolation=e.interpolation);b={imageServiceParameters:b,opacity:e.opacity,visible:e.visibility};k.isDefined(e.mapLayerId)&&(b.id=e.mapLayerId);k.isDefined(e.minScale)&&(b.minScale=e.minScale);k.isDefined(e.maxScale)&&(b.maxScale=e.maxScale);k.isDefined(e.refreshInterval)&&(b.refreshInterval=e.refreshInterval);k.isDefined(e.resourceInfo)&&(b.resourceInfo=e.resourceInfo);r=new C(this._checkUrl(r),b);this._waitForLayer(r).then(function(b){e.layerDefinition&&
e.layerDefinition.definitionExpression&&b.setDefinitionExpression(e.layerDefinition.definitionExpression,!0);f.resolve(b)},function(b){f.reject(b)});return f},_newInfoTemplate:function(f,p){if(f)try{return new y({description:f.description,title:f.title,showAttachments:f.showAttachments,fieldInfos:f.fieldInfos,mediaInfos:f.mediaInfos})}catch(H){console.error(H)}var h=new b;k.isDefined(p)&&h.setTitle(p);return h},_newKMLLayer:function(){var b={id:this._generateLayerId()},b=new e(this.serviceUrl,b);
return this._waitForLayer(b)},_newMapServiceLayer:function(b){var f=this,h=new m,r=this.serviceUrl,e=this._generateLayerId();w({url:r,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{}).then(function(p){var d=null,d={id:e};if(p.tileInfo)d=new B(r,d);else if(p&&p.supportedImageFormatTypes&&-1!==p.supportedImageFormatTypes.indexOf("PNG32")&&(d.imageParameters=new E,d.imageParameters.format="png32"),d=new v(r,d),b&&b.layers&&0<b.layers.length){var c=[],y,J=[],H,x=[],D;n.forEach(b.layers,
function(f){f.layerDefinition&&f.layerDefinition.definitionExpression&&(c[f.id]=f.layerDefinition.definitionExpression);if(f.layerDefinition&&f.layerDefinition.source){y=null;D=f.layerDefinition.source;if("mapLayer"===D.type){var h=n.filter(p.layers,function(b){return b.id===D.mapLayerId});h.length&&(y=a.mixin(h[0],f))}else y=a.mixin({},f);y&&(y.source=D,delete y.popupInfo,y=new F(y),b.visibleLayers&&(h="string"===typeof b.visibleLayers?b.visibleLayers.split(","):b.visibleLayers,-1<n.indexOf(h,f.id)?
y.defaultVisibility=!0:y.defaultVisibility=!1),J.push(y))}f.layerDefinition&&f.layerDefinition.source&&f.layerDefinition.drawingInfo&&(H=new q(f.layerDefinition.drawingInfo),x[f.id]=H)});0<c.length&&d.setLayerDefinitions(c);0<J.length&&(d.setDynamicLayerInfos(J,!0),0<x.length&&d.setLayerDrawingOptions(x,!0))}f._waitForLayer(d).then(function(p){var r=null;n.forEach(p.layerInfos,function(p){var h=null;b&&n.some(b.layers,function(b){if(p.id===b.id)return h=b,!0});var d=null;h&&h.popupInfo&&(d=h.popupInfo);
d&&(null===r&&(r={}),r[p.id]={infoTemplate:f._newInfoTemplate(d,p.name)})});null===p.infoTemplates&&r&&(p.infoTemplates=r);h.resolve(p)},function(b){h.reject(b)})},function(b){h.reject(b)});return h},_getVisibleFeatureLayers:function(b,p){if(!b||!p||0===p.length)return[];var f=","+p+",",h=[],r,d=",";for(r=0;r<b.length;r++)if(null!==b[r].subLayerIds){if(-1===f.indexOf(","+b[r].id+",")||-1<d.indexOf(","+b[r].id+","))d+=b[r].subLayerIds.toString()+","}else-1<f.indexOf(","+b[r].id+",")&&-1===d.indexOf(","+
b[r].id+",")&&h.push(b[r].id);return h},_newPopupInfo:function(b,p){if(b&&b.fields){var f={title:b.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]};"string"===typeof p&&0<p.length&&(f.title=p);n.forEach(b.fields,function(b){var p=r.getDefaultPortalFieldInfo(b);p.visible=!0;p.isEditable=b.editable;f.fieldInfos.push(p)});return f}return null},_newVectorTileLayer:function(){var b=this,p=new m,h={},r=this.serviceUrl,d=this._generateLayerId();"string"===typeof r&&0<r.length?this._checkVectorTileUrl(r,
h).then(function(f){"string"===typeof f&&0<f.length?(f=b._checkMixedContent(f),f=new I(f,{id:d,opacity:1,visible:!0}),b._waitForLayer(f).then(function(b){p.resolve(b)},function(b){p.reject(b)})):p.resolve(null)},function(b){p.reject(b)}):p.resolve(null);return p},_newWMSLayer:function(){var b={id:this._generateLayerId()},b=new z(this.serviceUrl,b),p=this,b=this._waitForLayer(b);b.then(function(b){p._setWMSVisibleLayers(b)});return b},_processFeatureLayer:function(b,p,r){var f=this,d=c.search.featureLayerTitlePattern,
e=null;r&&r.layers&&0<r.layers.length?n.some(r.layers,function(r){var c,q,J,H=!1;if(r.id===b.layerId){r.popupInfo&&(c=r.popupInfo,c=t.parse(t.stringify(c)),c=new y(c),b.setInfoTemplate(c),H=!0);k.isDefined(r.showLabels)&&b.setShowLabels(r.showLabels);k.isDefined(r.refreshInterval)&&b.setRefreshInterval(r.refreshInterval);k.isDefined(r.showLegend)&&console.log("");k.isDefined(r.timeAnimation)&&!1===r.timeAnimation&&console.log("");if(c=r.layerDefinition)c.definitionExpression&&b.setDefinitionExpression(c.definitionExpression),
c.displayField&&b.displayField(c.displayField),c.drawingInfo&&(c.drawingInfo.renderer&&(q=t.parse(t.stringify(c.drawingInfo.renderer)),J=h.fromJson(q),q.type&&"classBreaks"===q.type&&(J.isMaxInclusive=!0),b.setRenderer(J)),k.isDefined(c.drawingInfo.transparency)&&b.setOpacity(1-c.drawingInfo.transparency/100)),k.isDefined(c.minScale)&&b.setMinScale(c.minScale),k.isDefined(c.maxScale)&&b.setMaxScale(c.maxScale),k.isDefined(c.defaultVisibility)&&!1===c.defaultVisibility&&b.setVisibility(!1);H||f._setFeatureLayerInfoTemplate(b,
r.popupInfo);e={url:b.url,id:b.id,itemId:p.id,title:f._makeFeatureLayerTitle(d,p.title,b.name)};return!0}}):(e={url:b.url,id:b.id,itemId:p.id,title:f._makeFeatureLayerTitle(d,p.title,b.name)},f._setFeatureLayerInfoTemplate(b,null,e.title));return e},_readItemJsonData:function(){return w({url:this.itemUrl+"/data",content:{f:"json"},handleAs:"json"},{})},_readRestInfo:function(b){return w({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{})},_setFeatureLayerInfoTemplate:function(b,
p,h){p||(p=this._newPopupInfo(b,h));p=this._newInfoTemplate(p,h);b.setInfoTemplate(p)},_setWMSVisibleLayers:function(b){var f=[];b&&(n.some(b.layerInfos,function(b){if("string"===typeof b.name&&0<b.name.length)if(10>f.length)f.push(b.name);else return!0}),10>=f.length&&b.setVisibleLayers(f))},_waitForLayer:function(b){var f=new m,h=[];if(b.loaded)return f.resolve(b),f;if(b.loadError)return f.reject(b.loadError),f;var r=function(){n.forEach(h,function(b){b.remove()})};h.push(b.on("load",function(b){r();
f.resolve(b.layer)}));h.push(b.on("error",function(b){r();b=b.error;try{b.message&&-1!==b.message.indexOf("Unable to complete")?(console.warn("layerAccessError",b),f.reject(Error(c.search.layerInaccessible))):f.reject(b)}catch(L){f.reject(b)}}));return f}})})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(l,a,n,g,m,t){l=l(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,
width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,compressionQuality:null,bandIds:null,timeExtent:null,mosaicRule:null,renderingRule:null,renderer:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,lercVersion:null,toJson:function(c){var a=this.bbox||this.extent;c=(a=a&&c&&a._normalize(!0))?a.spatialReference.wkid||n.toJson(a.spatialReference.toJson()):null;var k=this.imageSpatialReference,a={bbox:a?a.xmin+","+a.ymin+","+a.xmax+","+a.ymax:null,bboxSR:c,
size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:k?k.wkid||n.toJson(k.toJson()):c,format:this.format,interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?n.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?n.toJson(this.renderingRule.toJson()):null,renderer:this.renderer?n.toJson(this.renderer.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,
compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio,lercVersion:this.lercVersion};c=this.timeExtent;a.time=c?c.toJson().join(","):null;return t.filter(a,function(c){if(null!==c&&void 0!==c)return!0})}});a.mixin(l,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"});
g("extend-esri")&&a.setObject("layers.ImageServiceParameters",l,m);return l})},"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../urlUtils ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),function(l,
a,n,g,m,t,c,u,k,w,G,v,C,B,F,A,E,d,e,q,x,D,I){var z=a([e],{declaredClass:"esri.layers.KMLLayer",serviceUrl:F.getProtocolForWebResource()+"//utility.arcgis.com/sharing/kml",constructor:function(d,b){d||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new A({wkid:4326});this._options=g.mixin({},b);v.defaults.kmlService&&(this.serviceUrl=v.defaults.kmlService);var h=this.linkInfo=b&&b.linkInfo;h&&(this.visible=!!h.visibility,this._waitingForMap=!!h.viewFormat);
(!h||h&&h.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=g.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(d){if(d){var b=d.type,h=d.id,r;switch(b){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(d=this["_"+b])&&(r=g.getObject("_mode._featureMap."+h,!1,d));break;case "GroundOverlay":if(d=this._groundLyr){var f=d.getImages(),b=f.length;for(d=0;d<b;d++)if(f[d].id===h){r=f[d];break}}break;case "ScreenOverlay":break;
case "NetworkLink":m.some(this._links,function(b){return b.linkInfo&&b.linkInfo.id===h?(r=b,!0):!1});break;case "Folder":b=(f=this.folders)?f.length:0;for(d=0;d<b;d++)if(f[d].id===h){r=f[d];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return r}},getLayers:function(){var d=[];this._groundLyr&&d.push(this._groundLyr);this._fLayers&&(d=d.concat(this._fLayers));this._links&&m.forEach(this._links,function(b){b.declaredClass&&d.push(b)});return d},setFolderVisibility:function(d,
b){d&&(this._fireUpdateStart(),(d.visible=b)&&(b=this._areLocalAncestorsVisible(d)),this._setState(d,b),this._fireUpdateEnd())},_eventMap:{"network-link-error":["error"]},onRefresh:function(){},onOpacityChange:function(){},onNetworkLinkError:function(){},_parseKml:function(d){var b=this;this._fireUpdateStart();this._io=B({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(d),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:t.toJson(this._outSR.toJson())},callbackParamName:"callback",
load:function(h){b._io=null;b._initLayer(h)},error:function(h){b._io=null;h=g.mixin(Error(),h);h.message="Unable to load KML: "+(h.message||"");b._fireUpdateEnd(h);b._errorHandler(h)}})},_initLayer:function(e){var b;this.loaded&&(b=[],m.forEach(this.folders,function(f){f.visible&&b.push(f.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());this.name=e.name;this.description=e.description;this.snippet=e.snippet;
this.visibility=e.visibility;this.featureInfos=e.featureInfos;var h,r,f=this.folders=e.folders,p=[],c;if(f)for(r=f.length,h=0;h<r;h++)c=f[h]=new q(f[h]),-1===c.parentFolderId&&p.push(c);var f=this._links=e.networkLinks,H;r=f?f.length:0;for(h=0;h<r;h++)f[h].viewRefreshMode&&-1!==f[h].viewRefreshMode.toLowerCase().indexOf("onregion")||(H=g.mixin({},this._options),H.linkInfo=f[h],H.id&&(H.id=H.id+"_"+h),c=f[h]=new z(f[h].href,H),c._parentLayer=this,c._parentFolderId=this._getLinkParentId(c.linkInfo.id),
c._linkErrorHandle=c.on("error,network-link-error",g.hitch(c,function(b){this._parentLayer.onNetworkLinkError(b.error)})));if((f=e.groundOverlays)&&0<f.length)for(H=g.mixin({},this._options),H.id&&(H.id+="_mapImage"),c=this._groundLyr=new D(H),r=f.length,h=0;h<r;h++)c.addImage(new x(f[h]));(e=g.getObject("featureCollection.layers",!1,e))&&0<e.length&&(this._fLayers=[],m.forEach(e,function(b,f){var h=g.getObject("featureSet.features",!1,b);h&&0<h.length&&(H=g.mixin({outFields:["*"],infoTemplate:b.popupInfo?
new d(b.popupInfo):null,editable:!1},this._options),H.id&&(H.id=H.id+"_"+f),b.layerDefinition.capabilities="Query,Data",h=new I(b,H),h.geometryType&&(this["_"+h.geometryType]=h),this._fLayers.push(h))},this),0===this._fLayers.length&&delete this._fLayers);if(!this.loaded)for(r=p.length,h=0;h<r;h++)c=p[h],this._setState(c,c.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),m.forEach(this.folders,function(f){-1<m.indexOf(b,f.id)?this.setFolderVisibility(f,!0):this.setFolderVisibility(f,
!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var d=this._map;this._fireUpdateStart();this._links&&m.forEach(this._links,function(b){b.declaredClass&&(d.addLayer(b),b._waitingForMap&&(b._waitingForMap=null,b.visible?b._parseKml(d):b._wMap=d))});var b=d.spatialReference,h=this._outSR,r;if(!b.equals(h))if(b.isWebMercator()&&4326===h.wkid)r=E.geographicToWebMercator;else if(h.isWebMercator()&&4326===b.wkid)r=E.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");
return}this._groundLyr&&(r&&m.forEach(this._groundLyr.getImages(),function(b){b.extent=r(b.extent)}),d.addLayer(this._groundLyr));(b=this._fLayers)&&0<b.length&&m.forEach(b,function(b){if(r){var f=b.graphics,h,e,c=f?f.length:0;for(h=0;h<c;h++)(e=f[h].geometry)&&f[h].setGeometry(r(e))}d.addLayer(b)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var d=this._map;this._links&&m.forEach(this._links,function(b){b.declaredClass&&b._io&&b._io.cancel();b._linkErrorHandle&&(b._linkErrorHandle.remove(),
b._linkErrorHandle=null)});d&&m.forEach(this.getLayers(),d.removeLayer,d)},_setState:function(d,b){var h=d.featureInfos,r,f,p,e=h?h.length:0,c=b?"show":"hide";for(p=0;p<e;p++)if(r=h[p],f=this.getFeature(r))if("Folder"===r.type)this._setState(f,b&&f.visible);else if("NetworkLink"===r.type)this._setInternalVisibility(f,b);else f[c]()},_areLocalAncestorsVisible:function(d){var b=d.parentFolderId;for(d=d.visible;d&&-1!==b;)b=this.getFeature({type:"Folder",id:b}),d=d&&b.visible,b=b.parentFolderId;return d},
_setInternalVisibility:function(d,b){var h=d._parentLayer,r=d._parentFolderId;for(b=b&&d.visible;b&&h;)b=b&&h.visible,-1<r&&(b=b&&h._areLocalAncestorsVisible(h.getFeature({type:"Folder",id:r}))),r=h._parentFolderId,h=h._parentLayer;this._setIntState(d,b)},_setIntState:function(d,b){d&&m.forEach(d.getLayers(),function(h){h.linkInfo?d._setIntState(h,b&&h.visible&&d._areLocalAncestorsVisible(d.getFeature({type:"Folder",id:h._parentFolderId}))):h.setVisibility(b)})},_getLinkParentId:function(d){var b=
-1;this.folders&&m.some(this.folders,function(h){return h.networkLinkIds&&-1!==m.indexOf(h.networkLinkIds,d)?(b=h.id,!0):!1});return b},_checkAutoRefresh:function(){var d=this.linkInfo;if(d)if(this.visible){if(this.loaded&&this._map){var b=d.refreshMode,h=d.refreshInterval,r=d.viewRefreshMode,d=d.viewRefreshTime;b&&-1!==b.toLowerCase().indexOf("oninterval")&&0<h&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*h));r&&-1!==r.toLowerCase().indexOf("onstop")&&0<d&&!this._extChgHandle&&
(this._extChgHandle=n.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),n.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(d){d=d||this._map;var b={},h=this.linkInfo,r=d&&d.extent,f;this._url.query&&(g.mixin(b,this._url.query),f=!!this._url.query.token);G.id&&!f&&(f=G.id.findCredential(this._url.path))&&(b.token=f.token);if(h){f=h.viewFormat;
var p=h.httpQuery,h=h.viewBoundScale;if(r&&f){var e=r,c=r,q=r.spatialReference;q&&(q.isWebMercator()?e=E.webMercatorToGeographic(r):4326===q.wkid&&(c=E.geographicToWebMercator(r)));r=e.getCenter();c=Math.max(c.getWidth(),c.getHeight());h&&(e=e.expand(h));f=f.replace(/\[bboxWest\]/ig,e.xmin).replace(/\[bboxEast\]/ig,e.xmax).replace(/\[bboxSouth\]/ig,e.ymin).replace(/\[bboxNorth\]/ig,e.ymax).replace(/\[lookatLon\]/ig,r.x).replace(/\[lookatLat\]/ig,r.y).replace(/\[lookatRange\]/ig,c).replace(/\[lookatTilt\]/ig,
0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,r.x).replace(/\[lookatTerrainLat\]/ig,r.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,r.x).replace(/\[cameraLat\]/ig,r.y).replace(/\[cameraAlt\]/ig,c).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,d.width).replace(/\[vertPixels\]/ig,d.height).replace(/\[terrainEnabled\]/ig,0);g.mixin(b,u.queryToObject(f))}p&&(p=p.replace(/\[clientVersion\]/ig,G.version).replace(/\[kmlVersion\]/ig,
2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,l.locale),g.mixin(b,u.queryToObject(p)))}d=[];for(var x in b)C.isDefined(b[x])&&d.push(x+"\x3d"+b[x]);return(d=d.join("\x26"))?"?"+d:""},setScaleRange:function(d,b){this.inherited(arguments);m.forEach(this.getLayers(),function(h){h.setScaleRange(d,b)})},setOpacity:function(d){this.opacity!=d&&(m.forEach(this.getLayers(),function(b){b.setOpacity(d)}),this.opacity=d,this.onOpacityChange(d))},_setMap:function(d,b){this.inherited(arguments);
this._map=d;var h=this._div=k.create("div",null,b);w.set(h,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return h},_unsetMap:function(d,b){this._io&&this._io.cancel();this._stopAutoRefresh();n.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var h=this._div;h&&(b.removeChild(h),k.destroy(h));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(d){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,
d),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&d&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._parseKml()},getFeatureCollection:function(d){var b,h=[];(d=this.getFeature({type:"Folder",id:d}))&&(b=m.map(d.featureInfos,function(b){if("esriGeometryPoint"===b.type||"esriGeometryPolyline"===b.type||"esriGeometryPolygon"===b.type)return b.id},this))&&0<b.length&&m.forEach(this._fLayers,function(d){var f,
p;f=d.toJson();f.featureSet.features&&0<f.featureSet.features.length&&(p=m.filter(f.featureSet.features,function(f){if(-1!==m.indexOf(b,f.attributes[d.objectIdField]))return f},this));p&&0<p.length&&(f.featureSet.features=p,h.push(f))},this);return h},getFeatureCount:function(d){d=this.getFeature({type:"Folder",id:d});var b={points:0,polylines:0,polygons:0};d&&m.forEach(d.featureInfos,function(h){"esriGeometryPoint"===h.type&&(b.points+=1);"esriGeometryPolyline"===h.type&&(b.polylines+=1);"esriGeometryPolygon"===
h.type&&(b.polygons+=1)});return b},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});c("extend-esri")&&g.setObject("layers.KMLLayer",z,G);return z})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(l,a,n,g,m){l=l(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(g){a.mixin(this,g);m.isDefined(this.visibility)&&(this.visible=
!!this.visibility)}});n("extend-esri")&&a.setObject("layers.KMLFolder",l,g);return l})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(l,a,n,g,m,t){l=l([t],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(c){m.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});n("extend-esri")&&a.setObject("layers.KMLGroundOverlay",l,g);return l})},"esri/layers/WMSLayer":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff ../config ../graphic ../kernel ../request ../urlUtils ../dijit/PopupTemplate ../SpatialReference ../geometry/Extent ../geometry/Point ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),
function(l,a,n,g,m,t,c,u,k,w,G,v,C,B,F,A,E){n=n([A],{declaredClass:"esri.layers.WMSLayer",_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],
[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(d,e){var c=G.urlToObject(d);c.query&&(c.query.version||c.query.Version||c.query.VERSION)&&
(this.version=c.query.version||c.query.Version||c.query.VERSION);this.url=d=this._stripParameters(d,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));this._url=G.urlToObject(d);this._getCapabilitiesURL=d;this._initLayer=g.hitch(this,this._initLayer);this._parseCapabilities=g.hitch(this,this._parseCapabilities);this._getCapabilitiesError=g.hitch(this,this._getCapabilitiesError);e?(this.customParameters=e.customParameters,
this.customLayerParameters=e.customLayerParameters,this.imageFormat=this._getImageFormat(e.format),this.imageTransparency=!1!==e.transparent,this.visibleLayers=e.visibleLayers?e.visibleLayers:[],this.version=e.version||this.version,e.resourceInfo?this._readResourceInfo(e.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=l.toUrl("../images/pixel.png");this.extentProcessor=this._createExtentProcessor(0);
this._createChildLayer()},setVisibleLayers:function(d){this.visibleLayers=(d=this._checkVisibleLayersList(d))?d:[];this.refresh(!0)},setImageFormat:function(d){this.imageFormat=this._getImageFormat(d);this.refresh(!0)},setImageTransparency:function(d){this.imageTransparency=d;this.refresh(!0)},setCustomParameters:function(d,e){this.customParameters=d;this.customLayerParameters=e;this.refresh(!0)},refresh:function(){this.inherited(arguments);this._childLayer&&this._childLayer.refresh.apply(this._childLayer,
arguments)},getImageUrl:function(d,e,c,x){if(this.visibleLayers&&0!==this.visibleLayers.length){d=this._getImageParams(d,e,c);d=this._mixinCustomLayerParameters(d);e=this.getMapURL;var q;e+=-1===e.indexOf("?")?"?":"";for(q in d)d.hasOwnProperty(q)&&(e+="?"===e.substring(e.length-1,e.length)?"":"\x26",e+=q+"\x3d"+d[q]);x(G.addProxy(e))}else x(this._blankImageURL)},_setMap:function(d,e,c){var q=this.inherited(arguments);d.wrapAround180?this._childLayer&&(this.suspended&&this._childLayer.suspend(),this._childLayer._setMap(d,
q)):this._childLayer=this.extentProcessor=null;return q},_unsetMap:function(d,e){this._childLayer&&this._childLayer._unsetMap(d,this._div);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._childLayer&&this._childLayer.suspend()},onResume:function(){this.inherited(arguments);this._childLayer&&this._childLayer.resume()},_createChildLayer:function(){this._childLayer=new A(null,{extentProcessor:this._createExtentProcessor(1)});this._childLayer._isChildLayer=!0;this._childLayer.getImageUrl=
g.hitch(this,this.getImageUrl);this._childLayer.loaded=!0},_createExtentProcessor:function(d){return g.hitch(this,this._extentProcessor,d)},_extentProcessor:function(d,e){var c=e.extent,x=e.width,a=0;if(c){var k=c.getWidth()/x,z=c.bisect(),c=z.extents,y=c[d];y&&(x=z.marginLeft/k,a=0===d?x:x+c[0].getWidth()/k,x=Math.ceil(y.getWidth()/k),a=Math.ceil(a));c=y}return{extent:c,width:x,marginLeft:a}},_getImageParams:function(d,e,c){var q=d.spatialReference.wkid;-1===m.indexOf(this.spatialReferences,q)&&
d.spatialReference.latestWkid&&(q=d.spatialReference.latestWkid);if(m.some(this._WEB_MERCATOR,function(b){return b==q})){var a=m.filter(this.spatialReferences,function(b){return m.some(this._WEB_MERCATOR,function(h){return h==b})},this);0===a.length&&(a=m.filter(this.spatialReferences,function(b){return m.some(this._WORLD_MERCATOR,function(h){return h==b})},this));q=0<a.length?a[0]:this._WEB_MERCATOR[0]}this.spatialReferences=m.filter(this.spatialReferences,function(b){return b!==q});this.spatialReferences.unshift(q);
var a=d.xmin,k=d.xmax,z=d.ymin;d=d.ymax;var y={SERVICE:"WMS",REQUEST:"GetMap"};y.FORMAT=this.imageFormat;y.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";y.STYLES="";y.VERSION=this.version;y.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;y.WIDTH=e;y.HEIGHT=c;this.maxWidth<e&&(y.WIDTH=this.maxWidth);this.maxHeight<c&&(y.HEIGHT=this.maxHeight);e=q?q:NaN;isNaN(e)||("1.3.0"==this.version?y.CRS="EPSG:"+e:y.SRS="EPSG:"+e);"1.3.0"==this.version&&this._useLatLong(e)?y.BBOX=z+","+a+","+d+
","+k:y.BBOX=a+","+z+","+k+","+d;return y},_initLayer:function(d,e){this.spatialReference=new C(this.extent.spatialReference);this.initialExtent=new B(this.extent);this.fullExtent=new B(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);var q=g.hitch(this,function(){this.loaded=!0;this.onLoad(this);var d=this._loadCallback;d&&(delete this._loadCallback,d(this))});if(t("chrome")){var a=c.defaults.io,D="with-credentials"===a.useCors?G.canUseXhr(this.getMapURL,!0):-1;(a=
-1<D?a.corsEnabledServers[D]:null)&&a.withCredentials?w({url:this.getMapURL,handleAs:"text",content:{SERVICE:"WMS",REQUEST:"GetMap"}}).addBoth(function(){q()}):q()}else q()},_readResourceInfo:function(d){d.extent?d.layerInfos?(this.extent=d.extent,this.allExtents[0]=d.extent,this.layerInfos=d.layerInfos,this.description=d.description?d.description:"",this.copyright=d.copyright?d.copyright:"",this.title=d.title?d.title:"",this.getMapURL=d.getMapURL?d.getMapURL:this._getCapabilitiesURL,this.getFeatureInfoURL=
d.getFeatureInfoURL,this.featureInfoFormat=d.featureInfoFormat,this.version=d.version?d.version:"1.3.0",this.maxWidth=d.maxWidth?d.maxWidth:5E3,this.maxHeight=d.maxHeight?d.maxHeight:5E3,this.spatialReferences=d.spatialReferences?d.spatialReferences:[],this.imageFormat=this._getImageFormat(d.format),this.setScaleRange(d.minScale,d.maxScale),this.customLayerParameters=d.customLayerParameters||this.customLayerParameters,this.customParameters=d.customParameters||this.customParameters,this._initLayer()):
this._errorHandler(Error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo")):this._errorHandler(Error("esri.layers.WMSLayer: Unable to find the 'extent' property in resourceInfo."))},_getCapabilities:function(){var d=this._url.query?this._url.query:{};d.SERVICE="WMS";d.REQUEST="GetCapabilities";this.version&&(d.VERSION=this.version);var d=this._mixinCustomParameters(d),e=this._url.path+"?",c;for(c in d)d.hasOwnProperty(c)&&(e+="?"==e.substring(e.length-1,e.length)?"":
"\x26",e+=c+"\x3d"+d[c]);w({url:e,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(d){if(d){var e=this;this.version=this._getAttributeValue("WMS_Capabilities","version",d,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",d,"1.3.0"));var c=this._getTag("Service",d);this.title=this._getTagValue("Title",c,"");this.title||(this.title=this._getTagValue("Name",c,
""));this.copyright=this._getTagValue("AccessConstraints",c,"");this.description=this._getTagValue("Abstract",c,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",c,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",c,5E3),10);if(c=this._getTag("Layer",d)){var x=this._getLayerInfo(c),D=0,k=null,c=this._getTag("Capability",d);m.forEach(c.childNodes,function(b){"Layer"==b.nodeName&&(0===D?k=b:(1===D&&x.name&&(x.name="",x.subLayers=[],x.subLayers.push(this._getLayerInfo(k))),x.subLayers.push(this._getLayerInfo(b))),
D++)},this);if(x&&(this.layerInfos=x.subLayers,this.layerInfos&&0!==this.layerInfos.length||(this.layerInfos=[x]),this.extent=x.extent,this.extent||(x.extent=new B(this.layerInfos[0].extent.toJson()),this.extent=x.extent),this.allExtents=x.allExtents,this.allExtents&&this.allExtents.length||(x.allExtents=[],m.forEach(this.layerInfos[0].allExtents,function(b,d){b&&(x.allExtents[d]=new B(b.toJson()))}),this.allExtents=x.allExtents),this.spatialReferences=x.spatialReferences,!this.spatialReferences.length&&
0<this.layerInfos.length))for(var z=function(b){var h;for(h=0;h<b.subLayers.length;h++){var f=b.subLayers[h],p=f.spatialReferences;!p.length&&f.subLayers&&0<f.subLayers.length&&(p=z(f));if(p.length)return p}return[]},c=0;c<this.layerInfos.length;c++){var y=this.layerInfos[c];this.spatialReferences=this.layerInfos[0].spatialReferences;!this.spatialReferences.length&&y.subLayers&&0<y.subLayers.length&&(this.spatialReferences=z(y));if(this.spatialReferences.length)break}c=function(b){return(b=a.query("DCPType",
e._getTag(b,d)))&&0<b.length&&(b=a.query("HTTP",b[0]))&&0<b.length&&(b=a.query("Get",b[0]))&&0<b.length&&(b=e._getAttributeValue("OnlineResource","xlink:href",b[0],null))?(b.indexOf("\x26")===b.length-1&&(b=b.substring(0,b.length-1)),e._stripParameters(b,["service","request"])):null};y=function(b){var h=[];0===a.query("Operation",d).length?m.forEach(a.query("Format",e._getTag(b,d)),function(b){h.push(b.text?b.text:b.textContent)}):m.forEach(a.query("Operation",d),function(f){f.getAttribute("name")===
b&&m.forEach(a.query("Format",f),function(b){h.push(b.text?b.text:b.textContent)})});return h};this.getMapURL=c("GetMap")||this._getCapabilitiesURL;this.getMapFormats=y("GetMap");m.some(this.getMapFormats,function(b){return-1<b.indexOf(this.imageFormat)},this)||(this.imageFormat=this.getMapFormats[0]);if(this.getFeatureInfoURL=c("GetFeatureInfo"))this.getFeatureInfoFormats=y("GetFeatureInfo"),-1<m.indexOf(this.getFeatureInfoFormats,"text/html")?this.featureInfoFormat="text/html":-1<m.indexOf(this.getFeatureInfoFormats,
"text/plain")&&(this.featureInfoFormat="text/plain");if(!this.featureInfoFormat){var b=function(h){if(h&&(h.queryable=!1,h.subLayers))for(var d=0;d<h.subLayers.length;d++)b(h.subLayers[d])};b(x)}this._initLayer()}else this._errorHandler(Error("esri.layers.WMSLayer: Response does not contain any layers."))}else this._errorHandler(Error("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)"))},_getCapabilitiesError:function(d){d&&d.message&&(d.message="GetCapabilities request for "+
this._getCapabilitiesURL+" failed. ("+d.message+")");this._errorHandler(d)},_getLayerInfo:function(d){if(!d)return null;var c=new E;c.name="";c.title="";c.description="";c.allExtents=[];c.spatialReferences=[];c.queryable="1"===d.getAttribute("queryable");c.subLayers=[];var q=this._getTag("LatLonBoundingBox",d);q&&(c.allExtents[0]=this._getExtent(q,4326));var a=this._getTag("EX_GeographicBoundingBox",d),D;a&&(D=new B(0,0,0,0,new C({wkid:4326})),D.xmin=parseFloat(this._getTagValue("westBoundLongitude",
a,0)),D.ymin=parseFloat(this._getTagValue("southBoundLatitude",a,0)),D.xmax=parseFloat(this._getTagValue("eastBoundLongitude",a,0)),D.ymax=parseFloat(this._getTagValue("northBoundLatitude",a,0)),c.allExtents[0]=D);q||a||(D=new B(-180,-90,180,90,new C({wkid:4326})),c.allExtents[0]=D);c.extent=c.allExtents[0];var k=-1<m.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";m.forEach(d.childNodes,function(d){if("Name"==d.nodeName)c.name=(d.text?d.text:d.textContent)||"";else if("Title"==d.nodeName)c.title=
(d.text?d.text:d.textContent)||"";else if("Abstract"==d.nodeName)c.description=(d.text?d.text:d.textContent)||"";else if("BoundingBox"==d.nodeName){var e=d.getAttribute(k);e&&0===e.indexOf("EPSG:")?(e=parseInt(e.substring(5),10),0===e||isNaN(e)||(d="1.3.0"==this.version?this._getExtent(d,e,this._useLatLong(e)):this._getExtent(d,e),c.allExtents[e]=d,c.extent||(c.extent=d))):e&&0===e.indexOf("CRS:")?(e=parseInt(e.substring(4),10),0===e||isNaN(e)||(this._CRS_TO_EPSG[e]&&(e=this._CRS_TO_EPSG[e]),c.allExtents[e]=
this._getExtent(d,e))):(e=parseInt(e,10),0===e||isNaN(e)||(c.allExtents[e]=this._getExtent(d,e)))}else if(d.nodeName==k)d=(d.text?d.text:d.textContent).split(" "),m.forEach(d,function(b){b=-1<b.indexOf(":")?parseInt(b.split(":")[1],10):parseInt(b,10);0===b||isNaN(b)||(this._CRS_TO_EPSG[b]&&(b=this._CRS_TO_EPSG[b]),-1==m.indexOf(c.spatialReferences,b)&&c.spatialReferences.push(b))},this);else if("Style"!=d.nodeName||c.legendURL)"Layer"===d.nodeName&&c.subLayers.push(this._getLayerInfo(d));else if(d=
this._getTag("LegendURL",d))if(d=this._getTag("OnlineResource",d))c.legendURL=d.getAttribute("xlink:href")},this);c.title=c.title||c.name;return c},_getImageFormat:function(d){switch(d?d.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";
case "image/svg+xml":return"svg";default:return"png"}},_getExtent:function(d,c,q){var e;if(d){e=new B;var a=parseFloat(d.getAttribute("minx")),k=parseFloat(d.getAttribute("miny")),z=parseFloat(d.getAttribute("maxx"));d=parseFloat(d.getAttribute("maxy"));q?(e.xmin=isNaN(k)?-1*Number.MAX_VALUE:k,e.ymin=isNaN(a)?-1*Number.MAX_VALUE:a,e.xmax=isNaN(d)?Number.MAX_VALUE:d,e.ymax=isNaN(z)?Number.MAX_VALUE:z):(e.xmin=isNaN(a)?-1*Number.MAX_VALUE:a,e.ymin=isNaN(k)?-1*Number.MAX_VALUE:k,e.xmax=isNaN(z)?Number.MAX_VALUE:
z,e.ymax=isNaN(d)?Number.MAX_VALUE:d);e.spatialReference=new C({wkid:c})}return e},_useLatLong:function(d){var c,q;for(q=0;q<this._REVERSED_LAT_LONG_RANGES.length;q++){var a=this._REVERSED_LAT_LONG_RANGES[q];if(d>=a[0]&&d<=a[1]){c=!0;break}}return c},_getTag:function(d,c){var e=a.query(d,c);return e&&0<e.length?e[0]:null},_getTagValue:function(d,c,q){return(d=a.query(d,c))&&0<d.length?d[0].text?d[0].text:d[0].textContent:q},_getAttributeValue:function(d,c,q,x){return(d=a.query(d,q))&&0<d.length?d[0].getAttribute(c):
x},_checkVisibleLayersList:function(d){if(d&&0<d.length&&this.layerInfos&&0<this.layerInfos.length&&"number"==typeof d[0]){var c=[];m.forEach(d,function(d){d<this.layerInfos.length&&c.push(this.layerInfos[d].name)},this);d=c}return d},_stripParameters:function(d,c){var e=G.urlToObject(d),a,D=[];for(a in e.query)e.query.hasOwnProperty(a)&&-1===m.indexOf(c,a.toLowerCase())&&D.push(a+"\x3d"+e.query[a]);return e.path+(D.length?"?"+D.join("\x26"):"")},_getPopupGraphic:function(d,c){var e=this.visibleLayers;
if(!e||0===e.length)return null;var a=this._popupGraphic;a||(a=new v({title:this.title||"",description:'\x3cdiv style\x3d"position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%;"\x3e\x3ciframe src\x3d"{QUERY_URL}" width\x3d"250" height\x3d"147" frameborder\x3d"0" marginwidth\x3d"0" marginheight\x3d"0" style\x3d"position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:url(\''+l.toUrl("../dijit/images/loading-throb.gif")+"') transparent center no-repeat;\" onload\x3d\"(event.target || event.srcElement).style.background \x3d 'none';\"\x3e\x3c/iframe\x3e\x3c/div\x3e"}),
a=this._popupGraphic=new u(null,null,{},a),a._layer=this);var D=function(b){var h=[];if(b&&(b.queryable&&b.showPopup&&b.name&&h.push(b.name),b.subLayers))for(var f=0;f<b.subLayers.length;f++){var p=D(b.subLayers[f]);p.length&&(h=h.concat(p))}return h},k=D({subLayers:this.layerInfos}),k=m.filter(k,function(b){return-1<m.indexOf(e,b)});if(k.length){var z=this.getFeatureInfoURL,g=this._getImageParams(d.extent,d.width,d.height),g=this._mixinCustomLayerParameters(g);g.REQUEST="GetFeatureInfo";g.INFO_FORMAT=
this.featureInfoFormat;g.QUERY_LAYERS=k.join();g.FEATURE_COUNT=25;"1.3.0"===this.version?(g.I=Math.round(c.x),g.J=Math.round(c.y)):(g.X=Math.round(c.x),g.Y=Math.round(c.y));var z=z+(-1===z.indexOf("?")?"?":""),b;for(b in g)g.hasOwnProperty(b)&&(z+="?"===z.substring(z.length-1,z.length)?"":"\x26",z+=b+"\x3d"+g[b]);a.attributes.QUERY_URL=z;return a}return null},_mixinCustomParameters:function(d){if(this.customParameters)for(var c in this.customParameters)d[c]=encodeURIComponent(this.customParameters[c]);
return d},_mixinCustomLayerParameters:function(d){if(this.customLayerParameters||this.customParameters){var c=g.clone(this.customParameters||{});g.mixin(c,this.customLayerParameters||{});for(var a in c)"styles"===a.toLowerCase()&&delete d.STYLES,d[a]=encodeURIComponent(c[a])}return d}});t("extend-esri")&&g.setObject("layers.WMSLayer",n,k);return n})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(l,a,n,g,m){l=
l(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],queryable:!1,showPopup:!1,constructor:function(a){a&&(this.name=a.name,this.title=a.title,this.description=a.description,this.extent=a.extent,this.legendURL=a.legendURL,this.subLayers=a.subLayers?a.subLayers:[],this.allExtents=a.allExtents?a.allExtents:[],this.spatialReferences=a.spatialReferences?a.spatialReferences:[],this.queryable=!!a.queryable,
this.showPopup=!!a.showPopup)},clone:function(){var a={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL},c;this.extent&&(a.extent=this.extent.getExtent());a.subLayers=[];n.forEach(this.subLayers,function(c){a.subLayers.push(c.clone())});a.allExtents=[];for(c in this.allExtents)c=parseInt(c,10),isNaN(c)||(a.allExtents[c]=this.allExtents[c].getExtent());a.spatialReferences=[];n.forEach(this.spatialReferences,function(c){a.spatialReferences.push(c)});a.queryable=
this.queryable;a.showPopup=this.showPopup;return a}});g("extend-esri")&&a.setObject("layers.WMSLayerInfo",l,m);return l})},"widgets/AddData/search/Paging":function(){define("dojo/_base/declare dojo/dom-class ./SearchComponent dojo/text!./templates/Paging.html dojo/i18n!../nls/strings ./util".split(" "),function(l,a,n,g,m,t){return l([n],{i18n:m,templateString:g,hasLess:!1,hasMore:!1,nextStart:-1,numPerPage:null,previousStart:-1,start:1,postCreate:function(){this.inherited(arguments);null===this.numPerPage&&
(this.numPerPage=30);this.enableOrDisable()},startup:function(){if(!this._started){this.inherited(arguments);try{var c=this.getConfig().numPerPage,a=Number(c);"number"!==typeof a||isNaN(a)||(a=Math.floor(a),1<=a&&100>=a&&(this.numPerPage=a))}catch(k){console.warn("Error setting numPerPage:"),console.warn(k)}null===this.numPerPage&&(this.numPerPage=30)}},enableOrDisable:function(){this.hasLess?(a.remove(this.firstButton.parentNode,"disabled"),a.remove(this.previousButton.parentNode,"disabled")):(a.add(this.firstButton.parentNode,
"disabled"),a.add(this.previousButton.parentNode,"disabled"));this.hasMore?a.remove(this.nextButton.parentNode,"disabled"):a.add(this.nextButton.parentNode,"disabled")},firstButtonClicked:function(){this.hasLess&&(this.start=1,this.search())},previousButtonClicked:function(){this.hasLess&&(this.start=this.previousStart,this.search())},nextButtonClicked:function(){this.hasMore&&(this.start=this.nextStart,this.search())},appendQueryParams:function(c){c.start=this.start;c.num=this.numPerPage},processResults:function(c){this.start=
1;var a=this.numPerPage,k=c.total,g=c.queryParams.start;1>g&&(g=1);this.hasLess=!1;this.previousStart=-1;1<g&&(this.hasLess=!0,this.previousStart=g-c.queryParams.num,1>this.previousStart&&(this.previousStart=1));this.hasMore=!1;this.nextStart=-1;c.nextQueryParams&&1<c.nextQueryParams.start&&(this.hasMore=!0,this.nextStart=c.nextQueryParams.start);c="";k>a?(k=1,1<g&&(k=Math.floor(g/a)+1),c=this.i18n.search.paging.pagePattern,c=c.replace("{page}",""+k)):(c=this.i18n.search.paging.pagePattern,c=c.replace("{page}",
"1"));t.setNodeText(this.pageNode,c);this.enableOrDisable()}})})},"widgets/AddData/search/ResultCount":function(){define("dojo/_base/declare dojo/number ./SearchComponent dojo/text!./templates/ResultCount.html dojo/i18n!../nls/strings ./util".split(" "),function(l,a,n,g,m,t){return l([n],{i18n:m,templateString:g,typePlural:m.search.resultCount.itemPlural,typeSingular:m.search.resultCount.itemSingular,postCreate:function(){this.inherited(arguments)},processResults:function(c){c=c.total;var g=this.typePlural;
1===c&&(g=this.typeSingular);var k=this.i18n.search.resultCount.countPattern,k=k.replace("{count}",a.format(c)),k=k.replace("{type}",g);t.setNodeText(this.messageNode,k)}})})},"widgets/AddData/search/AddFromUrlPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/Deferred dojo/promise/all dojo/dom-class dojo/window dijit/Viewport dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromUrlPane.html dojo/i18n!../nls/strings ./LayerLoader ./util esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/CSVLayer esri/layers/FeatureLayer esri/layers/GeoRSSLayer esri/layers/ImageParameters esri/layers/KMLLayer esri/layers/StreamLayer esri/layers/VectorTileLayer esri/layers/WFSLayer esri/layers/WMSLayer esri/layers/WMTSLayer esri/InfoTemplate dijit/form/Select".split(" "),
function(l,a,n,g,m,t,c,u,k,w,G,v,C,B,F,A,E,d,e,q,x,D,I,z,y,b,h,r,f,p,J){return l([G,v,C],{i18n:F,templateString:B,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);this._updateExamples("ArcGIS");var b=this;this.own(g(this.urlTextBox,"keyup",function(f){f.keyCode===m.ENTER?b.addClicked():u.contains(b.addButton,"disabled")||b._setStatus("")}));this.own(g(this.urlTextBox,"focus",function(){try{b.urlTextBox.select()}catch(K){}}));this.own(g(this.typeSelect,"change",function(f){b._updateExamples(f)}));
this.own(g(this.typeSelect.dropDown,"open",function(){var b=this.domNode.parentElement;b&&u.add(b,"add-data-widget-popup")}));this.own(w.on("resize",b.resize()))},destroy:function(){this.inherited(arguments)},addClicked:function(){var b=this,f=!1,h=this.addButton;if(!u.contains(h,"disabled")){var p=this.typeSelect.get("value"),d=a.trim(this.urlTextBox.value);0<d.length&&(0===d.indexOf("http://")||0===d.indexOf("https://"))&&(f=!0);f&&(u.add(h,"disabled"),b._setStatus(F.search.item.messages.adding),
f=new t,this._handleAdd(f,this.wabWidget.map,p,d),f.then(function(f){f?b._setStatus(""):b._setStatus(F.search.item.messages.addFailed);u.remove(h,"disabled")}).otherwise(function(f){"string"===typeof f&&"Unsupported"===f?(b._setStatus(F.search.item.messages.unsupported),u.remove(h,"disabled")):(console.warn("Add layer failed."),console.warn(f),b._setStatus(F.search.item.messages.addFailed),u.remove(h,"disabled"),f&&"string"===typeof f.message&&0<f.message.length&&(b._setStatus(f.message),console.log("")))}))}},
examplesExpanderClicked:function(){u.toggle(this.examplesNode,"show")},preHide:function(){},resize:function(){var b=k.getBox(this.ownerDocument);b&&"undefined"!==typeof b.w&&(600<b.w?u.add(this.urlTextBox,"url-textbox-wide"):u.remove(this.urlTextBox,"url-textbox-wide"))},_handleAdd:function(a,k,g,l){l=E.checkMixedContent(l);var H=l.toLowerCase(),m=new A,w=m._generateLayerId(),u=this,v=null;"ArcGIS"===g?0<H.indexOf("/featureserver")||0<H.indexOf("/mapserver")?m._readRestInfo(l).then(function(b){if(b&&
"string"===typeof b.type&&"Feature Layer"===b.type)v=new D(l,{id:w,outFields:["*"],infoTemplate:new J}),u._waitThenAdd(a,k,g,m,v);else if(0<H.indexOf("/featureserver")){var f=[];n.forEach(b.layers,function(b){b=new D(l+"/"+b.id,{id:m._generateLayerId(),outFields:["*"],infoTemplate:new J});f.push(m._waitForLayer(b))});c(f).then(function(b){var f=[];n.forEach(b,function(b){f.push(b)});f.reverse();n.forEach(f,function(b){m._setFeatureLayerInfoTemplate(b);b.xtnAddData=!0;k.addLayer(b)});a.resolve(f)}).otherwise(function(b){a.reject(b)})}else if(0<
H.indexOf("/mapserver")){if(b.tileInfo)v=new q(l,{id:w});else{var h={id:w};b&&b.supportedImageFormatTypes&&-1!==b.supportedImageFormatTypes.indexOf("PNG32")&&(h.imageParameters=new z,h.imageParameters.format="png32");v=new d(l,h)}u._waitThenAdd(a,k,g,m,v)}}).otherwise(function(b){a.reject(b)}):0<H.indexOf("/imageserver")?(v=new e(l,{id:w}),this._waitThenAdd(a,k,g,m,v)):0<H.indexOf("/vectortileserver")||0<H.indexOf("/resources/styles/root.json")?h&&h.supported()?m._checkVectorTileUrl(l,{}).then(function(b){v=
new h(b,{id:w});u._waitThenAdd(a,k,g,m,v)}).otherwise(function(b){a.reject(b)}):a.reject("Unsupported"):0<H.indexOf("/streamserver")?(v=new b(l,{id:w,purgeOptions:{displayCount:1E4},infoTemplate:new J}),this._waitThenAdd(a,k,g,m,v)):a.reject("Unsupported"):"WMS"===g?(v=new f(l,{id:w}),this._waitThenAdd(a,k,g,m,v)):"WMTS"===g?v=new p(l,{id:w}):"WFS"===g?(v=new r({id:w,url:l,infoTemplate:new J}),this._waitThenAdd(a,k,g,m,v),console.warn("WFSLayer",v)):"KML"===g?(v=new y(l,{id:w}),this._waitThenAdd(a,
k,g,m,v)):"GeoRSS"===g?(v=new I(l,{id:w}),this._waitThenAdd(a,k,g,m,v)):"CSV"===g&&(v=new x(l,{id:w}),v.setInfoTemplate(m._newInfoTemplate()),this._waitThenAdd(a,k,g,m,v))},_persist:function(){try{var b=this.typeSelect.get("value"),f=a.trim(this.urlTextBox.value);this.wabWidget.xtnAddFromUrlPane={type:b,url:f}}catch(L){}},_restore:function(){try{var b=this.wabWidget.xtnAddFromUrlPane;b&&"string"===typeof b.type&&0<b.type.length&&this.typeSelect.set("value",b.type);b&&"string"===typeof b.url&&0<b.url.length&&
(this.urlTextBox.value=b.url)}catch(K){}},_setStatus:function(b){this.wabWidget&&this.wabWidget._setStatus(b)},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()},_updateExamples:function(b){n.forEach(this.examplesNode.children,function(f){var h=f.getAttribute("data-examples-type");"string"===typeof h&&0<h.length&&(f.style.display=h===b?"":"none")})},_waitThenAdd:function(b,f,h,p,d){p._waitForLayer(d).then(function(d){if("WMS"===h)p._setWMSVisibleLayers(d);else if(!d||"esri.layers.ArcGISDynamicMapServiceLayer"!==
d.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==d.declaredClass)d&&"esri.layers.FeatureLayer"===d.declaredClass?p._setFeatureLayerInfoTemplate(d):d&&"esri.layers.CSVLayer"===d.declaredClass&&p._setFeatureLayerInfoTemplate(d);d.xtnAddData=!0;f.addLayer(d);b.resolve(d)}).otherwise(function(f){b.reject(f)})}})})},"esri/layers/CSVLayer":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../arcgis/csv ./FeatureLayer ../geometry/Extent ../tasks/FeatureSet".split(" "),
function(l,a,n,g,m,t,c,u,k){a=a(c,{declaredClass:"esri.layers.CSVLayer",_preventInit:!0,_fieldTypeMap:{Date:"esriFieldTypeDate",Number:"esriFieldTypeDouble",String:"esriFieldTypeString"},constructor:function(c,a){this.url=c;a=n.mixin({},a);this.columnDelimiter=a.columnDelimiter;this.latitudeFieldName=a.latitudeFieldName;this.longitudeFieldName=a.longitudeFieldName;var g=a.layerDefinition;g||(g={fields:a.fields||[],geometryType:"esriGeometryPoint",copyrightText:a.copyright},a.fields&&l.forEach(a.fields,
function(c){c.type=this._fieldTypeMap[c.type||"String"];c.alias||(c.alias=c.name)},this));this._buildCsvFcParam={url:this.url,columnDelimiter:this.columnDelimiter,layerDefinition:g,outFields:a.outFields};this.latitudeFieldName&&this.longitudeFieldName&&(this._buildCsvFcParam.locationInfo={locationType:"coordinates",latitudeFieldName:this.latitudeFieldName,longitudeFieldName:this.longitudeFieldName});this._projectFeatures=n.hitch(this,this._projectFeatures);this._addFeatures=n.hitch(this,this._addFeatures);
this._initCSVLayer(a)},refresh:function(){this._fireUpdateStart();this.applyEdits(null,null,this.graphics);this._loadFeatures()},_setMap:function(c){var a=this.inherited(arguments);this._fireUpdateStart();this._projectFeatures(this._csvFC).then(this._addFeatures).otherwise(this._errorHandler);this._csvFC=null;return a},_initCSVLayer:function(c){var a=this;t.buildCSVFeatureCollection(this._buildCsvFcParam).then(function(g){a._csvFC=g;var k=g.layerDefinition;k.extent=a._getFCExtent(g);c.outFields||
(c.outFields=["*"]);c.timeInfo&&(k.timeInfo=c.timeInfo);a._initFeatureLayer({layerDefinition:k},c)}).otherwise(this._errorHandler)},_loadFeatures:function(){t.buildCSVFeatureCollection(this._buildCsvFcParam).then(this._projectFeatures).then(this._addFeatures).otherwise(this._errorHandler)},_projectFeatures:function(c){return t.projectFeatureCollection(c,this._map.spatialReference)},_addFeatures:function(c){c=new k(c.featureSet);this.applyEdits(c.features,null,null);this._fireUpdateEnd()},_getFCExtent:function(c){var a;
if(c&&c.featureSet&&c.featureSet.features){c=c.featureSet.features;var g=c.length;if(1<g){var k=c[0].geometry;a=new u(k.x,k.y,k.x,k.y);for(--g;0<g;g--)k=c[g].geometry,a.xmin=Math.min(a.xmin,k.x),a.ymin=Math.min(a.ymin,k.y),a.xmax=Math.max(a.xmax,k.x),a.ymax=Math.max(a.ymax,k.y);0>=a.getWidth()&&0>=a.getHeight()&&(a=null)}}return a}});g("extend-esri")&&n.setObject("layers.CSVLayer",a,m);return a})},"esri/arcgis/csv":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/sniff dojo/number dojox/data/CsvStore ../kernel ../config ../request ../SpatialReference ../geometry/jsonUtils ../geometry/webMercatorUtils".split(" "),
function(l,a,n,g,m,t,c,u,k,w,G,v){function C(d){var c=0,e="";a.forEach([","," ",";","|","\t"],function(a){var b=d.split(a).length;b>c&&(c=b,e=a)});return e}function B(d,c){if(!d||"[object Date]"!==Object.prototype.toString.call(d)||isNaN(d.getTime()))return!1;var e=!0;if(g("chrome")&&/\d+\W*$/.test(c)){if(c.match(/[^0-9a-zA-Z\s]/))return!1;var a=c.match(/[a-zA-Z]{2,}/);if(a){for(var e=!1,b=0,h=a.length,r=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i;!e&&
b<=h&&!(e=!r.test(a[b]));)b++;e=!e}}return e}function F(d,c,g){var k=d.indexOf("\n"),k=l.trim(d.substr(0,k)),b=c.columnDelimiter;b||(b=C(k));var h=new t({data:d,separator:b});h.fetch({onComplete:function(b,f){var d=0,r={layerDefinition:c.layerDefinition,featureSet:{features:[],geometryType:"esriGeometryPoint"}},k=r.layerDefinition.objectIdField,D=r.layerDefinition.fields;k||a.some(D,function(b){return"esriFieldTypeOID"===b.type?(k=b.name,!0):!1})||(D.push({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",
editable:!1}),k="__OBJECTID");var x,z,y=h._attributes,I=[],n=[];a.forEach(D,function(b){"esriFieldTypeDate"===b.type?I.push(b.name):"esriFieldTypeDouble"!==b.type&&"esriFieldTypeInteger"!==b.type||n.push(b.name)});c.locationInfo&&"coordinates"===c.locationInfo.locationType?(x=c.locationInfo.latitudeFieldName,z=c.locationInfo.longitudeFieldName):a.forEach(y,function(b){var f;f=a.indexOf(e,b.toLowerCase());-1!==f&&(x=b);f=a.indexOf(q,b.toLowerCase());-1!==f&&(z=b)});if(x&&z){-1===a.indexOf(n,x)&&n.push(x);
-1===a.indexOf(n,z)&&n.push(z);var u;l.isArray(c.outFields)&&-1===a.indexOf(c.outFields,"*")&&(u=c.outFields);a.forEach(y,function(b){a.some(D,function(f){return b===f.name})||D.push({name:b,alias:b,type:b===x||b===z?"esriFieldTypeDouble":"esriFieldTypeString"})});var y=0,w=b.length;for(y;y<w;y++){var v=b[y],A=h.getAttributes(v),t={};a.forEach(A,function(b){if(b&&(b===x||b===z||!u||-1<a.indexOf(u,b))){var f=b;0===b.length&&a.forEach(D,function(f,d){f.name==="attribute_"+(d-1)&&(b="attribute_"+(d-
1))});if(-1<a.indexOf(I,b)){var f=h.getValue(v,f),d=new Date(f);t[b]=B(d,f)?d.getTime():null}else-1<a.indexOf(n,b)?(d=m.parse(h.getValue(v,f)),b!==x&&b!==z||!(isNaN(d)||181<Math.abs(d))||(d=parseFloat(h.getValue(v,f))),isNaN(d)?t[b]=null:t[b]=d):t[b]=h.getValue(v,f)}});t[k]=d;d++;var A=t[x],E=t[z];null==E||null==A||isNaN(A)||isNaN(E)||(u&&-1===a.indexOf(u,x)&&delete t[x],u&&-1===a.indexOf(u,z)&&delete t[z],r.featureSet.features.push({geometry:{x:E,y:A,spatialReference:{wkid:4326}},attributes:t}))}r.layerDefinition.name=
"csv";g&&g(r)}else setTimeout(function(){console.error("File does not seem to contain fields with point coordinates.")},1),g&&g(null,Error("File does not seem to contain fields with point coordinates."))},onError:function(b){console.error("Error fetching items from CSV store: ",b);g&&g(null,b)}});return!0}function A(d,c,e,q,b,h){0===d.length&&b(null);var r=G.getGeometryType(c),f=[];a.forEach(d,function(b){b=new r(b);b.spatialReference=e;f.push(b)},this);c=[102113,102100,3857];e.wkid&&4326===e.wkid&&
q.wkid&&-1<a.indexOf(c,q.wkid)?(a.forEach(f,function(b){b.xmin?(b.xmin=Math.max(b.xmin,-180),b.xmax=Math.min(b.xmax,180),b.ymin=Math.max(b.ymin,-89.99),b.ymax=Math.min(b.ymax,89.99)):b.rings?a.forEach(b.rings,function(b){a.forEach(b,function(b){b[0]=Math.min(Math.max(b[0],-180),180);b[1]=Math.min(Math.max(b[1],-89.99),89.99)},this)},this):b.paths?a.forEach(b.paths,function(b){a.forEach(b,function(b){b[0]=Math.min(Math.max(b[0],-180),180);b[1]=Math.min(Math.max(b[1],-89.99),89.99)},this)},this):b.x&&
(b.x=Math.min(Math.max(b.x,-180),180),b.y=Math.min(Math.max(b.y,-89.99),89.99))},this),d=[],a.forEach(f,function(b){b=v.geographicToWebMercator(b);102100!==q.wkid&&(b.spatialReference=q);d.push(b.toJson())},this),b(d)):null!==e.wkid&&-1<a.indexOf(c,e.wkid)&&null!==q.wkid&&4326===q.wkid?(d=[],a.forEach(f,function(b){d.push(v.webMercatorToGeographic(b).toJson())},this),b(d)):(c=function(f,c){f&&f.length===d.length?(d=[],a.forEach(f,function(b){b&&(b.rings&&0<b.rings.length&&0<b.rings[0].length&&0<b.rings[0][0].length&&
!isNaN(b.rings[0][0][0])&&!isNaN(b.rings[0][0][1])||b.paths&&0<b.paths.length&&0<b.paths[0].length&&0<b.paths[0][0].length&&!isNaN(b.paths[0][0][0])&&!isNaN(b.paths[0][0][1])||b.xmin&&!isNaN(b.xmin)&&b.ymin&&!isNaN(b.ymin)||b.x&&!isNaN(b.x)&&b.y&&!isNaN(b.y))?d.push(b.toJson()):d.push(null)},this),b(d)):h(f,c)},u.defaults.geometryService?u.defaults.geometryService.project(f,q,l.hitch(this,c),h):b(null))}function E(d,c){var e=[102113,102100,3857];return d&&c&&d.wkid===c.wkid&&d.wkt===c.wkt||d&&c&&
d.wkid&&c.wkid&&-1<a.indexOf(e,d.wkid)&&-1<a.indexOf(e,c.wkid)?!0:!1}function d(d,c,e,q){if(d.featureSet&&0!==d.featureSet.features.length)if(E(e,c))q(d);else{var b,h=function(b){var f=[];a.forEach(d.featureSet.features,function(d,h){b[h]&&(d.geometry=b[h],f.push(d))},this);q(d)},r=function(b,f){console.error("error projecting featureSet ("+d.layerDefinition.name+"). Final try.");q(d)},f=function(f,a){console.error("error projecting featureSet ("+d.layerDefinition.name+"). Try one more time.");A(b,
d.featureSet.geometryType,c,e,l.hitch(this,h),l.hitch(this,r))};d.featureSet.features&&0<d.featureSet.features.length?(b=[],a.forEach(d.featureSet.features,function(f){if(f.geometry.toJson)b.push(f.geometry);else{var h=G.getGeometryType(d.featureSet.geometryType);b.push(new h(f.geometry))}}),c.toJson||(c=new w(c)),e.toJson||(e=new w(e)),A(b,d.featureSet.geometryType,c,e,l.hitch(this,h),l.hitch(this,f))):q(d)}}var e="lat latitude y ycenter latitude83 latdecdeg point-y lat_dd".split(" "),q="lon lng long longitude x xcenter longitude83 longdecdeg point-x long_dd".split(" "),
x={latFieldStrings:e,longFieldStrings:q,buildCSVFeatureCollection:function(d){var c=new n,e=function(b,d){d?c.errback(d):c.callback(b)},a={url:d.url,handleAs:"text",load:function(b){F(b,d,l.hitch(this,e))},error:function(b){c.errback(b);console.error("error: "+b)}};-1<d.url.indexOf("arcgis.com")&&-1<d.url.indexOf("/content/items")&&-1<d.url.indexOf("/data")&&(a.headers={"Content-Type":""});k(a,{usePost:!1});return c},projectFeatureCollection:function(c,e,a){var q=new n;a||(a=new w({wkid:4326}));d(c,
a,e,l.hitch(this,function(b){q.callback(b)}));return q},generateDefaultPopupInfo:function(d){var c={esriFieldTypeDouble:1,esriFieldTypeSingle:1},e={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},q={esriFieldTypeDate:1},b=null;d=a.map(d.layerDefinition.fields,l.hitch(this,function(d){"NAME"===d.name.toUpperCase()&&(b=d.name);var h="esriFieldTypeOID"!==d.type&&"esriFieldTypeGlobalID"!==d.type&&"esriFieldTypeGeometry"!==d.type,f=null;if(h){var p=d.name.toLowerCase();if(-1<",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,".indexOf(","+
p+",")||-1<p.indexOf("area")||-1<p.indexOf("length")||-1<p.indexOf("shape")||-1<p.indexOf("perimeter")||-1<p.indexOf("objectid")||p.indexOf("_")===p.length-1||p.indexOf("_i")===p.length-2&&1<p.length)h=!1;d.type in e?f={places:0,digitSeparator:!0}:d.type in c?f={places:2,digitSeparator:!0}:d.type in q&&(f={dateFormat:"shortDateShortTime"})}return l.mixin({},{fieldName:d.name,label:d.alias,isEditable:!0,tooltip:"",visible:h,format:f,stringFieldOption:"textbox"})}));return{title:b?"{"+b+"}":"",fieldInfos:d,
description:null,showAttachments:!1,mediaInfos:[]}},_getSeparator:C,_isValidDate:B,_processCsvData:F,_projectGeometries:A,_sameSpatialReference:E,_projectFeatureSet:d};g("extend-esri")&&l.setObject("arcgis.csv",x,c);return x})},"dojox/data/CsvStore":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/xhr dojo/_base/kernel dojo/data/util/filter dojo/data/util/simpleFetch".split(" "),function(l,a,n,g,m,t){a=a("dojox.data.CsvStore",null,{constructor:function(c){this._attributes=[];this._attributeIndexes=
{};this._dataArray=[];this._arrayOfAllItems=[];this._loadFinished=!1;c.url&&(this.url=c.url);this._csvData=c.data;c.label?this.label=c.label:""===this.label&&(this.label=void 0);this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._loadInProgress=!1;this._queuedFetches=[];this.identifier=c.identifier;""===this.identifier?delete this.identifier:this._idMap={};"separator"in c&&(this.separator=c.separator);"urlPreventCache"in c&&
(this.urlPreventCache=c.urlPreventCache?!0:!1)},url:"",label:"",identifier:"",separator:",",urlPreventCache:!1,_assertIsItem:function(c){if(!this.isItem(c))throw Error(this.declaredClass+": a function was passed an item argument that was not an item");},_getIndex:function(c){c=this.getIdentity(c);this.identifier&&(c=this._idMap[c]);return c},getValue:function(c,a,g){this._assertIsItem(c);var k=g;if("string"===typeof a)a=this._attributeIndexes[a],null!=a&&(k=this._dataArray[this._getIndex(c)][a]||
g);else throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");return k},getValues:function(c,a){var g=this.getValue(c,a);return g?[g]:[]},getAttributes:function(c){this._assertIsItem(c);var a=[];c=this._dataArray[this._getIndex(c)];for(var g=0;g<c.length;g++)""!==c[g]&&a.push(this._attributes[g]);return a},hasAttribute:function(c,a){this._assertIsItem(c);if("string"===typeof a){var g=this._attributeIndexes[a],l=this._dataArray[this._getIndex(c)];return"undefined"!==
typeof g&&g<l.length&&""!==l[g]}throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");},containsValue:function(c,a,g){var k=void 0;"string"===typeof g&&(k=m.patternToRegExp(g,!1));return this._containsValue(c,a,g,k)},_containsValue:function(c,a,g,l){c=this.getValues(c,a);for(a=0;a<c.length;++a){var k=c[a];if("string"===typeof k&&l)return null!==k.match(l);if(g===k)return!0}return!1},isItem:function(c){if(c&&c[this._storeProp]===this)if(c=c[this._idProp],
this.identifier){if(this._dataArray[this._idMap[c]])return!0}else if(0<=c&&c<this._dataArray.length)return!0;return!1},isItemLoaded:function(c){return this.isItem(c)},loadItem:function(c){},getFeatures:function(){return this._features},getLabel:function(c){if(this.label&&this.isItem(c))return this.getValue(c,this.label)},getLabelAttributes:function(c){return this.label?[this.label]:null},_fetchItems:function(c,a,g){var k=this,l=function(c,g){var l=null;if(c.query){var d,e,l=[],q=c.queryOptions?c.queryOptions.ignoreCase:
!1,x={};for(d in c.query)e=c.query[d],"string"===typeof e&&(x[d]=m.patternToRegExp(e,q));for(q=0;q<g.length;++q){var D=!0,n=g[q];for(d in c.query)e=c.query[d],k._containsValue(n,d,e,x[d])||(D=!1);D&&l.push(n)}}else l=g.slice(0,g.length);a(l,c)};if(this._loadFinished)l(c,this._arrayOfAllItems);else if(""!==this.url)if(this._loadInProgress)this._queuedFetches.push({args:c,filter:l});else{this._loadInProgress=!0;var v=n.get({url:k.url,handleAs:"text",preventCache:k.urlPreventCache});v.addCallback(function(a){try{k._processData(a),
l(c,k._arrayOfAllItems),k._handleQueuedFetches()}catch(A){g(A,c)}});v.addErrback(function(a){k._loadInProgress=!1;if(g)g(a,c);else throw a;});var u=null;c.abort&&(u=c.abort);c.abort=function(){var a=v;a&&-1===a.fired&&(a.cancel(),a=null);u&&u.call(c)}}else if(this._csvData)try{this._processData(this._csvData),this._csvData=null,l(c,this._arrayOfAllItems)}catch(F){g(F,c)}else{var t=Error(this.declaredClass+": No CSV source data was provided as either URL or String data input.");if(g)g(t,c);else throw t;
}},close:function(c){},_getArrayOfArraysFromCsvFileContents:function(c){if(l.isString(c)){var a=RegExp("^\\s+","g"),g=RegExp("\\s+$","g"),m=RegExp('""',"g"),n=[],v=this._splitLines(c);for(c=0;c<v.length;++c){var t=v[c];if(0<t.length){for(var t=t.split(this.separator),B=0;B<t.length;){var F=t[B].replace(a,""),A=F.replace(g,""),E=A.charAt(0),d=A.charAt(A.length-1),e=A.charAt(A.length-2),q=A.charAt(A.length-3);if(2===A.length&&'""'==A)t[B]="";else if('"'==E&&('"'!=d||'"'==d&&'"'==e&&'"'!=q)){if(B+1===
t.length)return;t[B]=F+this.separator+t[B+1];t.splice(B+1,1)}else'"'==E&&'"'==d&&(A=A.slice(1,A.length-1),A=A.replace(m,'"')),t[B]=A,B+=1}n.push(t)}}this._attributes=n.shift();for(c=0;c<this._attributes.length;c++)this._attributeIndexes[this._attributes[c]]=c;this._dataArray=n}},_splitLines:function(c){var a=[],g,l="",m=!1;for(g=0;g<c.length;g++){var n=c.charAt(g);switch(n){case '"':m=!m;l+=n;break;case "\r":m?l+=n:(a.push(l),l="",g<c.length-1&&"\n"==c.charAt(g+1)&&g++);break;case "\n":m?l+=n:(a.push(l),
l="");break;default:l+=n}}""!==l&&a.push(l);return a},_processData:function(c){this._getArrayOfArraysFromCsvFileContents(c);this._arrayOfAllItems=[];if(this.identifier&&void 0===this._attributeIndexes[this.identifier])throw Error(this.declaredClass+": Identity specified is not a column header in the data set.");for(c=0;c<this._dataArray.length;c++){var a=c;this.identifier&&(a=this._dataArray[c][this._attributeIndexes[this.identifier]],this._idMap[a]=c);this._arrayOfAllItems.push(this._createItemFromIdentity(a))}this._loadFinished=
!0;this._loadInProgress=!1},_createItemFromIdentity:function(c){var a={};a[this._storeProp]=this;a[this._idProp]=c;return a},getIdentity:function(c){return this.isItem(c)?c[this._idProp]:null},fetchItemByIdentity:function(c){var a,k=c.scope?c.scope:g.global;if(this._loadFinished)a=this._createItemFromIdentity(c.identity),this.isItem(a)||(a=null),c.onItem&&c.onItem.call(k,a);else{var l=this;if(""!==this.url)this._loadInProgress?this._queuedFetches.push({args:c}):(this._loadInProgress=!0,a=n.get({url:l.url,
handleAs:"text"}),a.addCallback(function(a){try{l._processData(a);var g=l._createItemFromIdentity(c.identity);l.isItem(g)||(g=null);c.onItem&&c.onItem.call(k,g);l._handleQueuedFetches()}catch(C){c.onError&&c.onError.call(k,C)}}),a.addErrback(function(a){this._loadInProgress=!1;c.onError&&c.onError.call(k,a)}));else if(this._csvData)try{l._processData(l._csvData),l._csvData=null,a=l._createItemFromIdentity(c.identity),l.isItem(a)||(a=null),c.onItem&&c.onItem.call(k,a)}catch(G){c.onError&&c.onError.call(k,
G)}}},getIdentityAttributes:function(c){return this.identifier?[this.identifier]:null},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var c=0;c<this._queuedFetches.length;c++){var a=this._queuedFetches[c],g=a.filter,l=a.args;g?g(l,this._arrayOfAllItems):this.fetchItemByIdentity(a.args)}this._queuedFetches=[]}}});l.extend(a,t);return a})},"esri/layers/GeoRSSLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../config ../request ../urlUtils ./ServiceGeneratedFeatureCollection".split(" "),
function(l,a,n,g,m,t,c,u,k){l=l([k],{declaredClass:"esri.layers.GeoRSSLayer",serviceUrl:u.getProtocolForWebResource()+"//utility.arcgis.com/sharing/rss",constructor:function(c,a){t.defaults.geoRSSService&&(this.serviceUrl=t.defaults.geoRSSService);this._createLayer()},parse:function(){return this._io=c({url:this.serviceUrl,content:{url:this.url,refresh:this.loaded?!0:void 0,outSR:this._outSR?n.toJson(this._outSR.toJson()):void 0},callbackParamName:"callback"})},_initLayer:function(c){this.inherited(arguments);
this.loaded||(this.loaded=!0,this.onLoad(this))}});g("extend-esri")&&a.setObject("layers.GeoRSSLayer",l,m);return l})},"esri/layers/ServiceGeneratedFeatureCollection":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/webMercatorUtils ../renderers/SimpleRenderer ./layer ./FeatureLayer ../dijit/PopupTemplate".split(" "),function(l,a,n,g,m,t,c,u,k,w,G,v,C,B,
F){l=l([C],{declaredClass:"esri.layers._ServiceGeneratedFeatureCollection",constructor:function(c,a){this.pointSymbol=a&&a.pointSymbol;this.polylineSymbol=a&&a.polylineSymbol;this.polygonSymbol=a&&a.polygonSymbol;this._outSR=a&&(a.outSpatialReference||a.outSR)||new k({wkid:4326});this._options=n.mixin({},a)},parse:function(){console.error("parse function has not been implemented")},getFeatureLayers:function(){var c=[];this._fLayers&&(c=c.concat(this._fLayers));return c},onRefresh:function(){},onOpacityChange:function(){},
refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._createLayer()},_createLayer:function(c){var a=this;this._fireUpdateStart();c=this.parse(c);c.addCallback(function(d){a._io=null;a._initLayer(d)});c.addErrback(function(d){a._io=null;d=n.mixin(Error(),d);d.message="Unable to load resource: "+a.url+" "+(d.message||"");a._fireUpdateEnd(d);a.onError(d)})},_initLayer:function(c){this.loaded&&this._removeInternalLayers();this.name=c.name;this.description=c.description;this.snippet=
c.snippet;this.featureInfos=c.featureInfos;this.fullExtent=this.initialExtent=new w(c.lookAtExtent);this.copyright=c.author||c.copyright;var a;(c=n.getObject("featureCollection.layers",!1,c))&&0<c.length&&(this._fLayers=[],g.forEach(c,function(d,c){var e=n.getObject("featureSet.features",!1,d);e&&0<e.length&&(a=n.mixin({outFields:["*"],infoTemplate:d.popupInfo?new F(d.popupInfo):null,editable:!1},this._options),a.id&&(a.id=a.id+"_"+c),d.layerDefinition.capabilities="Query,Data",e=new B(d,a),e.geometryType&&
(this["_"+e.geometryType]=e),this._fLayers.push(e))},this),0===this._fLayers.length&&delete this._fLayers);this.items=[];this._esriGeometryPoint&&(this.items=this.items.concat(this._esriGeometryPoint.graphics),this.pointSymbol&&(c=new v(this.pointSymbol),this._esriGeometryPoint.setRenderer(c)));this._esriGeometryPolyline&&(this.items=this.items.concat(this._esriGeometryPolyline.graphics),this.polylineSymbol&&(c=new v(this.polylineSymbol),this._esriGeometryPolyline.setRenderer(c)));this._esriGeometryPolygon&&
(this.items=this.items.concat(this._esriGeometryPolygon.graphics),this.polygonSymbol&&(c=new v(this.polygonSymbol),this._esriGeometryPolygon.setRenderer(c)));this._fireUpdateEnd();this.loaded&&(this._addInternalLayers(),this.onRefresh())},_addInternalLayers:function(){var c=this._map;this._fireUpdateStart();var a=c.spatialReference,d=this._outSR,e;if(a.wkid)e=a._isWebMercator()&&d._isWebMercator()||a.wkid===d.wkid;else if(a.wkt)e=a.wkt===d.wkt;else{console.log("_setMap - map has invalid spatial reference");
return}if(!e)if(a._isWebMercator()&&4326===d.wkid)this._converter=G.geographicToWebMercator;else if(d._isWebMercator()&&4326===a.wkid)this._converter=G.webMercatorToGeographic;else{console.log("_setMap - unsupported workflow. Spatial reference of the map and layer do not match, and the conversion cannot be done on the client.");return}(a=this._fLayers)&&0<a.length&&g.forEach(a,function(d){if(this._converter){var a=d.graphics,e,g,q=a?a.length:0;for(e=0;e<q;e++)(g=a[e].geometry)&&a[e].setGeometry(this._converter(g))}c.addLayer(d)},
this);this.setVisibility(this.visible);this._fireUpdateEnd()},_removeInternalLayers:function(){var c=this._map;c&&g.forEach(this.getFeatureLayers(),c.removeLayer,c)},setScaleRange:function(c,a){this.inherited(arguments);g.forEach(this.getFeatureLayers(),function(d){d.setScaleRange(c,a)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(c){this.opacity!=c&&(g.forEach(this.getFeatureLayers(),function(a){a.setOpacity(c)}),this.opacity=this._options.opacity=
c,this.onOpacityChange(c))},onVisibilityChange:function(c){this._fireUpdateStart();g.forEach(this.getFeatureLayers(),function(a){a.setVisibility(c)});this._fireUpdateEnd()},_setMap:function(c,a){this.inherited(arguments);this._map=c;var d=this._div=m.create("div",null,a);t.set(d,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return d},_unsetMap:function(c,g){this._io&&this._io.cancel();a.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();
var d=this._div;d&&(g.removeChild(d),m.destroy(d));this._div=null;this.inherited(arguments)}});c("extend-esri")&&n.setObject("layers._ServiceGeneratedFeatureCollection",l,u);return l})},"esri/layers/WFSLayer":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/on ../request ../kernel ../graphic ../renderers/jsonUtils ../symbols/jsonUtils ../Color ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent ../geometry/Point ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ./LabelClass ./GraphicsLayer".split(" "),
function(l,a,n,g,m,t,c,u,k,w,G,v,C,B,F,A,E,d,e,q,x,D,I,z,y){l=l([y],{declaredClass:"esri.layers.WFSLayer",constructor:function(b){this.geometryType=this.describeFeatureTypeUrl=this.getFeatureUrl=this.layerNamespace="";this.fields=[];this.spatialReferences=[];this.fullExtent=null;this.visible=!0;this.renderer=null;this.id="WFSLayer";this._url="";this._version="1.1.0";this._layerName="";this._nsLayerNames={};this._layerDefinedGeometryType="esriGeometryComplex";this._wkid=3857;this._mode="snapshot";
this._maxFeatures=100;this._inverseResponse=this._inverseFilter=!1;this._nsGeometryFieldName=this._getFeatureRequest=this._nsFields="";this._graphicArray=[];this._gmlNS="http://www.opengis.net/gml";this._layerEventHandlers=[];this.customParameters=this._describeFeatureTypeCallback=this._getCapabilitiesCallback=null;this.showLabels=!0;this.labelingInfo=null;b&&(b.id&&(this.id=b.id),this.showLabels=null!==b.showLabels?b.showLabels:!0);this.onError=n.hitch(this,this.onError);this._errorSupport=n.hitch(this,
this._errorSupport);this._parseGml=n.hitch(this,this._parseGml);this._getCapabilities=n.hitch(this,this._getCapabilities);this._getCapabilitiesResponse=n.hitch(this,this._getCapabilitiesResponse);this._describeFeatureTypeResponse=n.hitch(this,this._describeFeatureTypeResponse);this._pointSymbol=new B(B.STYLE_CIRCLE,6,new F(F.STYLE_SOLID,new C([0,255,0]),1),new C([255,0,0]));this._lineSymbol=new F(F.STYLE_SOLID,new C([0,255,0]),3);this._polygonSymbol=new A(A.STYLE_SOLID,new F(F.STYLE_SOLID,new C([255,
0,0]),2),new C([255,255,0,.25]));this.loaded=!1;this._isProjectedOk=!0},initialize:function(b,d){b.id&&(this.id=b.id);b.url&&(this._url=b.url);b.version&&(this._version=b.version);this.customParameters=b.customParameters;this._getCapabilities(d)},selectLayer:function(b,d){this._layerName=b.layerName;this._wkid=b.wkid;this._mode=b.mode;this._maxFeatures=b.maxFeatures;this._inverseResponse=b.swapXY;this._inverseFilter=b.swapXYFilter;this.geometryType=b.geometryType;this._describeFeatureType(d);this.loaded=
!0},toJson:function(){var b={};b.id=this.id;b.url=this._url;b.version=this._version;b.mode="snapshot"===this._mode?0:1;b.name=this._layerName;b.geometryType=this.geometryType;b.wkid=this._wkid;b.maxFeatures=this._maxFeatures;b.swapXY=this._inverseResponse;b.swapXYFilter=this._inverseFilter;b.pointSymbol=this._pointSymbol.toJson();b.lineSymbol=this._lineSymbol.toJson();b.polygonSymbol=this._polygonSymbol.toJson();b.showLabels=this.showLabels;this.labelingInfo&&(b.labelingInfo=g.map(this.labelingInfo,
function(b){return b.toJson()}));this.customParameters&&(b.customParameters=this.customParameters);return b},fromJson:function(b,d){b.id&&(this.id=b.id);b.url&&(this._url=b.url);b.version&&(this._version=b.version);b.mode&&(this._mode=0===b.mode?"snapshot":"onDemand");b.name&&(this._layerName=b.name);b.geometryType&&(this.geometryType=b.geometryType);b.wkid&&(this._wkid=b.wkid);b.maxFeatures&&(this._maxFeatures=b.maxFeatures);b.swapXY&&(this._inverseResponse=b.swapXY);b.swapXYFilter&&(this._inverseFilter=
b.swapXYFilter);b.pointSymbol&&(this._pointSymbol=v.fromJson(b.pointSymbol));b.lineSymbol&&(this._lineSymbol=v.fromJson(b.lineSymbol));b.polygonSymbol&&(this._polygonSymbol=v.fromJson(b.polygonSymbol));this.showLabels=null!=b.showLabels?b.showLabels:!0;b.labelingInfo&&(this.labelingInfo=g.map(b.labelingInfo,function(b){return new z(b)}));this.customParameters=b.customParameters;this._getCapabilities(d);this.loaded=!0},setPointSymbol:function(b){this._pointSymbol=b},setLineSymbol:function(b){this._lineSymbol=
b},setPolygonSymbol:function(b){this._polygonSymbol=b},_setMap:function(b){this._map=b;var d=this.inherited(arguments);this._map&&(this._layerEventHandlers.push(this._map.on("extent-change",n.hitch(this,"refresh"))),this._layerEventHandlers.push(this.on("visibility-change",n.hitch(this,"_visibilityChange"))));this._getFeature();this.refresh();return d},_unsetMap:function(){for(var b=0;b<this._layerEventHandlers.length;b++)m.disconnect(this._layerEventHandlers[b]);this.refresh();this.inherited(arguments)},
refresh:function(b){this.clear();this.redraw();"ondemand"===this._mode.toLowerCase()&&this._fireUpdateStart()},redraw:function(){if(this.visible)for(var b=0;b<this._graphicArray.length;b++){var d=this._graphicArray[b],c=d.geometry,f=null;"point"===c.type?f=this.renderer?this.renderer.getSymbol(d):this._pointSymbol:"multipoint"===c.type?f=this.renderer?this.renderer.getSymbol(d):this._pointSymbol:"polyline"===c.type?f=this.renderer?this.renderer.getSymbol(d):this._lineSymbol:"polygon"===c.type&&(f=
this.renderer?this.renderer.getSymbol(d):this._polygonSymbol);d.setSymbol(f);this.add(d)}},_visibilityChange:function(b){this.visible=b.visible;this.redraw()},onUpdateStart:function(){this._getFeature()},onUpdateEnd:function(){this.clear();this.redraw()},setLabelingInfo:function(b){b?(this.labelingInfo=b,this._fixLabelExpr()):delete this.labelingInfo;this.onLabelingInfoChange()},onLabelingInfoChange:function(){},_fixLabelExpr:function(){var b=/\[([^\[\]]+)\]/ig,d,c=this,f=function(b,f){var d=c._getField(f,
!0);return"["+(d&&d.name||f)+"]"};g.forEach(this.labelingInfo,function(c){if(d=c.labelExpression)c.labelExpression=d.replace(b,f)})},_getField:function(b,d){var c=this.fields;if(!c||0===c.length)return null;var f;d&&(b=b.toLowerCase());g.some(c,function(c){var h=!1;(h=d?c&&c.name.toLowerCase()===b?!0:!1:c&&c.name===b?!0:!1)&&(f=c);return h});return f},setCustomParameters:function(b){this.customParameters=b;this._getFeature();this.refresh()},_getCapabilities:function(b){this._getCapabilitiesCallback=
b;b=n.trim(this._url);if(""===b)this.onError("WFSLayer: url is invalid");else if("1.0.0"!==this._version&&"1.1.0"!==this._version&&"2.0.0"!==this._version)this.onError("WFSLayer: version is invalid");else if(""!==b){var d=b.indexOf("?");b=b+(-1===d?"?":"\x26")+"service\x3dWFS\x26request\x3dGetCapabilities\x26version\x3d"+this._version;b=this._appendCustomParameters(b);u({url:b,handleAs:"text",headers:{"Content-Type":null}},{usePost:!1}).then(this._getCapabilitiesResponse,this._errorSupport)}},_errorSupport:function(b){this.onError(b)},
_getCapabilitiesResponse:function(b){var d,c,f,p,a,e=new DOMParser;try{var g=e.parseFromString(b,"text/xml"),q=this._readExceptionReport(g,b);if(q)this.onError("WFSLayer: getCapabilities - returns exception: "+q);else{var l=g.documentElement.attributes.getNamedItem("version");if(l){this._version=l.value;var k="2.0.0"===this._version?"http://www.opengis.net/wfs/2.0":"http://www.opengis.net/wfs";if("2.0.0"===this._version)for(d=g.getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Operation"),
c=0;c<d.length;c++)(p=d[c].attributes.getNamedItem("name"))&&"DescribeFeatureType"===p.value&&(getList=d[c].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Get"),this.describeFeatureTypeUrl=getList[0].attributes.getNamedItem("xlink:href").value),p&&"GetFeature"===p.value&&(a=d[c].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Post"),this.getFeatureUrl=a[0].attributes.getNamedItem("xlink:href").value);else if("1.1.0"===this._version)for(d=g.getElementsByTagNameNS("http://www.opengis.net/ows",
"Operation"),c=0;c<d.length;c++)(p=d[c].attributes.getNamedItem("name"))&&"DescribeFeatureType"===p.value&&(getList=d[c].getElementsByTagNameNS("http://www.opengis.net/ows","Get"),this.describeFeatureTypeUrl=getList[0].attributes.getNamedItem("xlink:href").value),p&&"GetFeature"===p.value&&(a=d[c].getElementsByTagNameNS("http://www.opengis.net/ows","Post"))&&a.length&&(this.getFeatureUrl=a[0].attributes.getNamedItem("xlink:href").value);else if("1.0.0"===this._version){var x=g.getElementsByTagNameNS(k,
"DescribeFeatureType");if(!x||!x.length){this.onError("WFSLayer: getCapabilities - no describeFeatureType info");return}getList=x[0].getElementsByTagNameNS(k,"Get");this.describeFeatureTypeUrl=getList[0].attributes.getNamedItem("onlineResource").value;var m=g.getElementsByTagNameNS(k,"GetFeature");if(!m||!m.length){this.onError("WFSLayer: getCapabilities - no GetFeature info");return}(a=m[0].getElementsByTagNameNS(k,"Post"))&&a.length&&(this.getFeatureUrl=a[0].attributes.getNamedItem("onlineResource").value)}this._nsLayerNames=
{};b=[];var D=g.getElementsByTagNameNS(k,"FeatureTypeList");for(c=0;c<D.length;c++){var z=D[c].getElementsByTagNameNS(k,"FeatureType");for(f=0;f<z.length;f++){var n=z[f],y=n.getElementsByTagNameNS(k,"Name")[0],t=y.textContent,v=t.indexOf(":"),I=t.substring(0,v),u=t.substring(v+1),w=y.lookupNamespaceURI(I);null===w&&(w=y.lookupNamespaceURI(null));this._nsLayerNames[u]={prefix:I,namespace:w};var C=n.getElementsByTagNameNS(k,"Title"),A=0<C.length?C[0].textContent:"";""===A&&(A=u);this.spatialReferences=
this._readFactoryCodes(this._version,n);var B=this._readDefaultBBOX(this._version,n);b.push({name:u,title:A,spatialReferences:this.spatialReferences,extent:B})}}this._describeFeatureType();var E=this._getCapabilitiesCallback;E&&E(b)}else this.onError("WFSLayer: getCapabilities - document not recognized.")}}catch(N){this.onError("WFSLayer: getCapabilities - parsing error")}},_readFactoryCodes:function(b,d){var c,f,h=[];if("2.0.0"===b||"1.1.0"===b){c=d.getElementsByTagNameNS("*","DefaultSRS");this._addCodeList(h,
c[0]);c=d.getElementsByTagNameNS("*","DefaultCRS");this._addCodeList(h,c[0]);c=d.getElementsByTagNameNS("*","OtherSRS");for(f=0;f<c.length;f++)this._addCodeList(h,c[f]);c=d.getElementsByTagNameNS("*","OtherCRS");for(f=0;f<c.length;f++)this._addCodeList(h,c[f])}else"1.0.0"===b&&(c=d.getElementsByTagNameNS("*","SRS"),this._addCodeList(h,c[0]));for(c=!1;0<h.length;){4326===h[0]&&(c=!0);break}c||h.push(4326);return h},_addCodeList:function(b,d){if(d){var c=d.textContent.match(/\d+/g);0<c.length&&(c=parseInt(c[c.length-
1],10),84===c&&(c=4326),b.push(c))}},_readDefaultBBOX:function(b,d){var c,f,h,a;if("2.0.0"===b||"1.1.0"===b){c=d.getElementsByTagNameNS("*","WGS84BoundingBox");if(!c[0]||!c[0].attributes)return[];f=c[0].getElementsByTagNameNS("*","LowerCorner");a=c[0].getElementsByTagNameNS("*","UpperCorner");if(0>=f.length||0>=a.length)return[];h=f[0].textContent;c=h.indexOf(" ");f=h.substring(0,c);h=h.substring(c+1);c=a[0].textContent;var e=c.indexOf(" ");a=c.substring(0,e);c=c.substring(e+1)}else if("1.0.0"===
b){c=d.getElementsByTagNameNS("*","LatLongBoundingBox");if(!c[0]||!c[0].attributes)return[];f=c[0].attributes.getNamedItem("minx").value;h=c[0].attributes.getNamedItem("miny").value;a=c[0].attributes.getNamedItem("maxx").value;c=c[0].attributes.getNamedItem("maxy").value}f=parseFloat(f,10);h=parseFloat(h,10);a=parseFloat(a,10);c=parseFloat(c,10);return[f,h,a,c]},_describeFeatureType:function(b){if(""!==this._layerName)if(""===this.describeFeatureTypeUrl)this.onError("WFSLayer: invalid describeFeatureType url");
else if(""===this._wkid)this.onError("WFSLayer: invalid wkid");else if("snapshot"!==this._mode&&"onDemand"!==this._mode)this.onError("WFSLayer: invalid mode");else if(""===this._maxFeatures||0>this._maxFeatures||1E6<this._maxFeatures)this.onError("WFSLayer: invalid maxFeatures");else{this._describeFeatureTypeCallback=b;var d=n.trim(this.describeFeatureTypeUrl);if(""!==d){var c=-1===d.indexOf("?")?"?":"\x26",f=this._nsLayerNames[this._layerName];if(void 0===f)this.onError("WFSLayer: invalid layerName");
else b=f.prefix,f=f.namespace,d=d+c+"service\x3dWFS\x26request\x3dDescribeFeatureType\x26version\x3d"+this._version,d+="\x26typeName\x3d",""!==b&&(d+=b+":"),d+=this._layerName,""!==b&&(d+="\x26namespace\x3dxmlns("+b+"\x3d"+f+")"),d=this._appendCustomParameters(d),u({url:d,handleAs:"text",headers:{"Content-Type":null}},{usePost:!1}).then(this._describeFeatureTypeResponse,this._errorSupport)}}},_describeFeatureTypeResponse:function(b){var d;d=(new DOMParser).parseFromString(b,"text/xml");if(b=this._readExceptionReport(d,
b))this.onError("WFSLayer: DescribeFeatureType - returns exception: "+b);else{this.fields=[];b=d.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","schema");for(d=0;d<b.length;d++){var c=this._readAllFields(b[d]);null!==c&&(this._layerDefinedGeometryType=c[0],this.fields=c[1])}this.geometryType&&""!==this.geometryType||(this.geometryType=this._layerDefinedGeometryType);for(d=0;d<this.fields.length;d++)b=this.fields[d],"esriFieldTypeGeometry"===b.type&&(this._nsGeometryFieldName=b.name);this.layerNamespace=
this._nsLayerNames[this._layerName].namespace;if(0===this.fields.length)this.onError("WFSLayer: DescribeFeatureType - can't get fields");else this._getFeature(),(d=this._describeFeatureTypeCallback)&&d(this.fields)}},_readAllFields:function(b){for(var d=b.childNodes,c=0;c<d.length;c++){var f=d[c];if("element"===f.localName){var a=f.attributes;if(a.name.value===this._layerName)return(d=a.type)?(f=d.value,d=f.indexOf(":"),f=f.substring(d+1),this._readFieldsFromGlobalComplextType(b,f)):this._readFieldsFromLocalComplextType(f)}}return null},
_readFieldsFromGlobalComplextType:function(b,d){for(var c=b.childNodes,f=0;f<c.length;f++){var a=c[f];if("complexType"===a.localName&&a.attributes.name.value===d)return this._readFieldsFromLocalComplextType(a)}return null},_readFieldsFromLocalComplextType:function(b){var d=[],c="esriGeometryComplex";b=b.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","element");for(var f=0;f<b.length;f++){var a=b[f],e="",g=a.attributes.getNamedItem("name");g&&(e=g.value);if(""!==e){var q=g="",a=a.attributes.getNamedItem("type"),
g="unknown";if(null!==a){var q=a.value,l=q.indexOf(":"),g=q.substring(0,l),q=q.substring(l+1),g=a.lookupNamespaceURI(g);null===g&&(g=a.lookupNamespaceURI(null))}a="Unknown";switch(q){case "integer":case "nonPositiveInteger":case "negativeInteger":case "long":case "int":case "short":case "byte":case "nonNegativeInteger":case "unsignedLong":case "unsignedInt":case "unsignedShort":case "unsignedByte":case "positiveInteger":a="esriFieldTypeInteger";d.push({name:e,alias:e,type:a,wfsNamespace:g});break;
case "float":case "double":case "decimal":a="esriFieldTypeDouble";d.push({name:e,alias:e,type:a,wfsNamespace:g});break;case "boolean":case "string":case "gYearMonth":case "gYear":case "gMonthDay":case "gDay":case "gMonth":case "anyURI":case "QName":case "NOTATION":case "normalizedString":case "token":case "language":case "IDREFS":case "ENTITIES":case "NMTOKEN":case "NMTOKENS":case "Name":case "NCName":case "ID":case "IDREF":case "ENTITY":a="esriFieldTypeString";d.push({name:e,alias:e,type:a,wfsNamespace:g});
break;case "duration":case "dateTime":case "time":case "date":a="esriFieldTypeDate";d.push({name:e,alias:e,type:a,wfsNamespace:g});break;case "PointPropertyType":case "MultiPointPropertyType":a="esriFieldTypeGeometry";c="esriGeometryPoint";d.push({name:e,alias:e,type:a,wfsNamespace:g});break;case "MultiCurvePropertyType":case "MultiLineStringPropertyType":a="esriFieldTypeGeometry";c="esriGeometryPolyline";d.push({name:e,alias:e,type:a,wfsNamespace:g});break;case "MultiSurfacePropertyType":case "MultiPolygonPropertyType":a=
"esriFieldTypeGeometry";c="esriGeometryPolygon";d.push({name:e,alias:e,type:a,wfsNamespace:g});break;case "GeometryPropertyType":case "MultiGeometryPropertyType":a="esriFieldTypeGeometry",c="esriGeometryComplex",d.push({name:e,alias:e,type:a,wfsNamespace:g})}}}return[c,d]},_getFeature:function(){var b;b="\x3c?xml version\x3d'1.0' encoding\x3d'utf-8'?\x3e\n\x3cGetFeature \n xmlns:xsi\x3d'http://www.w3.org/2001/XMLSchema-instance'\n xmlns:gml\x3d'http://www.opengis.net/gml'\n xmlns:ogc\x3d'http://www.opengis.net/ogc'\n xmlns:wfs\x3d'http://www.opengis.net/wfs'\n";
b="2.0.0"===this._version?b+" xmlns\x3d'http://www.opengis.net/wfs/2.0'\n":b+" xmlns\x3d'http://www.opengis.net/wfs'\n";var d=this._nsLayerNames[this._layerName];if(void 0===d)this.onError("WFSLayer: invalid layerName");else{var c=d.prefix,d=d.namespace;if("ondemand"===this._mode.toLowerCase()&&""===this._nsGeometryFieldName)this.onError("WFSLayer: GetFeature - can't use 'onDemand' mode as geometryFieldName is unknown.");else if(b+=" xmlns:"+c+"\x3d'"+d+"'\n",b="2.0.0"===this._version?b+(" version\x3d'"+
this._version+"' service\x3d'WFS' count\x3d'"+this._maxFeatures+"'\x3e\n"):b+(" version\x3d'"+this._version+"' service\x3d'WFS' maxFeatures\x3d'"+this._maxFeatures+"'\x3e\n"),b="2.0.0"===this._version?b+(" \x3cQuery typeNames\x3d'"+c+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n"):b+(" \x3cwfs:Query typeName\x3d'"+c+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n"),"ondemand"===this._mode.toLowerCase()&&(b=b+"  \x3cogc:Filter xmlns:ogc\x3d'http://www.opengis.net/ogc'\x3e\n   \x3cogc:BBOX\x3e\n"+
("    \x3cogc:PropertyName\x3e"+c+":"+this._nsGeometryFieldName+"\x3c/ogc:PropertyName\x3e\n"),b+="    \x3cgml:Box srsName\x3d'EPSG:"+this._wkid+"'\x3e\n",b=this._inverseFilter?b+"      \x3cgml:coordinates\x3e{ymin},{xmin} {ymax},{xmax}\x3c/gml:coordinates\x3e\n":b+"      \x3cgml:coordinates\x3e{xmin},{ymin} {xmax},{ymax}\x3c/gml:coordinates\x3e\n",b+="    \x3c/gml:Box\x3e\n   \x3c/ogc:BBOX\x3e\n  \x3c/ogc:Filter\x3e\n"),b="2.0.0"===this._version?b+" \x3c/Query\x3e\n":b+" \x3c/wfs:Query\x3e\n",this._getFeatureRequest=
b+"\x3c/GetFeature\x3e\n",""===this.getFeatureUrl)this.onError("WFSLayer: getFeature - server doesn't support POST method.");else if(""!==this._getFeatureRequest&&this._map&&null!==this._map.spatialReference.wkid){b=this._getFeatureRequest;if("ondemand"===this._mode.toLowerCase()){b=this._map.extent.xmin;var c=this._map.extent.ymin,d=this._map.extent.xmax,f=this._map.extent.ymax,a={},e=this._map.spatialReference,g=new E(this._wkid);this._projectFromSRToSR(e,g,b,c,a)&&(b=a.x,c=a.y);this._projectFromSRToSR(e,
g,d,f,a)&&(d=a.x,f=a.y);b=this._getFeatureRequest.replace(/{xmin}/,b).replace(/{ymin}/,c).replace(/{xmax}/,d).replace(/{ymax}/,f)}c=this._appendCustomParameters(this.getFeatureUrl);u({url:c,handleAs:"text",headers:{"Content-Type":"text/xml"},postData:b},{usePost:!0}).then(this._parseGml,this._errorSupport)}}},_parseGml:function(b){if(this._map&&this._map.spatialReference&&this._map.spatialReference.wkid){var d=(new DOMParser).parseFromString(b,"text/xml");if(b=this._readExceptionReport(d,b))this.onError("WFSLayer: GetFeature - returns exception: "+
b);else this._gmlNS="2.0.0"===this._version?"http://www.opengis.net/gml/3.2":"http://www.opengis.net/gml",""===this._wkid&&(this._wkid=this._map.spatialReference.wkid),this._graphicArray=this._readFeatureMembers(d,this._wkid,2,this._nsLayerNames[this._layerName].namespace,this._layerName),this.fullExtent=this._createFullExtent(this._graphicArray),this.onLabelingInfoChange(),"ondemand"===this._mode.toLowerCase()?this._fireUpdateEnd():this.refresh()}},_limit4326:function(b){for(var d=0;d<b.length;d++){var c=
b[d].geometry;4326===c.spatialReference.wkid&&(c.x=this._limit4326X(c.x),c.y=this._limit4326Y(c.y))}},_limit4326X:function(b){180<=b&&(b=179.99);-180>=b&&(b=-179.99);return b},_limit4326Y:function(b){90<=b&&(b=89.99);-90>=b&&(b=-89.99);return b},_createFullExtent:function(b){for(var d=null,c=0;c<b.length;c++){var f=b[c].geometry,a=null;(a="point"===f.geometryType?new e(f.x,f.y,f.x,f.y,f.spatialReference):f.getExtent())&&(d=null===d?a:d.union(a))}return d},_readExceptionReport:function(b,d){return 0<
b.getElementsByTagNameNS("*","ExceptionReport").length||0<b.getElementsByTagNameNS("*","ServiceExceptionReport").length?d:""},_readFeatureMembers:function(b,d,c,f,a){var h,e,p,g;e=this._readWkidFromNode(b);-1!=e&&(d=e);e=this._readSrsDimension(b);0!==e&&(c=e);var r=[];p=b.getElementsByTagNameNS("*","featureMembers");for(e=0;e<p.length;e++)for(h=p[e],g=h.getElementsByTagNameNS(f,a),0===g.length&&(g=h.getElementsByTagNameNS(null,a)),0===g.length&&(g=h.getElementsByTagNameNS("*",a)),h=0;h<g.length;h++)this._readLayer(r,
g[h],d,c);p=b.getElementsByTagNameNS("*","featureMember");for(e=0;e<p.length;e++)for(h=p[e],g=h.getElementsByTagNameNS(f,a),0===g.length&&(g=h.getElementsByTagNameNS(null,a)),0===g.length&&(g=h.getElementsByTagNameNS("*",a)),h=0;h<g.length;h++)this._readLayer(r,g[h],d,c);p=b.getElementsByTagNameNS("*","member");for(e=0;e<p.length;e++)for(h=p[e],g=h.getElementsByTagNameNS(f,a),0===g.length&&(g=h.getElementsByTagNameNS(null,a)),0===g.length&&(g=h.getElementsByTagNameNS("*",a)),h=0;h<g.length;h++)this._readLayer(r,
g[h],d,c);return r},_readLayer:function(b,d,c,f){var a,h;h=this._readSrsDimension(d);0!==h&&(f=h);var e=d.childNodes,g="",r=null;for(d=0;d<e.length;d++)if(a=e[d],1==a.nodeType&&(h=a.localName,"boundedBy"!==h)){a=this._readGeometry(a,c,f);if(!this._isProjectedOk){this._isProjectedOk=!0;console.error("WFSLayer: could not project geometry.");break}if(null!==a){r=a;g=h;break}}if(r){c={};for(d=0;d<e.length;d++)if(a=e[d],h=a.localName,f=a.textContent,h!==g)for(a=0;a<this.fields.length;a++){var q=this.fields[a];
q.name==h&&(c[h]="esriFieldTypeDouble"===q.type?parseFloat(f,10):"esriFieldTypeInteger"===q.type?parseInt(f,10):f.trim())}this._convertWFSGeometryToGraphicObjects(b,r,c)}},_convertWFSGeometryToGraphicObjects:function(b,d,c){var f;if("point"===d.geometryType&&("esriGeometryPoint"===this.geometryType||"esriGeometryComplex"===this.geometryType))f=new w,d=new q(d),f.setGeometry(d),f.setAttributes(c),b.push(f);else if("multipoint"===d.geometryType&&("esriGeometryPoint"===this.geometryType||"esriGeometryComplex"===
this.geometryType))f=new w,d=new x(d),f.setGeometry(d),f.setAttributes(c),b.push(f);else if("polyline"===d.geometryType&&("esriGeometryPolyline"===this.geometryType||"esriGeometryComplex"===this.geometryType))f=new w,d=new D(d),f.setGeometry(d),f.setAttributes(c),b.push(f);else if("polygon"===d.geometryType&&("esriGeometryPolygon"===this.geometryType||"esriGeometryComplex"===this.geometryType))f=new w,d=new I(d),f.setGeometry(d),f.setAttributes(c),b.push(f);else if("multigeometry"===d.geometryType)for(f=
0;f<d.length;f++)this._convertWFSGeometryToGraphicObjects(b,d[f],c)},_readGeometry:function(b,d,c){var f,a;f=this._readWkidFromNode(b);-1!=f&&(d=f);f=this._readSrsDimension(b);0!==f&&(c=f);a=b.getElementsByTagNameNS(this._gmlNS,"MultiSurface");if(1<=a.length)for(f=0;f<a.length;)return this._readMultiSurface(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"MultiCurve");if(1<=a.length){var e=[];for(f=0;f<a.length;f++){var h=this._readMultiCurve(a[f],d,c);for(b=0;b<h.length;b++)e.push(h[b])}return{geometryType:"polyline",
paths:e,spatialReference:{wkid:this._map.spatialReference.wkid}}}a=b.getElementsByTagNameNS(this._gmlNS,"MultiGeometry");for(f=0;f<a.length;)return this._readMultiGeometry(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"Geometry");for(f=0;f<a.length;)return this._readGeometry(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"GeometryCollection");for(f=0;f<a.length;)return this._readGeometryCollection(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"Surface");for(f=0;f<a.length;)return this._readSurface(a[f],
d,c);a=b.getElementsByTagNameNS(this._gmlNS,"Curve");for(f=0;f<a.length;)return this._readCurve(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"MultiPolygon");for(f=0;f<a.length;)return this._readMultiPolygon(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(f=0;f<a.length;)return this._readPolygon(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"MultiLineString");for(f=0;f<a.length;)return this._readMultiLineString(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(f=
0;f<a.length;){d=this._readLineString(a[f],d,c);c={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};f=[];for(b=0;b<d.length;b++)f.push(d[b]);c.paths.push(f);return c}a=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");for(f=0;f<a.length;)return this._readLinearRing(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"Box");if(1<=a.length)for(f=0;f<a.length;)return this._readBox(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"Envelope");for(f=0;f<a.length;)return this._readEnvelope(a[f],
d,c);a=b.getElementsByTagNameNS(this._gmlNS,"MultiPoint");if(1<=a.length)for(f=0;f<a.length;)return this._readMultiPoint(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"Point");for(f=0;f<a.length;)return this._readPoint(a[f],d,c);return null},_readGeometryCollection:function(b,d,c){var f,a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);a=[];a.geometryType="multigeometry";a.spatialReference={wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,
"geometryMember");for(b=0;b<f.length;b++){var e=this._readGeometryMember(f[b],d,c);a.push(e)}return a},_readMultiGeometry:function(b,d,c){var f,a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);a=[];a.geometryType="multigeometry";a.spatialReference={wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(b=0;b<f.length;b++){var e=this._readGeometryMember(f[b],d,c);a.push(e)}return a},_readSurface:function(b,d,c){var f,a;f=
this._readWkidFromNode(b);-1!=f&&(d=f);f=this._readSrsDimension(b);0!==f&&(c=f);var e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};a=b.getElementsByTagNameNS(this._gmlNS,"Point");for(f=0;f<a.length;f++)e.push(this._readPoint(a[f],d,c));a=b.getElementsByTagNameNS(this._gmlNS,"patches");for(f=0;f<a.length;f++){b=this._readPatches(a[f],d,c);for(var h=0;h<b.length;h++)e.push(b[h])}return e},_readMultiSurface:function(b,d,c){var f,a,e;f=this._readWkidFromNode(b);
-1!=f&&(d=f);f=this._readSrsDimension(b);0!==f&&(c=f);var h=[];h.geometryType="multigeometry";h.spatialReference={wkid:this._map.spatialReference.wkid};e=b.getElementsByTagNameNS(this._gmlNS,"surfaceMember");for(f=0;f<e.length;f++){var g=this._readSurfaceMember(e[f],d,c);for(a=0;a<g.length;a++)h.push(g[a])}e=b.getElementsByTagNameNS(this._gmlNS,"surfaceMembers");for(f=0;f<e.length;f++)for(b=this._readSurfaceMembers(e[f],d,c),a=0;a<b.length;a++)h.push(b[a]);return h},_readCurve:function(b,d,c){var f,
a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);a={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};f=b.getElementsByTagNameNS(this._gmlNS,"segments");for(b=0;b<f.length;b++)for(var e=this._readSegments(f[b],d,c),h=0;h<e.length;h++)a.paths.push(e[h]);return a},_readSegments:function(b,d,c){var f,a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);a=[];a.geometryType="multigeometry";a.spatialReference=
{wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,"LineStringSegment");for(b=0;b<f.length;b++){var e=this._readLineStringSegment(f[b],d,c);a.push(e)}return a},_readLineStringSegment:function(b,d,c){var f=this._readWkidFromNode(b);-1!=f&&(d=f);f=this._readSrsDimension(b);0!==f&&(c=f);for(b=b.getElementsByTagNameNS(this._gmlNS,"posList");0<b.length;)return this._readPosList(b[0],d,c)},_readMultiCurve:function(b,d,c){var f,a,e,h;f=this._readWkidFromNode(b);-1!=f&&(d=f);f=
this._readSrsDimension(b);0!==f&&(c=f);var g=[];g.spatialReference={wkid:this._map.spatialReference.wkid};e=b.getElementsByTagNameNS(this._gmlNS,"curveMember");for(f=0;f<e.length;f++)for(h=this._readCurveMember(e[f],d,c),a=0;a<h.length;a++)g.push(h[a]);e=b.getElementsByTagNameNS(this._gmlNS,"curveMembers");for(f=0;f<e.length;f++)for(h=this._readCurveMembers(e[f],d,c),a=0;a<h.length;a++)g.push(h[a]);return g},_readGeometryMember:function(b,d,c){var f,a;f=this._readWkidFromNode(b);-1!=f&&(d=f);f=this._readSrsDimension(b);
0!==f&&(c=f);a=b.getElementsByTagNameNS(this._gmlNS,"Point");for(f=0;f<a.length;)return this._readPoint(a[f],d,c);a=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(f=0;f<a.length;){d=this._readLineString(a[f],d,c);c={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};f=[];for(b=0;b<d.length;b++)f.push(d[b]);c.paths.push(f);return c}a=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(f=0;f<a.length;)return this._readPolygon(a[f],d,c);return null},_readSurfaceMember:function(b,
d,c){var f,a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);a=[];a.geometryType="multigeometry";a.spatialReference={wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(b=0;b<f.length;b++){var e=this._readPolygon(f[b],d,c);a.push(e)}return a},_readSurfaceMembers:function(b,d,c){var f,a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);a=[];a.geometryType="multigeometry";a.spatialReference={wkid:this._map.spatialReference.wkid};
f=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(b=0;b<f.length;b++){var e=this._readPolygon(f[b],d,c);a.push(e)}return a},_readCurveMember:function(b,d,c){var f,a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);a=[];a.geometryType="multigeometry";a.spatialReference={wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(b=0;b<f.length;b++){var e=this._readLineString(f[b],d,c);a.push(e)}return a},_readCurveMembers:function(b,
d,c){var f,a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);a=[];a.geometryType="multigeometry";a.spatialReference={wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(b=0;b<f.length;b++){var e=this._readLineString(f[b],d,c);a.push(e)}return a},_readBox:function(b,d,c){var a,e,h,g,q,l,k,r=this._readWkidFromNode(b);-1!=r&&(d=r);r=this._readSrsDimension(b);0!==r&&(c=r);r={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};
e=b.getElementsByTagNameNS(this._gmlNS,"coordinates");for(a=0;a<e.length;a++)if(h=this._readCoordinates(e[a],d,c))return 1<=h.length&&(g=l=h[0][0],q=k=h[0][1]),1<=h.length&&(l=h[1][0],k=h[1][1]),r.rings.push([[g,q],[g,k],[l,k],[l,q],[g,q]]),r;e=b.getElementsByTagNameNS(this._gmlNS,"coord");return 2<=e.length?((b=this._readCoord(e[0],d,c))&&1<=b.length&&(g=l=b[0][0],q=k=b[0][1]),(d=this._readCoord(e[1],d,c))&&1<=d.length&&(l=d[0][0],k=d[0][1]),r.rings.push([[g,q],[g,k],[l,k],[l,q],[g,q]]),r):null},
_readEnvelope:function(b,d,c){var a,e,h,g;a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);e=b.getElementsByTagNameNS(this._gmlNS,"lowerCorner");for(a=0;a<e.length;a++){var q=this._readCoordinates(e[a],d,c);q&&(h=q[0])}e=b.getElementsByTagNameNS(this._gmlNS,"upperCorner");for(a=0;a<e.length;a++)(b=this._readCoordinates(e[a],d,c))&&(g=b[0]);return h&&g?{geometryType:"polygon",rings:[[[h[0],h[1]],[h[0],g[1]],[g[0],g[1]],[g[0],h[1]],[h[0],h[1]]]],spatialReference:{wkid:this._map.spatialReference.wkid}}:
null},_readPolygon:function(b,d,c){var a,e,h;a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);var g={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};e=b.getElementsByTagNameNS(this._gmlNS,"outerBoundaryIs");for(a=0;a<e.length;a++)h=this._readOuterBoundaryIs(e[a],d,c),g.rings.push(h);e=b.getElementsByTagNameNS(this._gmlNS,"innerBoundaryIs");for(a=0;a<e.length;a++)h=this._readInnerBoundaryIs(e[a],d,c),g.rings.push(h);e=b.getElementsByTagNameNS(this._gmlNS,
"exterior");for(a=0;a<e.length;a++)h=this._readExterior(e[a],d,c),g.rings.push(h);e=b.getElementsByTagNameNS(this._gmlNS,"interior");for(a=0;a<e.length;a++)h=this._readInterior(e[a],d,c),g.rings.push(h);return g},_readPolygonMember:function(b,d,c){var a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);for(b=b.getElementsByTagNameNS(this._gmlNS,"Polygon");0<b.length;)return this._readPolygon(b[0],d,c);return null},_readMultiPolygon:function(b,d,c){var a,e=this._readWkidFromNode(b);
-1!=e&&(d=e);e=this._readSrsDimension(b);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};a=b.getElementsByTagNameNS(this._gmlNS,"polygonMember");for(b=0;b<a.length;b++){var h=this._readPolygonMember(a[b],d,c);e.push(h)}return e},_readOuterBoundaryIs:function(b,d,c){var a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],
d,c);return null},_readInnerBoundaryIs:function(b,d,c){var a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],d,c);return null},_readExterior:function(b,d,c){var a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],d,c);return null},_readInterior:function(b,
d,c){var a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],d,c);return null},_readPatches:function(b,d,c){var a,e=this._readWkidFromNode(b);-1!=e&&(d=e);e=this._readSrsDimension(b);0!==e&&(c=e);e=[];e.spatialReference={wkid:this._map.spatialReference.wkid};a=b.getElementsByTagNameNS(this._gmlNS,"PolygonPatch");for(b=0;b<a.length;b++)e.push(this._readPolygon(a[b],d,
c));return e},_readLineString:function(b,d,c){var a,e,h,g,q;a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);var l=[];l.spatialReference={wkid:this._map.spatialReference.wkid};h=b.getElementsByTagNameNS(this._gmlNS,"coordinates");for(a=0;a<h.length;a++)if(g=this._readCoordinates(h[a],d,c))for(e=0;e<g.length;e++)q=g[e],l.push(q);h=b.getElementsByTagNameNS(this._gmlNS,"coord");for(a=0;a<h.length;a++)if(g=this._readCoord(h[a],d,c))for(e=0;e<g.length;e++)q=g[e],l.push(q);
h=b.getElementsByTagNameNS(this._gmlNS,"posList");for(a=0;a<h.length;a++)if(g=this._readPosList(h[a],d,c))for(e=0;e<g.length;e++)q=g[e],l.push(q);return l},_readLineStringMember:function(b,d,a){var c=this._readWkidFromNode(b);-1!=c&&(d=c);c=this._readSrsDimension(b);0!==c&&(a=c);for(b=b.getElementsByTagNameNS(this._gmlNS,"LineString");0<b.length;)return this._readLineString(b[0],d,a);return null},_readMultiLineString:function(b,d,a){var c,e=this._readWkidFromNode(b);-1!=e&&(d=e);e=this._readSrsDimension(b);
0!==e&&(a=e);e={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};c=b.getElementsByTagNameNS(this._gmlNS,"lineStringMember");for(b=0;b<c.length;b++){var h=this._readLineStringMember(c[b],d,a);h&&e.paths.push(h)}return 1<=e.paths.length?e:null},_readPoint:function(b,d,a){var c,e,h;c=this._readWkidFromNode(b);-1!=c&&(d=c);c=this._readSrsDimension(b);0!==c&&(a=c);e=b.getElementsByTagNameNS(this._gmlNS,"coordinates");for(c=0;c<e.length;c++)if(h=this._readCoordinates(e[c],
d,a))return{geometryType:"point",x:h[0][0],y:h[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};e=b.getElementsByTagNameNS(this._gmlNS,"pos");for(c=0;c<e.length;c++)if((h=this._readPos(e[c],d,a))&&0<h.length)return{geometryType:"point",x:h[0][0],y:h[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};e=b.getElementsByTagNameNS(this._gmlNS,"coord");for(c=0;c<e.length;c++)if(b=this._readCoord(e[c],d,a))return{geometryType:"point",x:b[0][0],y:b[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};
return null},_readPointMember:function(b,d,c){var a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);for(b=b.getElementsByTagNameNS(this._gmlNS,"Point");0<b.length;)return this._readPoint(b[0],d,c);return null},_readMultiPoint:function(b,d,c){var a,e=this._readWkidFromNode(b);-1!=e&&(d=e);e=this._readSrsDimension(b);0!==e&&(c=e);e={geometryType:"multipoint",points:[],spatialReference:{wkid:this._map.spatialReference.wkid}};a=b.getElementsByTagNameNS(this._gmlNS,"pointMember");
for(b=0;b<a.length;b++){var h=this._readPointMember(a[b],d,c);h&&e.points.push([h.x,h.y])}return 1<=e.points.length?e:null},_readLinearRing:function(b,d,c){var a,e;a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);e=b.getElementsByTagNameNS(this._gmlNS,"coordinates");for(a=0;a<e.length;)return this._readCoordinates(e[a],d,c);e=b.getElementsByTagNameNS(this._gmlNS,"posList");for(a=0;a<e.length;)return this._readCoordinates(e[a],d,c);e=b.getElementsByTagNameNS(this._gmlNS,
"pos");for(a=0;a<e.length;)return this._readPos(e[a],d,c)},_readCoordinatesBody:function(b,d,a){var c,e=new E(b);d=d.trim();var h,g,q=[];q.spatialReference={wkid:this._map.spatialReference.wkid};b=this._isReverse(b,this.version);if(d)if(2===a){if((d=d.match(/[0123456789.\-\+eE]+/g))&&2<=d.length)for(a=0;a<d.length;a+=2)h=parseFloat(d[a]),g=parseFloat(d[a+1]),b&&(c=g,g=h,h=c),c={},this._projectFromSRToSR(e,this._map.spatialReference,h,g,c)&&(h=c.x,g=c.y),q.push([h,g])}else if(3===a&&(d=d.match(/[0123456789.\-\+eE]+/g))&&
3<=d.length)for(a=0;a<d.length;a+=3)h=parseFloat(d[a]),g=parseFloat(d[a+1]),b&&(c=g,g=h,h=c),c={},this._projectFromSRToSR(e,this._map.spatialReference,h,g,c)&&(h=c.x,g=c.y),q.push([h,g]);return q},_readCoord:function(b,d,a){var c,e,h,g,q=this._readWkidFromNode(b);-1!=q&&(d=q);q=new E(d);h=this._readSrsDimension(b);0!==h&&(a=h);var l=this._isReverse(d,this.version),k=[];k.spatialReference={wkid:this._map.spatialReference.wkid};h=0;e=b.getElementsByTagNameNS(this._gmlNS,"X");for(c=0;c<e.length;){h=
this._readFloat(e[c],d,a);break}g=0;e=b.getElementsByTagNameNS(this._gmlNS,"Y");for(c=0;c<e.length;){g=this._readFloat(e[c],d,a);break}l&&(b=g,g=h,h=b);b={};this._projectFromSRToSR(q,this._map.spatialReference,h,g,b)&&(h=b.x,g=b.y);k.push(l?[g,h]:[h,g]);return k},_readCoordinates:function(b,d,a){var c=this._readWkidFromNode(b);-1!=c&&(d=c);c=this._readSrsDimension(b);0!==c&&(a=c);return this._readCoordinatesBody(d,b.textContent,a)},_readPos:function(b,d,a){var c=this._readWkidFromNode(b);-1!=c&&(d=
c);c=this._readSrsDimension(b);0!==c&&(a=c);return this._readCoordinatesBody(d,b.textContent,a)},_readPosList:function(b,d,c){var a=this._readWkidFromNode(b);-1!=a&&(d=a);a=this._readSrsDimension(b);0!==a&&(c=a);return this._readCoordinatesBody(d,b.textContent,c)},_projectFromSRToSR:function(b,a,c,e,g){if(d.canProject(b,a))return b=new q(c,e,b),a=d.project(b,a),g.x=a.x,g.y=a.y,!0;g.x=c;g.y=e;return this._isProjectedOk=!1},_readFloat:function(b){return(b=b.textContent)?parseFloat(b):0},_readSrsDimension:function(b){return b.attributes&&
(b=b.attributes.getNamedItem("srsDimension"))?parseInt(b.value,10):0},_readWkidFromNode:function(b){return b.attributes&&(b=b.attributes.getNamedItem("srsName"))&&(b=b.value.match(/\d+/g))&&0<b.length?(b=parseInt(b[b.length-1],10),84===b&&(b=4326),parseInt(b,10)):-1},_isReverse:function(b,d){return this._inverseResponse},_appendCustomParameters:function(b){if(this.customParameters)for(var d in this.customParameters)b+=(-1===b.indexOf("?")?"?":"\x26")+d+"\x3d"+encodeURIComponent(this.customParameters[d]);
return b}});t("extend-esri")&&n.setObject("layers.WFSLayer",l,k);return l})},"esri/layers/WMTSLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff dojox/xml/parser ../kernel ../lang ../request ../WKIDUnitConversion ../SpatialReference ../geometry/Point ../geometry/Extent ../geometry/webMercatorUtils ./TiledMapServiceLayer ./TileInfo ./WMTSLayerInfo dojo/query".split(" "),function(l,a,n,g,m,t,c,u,k,w,G,v,C,B,F,A,E){a=a([F],{declaredClass:"esri.layers.WMTSLayer",
copyright:null,extent:null,tileUrl:null,spatialReference:null,tileInfo:null,constructor:function(d,a){this.version="1.0.0";this.tileUr=this._url=d;this.serviceMode="RESTful";this._parseCapabilities=n.hitch(this,this._parseCapabilities);this._getCapabilitiesError=n.hitch(this,this._getCapabilitiesError);a||(a={});if(a.serviceMode)if("KVP"===a.serviceMode||"RESTful"===a.serviceMode)this.serviceMode=a.serviceMode;else{console.error("WMTS mode could only be 'KVP' or 'RESTful'");return}this.customParameters=
a.customParameters;this.customLayerParameters=a.customLayerParameters;this.layerInfo=new E;a.layerInfo&&(this.layerInfo=a.layerInfo,this._identifier=a.layerInfo.identifier,this._tileMatrixSetId=a.layerInfo.tileMatrixSet,a.layerInfo.format&&(this.format="image/"+a.layerInfo.format),this._style=a.layerInfo.style,this.title=a.layerInfo.title,this._dimension=a.layerInfo.dimension,this._dimension2=a.layerInfo.dimension2);a.resourceInfo?(this.version=a.resourceInfo.version,a.resourceInfo.getTileUrl&&(this._url=
this.tileUrl=a.resourceInfo.getTileUrl),this.copyright=a.resourceInfo.copyright,this.layerInfos=a.resourceInfo.layerInfos,this.customParameters=a.resourceInfo.customParameters||this.customParameters,this.customLayerParameters=a.resourceInfo.customLayerParameters||this.customLayerParameters,this._parseResourceInfo(),this.loaded=!0,this.onLoad(this)):this._getCapabilities();this._formatDictionary={"image/png":".png","image/png8":".png","image/png24":".png","image/png32":".png","image/jpg":".jpg","image/jpeg":".jpeg",
"image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"","image/jpegpng":"","image/unknown":""}},setActiveLayer:function(d){this.setVisibleLayer(d)},setVisibleLayer:function(d){this._setActiveLayer(d);this.refresh(!0)},setCustomParameters:function(d,a){this.customParameters=d;this.customLayerParameters=a;this.refresh(!0)},getTileUrl:function(d,a,c){d=this._levelToLevelValue[d];d=this.resourceUrls&&0<this.resourceUrls.length?this.resourceUrls[a%this.resourceUrls.length].template.replace(/\{Style\}/gi,
this._style).replace(/\{TileMatrixSet\}/gi,this._tileMatrixSetId).replace(/\{TileMatrix\}/gi,d).replace(/\{TileRow\}/gi,a).replace(/\{TileCol\}/gi,c).replace(/\{dimensionValue\}/gi,this._dimension).replace(/\{dimensionValue2\}/gi,this._dimension2):this.UrlTemplate.replace(/\{level\}/gi,d).replace(/\{row\}/gi,a).replace(/\{col\}/gi,c);d=this._appendCustomLayerParameters(d);return d=this.addTimestampToURL(d)},getTileUrlTemplate:function(d){var a=d.identifier,c=d.tileMatrixSet,l=d.format,k=d.style,m=
d.dimension,z=d.dimension2;a?d=g.filter(this.layers,function(b){return b.identifier===a})[0]:(d=this.layers[0],a=this.layers[0].identifier);if(d){if(!l)l=d.formats[0];else if(!(-1===l.indexOf("image/")&&-1<g.indexOf(d.formats,l))&&(-1===l.indexOf("image/")&&(l="image/"+l),-1===g.indexOf(d.formats,l))){console.error("The layer doesn't support the format of "+l);this.onError(Error("The layer doesn't support the format of "+l));return}if(!k)k=d.styles[0];else if(-1===g.indexOf(d.styles,k)){console.error("The layer doesn't support the style of "+
k);this.onError(Error("The layer doesn't support the style of "+k));return}if(!m&&d.dimensions)m=d.dimensions[0];else if(-1===g.indexOf(d.dimensions,m)){console.error("The layer doesn't support the dimension of "+m);this.onError(Error("The layer doesn't support the dimension of "+m));return}if(!z&&d.dimensions2)z=d.dimensions2[0];else if(-1===g.indexOf(d.dimensions2,z)){console.error("The layer doesn't support the dimension of "+z);this.onError(Error("The layer doesn't support the dimension of "+
z));return}var n;if(c){if(n=g.filter(d.tileMatrixSetInfos,function(b){return b.tileMatrixSet===c})[0],!n){console.error("The tileMatrixSetId "+c+" is not supported by the layer of "+a);this.onError(Error("The tileMatrixSetId "+c+" is not supported by the layer of "+a));return}}else(n=g.filter(d.tileMatrixSetInfos,function(b){return"GoogleMapsCompatible"===b.tileMatrixSet})[0])||(n=d.tileMatrixSetInfos[0]),c=n.tileMatrixSet;return this._getTileUrlTemplate(a,c,l,k,m,z)}console.error("couldn't find the layer "+
a);this.onError(Error("couldn't find the layer "+a))},_getTileUrlTemplate:function(d,a,c,g,l,k){var e;d||(d=this._identifier);a||(a=this._tileMatrixSetId);c||(c=this.format);g||""===g||(g=this._style);if(this.resourceUrls&&0<this.resourceUrls.length)return e=this.resourceUrls[0].template,e.indexOf(".xxx")===e.length-4&&(e=e.slice(0,e.length-4)),e=e.replace(/\{Style\}/gi,g),e=e.replace(/\{TileMatrixSet\}/gi,a),e=e.replace(/\{TileMatrix\}/gi,"{level}"),e=e.replace(/\{TileRow\}/gi,"{row}"),e=e.replace(/\{TileCol\}/gi,
"{col}"),e=e.replace(/\{dimensionValue\}/gi,l),e=e.replace(/\{dimensionValue2\}/gi,k);"KVP"===this.serviceMode?e=this._url+"SERVICE\x3dWMTS\x26VERSION\x3d"+this.version+"\x26REQUEST\x3dGetTile\x26LAYER\x3d"+d+"\x26STYLE\x3d"+g+"\x26FORMAT\x3d"+c+"\x26TILEMATRIXSET\x3d"+a+"\x26TILEMATRIX\x3d{level}\x26TILEROW\x3d{row}\x26TILECOL\x3d{col}":"RESTful"===this.serviceMode&&(l="",this._formatDictionary[c.toLowerCase()]&&(l=this._formatDictionary[c.toLowerCase()]),e=this._url+d+"/"+g+"/"+a+"/{level}/{row}/{col}"+
l);return e},_parseResourceInfo:function(){var d=this.layerInfos,a,c;"KVP"===this.serviceMode&&(this._url+=-1<this._url.indexOf("?")?"":"?");for(c=0;c<d.length;c++)if(!(this._identifier&&d[c].identifier!==this._identifier||this.title&&d[c].title!==this.title||this._tileMatrixSetId&&d[c].tileMatrixSet!==this._tileMatrixSetId||this.format&&"image/"+d[c].format!==this.format||this._style&&d[c].style!==this._style)){n.mixin(this,{description:d[c].description,tileInfo:d[c].tileInfo,spatialReference:d[c].tileInfo.spatialReference,
fullExtent:d[c].fullExtent,initialExtent:d[c].initialExtent,_identifier:d[c].identifier,_tileMatrixSetId:d[c].tileMatrixSet,format:"image/"+d[c].format,_style:d[c].style});break}for(c=0;c<d.length;c++)a=d[c].tileInfo,96!==a.dpi&&(g.forEach(a.lods,function(d){d.scale=96*d.scale/a.dpi}),a.dpi=96),g.forEach(a.lods,function(e){e.resolution=this._getResolution(a.spatialReference.wkid,90.71428571428571*e.scale/96,d[c].tileMatrixSet)},this);this._setActiveLayer();this.UrlTemplate=this._getTileUrlTemplate();
this._levelToLevelValue=[];g.forEach(this.tileInfo.lods,function(d){this._levelToLevelValue[d.level]=d.levelValue?d.levelValue:d.level},this)},_getCapabilities:function(){var d;"KVP"===this.serviceMode?d=-1<this._url.indexOf("?")?this._url+"\x26request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:this._url+"?request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:"RESTful"===this.serviceMode&&(d=this._url+"/"+this.version+"/WMTSCapabilities.xml");d=this._appendCustomParameters(d);
k({url:d,handleAs:"text",load:this._parseCapabilities,error:this._getCapabilitiesError})},_parseCapabilities:function(d){d=d.replace(/ows:/gi,"");d=t.parse(d);var a=l.query("Contents",d)[0];if(a){var c=l.query("OperationsMetadata",d)[0],k=l.query("[name\x3d'GetTile']",c)[0],c=this._url,k=l.query("Get",k),m,n=!1,z,y;for(m=0;m<k.length;m++){var b=l.query("Constraint",k[m])[0];if(!b||this._getTagWithChildTagValue("AllowedValues","Value",this.serviceMode,b)){c=k[m].attributes[0].nodeValue;n=!0;break}else if(!b||
this._getTagWithChildTagValue("AllowedValues","Value","RESTful",b))z=k[m].attributes[0].nodeValue;else if(!b||this._getTagWithChildTagValue("AllowedValues","Value","KVP",b))y=k[m].attributes[0].nodeValue}n||("KVP"===this.serviceMode&&z?(c=z,this.serviceMode="RESTful"):"RESTful"===this.serviceMode&&y&&(c=y,this.serviceMode="KVP"));-1===c.indexOf("/1.0.0/")&&"RESTful"===this.serviceMode&&(c+="/");"KVP"===this.serviceMode&&(c+=-1<c.indexOf("?")?"":"?");this._url=c;this.copyright=this._getTagValues("Capabilities\x3eServiceIdentification\x3eAccessConstraints",
d)[0];z=l.query("Layer",a);var h,r=[];this.layers=[];g.forEach(z,function(b){h=this._getTagValues("Identifier",b)[0];r.push(h);this.layers.push(this._getWMTSLayerInfo(h,b,a))},this);this._setActiveLayer();this.loaded=!0;this.onLoad(this)}else console.error("The WMTS capabilities XML is not valid"),this.onError(Error("The WMTS capabilities XML is not valid"))},_setActiveLayer:function(d){d||(d={});d.identifier&&(this._identifier=d.identifier);d.tileMatrixSet&&(this._tileMatrixSetId=d.tileMatrixSet);
d.format&&(this.format=d.format);d.style&&(this._style=d.style);d.dimension&&(this._dimension=d.dimension);d.dimension2&&(this._dimension2=d.dimension2);if(this.layers)if(this._identifier?d=g.filter(this.layers,function(a){return a.identifier===this._identifier},this)[0]:(d=this.layers[0],this._identifier=this.layers[0].identifier),d){if(this.format){if(-1===this.format.indexOf("image/")&&(this.format="image/"+this.format),-1===g.indexOf(d.formats,this.format)){console.error("The layer doesn't support the format of "+
this.format);this.onError(Error("The layer doesn't support the format of "+this.format));return}}else this.format=d.formats[0],-1===this.format.indexOf("image/")&&(this.format="image/"+this.format);if(!this._style)this._style=d.styles[0];else if(-1===g.indexOf(d.styles,this._style)){console.error("The layer doesn't support the style of "+this._style);this.onError(Error("The layer doesn't support the style of "+this._style));return}if(!this._dimension&&d.dimensions)this._dimension=d.dimensions[0];
else if(-1===g.indexOf(d.dimensions,this._dimension)){console.error("The layer doesn't support the dimension of "+this._dimension);this.onError(Error("The layer doesn't support the dimension of "+this._dimension));return}if(!this._dimension2&&d.dimensions2)this._dimension2=d.dimensions2[0];else if(-1===g.indexOf(d.dimensions2,this._dimension2)){console.error("The layer doesn't support the dimension of "+this._dimension2);this.onError(Error("The layer doesn't support the dimension of "+this._dimension2));
return}var a;if(this._tileMatrixSetId){if(a=g.filter(d.tileMatrixSetInfos,function(a){return a.tileMatrixSet===this._tileMatrixSetId},this)[0],!a){console.error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier);this.onError(Error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier));return}}else(a=g.filter(d.tileMatrixSetInfos,function(a){return"GoogleMapsCompatible"===a.tileMatrixSet})[0])||(a=d.tileMatrixSetInfos[0]),
this._tileMatrixSetId=a.tileMatrixSet;this.description=d.description;this.title=d.title;this.spatialReference=a.tileInfo.spatialReference;this.tileInfo=a.tileInfo;this._levelToLevelValue=[];g.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=a.levelValue?a.levelValue:a.level},this);102100===this.spatialReference.wkid||102113===this.spatialReference.wkid?this.fullExtent=this.initialExtent=B.geographicToWebMercator(d.gcsExtent):4326===this.spatialReference.wkid?this.fullExtent=
this.initialExtent=d.gcsExtent:(this.fullExtent=a.fullExtent,this.initialExtent=a.initialExtent);this.resourceUrls=d.resourceUrls;this.UrlTemplate=this._getTileUrlTemplate();this.layerInfo={identifier:this._identifier,tileMatrixSet:this._tileMatrixSetId,format:this.format,style:this._style,fullExtent:this.fullExtent,initialExtent:this.initialExtent,tileInfo:this.tileInfo,title:this.title,description:this.description}}else console.error("couldn't find the layer "+this._identifier),this.onError(Error("couldn't find the layer "+
this._identifier))},_getWMTSLayerInfo:function(a,c,q){var d=this._getTagValues("Abstract",c)[0],e=this._getTagValues("Title",c)[0],k=l.query("WGS84BoundingBox",c)[0],m=k?this._getTagValues("LowerCorner",k)[0].split(" "):["-180","-90"],n=k?this._getTagValues("UpperCorner",k)[0].split(" "):["180","90"],k=parseFloat(m[0]),m=parseFloat(m[1]),b=parseFloat(n[0]),n=parseFloat(n[1]),k=new C(k,m,b,n,new G({wkid:4326})),n=this._getTagValues("Identifier",l.query("Style",c)[0]),h=this._getTagValues("Identifier",
l.query("Dimension",c)[0]),r=this._getTagValues("Default",l.query("Dimension",c)[0])||this._getTagValues("Value",l.query("Dimension",c)[0]),f=1<l.query("Dimension",c).length?this._getTagValues("Identifier",l.query("Dimension",c)[1]):[],p=1<l.query("Dimension",c).length?this._getTagValues("Default",l.query("Dimension",c)[1])||this._getTagValues("Value",l.query("Dimension",c)[1]):[],m=this._getTagValues("Format",c);q=this._getLayerMatrixInfos(c,q);a={identifier:a,tileMatrixSetInfos:q,formats:m,styles:n,
title:e,description:d,gcsExtent:k,dimensions:r,dimensions2:p};c=l.query("ResourceURL",c);var t=[],v;g.forEach(c,function(b){v=b.getAttribute("template");if(h&&r&&h[0]&&r[0])if(-1<v.indexOf("{"+h+"}"))v=v.replace("{"+h+"}","{dimensionValue}");else{var a=v.toLowerCase().indexOf("{"+h[0].toLowerCase()+"}");-1<a&&(v=v.substring(0,a)+"{dimensionValue}"+v.substring(a+h[0].length+2))}f&&p&&f[0]&&p[0]&&(-1<v.indexOf("{"+f+"}")?v=v.replace("{"+f+"}","{dimensionValue2}"):(a=v.toLowerCase().indexOf("{"+f[0].toLowerCase()+
"}"),-1<a&&(v=v.substring(0,a)+"{dimensionValue2}"+v.substring(a+f[0].length+2))));t.push({template:v,format:b.getAttribute("format"),resourceType:b.getAttribute("resourceType")})});t&&0<t.length&&(a.resourceUrls=t);return a},_getLayerMatrixInfos:function(a,c){var d,e=[];this._allMatrixInfos||(this._allMatrixInfos=[]);var l=this._getTagValues("TileMatrixSet",a);if(l&&0!==l.length)return g.forEach(l,function(g){var l;if(0<this._allMatrixInfos.length)for(d=0;d<this._allMatrixInfos.length;d++)if(this._allMatrixInfos[d].tileMatrixSet==
g){l=this._allMatrixInfos[d];break}l||(l=this._getLayerMatrixInfo(g,a,c),this._allMatrixInfos.push(l));e.push(l)},this),e},_getLayerMatrixInfo:function(a,c,g){var d,e,k,q,m=[];c=this._getTagWithChildTagValue("TileMatrixSetLink","TileMatrixSet",a,c);var b=this._getTagValues("TileMatrix",c),h=this._getTagWithChildTagValue("TileMatrixSet","Identifier",a,g),n=this._getTagValues("SupportedCRS",h)[0];d=parseInt(n.split(":").pop(),10);if(900913==d||3857==d)d=102100;if(-1<n.toLowerCase().indexOf("crs84")||
-1<n.toLowerCase().indexOf("crs:84"))d=4326,q=!0;else if(-1<n.toLowerCase().indexOf("crs83")||-1<n.toLowerCase().indexOf("crs:83"))d=4269,q=!0;else if(-1<n.toLowerCase().indexOf("crs27")||-1<n.toLowerCase().indexOf("crs:27"))d=4267,q=!0;var f=new G({wkid:d}),p=l.query("TileMatrix",h)[0];g=parseInt(this._getTagValues("TileWidth",p)[0],10);c=parseInt(this._getTagValues("TileHeight",p)[0],10);e=this._getTagValues("TopLeftCorner",p)[0].split(" ");var t=e[0],u=e[1];1<t.split("E").length&&(e=t.split("E"),
t=e[0]*Math.pow(10,e[1]));1<u.split("E").length&&(e=u.split("E"),u=e[0]*Math.pow(10,e[1]));var t=parseFloat(t),u=parseFloat(u),w=q&&4326===d&&90===t&&-180===u;for(e=0;e<this._flippingAxisForWkids.length;e++)if(n.split(":").pop()>=this._flippingAxisForWkids[e][0]&&n.split(":").pop()<=this._flippingAxisForWkids[e][1]||4326===d&&(!q||w)){4326===d&&90<t&&(t="90");k=new v(u,t,f);break}e===this._flippingAxisForWkids.length&&(k=new v(t,u,f));if(0===b.length)for(b=l.query("TileMatrix",h),e=0;e<b.length;e++)q=
this._getLodFromTileMatrix(b[e],d,e,a),m.push(q);else for(e=0;e<b.length;e++)q=this._getTagWithChildTagValue("TileMatrix","Identifier",b[e],h),q=this._getLodFromTileMatrix(q,d,e,a),m.push(q);d=l.query("BoundingBox",h)[0];var B,E;d&&(B=this._getTagValues("LowerCorner",d)[0].split(" "),E=this._getTagValues("UpperCorner",d)[0].split(" "));B&&1<B.length&&E&&1<E.length?(p=parseFloat(B[0]),d=parseFloat(B[1]),B=parseFloat(E[0]),E=parseFloat(E[1])):(B=this._getTagValues("MatrixWidth",p)[0],d=this._getTagValues("MatrixHeight",
p)[0],p=k.x,E=k.y,B=p+B*c*m[0].resolution,d=E-d*g*m[0].resolution);E=B=new C(p,d,B,E,f);k=new A({dpi:96,spatialReference:f,format:this.format,rows:g,cols:c,origin:k,lods:m});return{tileMatrixSet:a,fullExtent:E,initialExtent:B,tileInfo:k}},_getCapabilitiesError:function(a){console.error("Failed to get capabilities xml");this.onError(a)},_getLodFromTileMatrix:function(a,c,g,l){var d=this._getTagValues("Identifier",a)[0];a=this._getTagValues("ScaleDenominator",a)[0];1<a.split("E").length?(a=a.split("E"),
a=a[0]*Math.pow(10,a[1])):a=parseFloat(a);c=this._getResolution(c,a,l);return{level:g,levelValue:d,scale:1.058267716535433*a,resolution:c}},_getResolution:function(a,c,g){a=u.isDefined(w[a])?w.values[w[a]]:"default028mm"===g?6370997*Math.PI/180:6378137*Math.PI/180;return 7*c/25E3/a},_getTag:function(a,c){var d=l.query(a,c);return d&&0<d.length?d[0]:null},_getTagValues:function(a,c){var d=[],e=a.split("\x3e"),k,n;k=l.query(e[0],c)[0];if(1<e.length){for(n=1;n<e.length-1;n++)k=l.query(e[n],k)[0];e=l.query(e[e.length-
1],k)}else e=l.query(e[0],c);e&&0<e.length&&g.forEach(e,function(a){9>m("ie")?d.push(a.childNodes.length?a.childNodes[0].nodeValue:""):d.push(a.textContent)});return d},_getAttributeValues:function(a,c,k){a=l.query(a,k);var d=[];a&&0<a.length&&g.forEach(a,function(a){d.push(a.getAttribute(c))});return d},_getTagWithChildTagValue:function(a,c,g,k){k=k.childNodes;var d,e;for(e=0;e<k.length;e++)if(-1<k[e].nodeName.indexOf(a)&&(9>m("ie")?u.isDefined(l.query(c,k[e])[0])&&(d=l.query(c,k[e])[0].childNodes[0].nodeValue):
u.isDefined(l.query(c,k[e])[0])&&(d=l.query(c,k[e])[0].textContent),d===g||g.split(":")&&d===g.split(":")[1]))return k[e]},_appendCustomParameters:function(a){var c;if(this.customParameters)for(c in this.customParameters)a+=(-1===a.indexOf("?")?"?":"\x26")+c+"\x3d"+encodeURIComponent(this.customParameters[c]);return a},_appendCustomLayerParameters:function(a){var c,d;if(this.customLayerParameters||this.customParameters)for(c in d=n.clone(this.customParameters||{}),n.mixin(d,this.customLayerParameters||
{}),d)a+=(-1===a.indexOf("?")?"?":"\x26")+c+"\x3d"+encodeURIComponent(d[c]);return a},_flippingAxisForWkids:[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],
[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],
[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],
[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]]});m("extend-esri")&&n.setObject("layers.WMTSLayer",a,c);return a})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(l){l.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(a,n){var g=l.doc,m;n=n||"text/xml";if(a&&l.trim(a)&&"DOMParser"in l.global){m=(new DOMParser).parseFromString(a,n);g=m.documentElement;
if("parsererror"==g.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==g.namespaceURI){var t=g.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0];t&&(t=t.firstChild.data);throw Error("Error parsing text "+g.firstChild.data+" \n"+t);}return m}if("ActiveXObject"in l.global){g=function(a){return"MSXML"+a+".DOMDocument"};g=["Microsoft.XMLDOM",g(6),g(4),g(3),g(2)];l.some(g,function(a){try{m=new ActiveXObject(a)}catch(k){return!1}return!0});if(a&&
m&&(m.async=!1,m.loadXML(a),g=m.parseError,0!==g.errorCode))throw Error("Line: "+g.line+"\nCol: "+g.linepos+"\nReason: "+g.reason+"\nError Code: "+g.errorCode+"\nSource: "+g.srcText);if(m)return m}else if(g.implementation&&g.implementation.createDocument){if(a&&l.trim(a)&&g.createElement){t=g.createElement("xml");t.innerHTML=a;var c=g.implementation.createDocument("foo","",null);l.forEach(t.childNodes,function(a){c.importNode(a,!0)});return c}return g.implementation.createDocument("","",null)}return null};
dojox.xml.parser.textContent=function(a,n){if(1<arguments.length)return dojox.xml.parser.replaceChildren(a,(a.ownerDocument||l.doc).createTextNode(n)),n;if(void 0!==a.textContent)return a.textContent;var g="";a&&l.forEach(a.childNodes,function(a){switch(a.nodeType){case 1:case 5:g+=dojox.xml.parser.textContent(a);break;case 3:case 2:case 4:g+=a.nodeValue}});return g};dojox.xml.parser.replaceChildren=function(a,n){var g=[];l.isIE&&l.forEach(a.childNodes,function(a){g.push(a)});dojox.xml.parser.removeChildren(a);
l.forEach(g,l.destroy);l.isArray(n)?l.forEach(n,function(g){a.appendChild(g)}):a.appendChild(n)};dojox.xml.parser.removeChildren=function(a){for(var l=a.childNodes.length;a.hasChildNodes();)a.removeChild(a.firstChild);return l};dojox.xml.parser.innerXML=function(a){return a.innerXML?a.innerXML:a.xml?a.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(a):null};return dojox.xml.parser})},"esri/layers/WMTSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel"],function(l,a,n,g){l=l(null,{declaredClass:"esri.layers.WMTSLayerInfo",identifier:null,tileMatrixSet:null,format:null,style:null,tileInfo:null,title:null,fullExtent:null,initialExtent:null,description:null,dimension:null,constructor:function(a){a&&(this.title=a.title,this.tileMatrixSet=a.tileMatrixSet,this.format=a.format,this.style=a.style,this.tileInfo=a.tileInfo,this.fullExtent=a.fullExtent,this.initialExtent=a.initialExtent,this.identifier=a.identifier,this.description=
a.description,this.dimension=a.dimension)}});n("extend-esri")&&a.setObject("layers.WMTSLayerInfo",l,g);return l})},"widgets/AddData/search/AddFromFilePane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/Deferred dojo/dom-class dijit/Viewport dojo/sniff dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromFilePane.html dojo/i18n!../nls/strings ./LayerLoader ./util esri/request esri/layers/FeatureLayer esri/geometry/scaleUtils jimu/dijit/Message jimu/dijit/CheckBox".split(" "),
function(l,a,n,g,m,t,c,u,k,w,G,v,C,B,F,A,E,d,e){return l([k,w,G],{i18n:C,templateString:v,wabWidget:null,maxRecordCount:1E3,maxRecordThreshold:1E5,SHAPETYPE_ICONS:[{type:"shapefile",url:"images/filetypes/zip.svg"},{type:"csv",url:"images/filetypes/csv.svg"},{type:"gpx",url:"images/filetypes/gpx.svg"},{type:"geojson",url:"images/filetypes/geojson.svg"}],postCreate:function(){this.inherited(arguments);this.generalizeCheckBox.setLabel(C.addFromFile.generalizeOn);this.own(c.on("resize",this.resize()))},
destroy:function(){this.inherited(arguments)},startup:function(){if(!this._started){this.inherited(arguments);var c=this,d=this.dropArea,k,l=this.wabWidget.config;if(l.addFromFile)try{k=Number(l.addFromFile.maxRecordCount),"number"!==typeof k||isNaN(k)||(k=Math.floor(k),1<=k&&k<=this.maxRecordThreshold&&(this.maxRecordCount=k))}catch(y){console.warn("Error setting AddFromFile.maxRecordCount:"),console.warn(y)}if(C.addFromFile.types)try{for(var m in C.addFromFile.types)this._createFileTypeImage(m)}catch(y){console.warn("Error reading support file types:"),
console.warn(y)}this.own(g(this.fileNode,"change",function(){if(!c._getBusy()){c._setBusy(!0);var a=c._getFileInfo();a.ok&&c._execute(a)}}));this.own(g(this.uploadLabel,"click",function(a){c._getBusy()&&(a.preventDefault(),a.stopPropagation())}));this.own(g(d,"dragenter",function(a){a.preventDefault();c._getBusy()||(t.add(d,"hit"),c._setStatus(""))}));this.own(g(d,"dragleave",function(a){a.preventDefault();t.remove(d,"hit")}));this.own(g(d,"dragover",function(a){a.preventDefault()}));this.own(g(d,
"drop",function(a){a.preventDefault();a.stopPropagation();c._getBusy()||(c._setBusy(!0),a=c._getFileInfo(a),a.ok&&c._execute(a))}));k=this.wabWidget.domNode;this.own(g(k,"dragenter",function(a){a.preventDefault()}));this.own(g(k,"dragleave",function(a){a.preventDefault()}));this.own(g(k,"dragover",function(a){a.preventDefault()}));this.own(g(k,"drop",function(a){a.preventDefault()}));this.own(g(this.hintButton,"click",a.hitch(this,function(a){a.preventDefault();a='\x3cdiv class\x3d"intro"\x3e\x3clabel\x3e'+
C.addFromFile.intro+"\x3c/label\x3e\x3cul\x3e\x3cli\x3e"+C.addFromFile.types.Shapefile+"\x3c/li\x3e\x3cli\x3e"+C.addFromFile.types.CSV+"\x3c/li\x3e\x3cli\x3e"+C.addFromFile.types.GPX+"\x3c/li\x3e\x3cli\x3e"+C.addFromFile.types.GeoJSON+'\x3c/li\x3e\x3cli\x3e\x3cspan class\x3d"note"\x3e'+C.addFromFile.maxFeaturesAllowedPattern.replace("{count}",this.maxRecordCount)+"\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e";new e({message:a})})))}},_addFeatures:function(a,c){var d,e=[],g=a.map,k=0,b=new B;c.layers&&
(k=c.layers.length);n.forEach(c.layers,function(c){c=new E(c,{id:b._generateLayerId(),outFields:["*"]});c.xtnAddData=!0;c.graphics&&(a.numFeatures+=c.graphics.length);0===k?c.name=a.baseFileName:"string"!==typeof c.name||0===c.name.length?c.name=a.baseFileName:0!==c.name.indexOf(a.baseFileName)&&(c.name=C.addFromFile.layerNamePattern.replace("{filename}",a.baseFileName).replace("{name}",c.name));b._setFeatureLayerInfoTemplate(c,null,null);c.fullExtent&&(d=d?d.union(c.fullExtent):c.fullExtent);e.push(c)});
0<e.length&&(g.addLayers(e),d&&g.setExtent(d.expand(1.25),!0))},_analyze:function(a,c){if("csv"!==a.fileType.toLowerCase()){var d=new m;d.resolve(null);return d}var d=a.sharingUrl+"/content/features/analyze",e={f:"json",filetype:a.fileType.toLowerCase()},d=A({url:d,content:e,form:c,handleAs:"json"});d.then(function(c){c&&c.publishParameters&&(a.publishParameters=c.publishParameters)});return d},_createFileTypeImage:function(c){var d=window.isRTL;n.some(this.SHAPETYPE_ICONS,a.hitch(this,function(a,
e){if(c.toLowerCase()===a.type){var g=document.createElement("IMG");g.src=this.wabWidget.folderUrl+a.url;g.alt=c;0===e?g.className+=" "+(d?"last":"first")+"-type-icon":1===e?g.className+=" second-"+(d?"last":"first")+"-type-icon":e===this.SHAPETYPE_ICONS.length-2?g.className+=" second-"+(d?"first":"last")+"-type-icon":e===this.SHAPETYPE_ICONS.length-1&&(g.className+=" "+(d?"first":"last")+"-type-icon");this.supportedFileTypes.appendChild(g)}}))},_execute:function(a){this._setBusy(!0);var c=a.fileName;
this._setStatus(C.addFromFile.addingPattern.replace("{filename}",c));var d=this,g=new FormData;g.append("file",a.file);var k={map:this.wabWidget.map,sharingUrl:this.wabWidget.getSharingUrl(),baseFileName:a.baseFileName,fileName:a.fileName,fileType:a.fileType,generalize:!!this.generalizeCheckBox.getValue(),publishParameters:{},numFeatures:0};d._analyze(k,g).then(function(){return d._generateFeatures(k,g)}).then(function(a){d._addFeatures(k,a.featureCollection);d._setBusy(!1);d._setStatus(C.addFromFile.featureCountPattern.replace("{filename}",
c).replace("{count}",k.numFeatures))}).otherwise(function(a){d._setBusy(!1);d._setStatus(C.addFromFile.addFailedPattern.replace("{filename}",c));console.warn("Error generating features.");console.warn(a);a&&"string"===typeof a.message&&0<a.message.length&&new e({titleLabel:C._widgetLabel,message:a.message})})},_generateFeatures:function(c,e){var g=c.sharingUrl+"/content/features/generate";c.publishParameters=c.publishParameters||{};var k=a.mixin(c.publishParameters,{name:c.baseFileName,targetSR:c.map.spatialReference,
maxRecordCount:this.maxRecordCount,enforceInputFileSizeLimit:!0,enforceOutputJsonSizeLimit:!0});if(c.generalize){var l=d.getExtentForScale(c.map,4E4).getWidth()/c.map.width;k.generalize=!0;k.maxAllowableOffset=l;for(var l=l/10,m=0;1>l;)l*=10,m++;k.reducePrecision=!0;k.numberOfDigitsAfterDecimal=m}k={f:"json",filetype:c.fileType.toLowerCase(),publishParameters:window.JSON.stringify(k)};return A({url:g,content:k,form:e,handleAs:"json"})},_getBaseFileName:function(a){u("ie")&&(a=a.split("\\"),a=a[a.length-
1]);a=a.split(".");return a=a[0].replace("c:\\fakepath\\","")},_getBusy:function(){return t.contains(this.uploadLabel,"disabled")},_getFileInfo:function(a){var c={ok:!1,file:null,fileName:null,fileType:null};if((a=a?a.dataTransfer.files:this.fileNode.files)&&1===a.length)if(c.file=a=a[0],c.fileName=a.name,F.endsWith(a.name,".zip"))c.ok=!0,c.fileType="Shapefile";else if(F.endsWith(a.name,".csv"))c.ok=!0,c.fileType="CSV";else if(F.endsWith(a.name,".gpx"))c.ok=!0,c.fileType="GPX";else if(F.endsWith(a.name,
".geojson")||F.endsWith(a.name,".geo.json"))c.ok=!0,c.fileType="GeoJSON";if(c.ok)c.baseFileName=this._getBaseFileName(c.fileName);else{a=C.addFromFile.invalidType;"string"===typeof c.fileName&&0<c.fileName.length&&(a=C.addFromFile.invalidTypePattern.replace("{filename}",c.fileName));this._setBusy(!1);this._setStatus(a);var d=document.createElement("div");d.appendChild(document.createTextNode(a));new e({titleLabel:C._widgetLabel,message:d})}return c},resize:function(){},_setBusy:function(a){a?(t.add(this.uploadLabel,
"disabled"),t.add(this.dropArea,["hit","disabled"])):(t.remove(this.uploadLabel,"disabled"),t.remove(this.dropArea,["hit","disabled"]))},_setStatus:function(a){this.wabWidget&&this.wabWidget._setStatus(a)}})})},"widgets/AddData/search/LayerListPane":function(){define("dojo/_base/declare dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/LayerListPane.html dojo/i18n!../nls/strings ./util".split(" "),
function(l,a,n,g,m,t,c,u,k,w,G){return l([t,c,u],{i18n:w,templateString:k,wabWidget:null,baseClass:"add-data-widget-layers",postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this._buildList(),this._initListeners(),this.inherited(arguments))},_addLayer:function(a,c){var g=this,k=this._getLayerTitle(c),l=m.create("div",{"class":"add-data-layerlist--listitem"},a);m.create("A",{"class":"remove-button",href:"#",innerHTML:"\x3cspan class\x3d'esri-icon-trash'\x3e\x3c/span\x3e",
title:w.layerList.removeLayer,onclick:function(a){a.preventDefault();try{g.wabWidget&&g.wabWidget.map&&(g.wabWidget.map.removeLayer(c),m.destroy(l))}catch(e){console.warn("Error removing layer."),console.warn(e)}}},l);var n=m.create("label",{"class":"layer-name"},l);G.setNodeText(n,k)},_buildList:function(){var c=this,g=!1,k=[],l=this.wabWidget.map,n=m.create("div",{"class":"add-data-layerlist--list"});a.forEach(l.layerIds,function(a){k.push(a)});a.forEach(l.graphicsLayerIds,function(a){k.push(a)});
k.reverse();a.forEach(k,function(a){(a=l.getLayer(a))&&a.xtnAddData&&(g=!0,c._addLayer(n,a))});return g?n:m.create("div",{"class":"no-data-message",innerHTML:w.layerList.noLayersAdded})},_getLayerTitle:function(a){var c="...";if("string"===typeof a.label&&0<a.label.length)c=a.label;else if("string"===typeof a.title&&0<a.title.length)c=a.title;else if("string"===typeof a.name&&0<a.name.length)c=a.name;else if(a.url){var g=a.url.indexOf("/FeatureServer");-1===g&&(g=a.url.indexOf("/MapServer"));-1===
g&&(g=a.url.indexOf("/ImageServer"));-1===g&&(g=a.url.indexOf("/service"));-1<g&&(a=a.url.substring(0,g),c=a=a.substring(a.lastIndexOf("/")+1,a.length))}return c},_initListeners:function(){var a=this;this.own(n(this._backButton,"click",function(c){c.preventDefault();a.hide()}))},show:function(){var a=this._buildList();this._title.innerHTML=w.layerList.caption;this._layerlist.innerHTML="";a&&a.tagName&&this._layerlist.appendChild(a);this.wabWidget&&this.wabWidget.domNode&&g.add(this.wabWidget.domNode,
"layerlist-show");g.add(this.domNode,"show")},hide:function(){this.wabWidget&&this.wabWidget.domNode&&g.remove(this.wabWidget.domNode,"layerlist-show");g.remove(this.domNode,"show")}})})},"widgets/AddData/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/AddData/search/templates/SearchPane.html":'\x3cdiv class\x3d"search-pane"\x3e\r\n  \x3cdiv class\x3d"search-pane-header" data-dojo-attach-point\x3d"headerNode"\x3e\r\n    \x3cdiv class\x3d"search-bar main-search-bar"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ScopeOptions"\r\n        data-dojo-attach-point\x3d"scopeOptions"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\x3cspan class\x3d"search-box-placeholder" data-dojo-attach-point\x3d"searchBoxPlaceholder"\x3e\x3c/span\x3e--\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SearchBox"\r\n        data-dojo-attach-point\x3d"searchBox"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar-separator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar search-bar-secondary" data-dojo-attach-point\x3d"optionsNode"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/BBoxOption"\r\n        data-dojo-attach-point\x3d"bboxOption"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"filter-wrapper2"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n          data-dojo-attach-point\x3d"typeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n          data-dojo-attach-point\x3d"sortOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n      \x3cspan class\x3d"filter-placeholder" data-dojo-attach-point\x3d"filterPlaceholder"\x3e\x3c/span\x3e\r\n      \x3cdiv class\x3d"filter-wrapper" data-dojo-attach-point\x3d"filterWrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n          data-dojo-attach-point\x3d"typeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n          data-dojo-attach-point\x3d"sortOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane-content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultsPane"\r\n      data-dojo-attach-point\x3d"resultsPane"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane-footer jimu-float-leading" data-dojo-attach-point\x3d"footerNode"\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/Paging"\r\n      data-dojo-attach-point\x3d"paging"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultCount"\r\n      data-dojo-attach-point\x3d"resultCount"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SearchBox.html":'\x3cdiv class\x3d"search-box2"\x3e\r\n\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\tdata-dojo-attach-point\x3d"searchTextBox"\r\n\t\x3e\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\x3c/button\x3e\r\n\x3c!--\r\n\x3cdiv class\x3d"search-box"\x3e\r\n\t\x3cdiv class\x3d"input-group"\x3e\r\n\t\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\t\tdata-dojo-attach-point\x3d"searchTextBox"\x3e\r\n    \x3cspan class\x3d"search-btn"\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-clear hidden" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"clearButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: clearButtonClicked"\x3e\r\n\t\t\t\t\x3cspan class\x3d"esri-icon-close"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n--\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/BBoxOption.html":'\x3cdiv class\x3d"search-bbox-option"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"bboxSection" class\x3d"switch-toggle-group"\x3e\r\n    \x3clabel class\x3d"checkbox-inline"\x3e\r\n      \x3cinput id\x3d"${id}_bboxId"\r\n\t      data-dojo-type\x3d"dijit/form/CheckBox"\r\n\t      data-dojo-attach-point\x3d"bboxToggle"\r\n\t      data-dojo-attach-event\x3d"onClick: bboxClicked"\r\n\t      data-dojo-props\x3d"class: \'switch-toggle\'"\r\n        title\x3d"${i18n.search.bboxOption.bbox}"/\x3e\r\n      \x3cspan class\x3d"label-text"\x3e${i18n.search.bboxOption.bbox}\x3c/span\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/ScopeOptions.html":'\x3cdiv class\x3d"search-scope-options"\x3e\r\n  \x3ca href\x3d"#" class\x3d"scope-placeholder"\r\n    data-dojo-attach-point\x3d"scopePlaceholder"\r\n    data-dojo-attach-event\x3d"onClick: scopePlaceholderClicked"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"scopePlaceholderText"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"dropdown-arrow"\x3e\x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"btn-group" data-dojo-attach-point\x3d"btnGroup"\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyContentToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyContent"\x3e\r\n      ${i18n.search.scopeOptions.myContent}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyOrganizationToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyOrganization"\x3e\r\n      ${i18n.search.scopeOptions.myOrganization}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"CuratedToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"Curated"\x3e\r\n      ${i18n.search.scopeOptions.curated}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"ArcGISOnlineToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"ArcGISOnline"\x3e\r\n      ${i18n.search.scopeOptions.ArcGISOnline}\r\n    \x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/TypeOptions.html":'\x3cdiv class\x3d"search-data-type-options"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n    \x3cspan\x3e${i18n.search.typeOptions.prompt}\x3c/span\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\r\n         data-dojo-attach-point\x3d"tooltipDialog"\r\n         data-dojo-props\x3d"\'class\':\'add-data-widget-popup\'"\x3e\r\n      \x3clabel for\x3d"${id}_mapServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_mapServiceId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"mapServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Map Service\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.mapService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_featureServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_featureServiceId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"featureServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Feature Service\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.featureService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_imageServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_imageServiceId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"imageServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Image Service\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.imageService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_vectorTileServiceId" class\x3d"search-type-option"\r\n        data-dojo-attach-point\x3d"vectorTileNode"\x3e\r\n        \x3cinput id\x3d"${id}_vectorTileServiceId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"vectorTileServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Vector Tile Service\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.vectorTileService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_kmlId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_kmlId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"kmlToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;KML\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.kml}\r\n      \x3c/label\x3e\r\n       \x3clabel for\x3d"${id}_wmsId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_wmsId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"wmsToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;WMS\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.wms}\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SortOptions.html":'\x3cdiv class\x3d"search-sort-options"\x3e\r\n  \x3clabel for\x3d"${id}_select" class\x3d"sort-prompt"\x3e${i18n.search.sortOptions.prompt}\x3c/label\x3e \r\n  \x3cselect id\x3d"${id}_select"\r\n    data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"sortSelect"\x3e\r\n    \x3coption value\x3d"" selected\x3d"selected"\x3e${i18n.search.sortOptions.relevance}\x3c/option\x3e\r\n    \x3coption value\x3d"title"\x3e${i18n.search.sortOptions.title}\x3c/option\x3e\r\n    \x3coption value\x3d"owner"\x3e${i18n.search.sortOptions.owner}\x3c/option\x3e\r\n    \x3coption value\x3d"avgrating"\x3e${i18n.search.sortOptions.rating}\x3c/option\x3e\r\n    \x3coption value\x3d"numviews"\x3e${i18n.search.sortOptions.views}\x3c/option\x3e\r\n    \x3coption value\x3d"modified"\x3e${i18n.search.sortOptions.date}\x3c/option\x3e\r\n  \x3c/select\x3e\r\n  \x3ca href\x3d"#" class\x3d"sort-order-icon"\r\n    title\x3d"${i18n.search.sortOptions.switchOrder}"\r\n    data-dojo-attach-point\x3d"sortOrderBtn"\r\n    data-dojo-attach-event\x3d"onclick: sortOrderClicked"\x3e\r\n  \x3c/a\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/ResultsPane.html":'\x3cdiv class\x3d"search-results-pane" data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"search-results-pane-no-match empty-data-label" data-dojo-attach-point\x3d"noMatchNode" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"itemsNode" class\x3d"search-results"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/ItemCard.html":'\x3cdiv class\x3d"item-card"\x3e\r\n  \x3cdiv class\x3d"item-card-inner"\x3e\r\n    \x3cdiv class\x3d"thumbnail" data-dojo-attach-point\x3d"thumbnailNode"\x3e\x3c/div\x3e\r\n    \x3ch3 class\x3d"title" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/h3\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"typeByOwnerNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"dateNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-bar"\x3e\r\n      \x3cspan class\x3d"message" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"addButton"\r\n        data-dojo-attach-event\x3d"onClick: addClicked"\r\n        \x3e${i18n.search.item.actions.add}\r\n      \x3c/a\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"detailsButton"\r\n        data-dojo-attach-event\x3d"onClick: detailsClicked"\r\n        \x3e${i18n.search.item.actions.details}\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/Paging.html":'\x3cdiv class\x3d"search-paging"\x3e\r\n\t\x3cul class\x3d"pagination pagination-sm"\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"First"\r\n\t\t\t\tdata-dojo-attach-point\x3d"firstButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: firstButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.firstTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-expand"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Previous"\r\n\t\t\t\tdata-dojo-attach-point\x3d"previousButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: previousButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.previousTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-left"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli class\x3d"current-page"\x3e\r\n\t\t  \x3cspan data-dojo-attach-point\x3d"pageNode"\x3e\x3c/span\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Next"\r\n\t\t\t\tdata-dojo-attach-point\x3d"nextButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: nextButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.nextTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-right"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\x3c/ul\x3e\r\n\x3c/div\x3e',
"url:widgets/AddData/search/templates/ResultCount.html":'\x3cdiv class\x3d"search-result-count"\x3e\r\n  \x3cspan class\x3d"search-count" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/AddFromUrlPane.html":'\x3cdiv class\x3d"secondary-pane add-url-pane"\x3e\r\n  \x3cdiv class\x3d"add-url-pane-container"\x3e\r\n    \x3cdiv class\x3d"add-url-pane-container--inner"\x3e\r\n      \x3clabel for\x3d"${id}_select"\x3e${i18n.addFromUrl.type}\x3c/label\x3e\r\n      \x3cselect id\x3d"${id}_select"\r\n        data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"typeSelect"\x3e\r\n        \x3coption value\x3d"ArcGIS" selected\x3d"selected"\x3e${i18n.addFromUrl.types.ArcGIS}\x3c/option\x3e\r\n        \x3coption value\x3d"WMS"\x3e${i18n.addFromUrl.types.WMS}\x3c/option\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WMTS"\x3e${i18n.addFromUrl.types.WMTS}\x3c/option\x3e --\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WFS"\x3e${i18n.addFromUrl.types.WFS}\x3c/option\x3e --\x3e\r\n        \x3coption value\x3d"KML"\x3e${i18n.addFromUrl.types.KML}\x3c/option\x3e\r\n        \x3coption value\x3d"GeoRSS"\x3e${i18n.addFromUrl.types.GeoRSS}\x3c/option\x3e\r\n        \x3coption value\x3d"CSV"\x3e${i18n.addFromUrl.types.CSV}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n      \x3clabel for\x3d"${id}_url"\x3e${i18n.addFromUrl.url}\x3c/label\x3e\r\n      \x3cinput id\x3d"${id}_url" type\x3d"text" class\x3d"url-textbox jimu-input"\r\n          data-dojo-attach-point\x3d"urlTextBox"\x3e\r\n      \x3cdiv class\x3d"action-bar"\x3e\r\n        \x3ca class\x3d"jimu-float-leading" href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"examplesExpander"\r\n          data-dojo-attach-event\x3d"onClick: examplesExpanderClicked"\r\n          \x3e${i18n.addFromUrl.samplesHint}\x3c/a\x3e\r\n        \x3ca class\x3d"jimu-btn"\r\n          href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"addButton"\r\n          data-dojo-attach-event\x3d"onClick: addClicked"\r\n          \x3e${i18n.search.item.actions.add}\r\n        \x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"examples" data-dojo-attach-point\x3d"examplesNode"\x3e\r\n        \x3cdiv data-examples-type\x3d"ArcGIS"\x3e\r\n          \x3cdiv\x3ehttp://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Cities/FeatureServer/0\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://services.arcgisonline.com/ArcGIS/rest/services/Demographics/USA_Tapestry/MapServer\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://imagery.arcgisonline.com/ArcGIS/rest/services/LandsatGLS/VegetationAnalysis/ImageServer\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"WMS"\x3e\r\n          \x3cdiv\x3ehttp://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service\x3dWMS\x26amp;request\x3dGetCapabilities\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"KML"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_month_age_animated.kml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"GeoRSS"\x3e\r\n          \x3cdiv\x3ehttp://www.gdacs.org/xml/rss.xml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"CSV"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.csv\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/AddFromFilePane.html":'\x3cdiv class\x3d"secondary-pane add-file-pane"\x3e\r\n\r\n  \x3cdiv class\x3d"generalize-options"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n      data-dojo-attach-point\x3d"generalizeCheckBox"\r\n      data-dojo-props\x3d"checked:true"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"browse-or-drop"\x3e\r\n    \x3cdiv class\x3d"drop-container" data-dojo-attach-point\x3d"dropContainer"\x3e\r\n      \x3cdiv class\x3d"drop-area" data-dojo-attach-point\x3d"dropArea"\x3e\r\n        \x3cdiv class\x3d"supported-file-types" data-dojo-attach-point\x3d"supportedFileTypes"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"or"\x3e${i18n.addFromFile.dropOrBrowse}\x3c/div\x3e\r\n        \x3cform class\x3d"file-form" enctype\x3d"multipart/form-data" method\x3d"post"\r\n          data-dojo-attach-point\x3d"fileForm"\x3e\r\n          \x3clabel for\x3d"${id}_file" class\x3d"jimu-btn"\r\n            data-dojo-attach-point\x3d"uploadLabel"\x3e${i18n.addFromFile.browse}\x3c/label\x3e\r\n          \x3cinput id\x3d"${id}_file" name\x3d"file" type\x3d"file" style\x3d"display:none"\r\n            data-dojo-attach-point\x3d"fileNode" /\x3e\r\n        \x3c/form\x3e\r\n        \x3ca href\x3d"#" class\x3d"drop-area-hint" data-dojo-attach-point\x3d"hintButton"\x3e\r\n          \x3ci class\x3d"esri-icon-question"\x3e\x3c/i\x3e\r\n        \x3c/a\x3e\r\n        \x3cspan class\x3d"upload-arrow"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/LayerListPane.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--container" data-dojo-attach-point\x3d"_container"\x3e\r\n    \x3ch2 data-dojo-attach-point\x3d"_title"\x3e\x3c/h2\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_layerlist"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--footer jimu-widget-add-data-footer" data-dojo-attach-point\x3d"_footer"\x3e\r\n    \x3ca href\x3d"#" class\x3d"back-button" data-dojo-attach-point\x3d"_backButton"\x3e\r\n      ${i18n.layerList.back}\x3ci class\x3d"esri-icon-collapse"\x3e\x3c/i\x3e\r\n    \x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tabsNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fileNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/AddData/css/style.css":'.jimu-widget-add-data .jimu-tab3 {height: 100%;}.jimu-widget-add-data .search-pane,.jimu-widget-add-data .secondary-pane {height: 100%; width: 100%; background-color: #f8f8f8; position: relative;}.jimu-widget-add-data .search-pane \x3e *,.jimu-widget-add-data .secondary-pane \x3e * {width: 100%;}.jimu-widget-add-data .search-pane-content {position: absolute; top: 140px; bottom: 0; overflow: auto; background-color: #efefef;}.jimu-widget-add-data .search-pane .search-bar {padding: 10px 15px; line-height: 20px;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn {min-width: 40px; padding-top: 10px; padding-bottom: 13px; background-color: transparent; border: 0; border-bottom: 2px solid transparent; margin-left: 5px; margin-right: 5px; color: #898989; font-size: 12px; font-weight: bold; font-family: inherit;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active,.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active,.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {background-color: transparent !important; color: #000 !important; border-bottom-color: #24b5cc; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none;}.jimu-widget-add-data .search-pane .search-bar.main-search-bar {background-color: #fff; padding-bottom: 0; position: relative;}.jimu-widget-add-data .search-pane .search-bar.search-scope-bar .search-sort-options {margin-top: 5px;}.jimu-widget-add-data .search-pane .search-bar-secondary {background-color: #f8f8f8; padding-top: 5px; padding-bottom: 5px; font-size: 11px;}.jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .search-pane .search-pane-header:before,.jimu-widget-add-data .search-pane .search-pane-header:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-pane-header:after {clear: both;}.jimu-widget-add-data .search-pane .search-bar:before,.jimu-widget-add-data .search-pane .search-bar:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-bar:after {clear: both;}.jimu-widget-add-data .search-pane .search-data-type-options {margin-right: 15px;}.jimu-widget-add-data .search-pane .search-curated-option {display: inline-block; margin-left: 30px;}.jimu-widget-add-data .search-pane .search-bar-separator {border-bottom: 1px solid #e7e7e7;}.jimu-widget-add-data .search-pane .search-pane-default .search-bar {text-align: right; margin-bottom: 24px;}.jimu-widget-add-data .search-pane .search-results-pane {padding: 10px 5px;}.jimu-widget-add-data .search-pane .search-results-pane:after {content: ""; display: table; clear: both;}.jimu-widget-add-data .search-pane .item-card {float: left; width: 100%; padding-left: 5px; padding-right: 5px; -webkit-transition: width 0.1s ease; -moz-transition: width 0.1s ease; -o-transition: width 0.1s ease; transition: width 0.1s ease;}.jimu-widget-add-data .search-pane .item-card .item-card-inner {height: 70px; background: #ffffff; border: 1px solid #e0e0e0; border-bottom-color: #cccccc; padding: 5px; margin-bottom: 10px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;}.jimu-widget-add-data .search-pane .item-card .thumbnail {float: left; margin-right: 10px;}.jimu-widget-add-data .search-pane .item-card .thumbnail img {height: 60px; width: 90px;}.jimu-widget-add-data .search-pane .item-card h3.title {margin: 0 5px; padding: 0; font-size: 12px; font-weight: bold; color: #4c4c4c; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .search-pane .item-card div.info {color: #898989; font-size: 10px; overflow: hidden; white-space: nowrap; padding-top: 3px;}.jimu-widget-add-data .search-pane .item-card .action-bar,.jimu-widget-add-data .secondary-pane .action-bar {text-align: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .action-bar,.jimu-rtl .jimu-widget-add-data .secondary-pane .action-bar {text-align: left;}.jimu-widget-add-data .secondary-pane {padding: 20px 15px; overflow: auto;}.jimu-widget-add-data .secondary-pane label {color: #898989; display: block; margin-bottom: 10px;}.jimu-widget-add-data .secondary-pane .dijit {margin-bottom: 10px;}.jimu-widget-add-data .secondary-pane div.action-bar {margin-top: 20px;}.jimu-widget-add-data .secondary-pane .jimu-btn {color: #fff; line-height: 20px; text-decoration: none;}.jimu-widget-add-data .secondary-pane .jimu-btn:active {}.jimu-widget-add-data .search-pane .item-card .action-bar a,.jimu-widget-add-data .add-url-pane .action-bar a,.jimu-widget-add-data .add-file-pane .file-form label {display: inline-block; font-size: 11px; text-transform: uppercase; padding: 5px; margin-right: 5px;}.jimu-widget-add-data .search-pane .item-card .action-bar a.disabled,.jimu-widget-add-data .add-url-pane .action-bar a.disabled,.jimu-widget-add-data .add-file-pane .file-form label.disabled,.jimu-widget-add-data .add-file-pane .drop-area.disabled {opacity: 0.3;}.jimu-widget-add-data .search-pane .item-card .action-bar .message {font-size: 10px; font-style: italic; margin-left: 4px; margin-right: 4px;}.jimu-widget-add-data .add-url-pane .action-bar .jimu-btn,.jimu-widget-add-data .add-file-pane .file-form label {margin-right: 0; min-width: 180px; white-space: normal;}.jimu-widget-add-data .add-url-pane {padding: 0;}.jimu-widget-add-data .add-url-pane-container {background-color: #fff; border-bottom: 1px solid #ccc; padding: 15px 15px 35px;}.jimu-widget-add-data .add-url-pane-container--inner {max-width: 960px; margin: 0 auto;}.jimu-widget-add-data .add-file-pane .intro ul {font-size: 10px; margin: 0; padding: 2px 0 2px 20px;}.jimu-widget-add-data .add-file-pane .intro ul .note {font-style: italic;}.jimu-rtl .jimu-widget-add-data .add-file-pane .intro ul {padding: 2px 20px 2px 0;}.jimu-widget-add-data .add-file-pane .generalize-options .jimu-checkbox .checkbox {margin-top: 0; vertical-align: middle;}.jimu-widget-add-data .add-file-pane .generalize-options .jimu-checkbox .label {font-size: 12px; vertical-align: middle; cursor: pointer;}.jimu-widget-add-data .add-file-pane .browse-or-drop {}.jimu-widget-add-data .add-file-pane .or {display: block; margin: 20px auto; font-size: 11px; color: #898989; width: 90%; max-width: 400px; line-height: 20px; position: relative;}.jimu-widget-add-data .add-file-pane .or:before,.jimu-widget-add-data .add-file-pane .or:after {content: ""; display: block; height: 1px; width: 35%; background: #eee; position: absolute; top: 9px; left: 0;}.jimu-widget-add-data .add-file-pane .or:after {right: 0; left: auto;}.jimu-widget-add-data .add-file-pane .or b {display: inline-block; padding-right: 5px;}.jimu-widget-add-data .add-file-pane .drop-area {width: 100%; background: #fff; margin: 10px auto 0; padding: 25px 50px 35px; border: 1px dashed #ccc; color: #898989; font-size: 12px; text-align: center; line-height: 1.75; text-transform: uppercase; position: relative; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; -webkit-transition: opacity ease-in-out 0.15s; -moz-transition: opacity ease-in-out 0.15s; -o-transition: opacity ease-in-out 0.15s; transition: opacity ease-in-out 0.15s;}.jimu-widget-add-data .add-file-pane .drop-area i {color: #485566; font-style: normal;}.jimu-widget-add-data .add-file-pane .drop-area a.drop-area-hint {position: absolute; top: 0; right: 0; margin: 5px; padding: 10px; font-size: 14px; line-height: 1;}.jimu-widget-add-data .add-file-pane .drop-area.hit {background: #f9f9f9; border-color: #24b5cc;}.jimu-widget-add-data .add-file-pane .drop-area.hit \x3e * {pointer-events: none; display: none;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types {display: block;}.jimu-widget-add-data .add-file-pane .drop-area.hit .upload-arrow {display: block; width: 48px; height: 48px; background: url(images/arrow_up.png) no-repeat; margin: 0 auto; -moz-animation: updload-arrow-animation 1s infinite; -webkit-animation: updload-arrow-animation 1s infinite; animation: updload-arrow-animation 1s infinite;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types {margin: 15px 0 35px; opacity: .5; pointer-events: none; -webkit-transition: opacity ease-in-out 0.15s; -moz-transition: opacity ease-in-out 0.15s; -o-transition: opacity ease-in-out 0.15s; transition: opacity ease-in-out 0.15s;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img {width: 45px; margin-left: -5px; position: relative; -webkit-transition: all ease-in-out 0.2s; -moz-transition: all ease-in-out 0.2s; -o-transition: all ease-in-out 0.2s; transition: all ease-in-out 0.2s;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.first-type-icon {-moz-transform: rotate(-8deg); -moz-transform-origin: right bottom; -webkit-transform: rotate(-8deg); -webkit-transform-origin: right bottom; -o-transform: rotate(-8deg); -o-transform-origin: right bottom; transform: rotate(-8deg); transform-origin: right bottom; bottom: -1px;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.second-first-type-icon {-moz-transform: rotate(-3deg); -moz-transform-origin: right bottom; -webkit-transform: rotate(-3deg); -webkit-transform-origin: right bottom; -o-transform: rotate(-3deg); -o-transform-origin: right bottom; transform: rotate(-3deg); transform-origin: right bottom;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.second-last-type-icon {-moz-transform: rotate(3deg); -moz-transform-origin: left bottom; -webkit-transform: rotate(3deg); -webkit-transform-origin: left bottom; -o-transform: rotate(3deg); -o-transform-origin: left bottom; transform: rotate(3deg); transform-origin: left bottom;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.last-type-icon {-moz-transform: rotate(8deg); -moz-transform-origin: left bottom; -webkit-transform: rotate(8deg); -webkit-transform-origin: left bottom; -o-transform: rotate(8deg); -o-transform-origin: left bottom; transform: rotate(8deg); transform-origin: left bottom; bottom: -1px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types {opacity: 1;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img {margin-left: 0px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.first-type-icon {-moz-transform: rotate(-12deg); -webkit-transform: rotate(-12deg); -o-transform: rotate(-12deg); transform: rotate(-12deg); bottom: -3px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.second-first-type-icon {-moz-transform: rotate(-5deg); -webkit-transform: rotate(-5deg); -o-transform: rotate(-5deg); transform: rotate(-5deg);}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.second-last-type-icon {-moz-transform: rotate(5deg); -webkit-transform: rotate(5deg); -o-transform: rotate(5deg); transform: rotate(5deg);}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.last-type-icon {-moz-transform: rotate(12deg); -webkit-transform: rotate(12deg); -o-transform: rotate(12deg); transform: rotate(12deg); bottom: -3px;}.jimu-widget-add-data .add-file-pane .file-form {display: inline-block;}.jimu-widget-add-data .search-box2 {display: inline-block;}.jimu-widget-add-data .search-box2 {float: right;}.jimu-widget-add-data .search-box2 .search-textbox {vertical-align: middle; height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-box2 .btn {display: inline-block; height: 30px; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data.width-small .search-box2 .search-textbox {width: 150px;}.jimu-widget-add-data.width-small .add-file-pane .or:before,.jimu-widget-add-data.width-small .add-file-pane .or:after {width: 25%;}.jimu-widget-add-data.width-medium .search-box2 .search-textbox {width: 140px;}.jimu-widget-add-data.width-medium .filter-wrapper .sort-prompt,.jimu-widget-add-data.width-small .filter-wrapper .sort-prompt {display: none;}.jimu-widget-add-data.width-medium .search-pane .search-results-pane {padding: 5px 0;}.jimu-widget-add-data.width-medium .search-pane .item-card .item-card-inner {margin-bottom: 5px;}.jimu-widget-add-data.height-small .add-file-pane {padding-top: 15px; padding-bottom: 15px;}.jimu-widget-add-data.height-small .add-file-pane .drop-area {padding-top: 15px; padding-bottom: 25px;}.jimu-widget-add-data.height-small .add-file-pane .drop-area .supported-file-types {margin-bottom: 20px;}.jimu-widget-add-data .search-bbox-option .checkbox-inline,.jimu-widget-add-data .search-bbox-option .checkbox-inline input,.jimu-widget-add-data .search-pane .filter-placeholder {cursor: pointer;}.jimu-widget-add-data.width-small .search-bbox-option {max-width: 120px; font-size: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-add-data.width-small .search-bbox-option .switch-toggle-group {overflow: hidden; text-overflow: ellipsis;}.jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: 38px; margin-right: 25px;}.jimu-widget-add-data .search-pane .search-box .input-group {position: relative; display: table; border-collapse: separate;}.jimu-widget-add-data .search-pane .search-box .input-group \x3e * {display: table-cell; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-box .search-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-pane .search-box .btn {display: inline-block; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data .search-pane .search-box .btn-clear {border-color: transparent; background: transparent; position: absolute; left: -32px;}.jimu-widget-add-data .search-pane .search-box-placeholder,.jimu-widget-add-data .search-pane .filter-placeholder,.jimu-widget-add-data .search-pane .scope-placeholder {display: none;}.jimu-widget-add-data .search-pane .search-sort-options \x3e * {vertical-align: middle;}.jimu-widget-add-data .search-pane .search-sort-options label {font-weight: normal; font-size: 11px; color: #898989;}.jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: right; width: 24px; height: 24px; margin: 3px 0;}.jimu-widget-add-data .search-pane .search-sort-options .dropdown-toggle .sort-order-icon {float: none; padding: 0 5px;}.jimu-widget-add-data .search-pane .sort-order-icon {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px; background-image: url("images/sort-down-arrow.png");}.jimu-widget-add-data .search-pane .sort-order-icon.descending {background-image: url("images/sort-up-arrow.png");}.jimu-widget-add-data .search-pane .scope-options \x3e * {display: inline-block;}.jimu-widget-add-data .search-pane .checkbox-inline,.jimu-widget-add-data .search-pane .radio-inline {position: relative; padding-left: 21px; margin-right: 10px;}.jimu-widget-add-data .search-pane .checkbox-inline .dijitCheckBox,.jimu-widget-add-data .search-pane .radio-inline .dijitCheckBox {}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views {display: block; padding: 5px;}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views [class*\x3d"gd-icon-"] {margin-right: 10px; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-paging .pagination {margin: 0;}.jimu-widget-add-data .search-pane .search-paging,.jimu-widget-add-data .search-pane .search-result-count {display: inline-block; vertical-align: middle; line-height: 1;}.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span,.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:focus,.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:hover {color: inherit; border-color: transparent; background-color: transparent;}.jimu-widget-add-data .search-pane .pagination \x3e li.current-page \x3e span {padding-left: 15px; padding-right: 15px;}.jimu-widget-add-data .search-pane .pagination [class*\x3d" esri-icon-"],.jimu-widget-add-data .search-pane .pagination [class^\x3d"esri-icon-"] {position: relative; top: 1px;}.jimu-widget-add-data .search-pane .search-result-count {margin: 0 10px;}.jimu-widget-add-data.width-768 .item-card {width: 50%;}.jimu-widget-add-data.width-1200 .item-card {width: 33.3333333333%;}.jimu-widget-add-data.width-medium .search-pane .search-bar,.jimu-widget-add-data.width-small .search-pane .search-bar {padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn,.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: 0;}.jimu-rtl .jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn,.jimu-rtl .jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: auto; margin-right: 0;}.jimu-widget-add-data.width-medium .search-box-placeholder,.jimu-widget-add-data.width-small .search-box-placeholder,.jimu-widget-add-data.filter-placeholder-on .filter-placeholder {display: block; height: 30px; width: 30px; background-image: url("images/search.png"); background-position: center center; background-repeat: no-repeat; background-size: 12px;}.jimu-widget-add-data.width-medium .search-box,.jimu-widget-add-data.width-small .search-box {display: none; padding: 10px; position: absolute; top: 0; left: 0; right: 40px; background: #ffffff;}.jimu-widget-add-data.width-small .search-box {padding-top: 8px; padding-bottom: 8px;}.jimu-widget-add-data.width-medium .search-box .input-group,.jimu-widget-add-data.width-small .search-box .input-group {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-textbox,.jimu-widget-add-data.width-small .search-box .search-textbox {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-btn,.jimu-widget-add-data.width-small .search-box .search-btn {width: 1%; position: relative;}.jimu-widget-add-data.width-medium .search-box.show,.jimu-widget-add-data.width-small .search-box.show {display: block;}.jimu-widget-add-data.width-medium .search-box-placeholder,.jimu-widget-add-data.width-small .search-box-placeholder {margin: 0 0 8px;}.jimu-widget-add-data.width-medium .search-box-placeholder.opened,.jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close.png");}.jimu-widget-add-data.width-medium .filter-placeholder,.jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu.png");}.jimu-widget-add-data.width-medium .scope-placeholder,.jimu-widget-add-data.width-small .scope-placeholder {display: block; padding: 5px 10px 15px; color: #196fa6; font-weight: bold;}.jimu-widget-add-data.width-medium .scope-placeholder:focus,.jimu-widget-add-data.width-small .scope-placeholder:focus {text-decoration: none;}.jimu-widget-add-data.width-medium .scope-placeholder \x3e *,.jimu-widget-add-data.width-small .scope-placeholder \x3e * {vertical-align: middle;}.jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow {display: inline-block; background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data.width-medium .btn-group,.jimu-widget-add-data.filter-placeholder-on .filter-wrapper,.jimu-widget-add-data.width-small .btn-group {display: none;}.jimu-widget-add-data.width-medium .filter-wrapper.show,.jimu-widget-add-data.width-medium .btn-group.show,.jimu-widget-add-data.width-small .filter-wrapper.show,.jimu-widget-add-data.width-small .btn-group.show {display: block; position: absolute; right: 0; top: 91px; z-index: 10; padding: 5px 10px; background: #ffffff; border: 1px solid #cccccc; -webkit-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); -moz-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2);}.jimu-rtl .jimu-widget-add-data.width-medium .filter-wrapper.show,.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show,.jimu-rtl .jimu-widget-add-data.width-small .filter-wrapper.show,.jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: 0; right: auto;}.jimu-widget-add-data.width-medium .btn-group.show,.jimu-widget-add-data.width-small .btn-group.show {top: 48px; left: 0; padding: 0; right: auto; min-width: 50%;}.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show,.jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: auto; right: 0;}.jimu-widget-add-data.width-medium .btn-group.show .btn,.jimu-widget-add-data.width-small .btn-group.show .btn {display: block; width: 100%; padding: 10px 15px; border: 0; font-weight: normal;}.jimu-widget-add-data.width-medium .btn-group.show .btn:hover,.jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #f4f4f4;}.jimu-widget-add-data.width-medium .btn-group.show .btn.active,.jimu-widget-add-data.width-medium .btn-group.show .btn.active:hover,.jimu-widget-add-data.width-small .btn-group.show .btn.active,.jimu-widget-add-data.width-small .btn-group.show .btn.active:hover {background-color: #196fa6 !important; color: #fff !important;}.jimu-widget-add-data.width-small .jimu-tab3 .tab-item-td {padding-left: 20px; padding-right: 20px;}.jimu-widget-add-data.width-small .search-pane .search-bar {padding-top: 5px; padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin: 0; padding-left: 5px; padding-right: 5px; font-size: 11px;}.jimu-widget-add-data.width-small .search-pane .search-results-pane {padding: 0; overflow: hidden;}.jimu-widget-add-data.width-small .search-pane .item-card {padding-left: 0; padding-right: 0;}.jimu-widget-add-data.width-small .search-pane .item-card .item-card-inner {margin-bottom: 0; border-top: 0; border-left: 0; border-right: 0; border-bottom-color: #e0e0e0;}.add-data-widget-popup .search-type-option {display: block; margin-bottom: 10px;}.add-data-widget-popup .search-type-option,.add-data-widget-popup .search-type-option input {cursor: pointer;}.jimu-widget-add-data {position: absolute; top: 0; bottom: 0; left: 0; right: 0; padding-top: 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option,.jimu-widget-add-data .search-box {display: inline-block;}.jimu-widget-add-data .search-box,.jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options,.jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper,.jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging,.jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-widget-add-data .search-paging li.disabled a,.jimu-widget-add-data .search-paging li.disabled a:hover,.jimu-widget-add-data .search-paging li.disabled a:active,.jimu-widget-add-data .search-paging li.disabled a:focus {cursor: default; opacity: 0.35;}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .dijitDropDownButton {margin: 0;}.jimu-widget-add-data .dijitSelect,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {background: transparent; border: 0; padding: 7px 5px; color: #196fa6; font-weight: bold; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0;}.jimu-widget-add-data .dijitSelect .dijitButtonContents,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitButtonContents {border-color: transparent;}.jimu-widget-add-data .dijitSelect .dijitInputField,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitInputField {padding: 0 5px;}.jimu-widget-add-data .dijitSelect .dijitArrowButton,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitArrowButton {background: transparent; border: 0;}.jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 0;}.jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data-dialog {background-color: #FFFFFF !important; border-color: #555555 !important; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important; -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important; box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important;}.jimu-widget-add-data-dialog .dijitDialogPaneContent {border-top: 1px solid #cccccc;}.jimu-widget-add-data-dialog .dijitDialogTitleBar {background: none repeat scroll 0 0 rgba(0, 0, 0, 0); background-color: #FFFFFF; -moz-border-radius: 3px 3px 0 0; -webkit-border-radius: 3px 3px 0 0; border-radius: 3px 3px 0 0;}.jimu-widget-add-data-dialog .dijitDialogTitle {background-color: #FFFFFF; color: #000000; font-size: 16px; font-weight: bold;}.jimu-widget-add-data-dialog div.gap {margin-top: 20px;}.jimu-widget-add-data-dialog div.small-gap {margin-top: 4px;}.jimu-widget-add-data-dialog div.action-bar {margin-top: 10px;}.jimu-widget-add-data-dialog .url-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data-dialog .url-textbox-wide {width: 500px;}.jimu-widget-add-data-dialog .examples {font-size: 9px; font-style: italic; margin-top: 4px; margin-left: 4px; opacity: 0.5;}.jimu-widget-add-data .btn-link {color: #196fa6 !important;}.jimu-widget-add-data .switch-toggle-group {padding: 5px;}.jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: 36px; vertical-align: top;}.jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: -36px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox {height: 16px; width: 28px; border: 0 none; background: #e04f1d; position: relative; display: inline-block; cursor: pointer; -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox:before {content: ""; background: #f8f8f8; position: absolute; padding: 0; height: 12px; width: 12px; left: auto; right: 2px; top: 2px; z-index: 1; -webkit-transition: right 0.3s; -moz-transition: right 0.3s; -o-transition: right 0.3s; transition: right 0.3s; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%;}.jimu-widget-add-data .switch-toggle.dijitCheckBox input {width: 100%; height: 100%; position: absolute; left: 0; z-index: 2;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked {background: #50ad4e;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked:before {right: 14px;}.jimu-widget-add-data .panel-default \x3e .panel-heading {background-color: transparent; border-color: #e0e0e0;}.jimu-widget-add-data .panel-title {font-size: 16px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .panel-footer .btn + .btn {margin-left: 10px;}.jimu-widget-add-data .gp-panel {width: 300px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading {background-color: transparent; border-left: 1px solid rgba(0, 0, 0, 0.35); color: #efefef; height: 40px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .panel-title {font-weight: normal; line-height: 1.5;}.jimu-widget-add-data .gp-panel \x3e .panel-heading [class^\x3d"esri-icon-"],.jimu-widget-add-data .gp-panel \x3e .panel-heading [class*\x3d" esri-icon-"] {display: inline-block; margin-right: 10px; position: relative; top: 1px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {width: 20px; padding: 0; color: #efefef; float: right; margin-right: 0; font-size: 16px; line-height: 1.25; line-height: 20px; text-align: center;}.jimu-widget-add-data .gp-panel \x3e .panel-body {background-color: #f8f8f8; border-left: 1px solid #cccccc; position: absolute; top: 40px; bottom: 0; width: 100%; overflow: auto; padding: 0;}.jimu-widget-add-data .gp-panel .panel-section {background-color: #ffffff;}.jimu-widget-add-data .panel-section {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .panel-section .section-header {display: block; font-size: 16px; line-height: 1.25; line-height: 20px; padding: 10px 15px;}.jimu-widget-add-data .panel-section .section-header:after {content: ""; display: block; clear: both;}.jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"],.jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"],.jimu-widget-add-data .panel-section .section-header .btn {margin: 0 5px; float: right;}.jimu-widget-add-data .panel-section .section-header .btn {margin: 0; min-width: 80px;}.jimu-widget-add-data .panel-section .btn.section-header {border: 0; text-align: left; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-transition: all 0.25s ease; -moz-transition: all 0.25s ease; -o-transition: all 0.25s ease; transition: all 0.25s ease;}.jimu-widget-add-data .panel-section .btn.section-header:hover {background-color: #e2f1fb; text-decoration: none;}.jimu-widget-add-data .panel-section .btn.section-header:active,.jimu-widget-add-data .panel-section .btn.section-header:focus {background-color: #aadbfa; text-decoration: none;}.jimu-widget-add-data .panel-section .section-body {padding: 10px 15px;}.jimu-widget-add-data a, .add-url-pane a {display: block; color: #196fa6; text-decoration: none; line-height: 20px; padding: 10px 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option, .search-box {display: inline-block;}.jimu-widget-add-data .search-box,.jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options,.jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper,.jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging,.jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-rtl .jimu-widget-add-data .search-paging li {-moz-transform: rotate(180deg); -webkit-transform: rotate(180deg); -o-transform: rotate(180deg); transform: rotate(180deg);}.jimu-rtl .jimu-widget-add-data .search-paging li.current-page {-moz-transform: rotate(0); -webkit-transform: rotate(0); -o-transform: rotate(0); transform: rotate(0);}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .add-url-pane .url-textbox {width: 100%; font-size: 12px; color: #000000;}.jimu-widget-add-data .add-url-pane .examples {display: none; margin: 15px -15px 0; padding: 15px; font-size: 12px; color: #898989; word-wrap: break-word;}.jimu-widget-add-data .add-url-pane .examples \x3e div \x3e div {margin-bottom: 15px;}.jimu-widget-add-data .add-url-pane .examples.show {display: block;}.jimu-widget-add-data .jimu-tab3 \x3e .jimu-viewstack {position: absolute; top: 39px; left: 0px; right: 0; bottom: 0; padding-bottom: 40px;}.jimu-widget-add-data-footer {height: 40px; overflow: hidden; background-color: #f8f8f8; border-top: 1px solid #ccc; padding: 0 15px; color: #898989; font-size: 11px;}.jimu-widget-add-data-footer [class^\x3d"esri-icon-"],.jimu-widget-add-data-footer [class*\x3d" esri-icon-"] {line-height: 20px;}.jimu-widget-add-data-footer .layerlist-button {text-transform: uppercase;}.jimu-widget-add-data-footer .layerlist-button .esri-icon-layers {margin: 0 5px; vertical-align: middle; display: inline-block;}.jimu-widget-add-data-footer .message {display: block; color: #898989; line-height: 20px; padding: 10px 10px 10px 0; text-overflow: ellipsis; overflow: hidden; word-break: break-all; white-space: nowrap;}.jimu-widget-add-data.layerlist-show {overflow: hidden;}.jimu-widget-add-data.layerlist-show .jimu-tab3 {-webkit-filter: blur(5px); filter: blur(5px);}.jimu-widget-add-data.layerlist-show .add-data-layerlist--container {-moz-animation: slide-from-right .4s; -webkit-animation: slide-from-right .4s; animation: slide-from-right .4s;}.add-data-widget-layers {width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); position: absolute; top: 0; right: 0; z-index: 1;}.add-data-widget-layers {display: none;}.add-data-widget-layers.show {display: block;}.add-data-widget-layers .add-data-layerlist--container {background: #fff; position: absolute; top: 0; right: 0; width: 320px; height: 100%; -webkit-transition: width 0.4s ease; -moz-transition: width 0.4s ease; -o-transition: width 0.4s ease; transition: width 0.4s ease;}.width-small .add-data-widget-layers .add-data-layerlist--container {width: 100%;}.add-data-widget-layers .add-data-layerlist--container h2 {margin: 0; padding: 7px 15px; border-bottom: 1px solid #ccc; color: #898989; font-size: 14px; font-weight: normal; line-height: 2;}.add-data-layerlist--list {width: 100%; padding: 10px 15px; line-height: 20px; position: absolute; top: 45px; bottom: 40px; overflow: auto;}.add-data-layerlist--listitem {margin-bottom: 5px;}.add-data-layerlist--listitem:after {content: ""; display: table; clear: both;}.add-data-layerlist--listitem .remove-button {float: right; padding: 5px 10px;}.add-data-layerlist--listitem .layer-name {display: block; padding-top: 5px;}.add-data-widget-layers .add-data-layerlist--footer {width: 100%; position: absolute; bottom: 0;}.add-data-widget-layers .back-button {float: right; text-transform: uppercase;}.add-data-widget-layers .back-button i {display: inline-block; margin-left: 5px;}.add-data-widget-layers .no-data-message {color: #898989; padding: 25px; text-align: center;}.add-data-widget-popup {padding: 0;}.add-data-widget-popup .dijitTooltipConnector {display: none;}.add-data-widget-popup .dijitTooltipContainer {padding: 10px; border-color: #ccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup.dijitMenuPopup {-webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup .dijitMenu {border-color: #ccc;}.add-data-widget-popup .dijitMenu .dijitMenuItem td {padding: 10px 15px; border: 0;}.add-data-widget-popup .dijitMenu .dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitMenuItemActive td,.add-data-widget-popup .dijitMenu .dijitMenuItemSelected td {background-color: #f4f4f4; background-image: none;}.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemSelected td {background-color: #196fa6; background-image: none; color: #fff; font-weight: normal;}.LaunchpadTheme .jimu-widget-add-data.jimu-widget {position: absolute;}.LaunchpadTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 5px;}.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {color: #196fa6; font-size: inherit; letter-spacing: 0;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect,.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {background-color: transparent; border: 0;}.LaunchpadTheme .jimu-widget-add-data .secondary-pane .jimu-btn {background-color: #3b8fc4; border: 0;}.LaunchpadTheme .jimu-widget-add-data .secondary-pane .jimu-btn:hover {background-color: #2c6b93;}.DartTheme .jimu-widget-add-data .search-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-secondary {background: #3a3a3a;}.DartTheme .jimu-widget-add-data .secondary-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane-content {background-color: #222;}.DartTheme .jimu-tab3 .tab-item-td.jimu-state-active {background: #4C4C4C;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-separator,.DartTheme .jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #262626;}.DartTheme .jimu-widget-add-data .search-box2 .search-textbox {background: #393939; border: 0; -moz-border-radius: 2px; -webkit-border-radius: 2px; border-radius: 2px;}.DartTheme .jimu-widget-add-data.width-small .search-box2 .search-textbox {width: 100px;}.DartTheme .jimu-widget-add-data .search-box2 .btn {background: #393939; border: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card .item-card-inner {background: #4c4c4c; border-color: #787878;}.DartTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.DartTheme .jimu-widget-add-data.width-medium .filter-wrapper.show,.DartTheme .jimu-widget-add-data.width-medium .btn-group.show,.DartTheme .jimu-widget-add-data.width-small .filter-wrapper.show,.DartTheme .jimu-widget-add-data.width-small .btn-group.show {background: #393939; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); -moz-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .jimu-widget-add-data.width-medium .btn-group.show .btn:hover,.DartTheme .jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #222;}.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active,.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active,.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {color: #f8f8f8 !important;}.DartTheme .jimu-widget-add-data .search-pane .search-sort-options label {color: #a7a7a7 !important;}.DartTheme .jimu-widget-add-data .secondary-pane {border-bottom: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card div.info {color: #ddd !important;}.DartTheme .jimu-widget-add-data .search-pane .item-card .action-bar a,.DartTheme .jimu-widget-add-data .add-url-pane .action-bar a,.DartTheme .jimu-widget-add-data .add-file-pane .file-form label {color: #15a4fa !important;}.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {padding: 7px;}.DartTheme .jimu-widget-add-data .dijitSelect {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/search_white.png");}.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder.opened,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close_white.png");}.DartTheme.add-data-widget-popup .dijitTooltipContainer {color: #f8f8f8; background: #4c4c4c; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); -moz-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .add-data-widget-layers .add-data-layerlist--container {background-color: #4c4c4c;}.DartTheme .add-data-widget-layers .add-data-layerlist--container h2 {border-color: #262626;}.DartTheme .jimu-widget-add-data-footer,.DartTheme .add-data-widget-layers .add-data-layerlist--footer {background-color: transparent; border-top-color: #262626;}.DartTheme .jimu-widget-add-data .add-url-pane-container {background-color: transparent; border-color: transparent;}.DartTheme .jimu-widget-add-data .add-url-pane .action-bar a {padding-top: 0; padding-bottom: 0;}.DartTheme .jimu-widget-add-data .add-url-pane .action-bar .jimu-btn {min-width: 140px;}.DartTheme .jimu-widget-add-data .add-file-pane .drop-area {background: transparent; border-color: #ccc;}.DartTheme .jimu-widget-add-data.height-small .add-file-pane .drop-area {padding-left: 15px; padding-right: 15px;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card {float: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .thumbnail {float: right; margin-left: 10px; margin-right: 0;}.jimu-rtl .jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: auto; padding-right: 38px; margin-right: auto; margin-left: 25px;}.jimu-rtl .jimu-widget-add-data .search-box2 {float: left;}.jimu-rtl .jimu-widget-add-data .search-box2 .btn {margin-left: auto; margin-right: -1px;}.jimu-rtl .jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: left;}.jimu-rtl .jimu-widget-add-data .search-box, .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper,.jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: auto; padding-right: 36px;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: auto; margin-right: -36px;}.jimu-rtl .jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {float: left;}.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"],.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"],.jimu-rtl .jimu-widget-add-data .panel-section .section-header .btn {float: left;}.jimu-rtl .jimu-widget-add-data .search-box,.jimu-rtl .jimu-widget-add-data .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper,.jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}.jimu-widget-add-data .add-file-pane .or b {padding-left: 5px; padding-right: 0;}.jimu-rtl .jimu-widget-add-data .add-file-pane .drop-area a.drop-area-hint {left: 0; right: auto;}.jimu-rtl .add-data-widget-layers .add-data-layerlist--container {left: 0; right: auto;}.jimu-rtl .jimu-widget-add-data.layerlist-show .add-data-layerlist--container {-moz-animation: slide-from-left .4s; -webkit-animation: slide-from-left .4s; animation: slide-from-left .4s;}.jimu-rtl .add-data-layerlist--listitem .remove-button {float: left;}.jimu-rtl .add-data-widget-layers .back-button {float: left;}.jimu-rtl .add-data-widget-layers .back-button i {margin-left: 0; margin-right: 5px;}.jimu-rtl .add-data-widget-layers .back-button i.esri-icon-collapse:before {content: "\\e631";}@-moz-keyframes updload-arrow-animation {0% {-moz-transform: translateY(0px);} 50% {-moz-transform: translateY(-10px);} 100% {-moz-transform: translateY(0px);}}@-webkit-keyframes updload-arrow-animation {0% {-webkit-transform: translateY(0px);} 50% {-webkit-transform: translateY(-10px);} 100% {-webkit-transform: translateY(0px);}}@keyframes updload-arrow-animation {0% {transform: translateY(0px);} 50% {transform: translateY(-10px);} 100% {transform: translateY(0px);}}@-moz-keyframes slide-from-right {0% {-moz-transform: translateX(50%); opacity: 0.5;} 100% {-moz-transform: translateX(0%); opacity: 1;}}@-webkit-keyframes slide-from-right {0% {-webkit-transform: translateX(50%); opacity: 0.5;} 100% {-webkit-transform: translateX(0%); opacity: 1;}}@keyframes slide-from-right {0% {transform: translateX(50%); opacity: 0.5;} 100% {transform: translateX(0%); opacity: 1;}}@-moz-keyframes slide-from-left {0% {-moz-transform: translateX(-50%); opacity: 0.5;} 100% {-moz-transform: translateX(0%); opacity: 1;}}@-webkit-keyframes slide-from-left {0% {-webkit-transform: translateX(-50%); opacity: 0.5;} 100% {-webkit-transform: translateX(0%); opacity: 1;}}@keyframes slide-from-left {0% {transform: translateX(-50%); opacity: 0.5;} 100% {transform: translateX(0%); opacity: 1;}}',
"*now":function(l){l(['dojo/i18n!*preload*widgets/AddData/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/aspect dojo/Deferred dojo/dom-class jimu/portalUrlUtils jimu/portalUtils jimu/tokenUtils jimu/BaseWidget jimu/dijit/TabContainer3 dijit/_WidgetsInTemplateMixin ./search/SearchContext ./search/util ./search/SearchPane ./search/AddFromUrlPane ./search/AddFromFilePane ./search/LayerListPane".split(" "),function(l,a,n,g,m,t,c,u,k,w,G,v,C,B,F,A,E,d){return l([w,v],{name:"AddData",baseClass:"jimu-widget-add-data",_isOpen:!1,_searchOnOpen:!1,tabContainer:null,
searchPane:null,addFromUrlPane:null,addFromFilePane:null,postCreate:function(){this.inherited(arguments)},startup:function(){if(!this._started){var a=this,c=arguments;this._getUser().then(function(c){a._checkConfig();a._initTabs();return a._initContext(c)}).then(function(){a.inherited(c);a.tabContainer?a.tabContainer.startup():a.searchPane?a.searchPane.startup():a.addFromUrlPane?a.addFromUrlPane.startup():a.addFromFilePane&&a.addFromFilePane.startup();a._initFooter(a.tabContainer,{searchWidget:a.searchPane,
addFromUrlWidget:a.addFromUrlPane,addFromFileWidget:a.addFromFilePane});a._initListeners();a.resize()}).otherwise(function(d){console.warn("AddData.startup error:",d);a.inherited(c);a.resize()})}},_checkConfig:function(){this.config||(this.config={});var c=function(c,d){var e=c[d];e||(e=c[d]={allow:!0,label:null});"boolean"!==typeof e.allow&&(e.allow=!0);"Curated"!==d||"string"===typeof e.filter&&0!==a.trim(e.filter).length||(e.allow=!1)},d=this.config;d.scopeOptions||(d.scopeOptions={});var g=d.scopeOptions;
c(g,"MyContent");c(g,"MyOrganization");c(g,"Curated");c(g,"ArcGISOnline");c(d,"addFromUrl");c(d,"addFromFile")},getSharingUrl:function(){var a=u.getPortal(this.appConfig.portalUrl);return c.getSharingUrl(a.portalUrl)},_getUser:function(){var a=new m,c=this.appConfig.portalUrl;k.userHaveSignInPortal(c)?u.getPortal(c).getUser().then(function(c){a.resolve(c)}).otherwise(function(c){console.warn("AddData._getUser error:",c);a.resolve(null)}):a.resolve(null);return a},_initContext:function(a){var c=new m,
d=!0,e=B.checkMixedContent("http://www.arcgis.com"),g=this.config.scopeOptions,k=a&&"string"===typeof a.username&&0<a.username.length,l=new C,b=u.getPortal(this.appConfig.portalUrl);l.portal=b;a&&"string"===typeof a.orgId&&0<a.orgId.length&&(l.orgId=a.orgId);k?l.username=a.username:g.MyContent.allow=!1;this.searchPane&&(this.searchPane.searchContext=l,this.searchPane.portal=b);var h=this.nls.search.loadError+e,n=g.ArcGISOnline;l.allowArcGISOnline=n.allow;if(b.isPortal&&l.allowArcGISOnline){var f=
u.getPortal(e);f?f.helperServices||(d=!1,f.loadSelfInfo().then(function(){f.helperServices?l.arcgisOnlinePortal=f:(console.warn(h),l.allowArcGISOnline=!1,n.allow=!1);c.resolve()}).otherwise(function(a){l.allowArcGISOnline=!1;n.allow=!1;console.warn(h);console.warn(a);c.resolve()})):(console.warn(h),l.allowArcGISOnline=!1,n.allow=!1)}else!k&&!b.isPortal&&g.MyOrganization.allow&&g.ArcGISOnline.allow&&(g.MyOrganization.allow=!1);d&&c.resolve();return c},_initFooter:function(c,d){if(c){var e=d.searchWidget,
g=!1;e&&e.footerNode&&e.footerNode.nodeName&&(g=!0);var k=this.footerContainer=document.createElement("DIV");k.className=this.baseClass+"-footer";g&&k.appendChild(e.footerNode);var l=document.createElement("A");l.className="layerlist-button jimu-float-trailing";l.href="#";l.innerHTML="\x3cspan class\x3d'esri-icon-layers'\x3e\x3c/span\x3e"+this.nls.layerList.caption;this.own(n(l,"click",a.hitch(this,function(a){a.preventDefault();this.showLayers()})));k.appendChild(l);var m=this.messageNode=document.createElement("SPAN");
m.className="message";k.appendChild(m);l=c.containerNode||c.domNode||c;l.nodeName&&l.appendChild(k);this.own(n(this.tabContainer,"tabChanged",a.hitch(this,function(a){this._setStatus("");g&&(e.footerNode.style.display=a===this.nls.tabs.search?"":"none");this.nls.tabs.search===a?(g&&(e.footerNode.style.display=""),m.style.display="none"):(g&&(e.footerNode.style.display="none"),m.style.display="")})))}},_initListeners:function(){var a=this;this.map&&this.own(this.map.on("extent-change",function(){try{a.searchPane&&
a.searchPane.bboxOption.bboxToggle.get("checked")&&(a._isOpen?a.searchPane.search():a._searchOnOpen=!0)}catch(q){console.warn(q)}}))},_initTabs:function(){var a=this.config,c=[],d=!!(window.File&&window.FileReader&&window.FormData),k=!1,l=a.scopeOptions,m=function(a){k||l&&l[a]&&l[a].allow&&(k=!0)};m("MyContent");m("MyOrganization");m("Curated");m("ArcGISOnline");k&&(this.searchPane=new F({wabWidget:this},this.searchNode),c.push({title:this.nls.tabs.search,content:this.searchPane.domNode}));a.addFromUrl&&
a.addFromUrl.allow&&(this.addFromUrlPane=new A({wabWidget:this},this.urlNode),c.push({title:this.nls.tabs.url,content:this.addFromUrlPane.domNode}));d&&a.addFromFile&&a.addFromFile.allow&&(this.addFromFilePane=new E({wabWidget:this},this.fileNode),c.push({title:this.nls.tabs.file,content:this.addFromFilePane.domNode}));var n=this;if(0<c.length){this.tabContainer=new G({average:!0,tabs:c},this.tabsNode);try{1===c.length&&this.tabContainer.controlNode&&this.tabContainer.containerNode&&(this.tabContainer.controlNode.style.display=
"none",this.tabContainer.containerNode.style.top="0px")}catch(b){}this.own(g.after(this.tabContainer,"selectTab",function(a){n.searchPane&&a===n.nls.tabs.search&&n.searchPane.resize()},!0))}else 0===c.length&&this.tabsNode.appendChild(document.createTextNode(this.nls.noOptionsConfigured))},_setStatus:function(a){this.messageNode&&(B.setNodeText(this.messageNode,a),this.messageNode.title=a)},onClose:function(){this._isOpen=!1},onOpen:function(){var a=this.searchPane&&this._searchOnOpen;this._isOpen=
!0;this._searchOnOpen=!1;this.resize();a&&this.searchPane.search()},resize:function(){var a=this.domNode.clientWidth,c=this.domNode.clientHeight;1E3<a?(t.remove(this.domNode,"width-768"),t.add(this.domNode,"width-1200")):768<a?(t.remove(this.domNode,"width-1200"),t.add(this.domNode,"width-768")):t.remove(this.domNode,["width-768","width-1200"]);420>a?(t.remove(this.domNode,"width-medium"),t.add(this.domNode,"width-small")):750>a?(t.remove(this.domNode,"width-small"),t.add(this.domNode,"width-medium")):
t.remove(this.domNode,["width-small","width-medium"]);340>a?t.add(this.domNode,"filter-placeholder-on"):t.remove(this.domNode,"filter-placeholder-on");400>c?t.add(this.domNode,"height-small"):t.remove(this.domNode,"height-small");this.searchPane&&this.searchPane.resize()},showLayers:function(){this.layerListPane||(this.layerListPane=new d({wabWidget:this}),this.layerListPane.placeAt(this.domNode));this.layerListPane.show()}})});