// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Bookmark/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils ./ItemNode libs/storejs/store jimu/LayerInfos/LayerInfos".split(" "),function(q,e,d,k,r,n,p){var l={_uID:0,getUID:function(){return l._uID++},findBookMark:function(b,d){var g=-1,a=null;e.some(d,function(f,d){if(parseInt(f._uID,10)===parseInt(b._uID,10))return g=d,a=f,!0},this);return-1!==g?{bookmark:a,idx:g}:null},findBookMarkByUID:function(b,d){var g=-1,a=null;e.some(d,function(f,
d){if(parseInt(f._uID,10)===parseInt(b,10))return g=d,a=f,!0},this);return-1!==g?{bookmark:a,idx:g}:null},findBookMarkByNameAndExtent:function(b,d){var g=-1,a=null;e.some(d,function(f,d){if(f.name===b.name&&f.extent&&b.extent&&f.extent.xmax===b.extent.xmax&&f.extent.xmin===b.extent.xmin&&f.extent.ymax===b.extent.ymax&&f.extent.ymin===b.extent.ymin)return g=d,a=f,!0},this);return-1!==g?{bookmark:a,idx:g}:null},isBookmarksDataEmpty:function(b){return Array.isArray(b)&&0===b.length?!0:!1},empty:function(b,
l){var g=b;e.forEach(b,function(a){a&&a.itemNode&&a.itemNode.destroy()},this);b=[];b=g;l&&d.empty(l)},createBookMarkNode:function(b,d,g,a){g=b.thumbnail||"undefined"!==typeof b.thumbnail&&""!==b.thumbnail?k.processUrlInWidgetConfig(b.thumbnail,g):k.processUrlInWidgetConfig("images/thumbnail_default.png",g);var f=l.getUID();b._uID=f;return new r({dataId:f,img:g,label:b.displayName||b.name,display:a,nls:d})},cloneBookmarksDataWithOutDom:function(b){var d=[];if("undefined"===typeof b)return d;b.forEach(q.hitch(this,
function(b){b.itemNode&&b.itemNode.domNode&&(b=q.clone(b),delete b.itemNode,d.push(b))}));return d},readBookmarksInWebmap:function(b){var d=[];if(!b.itemInfo||!b.itemInfo.itemData||!b.itemInfo.itemData.bookmarks)return d;e.forEach(b.itemInfo.itemData.bookmarks,function(b){b=q.mixin({},b);b.isInWebmap=!0;d.push(b)},this);return d},filterBookmarkFromTarget:function(b,d){for(var g=[],a=0,f=b.length;a<f;a++){var m=b[a];l.findBookmarkByNameOrExtent(m,d)||g.push(m)}return g},findBookmarkByNameOrExtent:function(b,
d){var g=-1,a=null;e.some(d,function(f,d){if((f.displayName||f.name)===(b.displayName||b.name)||f.extent&&b.extent&&f.extent.xmax===b.extent.xmax&&f.extent.xmin===b.extent.xmin&&f.extent.ymax===b.extent.ymax&&f.extent.ymin===b.extent.ymin)return g=d,a=f,!0},this);return-1!==g?{bookmark:a,idx:g}:null},filter:function(b,d){d.forEach(function(d){"undefined"!==typeof b&&""!==b?-1!==(d.displayName||d.name).indexOf(b)?r.show(d):r.hide(d):r.show(d)})},getKeysKey:function(){return this.appConfig.map["3D"]?
this.name+".3D":this.name+".2D"},getAutoRenameBeforeAdd:function(b,d){var g=0,a=new RegExp(/\((\d+)\){1}$/g);e.forEach(d,function(f){f&&"undefined"!==typeof f.name&&-1!==f.name.indexOf(b)&&(f=a.exec(f.displayName),null===f&&0===g?g=1:f&&"undefined"!==typeof f[1]&&f[1]>=g&&(g=parseInt(f[1],10)+1))});return 0===g?b:b+"("+g+")"},processDuplicateName:function(b){for(var d=[],g={},a=b.length-1;0<=a;a--){var f=b[a];if(!f||"undefined"===typeof f.name)return;var m=f.name;m in g?g[m]++:g[m]=0;if(0<g[m]){var e=
m+"("+g[m]+")";e in g?(g[e]++,g[m]++):g[e]=0;f.displayName=0<g[e]?m+"("+g[m]+")":e;f._autoRename=!0}else f.displayName=m;d.push(f)}b=d},toogleCheckboxChecked:function(b){b&&b.setValue&&b.setValue(!b.checked)},setCheckboxWithoutEvent:function(b,d){b&&b.check&&b.uncheck&&(!0===d?b.check(!0):b.uncheck(!0))},layerInfosRestoreState:function(b){p.getInstanceSync().restoreState({layerOptions:b||null})},getlayerInfos:function(){var b={},d=p.getInstanceSync();d&&d.traversal&&d.traversal(q.hitch(this,function(d){b[d.id]=
{visible:d.isVisible()}}));return b},stringifyBookmarks:function(b){var d=[];e.forEach(b,function(b){b=q.mixin({},b);b.itemNode&&delete b.itemNode;d.push(b)},this);return d},parseBookmarks:function(b){return q.clone(b)},getKey:function(b){return"Bookmark.2D."+encodeURIComponent(k.getAppIdFromUrl())+"."+b},isConfigBefore5_3:function(b){return"undefined"===typeof b.syncMode||!0===b.needToUpdateFlag?!0:!1},getUpdateCacheKey:function(b){return"bookmark_cache_updated_"+encodeURIComponent(l.getKey(b))},
setUpdateCacheKey:function(b){n.set(l.getUpdateCacheKey(b),!0)},isCacheKeyUpdatedy:function(b){return n.get(l.getUpdateCacheKey(b))},setDefaultConfigForUpdate:function(b){b.needToUpdateFlag=!0;b.layout={cards:!0,list:!1,defaultMode:"cards"};b.editable=!0;Array.isArray(b.bookmarks2D)&&0<b.bookmarks2D.length?b.syncMode={webmap:!1,custom:!0}:b.syncMode={webmap:!0,custom:!0}},completeUpdateConfig:function(b){b.needToUpdateFlag&&delete b.needToUpdateFlag},updateBookmarks:function(b){for(var d=0;d<b.length;d++)"undefined"===
typeof b[d]&&(b.splice(d,1),d--);var g=/\/widgets\/Bookmark\/images\/thumbnail_default.png$/;e.forEach(b,function(a){"undefined"===typeof a.isSaveExtent&&(a.isSaveExtent=!0);a.thumbnail&&g.test(a.thumbnail)&&delete a.thumbnail},this)},getLayoutRecorderKey:function(){return"bookMarkLayout_"+encodeURIComponent(k.getAppIdFromUrl())},cleanLayoutRecorder:function(b){n.remove(l.getLayoutRecorderKey(b))},setLastLayout:function(b){n.set(l.getLayoutRecorderKey(),b)},getLastLayout:function(){return n.get(l.getLayoutRecorderKey())},
oldBookmarksBackup:'[{"displayName":"Greater Manchester or Greater Lincolnshire HAHAHAHA","name":"Greater Manchester or Greater Lincolnshire HAHAHAHA","extent":{"type":"extent","xmin":8997982.70263581,"ymin":2110475.6293307655,"xmax":14672667.682525788,"ymax":6024051.4775307495,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"Peterborough and Cambridgeshire HEHEHEHEHEH","name":"Peterborough and Cambridgeshire HEHEHEHEHEH","extent":{"type":"extent","xmin":9055621.33977054,"ymin":445965.34674161975,"xmax":14730306.319660518,"ymax":4359541.194941604,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"mentougou biejing china","name":"mentougou biejing china","extent":{"type":"extent","xmin":9502343.119353313,"ymin":3151483.465165457,"xmax":15177028.09924329,"ymax":7065059.313365442,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u51e4\u51f0\u7f6e\u5730\u4e09\u5143\u6865\u5317\u4eac\u4e2d\u56fd\u4e16\u754c\u592a\u9633\u7cfb\u5b87\u5b99","name":"\u51e4\u51f0\u7f6e\u5730\u4e09\u5143\u6865\u5317\u4eac\u4e2d\u56fd\u4e16\u754c\u592a\u9633\u7cfb\u5b87\u5b99","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u77ed\u4e2d\u6587","name":"\u77ed\u4e2d\u6587","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"short","name":"short","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u4e2d\u6587 English","name":"\u4e2d\u6587 English","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"Underneath the icons","name":"Underneath the icons","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u4e2d\u6587\u4e2d\u6587 \u5475\u5475","name":"\u4e2d\u6587\u4e2d\u6587 \u5475\u5475","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"eee RTL","name":"eee RTL","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false}]',
_testUpdateOldConfig:function(){return{bookmarks2D:[{extent:{spatialReference:{wkid:102100},xmax:-1656069.6628128502,xmin:-1.0861390956860503E7,ymax:1.510258315961978E7,ymin:-1119447.7364922247},name:"bm1",isInWebmap:!0,displayName:"bm1"},{extent:{spatialReference:{wkid:102100},xmax:-1656069.6628128502,xmin:-1.0861390956860503E7,ymax:1.510258315961978E7,ymin:-1119447.7364922247},name:"bm1",isInWebmap:!0,displayName:"bm1(1)"},{extent:{spatialReference:{wkid:102100},xmax:-3197863.7584074493,xmin:-1.3112899816301128E7,
ymax:1.1466459916526379E7,ymin:-4859686.568575533},name:"bm2",isInWebmap:!0,displayName:"bm2"},{extent:{spatialReference:{wkid:102100},xmax:-3767577.3201611056,xmin:-1.430429896767071E7,ymax:1.5120033300894285E7,ymin:-4622246.062418217},name:"Untitled",isInWebmap:!0,displayName:"Untitled"},{extent:{spatialReference:{wkid:102100},xmax:-4334684.982862408,xmin:-1.6556089386187213E7,ymax:1.6750523655935397E7,ymin:-5666212.383958025},name:"Untitled",isInWebmap:!0,displayName:"Untitled(1)"}],bookmarks3D:[],
flyTime:3E3}},_testSetOldCache:function(b){var d=[];e.forEach(b,function(b){var a="Bookmark.2D."+b.displayName;d.push(a);b=q.mixin({},b);b.itemNode&&delete b.itemNode;b._uID&&delete b._uID;try{n.set(a,b)}catch(f){alert("store error\x3d\x3d\x3e")}},this);n.set("Bookmark.2D",d)},_testSetOldCacheBookmark:function(){return JSON.parse('[{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-8273877.24778316,"xmin":-14295892.084200885,"ymax":6466269.8495007465,"ymin":2983187.344602761},"name":"bm1","isInWebmap":true,"displayName":"bm1"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-8004818.908219411,"xmin":-11015826.326428276,"ymax":5527011.645932751,"ymin":3785470.393483758},"name":"bm1","isInWebmap":true,"displayName":"bm1(1)"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-12874774.854323175,"xmin":-13627526.708875552,"ymax":4655629.523482032,"ymin":4220244.210369689},"name":"bm2","isInWebmap":true,"displayName":"bm2"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-11618761.605541585,"xmin":-14629769.023750449,"ymax":6691911.956998556,"ymin":4950370.704549563},"name":"bm3","isInWebmap":true,"displayName":"bm3"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-4317189.3003047705,"xmin":-16361218.973140221,"ymax":10449906.504800193,"ymin":3483741.495004222},"name":"bm4","isInWebmap":true,"displayName":"bm4"},{"name":"add-inRT-1","displayName":"add-inRT-1","extent":{"xmin":-14714155.502977258,"ymin":2694561.125798012,"xmax":-7855613.8290067855,"ymax":6754896.068305495,"spatialReference":{"wkid":102100,"latestWkid":3857}}},{"name":"add-inRT-2","displayName":"add-inRT-2","extent":{"xmin":-14714155.502977258,"ymin":2694561.125798012,"xmax":-7855613.8290067855,"ymax":6754896.068305495,"spatialReference":{"wkid":102100,"latestWkid":3857}}}]')}};
return l})},"widgets/Bookmark/ItemNode":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/html jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/on dojo/query jimu/utils dojo/text!./ItemNode.html dojo/mouse dijit/form/ValidationTextBox".split(" "),function(q,e,d,k,r,n,p,l,b,y){var g={},g=e([r,n,q],{templateString:y,isSelected:!1,postMixInProperties:function(){this.nls=d.mixin(this.nls,window.jimuNls.common)},postCreate:function(){k.setAttr(this.domNode,"data-id",b.sanitizeHTML(this.dataId));
this.img&&k.setAttr(this.thumbnail,"src",this.img);this.nls&&(k.setAttr(this.deleteBtn,"title",this.nls.deleteBtnTip),k.setAttr(this.editBtn,"title",this.nls.editBtnTip),k.setAttr(this.changeImgBtn,"title",this.nls.changeThumbnailTip),k.setAttr(this.renameBtn,"title",this.nls.editBtnTip),k.setAttr(this.thumbnail,"title",this.nls.dragReorderTip));this.display&&(!1===this.display.selectedBtn&&k.addClass(this.selectedBtn,"hide"),!1===this.display.editBtn&&k.addClass(this.editBtn,"hide"),!1===this.display.deleteBtn&&
k.addClass(this.deleteBtn,"hide"),!1===this.display.renameBtn&&k.addClass(this.renameBtn,"hide"),!0===this.display.selectedBtn&&k.removeClass(this.selectedBtn,"hide"),!0===this.display.changeImgBtn&&k.removeClass(this.changeImgBtn,"hide"));this.nodeLabel.setValue(b.sanitizeHTML(this.label));this._updateLabelTooltips(this.label);this.own(p(this.selectedBtn,"click",d.hitch(this,this.onSelected)));this.own(p(this.deleteBtn,"click",d.hitch(this,this.onDelete)));this.own(p(this.editBtn,"click",d.hitch(this,
this.onEdit)));this.own(p(this.changeImgBtn,"click",d.hitch(this,this.onChangeImg)));this.own(p(this.renameBtn,"click",d.hitch(this,this.onRenameClick)));this.own(p(this.nodeBox,"click",d.hitch(this,this.onNodeBoxClick)));this.own(p(this.dragMasker,"click",d.hitch(this,this.onNodeBoxClick)));!0===this.display.enableEditLabel?(this.own(p(this.nodeLabel,"click",d.hitch(this,this.onLabelClick))),this.own(p(this.nodeLabel,"change",d.hitch(this,this.onLabelChange))),this.own(p(this.nodeLabel,"blur",d.hitch(this,
this.onLabelBlur)))):this.nodeLabel.setDisabled(!0);this.own(p(this.nodeLabel,"contextmenu",d.hitch(this,function(a){a.preventDefault()})));this.own(p(this.nodeBox,"contextmenu",d.hitch(this,function(a){a.preventDefault()})))},onClick:function(){l(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");l(this.domNode).addClass("jimu-state-selected");this.emit("click")},onNodeBoxClick:function(a){a&&a.stopPropagation&&a.preventDefault&&(a.stopPropagation(),a.preventDefault());
this.emit("thumbnail-click")},onLabelClick:function(a){a&&a.stopPropagation&&a.preventDefault&&(a.stopPropagation(),a.preventDefault());this.emit("label-click")},onLabelChange:function(a){this._updateLabelTooltips(a)},onLabelBlur:function(a){a&&a.stopPropagation&&a.preventDefault&&(a.stopPropagation(),a.preventDefault());a=this.nodeLabel.get("value");this._updateLabelTooltips(a);this.emit("label-blur")},onSelected:function(a){a&&a.stopPropagation&&a.preventDefault&&(a.stopPropagation(),a.preventDefault());
k.hasClass(this.domNode,"selected")?(k.removeClass(this.domNode,"selected"),this.isSelected=!1,!1!==a&&this.emit("unselected")):(k.addClass(this.domNode,"selected"),this.isSelected=!0,!1!==a&&this.emit("selected"))},onDelete:function(a){a&&a.stopPropagation&&a.preventDefault&&(a.stopPropagation(),a.preventDefault());this.emit("delete")},onEdit:function(a){a&&a.stopPropagation&&a.preventDefault&&(a.stopPropagation(),a.preventDefault());this.emit("edit")},onChangeImg:function(a){a&&a.stopPropagation&&
a.preventDefault&&(a.stopPropagation(),a.preventDefault());this.emit("change-img")},changeImg:function(a){k.setAttr(this.thumbnail,"src",a)},onRenameClick:function(a){a&&a.stopPropagation&&a.preventDefault&&(a.stopPropagation(),a.preventDefault());this.emit("rename")},highLight:function(){l(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");l(this.domNode).addClass("jimu-state-selected")},startup:function(){this.inherited(arguments)},destroy:function(){this.inherited(arguments);
k.destroy(this.domNode)},_updateLabelTooltips:function(a){a&&(a=b.sanitizeHTML(a),k.setAttr(this.nodeLabel,"title",a),this.dragMasker&&k.setAttr(this.dragMasker,"title",a))}});g.addFloatLeading=function(a){a.itemNode&&a.itemNode.domNode&&(l(".selected-btn",a.itemNode.domNode).forEach(function(a){k.addClass(a,"jimu-float-leading")}),l(".node-box",a.itemNode.domNode).forEach(function(a){k.addClass(a,"jimu-float-leading")}),l(".node-label",a.itemNode.domNode).forEach(function(a){k.addClass(a,"jimu-float-leading")}),
l(".close-btn",a.itemNode.domNode).forEach(function(a){k.addClass(a,"jimu-float-leading")}))};g.removeFloatLeading=function(a){a.itemNode&&a.itemNode.domNode&&(l(".selected-btn",a.itemNode.domNode).forEach(function(a){k.removeClass(a,"jimu-float-leading")}),l(".node-box",a.itemNode.domNode).forEach(function(a){k.removeClass(a,"jimu-float-leading")}),l(".node-label",a.itemNode.domNode).forEach(function(a){k.removeClass(a,"jimu-float-leading")}),l(".close-btn",a.itemNode.domNode).forEach(function(a){k.removeClass(a,
"jimu-float-leading")}))};g.toggleEditable=function(a){a.itemNode&&a.itemNode.nodeLabel&&(a.itemNode.nodeLabel.disabled?g.enableEditable(a):g.disableEditable(a))};g.disableEditable=function(){};g.enableEditable=function(){};g.focusLabel=function(a){a.itemNode&&a.itemNode.nodeLabel&&a.itemNode.nodeLabel.focus()};g.unSelected=function(a){a.itemNode&&a.itemNode&&(a=a.itemNode,k.removeClass(a.domNode,"selected"),a.isSelected=!1)};g.show=function(a){a&&a.itemNode&&(a=a.itemNode,k.removeClass(a.domNode,
"hide"),a.isShow=!0)};g.hide=function(a){a&&a.itemNode&&(a=a.itemNode,k.addClass(a.domNode,"hide"),a.isShow=!1)};return g})},"widgets/Bookmark/setting/Layout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/on dojo/text!./Layout.html ../utils".split(" "),function(q,e,d,k,r,n,p,l){return q([k,r],{templateString:p,startup:function(){this.own(n(this.layoutCards_checkBox,"change",e.hitch(this,function(){this._fixLayoutModeByCheckBoxChanged("cards");
this._keepLayoutSelected(this.layoutCards_checkBox)})));this.own(n(this.layoutList_checkBox,"change",e.hitch(this,function(){this._fixLayoutModeByCheckBoxChanged("list");this._keepLayoutSelected(this.layoutList_checkBox)})));this.own(n(this.layoutCards,"click",e.hitch(this,function(){l.toogleCheckboxChecked(this.layoutCards_checkBox);this._keepLayoutSelected(this.layoutCards_checkBox)})));this.own(n(this.layoutList,"click",e.hitch(this,function(){l.toogleCheckboxChecked(this.layoutList_checkBox);
this._keepLayoutSelected(this.layoutList_checkBox)})));this.own(n(this.layoutCards,"mouseover",e.hitch(this,function(){this._isCardAndListChecked()&&d.removeClass(this.cardsDefaultSetting,"transparent")})));this.own(n(this.layoutCards,"mouseout",e.hitch(this,function(){"list"===this.config.layout.defaultMode&&d.addClass(this.cardsDefaultSetting,"transparent")})));this.own(n(this.layoutList,"mouseover",e.hitch(this,function(){this._isCardAndListChecked()&&d.removeClass(this.listDefaultSetting,"transparent")})));
this.own(n(this.layoutList,"mouseout",e.hitch(this,function(){"cards"===this.config.layout.defaultMode&&d.addClass(this.listDefaultSetting,"transparent")})));this.own(n(this.cardsDefaultSetting,"click",e.hitch(this,function(b){b&&b.stopPropagation&&b.preventDefault&&(b.stopPropagation(),b.preventDefault());this._whetherToggleDefaultLayout("cards")&&(this.config.layout.defaultMode="cards",this._setDefault("cards"))})));this.own(n(this.listDefaultSetting,"click",e.hitch(this,function(b){b&&b.stopPropagation&&
b.preventDefault&&(b.stopPropagation(),b.preventDefault());this._whetherToggleDefaultLayout("list")&&(this.config.layout.defaultMode="list",this._setDefault("list"))})));this.inherited(arguments)},setConfig:function(b){this.config.layout=b.layout;this.config.layout&&(!0===this.config.layout.cards&&this.layoutCards_checkBox.setValue(!0),!0===this.config.layout.list&&this.layoutList_checkBox.setValue(!0));this._setDefault(this.config.layout.defaultMode)},getConfig:function(){this.config.layout.cards=
!0===this.layoutCards_checkBox.checked?!0:!1;this.config.layout.list=!0===this.layoutList_checkBox.checked?!0:!1;return this.config.layout},_keepLayoutSelected:function(b){!1===this.layoutCards_checkBox.checked&&!1===this.layoutList_checkBox.checked&&l.toogleCheckboxChecked(b)},_setDefault:function(b){var e="",e="cards"===b?"list":"cards";d.removeClass(this[b+"DefaultSetting"],"transparent");var g=this[b+"_makeAsDefault"];g&&d.addClass(g,"hide");(g=this[b+"_default"])&&d.removeClass(g,"hide");d.addClass(this[e+
"DefaultSetting"],"transparent");(g=this[e+"_makeAsDefault"])&&d.removeClass(g,"hide");(g=this[e+"_default"])&&d.addClass(g,"hide");this._isCardAndListChecked()||(d.addClass(this[b+"DefaultSetting"],"transparent"),d.addClass(this[e+"DefaultSetting"],"transparent"))},_whetherToggleDefaultLayout:function(b){var d;d="cards"===b?this.layoutCards_checkBox:this.layoutList_checkBox;return("cards"===b?"list":"cards")===this.config.layout.defaultMode&&!0===d.checked?!0:!1},_fixLayoutModeByCheckBoxChanged:function(b){this._isCardAndListChecked()?
"list"===this.config.layout.defaultMode?d.removeClass(this.listDefaultSetting,"transparent"):d.removeClass(this.cardsDefaultSetting,"transparent"):(d.addClass(this.listDefaultSetting,"transparent"),d.addClass(this.cardsDefaultSetting,"transparent"));"cards"===b?!1===this.layoutCards_checkBox.checked&&!0===this.layoutList_checkBox.checked&&"cards"===this.config.layout.defaultMode&&(this.config.layout.defaultMode="list",this._setDefault("list")):!1===this.layoutList_checkBox.checked&&!0===this.layoutCards_checkBox.checked&&
"list"===this.config.layout.defaultMode&&(this.config.layout.defaultMode="cards",this._setDefault("cards"))},_isCardAndListChecked:function(){return!0===this.layoutCards_checkBox.getValue()&&!0===this.layoutList_checkBox.getValue()?!0:!1}})})},"widgets/Bookmark/setting/Sync":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/keys jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/on dojo/_base/html jimu/dijit/Popup jimu/dijit/Message ./Edit ./Import dojo/text!./Sync.html ../utils jimu/dijit/CheckBox".split(" "),
function(q,e,d,k,r,n,p,l,b,y,g,a,f,m,z){var u=window.Sortable;return q([r,n],{templateString:f,map:null,edit:null,popup:null,popupState:"",editIndex:null,startup:function(){this.webMapBookmarksNodes=u.create(this.webMapBookMarkerContainer,{sort:!1,disabled:!0,animation:100});this.sortableBookMarkerNodes=u.create(this.custombookMarkerContainer,{handle:".drag-masker",sort:!0,disabled:!1,animation:100,onSort:e.hitch(this,function(){this.saveBookMarkersBySortable()})});this.isSyncWebmapCheckBox=new z({label:this.nls.alwaysSync,
checked:!1},this.isSyncWebmapNode);this.isSyncWebmapCheckBox.startup();this.isSyncCustomCheckBox=new z({label:this.nls.configCustom,checked:!1},this.isSyncCustomNode);this.isSyncCustomCheckBox.startup();this.own(p(this.isSyncWebmapCheckBox,"change",e.hitch(this,function(){!0===this.isSyncWebmapCheckBox.getValue()?this.showWebmapBookmarks():this.hideWebmapBookmarks()})));this.own(p(this.isSyncCustomCheckBox,"change",e.hitch(this,function(){!0===this.isSyncCustomCheckBox.getValue()?this.showCustomBookmarks():
this.hideCustomBookmarks()})));this.own(p(this.createNewBtn,"click",e.hitch(this,function(){this.onAddBookmarkClick()})));this.hideWebmapBookmarks();this.hideCustomBookmarks();this.inherited(arguments)},showWebmapBookmarks:function(){l.removeClass(this.webMapBookMarkerContainer,"hide");m.empty(this._bookmarksInWebmap);this._bookmarksInWebmap=m.readBookmarksInWebmap(this.map);this._bookmarksInWebmap=this.displayBookmarks({bookmarks:this._bookmarksInWebmap,syncMode:"webmap",bookmarksContainerNode:this.webMapBookMarkerContainer})},
hideWebmapBookmarks:function(){l.addClass(this.webMapBookMarkerContainer,"hide")},showCustomBookmarks:function(){l.removeClass(this.customBtns,"hide");l.removeClass(this.custombookMarkerContainer,"hide");"undefined"===typeof this._customBookmarks&&(m.empty(this._customBookmarks),this._customBookmarks=this.config.bookmarks2D,this._customBookmarks=this.displayBookmarks({bookmarks:this._customBookmarks,syncMode:"custom",bookmarksContainerNode:this.custombookMarkerContainer}))},hideCustomBookmarks:function(){l.addClass(this.customBtns,
"hide");l.addClass(this.custombookMarkerContainer,"hide")},destroy:function(){this.webMapBookmarksNodes&&this.webMapBookmarksNodes.destroy&&(this.webMapBookmarksNodes.destroy(),this.webMapBookmarksNodes=null);this.sortableBookMarkerNodes&&(this.sortableBookMarkerNodes.destroy(),this.sortableBookMarkerNodes=null);d.forEach(this._bookmarksInWebmap,function(a){a.itemNode&&a.itemNode.destroy()},this);this._bookmarksInWebmap=[];d.forEach(this._customBookmarks,function(a){a.itemNode&&a.itemNode.destroy()},
this);this._customBookmarks=[];this.inherited(arguments)},setConfig:function(a){this.config=a;!0===this.config.syncMode.webmap&&this.isSyncWebmapCheckBox.setValue(!0);!0===this.config.syncMode.custom&&this.isSyncCustomCheckBox.setValue(!0)},getConfig:function(){!0===this.isSyncWebmapCheckBox.getValue()?this.config.syncMode.webmap=!0:this.config.syncMode.webmap=!1;!0===this.isSyncCustomCheckBox.getValue()?this.config.syncMode.custom=!0:this.config.syncMode.custom=!1;var a=[],a=a.concat(this._customBookmarks);
return{syncMode:this.config.syncMode,bookmarks:a}},displayBookmarks:function(a){var b=a.bookmarks,f=a.syncMode,g=a.bookmarksContainerNode||this.custombookMarkerContainer;m.empty(b);var z={},z="webmap"===f?{editBtn:!1,selectedBtn:!1,deleteBtn:!1,renameBtn:!1}:{editBtn:!0,selectedBtn:!1,deleteBtn:!0,renameBtn:!1};d.forEach(b,function(a){if(a){var b=m.createBookMarkNode(a,this.nls,this.folderUrl,z);a.itemNode=b;this.own(p(b,"thumbnail-click",e.hitch(this,e.partial(this._onBookmarkClick,a))));this.own(p(b,
"delete",e.hitch(this,e.partial(this._onBookmarkDeleteImmediately,a))));this.own(p(b,"edit",e.hitch(this,e.partial(this._onBookmarkEdit,a))))}},this);b.forEach(e.hitch(this,function(a){a&&a.itemNode&&a.itemNode.domNode&&l.place(a.itemNode.domNode,g,"last")}));return b},saveBookMarkersBySortable:function(){for(var a=this.sortableBookMarkerNodes.toArray(),b=[],d=0,f=a.length;d<f;d++){var g=m.findBookMarkByUID(a[d],this._customBookmarks);g&&b.push(g.bookmark)}this._customBookmarks=b;this.displayBookmarks({bookmarks:this._customBookmarks,
syncMode:"custom"})},getBookmarkByName:function(a){for(var b=this._customBookmarks.length,d=0;d<b;d++)if(this._customBookmarks[d].displayName===a)return this.editIndex=d,this._customBookmarks[d]},onAddBookmarkClick:function(){this.popupState="ADD";this._openEdit(this.nls.addBookmark,{name:"",thumbnail:"",extent:this.map.extent.toJson()})},_onBookmarkEdit:function(a){this.popupState="EDIT";this._openEdit(this.nls.edit,a)},_onBookmarkDeleteImmediately:function(a){(a=m.findBookMark(a,this._customBookmarks))&&
a.bookmark&&(a.bookmark.itemNode&&a.bookmark.itemNode.destroy(),this._customBookmarks.splice(a.idx,1))},_openEdit:function(a,d){this.edit=new g({nls:this.nls,folderUrl:this.folderUrl,portalUrl:this.appConfig.map.portalUrl,itemId:this.appConfig.map.itemId,mapOptions:this.appConfig.map.mapOptions});this.edit.setConfig(d||{});this.popup=new b({titleLabel:a,autoHeight:!0,content:this.edit,container:"main-page",width:480,buttons:[{label:this.nls.ok,key:k.ENTER,disable:!0,onClick:e.hitch(this,"_onEditOk",
d)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:k.ESCAPE}],onClose:e.hitch(this,"_onEditClose")});l.addClass(this.popup.domNode,"widget-setting-popup");this.edit.startup()},_onEditOk:function(a){var b=this.edit.getConfig(),f=null;if(b.name&&b.extent){"EDIT"===this.popupState&&(a=e.mixin(a,b));a=b.name;var g=m.getAutoRenameBeforeAdd(a,this._customBookmarks);b.name=a;b.displayName=g;"ADD"===this.popupState?(this.addBookmark(b),f=!0):"EDIT"===this.popupState&&(this.saveBookMarkersBySortable(),
f=!0);f?(this.popup.close(),this.popupState="",this.editIndex=null,f=!1):(b=d.mark(f.repeatFields,e.hitch(this,function(a){return a&&a.name})),new y({message:this.nls[f.errorCode]+b.toString()}))}else new y({message:this.nls.warning})},_onEditClose:function(){this.popup=this.edit=null},addBookmark:function(a){var b=m.createBookMarkNode(a,this.nls,this.folderUrl,{editBtn:!0,changeImgBtn:!1});a.itemNode=b;this._customBookmarks.unshift(a);a.itemNode&&a.itemNode.domNode&&l.place(a.itemNode.domNode,this.custombookMarkerContainer,
"last");this.saveBookMarkersBySortable()},onImport:function(){this.importWidget=new a({nls:this.nls,map:this.map,folderUrl:this.folderUrl});this.popup=new b({titleLabel:this.nls.importTitle,autoHeight:!0,content:this.importWidget,container:"main-page",width:640,buttons:[{label:this.nls.ok,key:k.ENTER,disable:!0,onClick:e.hitch(this,"_onImportOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:k.ESCAPE}],onClose:e.hitch(this,"_onImportClose")});l.addClass(this.popup.domNode,"widget-setting-popup");
this.importWidget.startup()},_onImportOk:function(){var a=this.importWidget.getConfig();d.forEach(a,function(a){this.addBookmark(a)},this);this.popup.close()},_onImportClose:function(){this.importWidget.destroy()},_onmarkItemEditClick:function(a){this._onEditClick(a)},_onmarkItemDeleteClick:function(a){this.getBookmarkByName(a);null!==this.editIndex&&this._customBookmarks.splice(this.editIndex,1);this.displayBookmarks({bookmarks:this._customBookmarks,syncMode:"custom"})}})})},"widgets/Bookmark/setting/Edit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting esri/geometry/Extent jimu/dijit/ImageChooser ./ExtentAndLayersChooser ./LayersChooser jimu/utils ../utils dojo/text!./Edit.html jimu/dijit/CheckBox".split(" "),
function(q,e,d,k,r,n,p,l,b,y,g,a,f,m){return q([n,r],{baseClass:"jimu-Bookmark-Edit",ImageChooser:null,templateString:f,extent:{},portalUrl:null,itemId:null,isInWebmap:!1,mapOptions:null,layerOptions:null,postCreate:function(){this.inherited(arguments);this.imageChooser=new l({cropImage:!0,defaultSelfSrc:this.folderUrl+"images/thumbnail_default.png",showSelfImg:!0,format:[l.GIF,l.JPEG,l.PNG],goldenWidth:100,goldenHeight:60});this._initOptins();this.own(k(this.displayName,"change",e.hitch(this,"_onNameChange")));
this.own(k(this.displayName,"keyUp",e.hitch(this,"_onNameChange")));d.addClass(this.imageChooser.domNode,"img-chooser");d.place(this.imageChooser.domNode,this.imageChooserBase,"replace")},startup:function(){this.displayName&&this.displayName.focusNode&&this.displayName.focusNode.focus&&this.displayName.focusNode.focus();this.inherited(arguments)},_initOptins:function(){this.saveExtent=new m({label:this.nls.saveExtent,checked:!0},this.saveExtent);this.saveLayers=new m({label:this.nls.savelayers,checked:!1},
this.saveLayers);this.own(k(this.saveLayers,"change",e.hitch(this,"_changeSetBtnStyle")));this.layersChooser=new y({nls:this.nls,layers:this._getLayers(),enable:this.saveLayers.getValue()});this.layersChooser.placeAt(this.setBtn);this.layersChooser.startup();this.own(k(this.layersChooser,"change",e.hitch(this,"_setLayers")))},_changeSetBtnStyle:function(){this.saveLayers.getValue()?this.layersChooser.enableMeun():this.layersChooser.disableMeun()},setLayersChooserLayers:function(a){this.layerOptions=
a;this.layersChooser.setLayers(this.layerOptions)},_setLayers:function(b){this.layerOptions=b;a.layerInfosRestoreState(b)},_getLayers:function(){return a.getlayerInfos()},setConfig:function(d){var f={portalUrl:this.portalUrl,itemId:this.itemId};d.displayName&&this.displayName.set("value",d.displayName);if(d.thumbnail){var m=g.processUrlInWidgetConfig(d.thumbnail,this.folderUrl);this.imageChooser.setDefaultSelfSrc(m)}d.extent&&(f.initExtent=new p(d.extent));this.mapOptions&&this.mapOptions.lods&&(f.lods=
this.mapOptions.lods);d.isInWebmap&&(this.isInWebmap=!0);this.extentChooser=new b(f,this.extentChooserNode);this.own(k(this.extentChooser,"extentChange",e.hitch(this,this._onExtentChange)));"undefined"===typeof d.isSaveExtent&&(d.isSaveExtent=!0);a.setCheckboxWithoutEvent(this.saveExtent,d.isSaveExtent);"undefined"===typeof d.isSaveLayers&&(d.isSaveLayers=!1);a.setCheckboxWithoutEvent(this.saveLayers,d.isSaveLayers);this._changeSetBtnStyle();d.layerOptions&&this.setLayersChooserLayers(d.layerOptions)},
getConfig:function(){return{displayName:this.displayName.get("value"),name:this.displayName.get("value"),extent:this.extentChooser.getExtent(),thumbnail:this.imageChooser.imageData,isInWebmap:this.isInWebmap,isSaveExtent:this.saveExtent.getValue(),isSaveLayers:this.saveLayers.getValue(),layerOptions:this.layerOptions}},_onNameChange:function(){this._checkRequiredField()},_onExtentChange:function(a){this.currentExtent=a},_checkRequiredField:function(){this.displayName.get("value")?this.popup&&this.popup.enableButton(0):
this.popup&&this.popup.disableButton(0)}})})},"widgets/Bookmark/setting/ExtentAndLayersChooser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Deferred dijit/_WidgetBase dojo/Evented esri/geometry/Extent jimu/portalUrlUtils esri/dijit/Search jimu/dijit/LoadingShelter jimu/utils".split(" "),function(q,e,d,k,r,n,p,l,b,y,g,a){return q([n,p],{baseClass:"bookmark-extent-chooser",declaredClass:"bookmark.ExtentChooser",portalUrl:null,itemId:null,initExtent:null,bingMapsKey:"",
geometryServiceURL:null,shelter:null,postCreate:function(){this.inherited(arguments);!this.geometryServiceURL&&esriConfig.defaults.geometryService&&(this.geometryServiceURL=esriConfig.defaults.geometryService.url);this.geometryServiceURL||(this.geometryServiceURL=a.getServices().geometryService);this.shelter=new g({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();var f=d.create("div",{style:{width:"100%",height:"100%"}},this.domNode);this.search=d.create("div",
{style:{position:"absolute",right:0,top:0}},f);if(this.portalUrl&&this.itemId){this.portalUrl=b.getStandardPortalUrl(this.portalUrl);var m={geometryServiceURL:this.geometryServiceURL,bingMapsKey:this.bingMapsKey};this.initExtent&&("esri.geometry.Extent"!==this.initExtent.declaredClass&&(this.initExtent=new l(this.initExtent)),m.mapOptions={extent:this.initExtent});this.lods&&("object"===typeof m.mapOptions?m.mapOptions.lods=this.lods:m.mapOptions={lods:this.lods});a.createWebMap(this.portalUrl,this.itemId,
f,m).then(e.hitch(this,function(a){this.map=a.map;this.map.webMapResponse=a;this.own(k(this.map,"extent-change",e.hitch(this,function(a){this.onExtentChange(a.extent)})));a=new y({map:this.map,enableLabel:!1,enableHighlight:!1,enableInfoWindow:!1},this.search);a.startup();this.own(k(a,"search-results",e.hitch(this,function(a){if(a&&a.results&&a.results[0]&&a.results[0][0]&&a.results[0][0].extent)this.onExtentChange(a.results[0][0].extent)})));if(this.initExtent)this.onExtentChange(this.initExtent);
else this.onExtentChange(this.map.extent);this.shelter.hide();this.emit("map-load",this.map)}),e.hitch(this,function(a){console.error(a)}))}},getExtent:function(){return this.map&&this.map.extent},setExtent:function(a){if(this.map)return this.map.setExtent(a);var b=new r;setTimeout(e.hitch(this,function(){b.reject("map is null.")}),0);return b},restoreToDefaultWebMapExtent:function(){a.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.geometryServiceURL)},onExtentChange:function(a){this.emit("extent-change",
a)}})})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(q,e,d,k,r,n,p,l,b,y,g,a,f,m,z,u,S,w,T,J,C,K,B,x,D,L,E,U,F,G,V,W,M,X,Y,H,N,P,O,Q,Z,R,aa,ba){function I(c,a){c&&a&&(c._layer=a,c._sourceLayer=a)}e=e([J,C,K,r],{declaredClass:"esri.dijit.Search",templateString:T,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(c,a){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",
searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",
showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new Z("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:w.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:w.widgets.Search.main.placeholder,highlightSymbol:(new V(q.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new Y).setColor(new aa([181,56,46,.9])).setFont(new H("14px",H.STYLE_NORMAL,H.VARIANT_NORMAL,H.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new L(w.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};var t=d.mixin({},this.options,c);this.set(t);this._updateActiveSource();this._i18n=w;this._defaultSR=new U(4326);this.domNode=a},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(d.hitch(this,this._init))},postCreate:function(){var c=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(l(this.submitNode,B,d.hitch(this,this._searchButton)));this.own(l(this.sourcesBtnNode,B,d.hitch(this,this._toggleSourcesMenu)));this.own(l(this.inputNode,B,d.hitch(this,this._inputClick)));this.own(l(this.clearNode,B,d.hitch(this,this._clearButton)));this.own(l(this.formNode,"submit",d.hitch(this,function(c){c.preventDefault();this._cancelSuggest();this.search()})));this.own(l(this.inputNode,"keyup",d.hitch(this,function(c){this._inputKey(c)})));
this.own(l(this.sourcesBtnNode,"keyup",d.hitch(this,function(c){this._sourceBtnKey(c)})));this.own(l(this.suggestionsNode,"li:click, li:keyup",function(a){c._suggestionsEvent(a,this)}));this.own(l(this.sourcesNode,"li:click, li:keyup",function(a){c._sourcesEvent(a,this)}));this.own(l(this.inputNode,"input, paste",d.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(l(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",d.hitch(this,function(c){this._showMoreResultsClick(c)}))),this.own(l(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",d.hitch(this,function(c){this._moreResultsClick(c)}))),this.own(l(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",d.hitch(this,function(c){this._switchCoordinatesClick(c)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();u.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();f.get(this.inputNode,"value")&&f.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);m.remove(this.containerNode,this.css.hasValue);f.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){z.set(this.domNode,"display","block")},hide:function(){z.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(m.add(this.containerNode,this.css.searchExpanded),m.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(m.remove(this.containerNode,this.css.searchExpanded),m.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(c){this.enableButtonMode&&("undefined"===typeof c&&(c=!this.expanded),c?this.expand():this.collapse())},search:function(c){var a=new n;this._mapLoaded().then(d.hitch(this,function(){this._searchDeferred(c).then(d.hitch(this,function(c){var b=c.results;this.set("searchResults",b);0===c.numResults&&(this._noResults(c.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",c);this._selectFirstResult(b,
c.activeSourceIndex);a.resolve(b)}),d.hitch(this,function(c){a.reject(c)}))}));return a.promise},suggest:function(c){var a=new n;this._mapLoaded().then(d.hitch(this,function(){this._suggestDeferred(c).then(d.hitch(this,function(c){if(c){var b=c.results;this.set("suggestResults",b);this._insertSuggestions(b,c.value);this.emit("suggest-results",c);a.resolve(b)}}),d.hitch(this,function(c){a.reject(c)}))}));return a.promise},select:function(c){var a=this._getDefaultSymbol(c),b=this.labelSymbol,h,v=this.sources,
f=this.activeSourceIndex,g=this.enableHighlight,m=this.enableLabel,e=this.autoNavigate,l=this.showInfoWindowOnSelect,k=this.enableInfoWindow,p=this.infoTemplate,u=new F(c.feature.toJson()),z=c.feature._sourceLayer;I(u,z);if(f===this._allIndex){var n=this._getSourceIndexOfResult(c);null!==n&&(h=v[n],f=n)}else h=v[f];h&&(h.hasOwnProperty("highlightSymbol")&&(a=h.highlightSymbol),h.hasOwnProperty("labelSymbol")&&(b=h.labelSymbol),h.hasOwnProperty("enableHighlight")&&(g=h.enableHighlight),h.hasOwnProperty("enableLabel")&&
(m=h.enableLabel),h.hasOwnProperty("autoNavigate")&&(e=h.autoNavigate),h.hasOwnProperty("showInfoWindowOnSelect")&&(l=h.showInfoWindowOnSelect),h.hasOwnProperty("enableInfoWindow")&&(k=h.enableInfoWindow),h.hasOwnProperty("infoTemplate")?p=h.infoTemplate:h.featureLayer&&h.featureLayer.infoTemplate&&(p=h.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(u){var v=this.highlightGraphic,r=this.graphicsLayer,n=this.labelGraphic,w=d.mixin({},u.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(c),
searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(c)}),q=null;k&&(q=p);n?(n.setGeometry(u.geometry),n.setAttributes(w),n.setSymbol(b),b&&"textsymbol"===b.type&&n.symbol.setText(c.name)):(n=new F(u.geometry,b,w),I(n,z),b&&"textsymbol"===b.type&&n.symbol.setText(c.name),m&&(r?r.add(n):this.map&&this.map.graphics&&this.map.graphics.add(n)));v?(v.setGeometry(u.geometry),
v.setAttributes(w),v.setInfoTemplate(q),v.setSymbol(a)):(v=new F(u.geometry,a,w,q),I(v,z),g&&(r?r.add(v):this.map&&this.map.graphics&&this.map.graphics.add(v)));v&&v.symbol&&"textsymbol"===v.symbol.type&&v.symbol.setText(c.name);this.map&&this.map.infoWindow&&k&&l&&(this.map.infoWindow.setFeatures([v]),a=this._getPointFromGeometry(v.geometry),this.map.infoWindow.show(a));this.map&&e&&c&&c.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&this.map.setExtent(c.extent);this.set("highlightGraphic",
v);this.set("labelGraphic",n)}this.set("selectedResult",c);this.emit("select-result",{result:c,source:h,sourceIndex:f})},focus:function(){x.focus(this.inputNode)},blur:function(){this.inputNode.blur();x.curNode&&x.curNode.blur()},clearGraphics:function(){var c=this.highlightGraphic,a=this.graphicsLayer,b=this.labelGraphic;c&&(a?a.remove(c):this.map&&this.map.graphics&&this.map.graphics.remove(c));b&&(a?a.remove(b):this.map&&this.map.graphics&&this.map.graphics.remove(b));this.set("labelGraphic",null);
this.set("highlightGraphic",null)},_mapLoaded:function(){var c=new n;if(this.map)if(this.map.loaded)c.resolve();else l.once(this.map,"load",d.hitch(this,function(){c.resolve()}));else c.resolve();return c.promise},_init:function(){this._getMapLayers().then(d.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();x.focus(this.inputNode)},_error:function(c){return Error(this.declaredClass+" "+c)},_searchDeferred:function(c){var a=new n,b=this.value,h=
this.activeSourceIndex;c&&c.hasOwnProperty("index")&&(h=c.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var v={magicKey:this.magicKey,text:b};c?"string"===typeof c?(v.text=c,c=this._searchQueries(v)):c="object"===typeof c&&c.hasOwnProperty("magicKey")?this._searchQueries(c):"object"===typeof c&&c.hasOwnProperty("geometry")?this._searchQueries({geometry:c}):"object"===typeof c&&c.hasOwnProperty(this._objectIdIdentifier)?this._searchQueries(c):"object"===typeof c&&
"point"===c.type?this._searchQueries({point:c}):c instanceof Array&&2===c.length?this._searchQueries({latlon:c}):this._searchQueries(v):c=this._searchQueries(v);c.always(d.hitch(this,function(c){c=this._formatResults(c,h,b);a.resolve(c)}));return a.promise},_suggestDeferred:function(c){var a=new n;this._deferreds.push(a);c||(c=this.value);var b=this.activeSourceIndex;this._suggestQueries({text:c}).always(d.hitch(this,function(h){var t;if(h)for(var d=0;d<h.length;d++)h[d]&&(t=!0);t?(h=this._formatResults(h,
b,c),a.resolve(h)):a.resolve()}));return a.promise},_getDefaultSymbol:function(c){var a,b,h,d;this.map&&(d=this.map.getBasemap());d||(d="topo");c&&c.feature&&c.feature.geometry&&(h=c.feature.geometry.type);"polyline"===h?h="line":"circle"===h||"extent"===h?h="polygon":"multipoint"===h&&(h="point");if(h){if(c=ba.getSchemes({theme:"default",basemap:d,geometryType:h}))b=c.primaryScheme;if(b){b.color&&b.hasOwnProperty("opacity")&&(b.color.a=b.opacity);a=b;c=b.color;b=b.size;var f;switch(h){case "point":f=
new W;f.setColor(c);f.setSize(null!==b?b:a.size);h=new M;h.setColor(a.outline.color);h.setWidth(a.outline.width);f.setOutline(h);break;case "line":f=new M;f.setColor(c);f.setWidth(null!==b?b:a.width);break;case "polygon":f=new X,f.setColor(c),h=new M,h.setColor(a.outline.color),h.setWidth(a.outline.width),f.setOutline(h)}a=f}}return a},_selectFirstResult:function(c,a){if(this.autoSelect&&c){var b;a===this._allIndex?b=this._getFirstResult(c):c[a]&&c[a][0]&&(b=c[a][0]);b&&this.select(b)}},_getSourceIndexOfResult:function(c){var a=
this.searchResults;if(a)for(var b in a)if(a[b]&&a[b].length)for(var h=0;h<a[b].length;h++)if(a[b][h]===c)return parseInt(b,10);return null},_getFirstResult:function(c){if(c)for(var a in c)if(c[a]&&c[a][0])return c[a][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();this.map&&"function"===typeof this.map.enableKeyboardNavigation&&
this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var c=new n;if(this.addLayersFromMap&&this.map){var a=[],b=this.map.graphicsLayerIds;if(b&&b.length){for(var h=0;h<b.length;h++){var f=this.map.getLayer(b[h]);f&&a.push(this._featureLayerLoaded(f))}G(a).always(d.hitch(this,function(a){for(var b,h=this.sources,d=0;d<a.length;d++)a[d]&&a[d].loaded&&"Feature Layer"===a[d].type&&(h.push({featureLayer:a[d],
enableSuggestions:!0}),b=!0);b&&this.set("sources",h);c.resolve()}))}else c.resolve()}else c.resolve();return c.promise},_switchCoordinatesClick:function(c){c.preventDefault();if(c=f.get(c.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",c),this.search()},_moreResultsClick:function(c){c.preventDefault();var a=c.target;c=parseInt(f.get(a,"data-source-index"),10);var a=parseInt(f.get(a,"data-index"),10),b=this.searchResults;b&&b[c]&&(c=b[c][a])&&this.select(c)},_showMoreResultsClick:function(c){c.preventDefault();
if(c=a.byId(this._moreResultsId)){m.toggle(c,this.css.searchShowMoreResults);var b=a.byId(this._moreResultsId+"_show");b&&(m.contains(c,this.css.searchShowMoreResults)?f.set(b,"textContent",w.widgets.Search.main.hideMoreResults):f.set(b,"textContent",w.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(c){var a=new n;if(c.loaded)a.resolve(c);else if(c.loadError)a.reject(this._error("Layer failed to load."));else{var b,h;b=l.once(c,"load",d.hitch(this,function(){h.remove();a.resolve(c)}));
h=l.once(c,"error",d.hitch(this,function(){b.remove();a.reject(this._error("Layer could not be loaded."))}))}return a.promise},_getObjectSize:function(c){var a=0,b;for(b in c)c.hasOwnProperty(b)&&a++;return a},_sourcesEvent:function(c,a){var d=f.get(a,"data-index"),h=b("li",this.sourcesNode),t=k.indexOf(h,a);d!==this._allIndex&&(d=parseInt(d,10));"click"===c.type||c.keyCode===p.ENTER?(this.set("activeSourceIndex",d),x.focus(this.inputNode),this._hideSourcesMenu()):c.keyCode===p.UP_ARROW?(c.stopPropagation(),
c.preventDefault(),d=t-1,0>d?x.focus(this.sourcesBtnNode):x.focus(h[d])):c.keyCode===p.DOWN_ARROW?(c.stopPropagation(),c.preventDefault(),d=t+1,d>=h.length?x.focus(this.sourcesBtnNode):x.focus(h[d])):c.keyCode===p.ESCAPE&&(this._hideSourcesMenu(),x.focus(this.inputNode))},_suggestionsEvent:function(c,a){var d=f.get(a,"data-source-index"),h=parseInt(f.get(a,"data-index"),10),t=b("li",this.suggestionsNode),g=this.sources,m=k.indexOf(t,a);d!==this._allIndex&&(d=parseInt(d,10));var e;this._clearQueryTimeout();
"click"===c.type||c.keyCode===p.ENTER?((t=this.suggestResults)&&t[d]&&t[d][h]&&(e=t[d][h]),e&&(e.index=d,g[d].featureLayer?(d=g[d].featureLayer.objectIdField,e[this._objectIdIdentifier]=e.feature.attributes[d],this.set("value",this._getSuggestionName(e)),this.set("selectedFeatureId",e.feature.attributes[d])):e.magicKey&&e.text&&(this.set("value",e.text),this.set("magicKey",e.magicKey)),this.search(e),x.focus(this.inputNode))):c.keyCode===p.BACKSPACE||c.keyCode===p.DELETE?x.focus(this.inputNode):c.keyCode===
p.UP_ARROW?(c.stopPropagation(),c.preventDefault(),e=m-1,0>e?x.focus(this.inputNode):x.focus(t[e])):c.keyCode===p.DOWN_ARROW?(c.stopPropagation(),c.preventDefault(),e=m+1,e>=t.length?x.focus(this.inputNode):x.focus(t[e])):c.keyCode===p.ESCAPE&&(this._hideMenus(),x.focus(this.inputNode))},_getResultName:function(c){var a;c.hasOwnProperty("name")&&null!==c.name&&(a=c.name.toString());a||(a=w.widgets.Search.main.untitledResult);return a},_getSuggestionName:function(c){var a;c.hasOwnProperty("name")&&
null!==c.name&&(a=c.name.toString());c=c.text||a;c||(c=w.widgets.Search.main.untitledResult);return c},_searchResultHTML:function(c){var a="";if(c.feature&&c.feature.attributes&&c.feature.attributes.Addr_type&&"LatLong"===c.feature.attributes.Addr_type){var b=c.name.split(" "),d,f;2===b.length&&(d=b[0],f=b[1]);f&&d?(c=parseFloat(d),f=parseFloat(f),b=f+", "+c,a+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',a+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+w.widgets.Search.main.lonlat+
"\x3c/div\x3e",a=a+(c+", "+f)+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),c===f||90<c||-90>c||180<f||-180>f||(a+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+w.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",a=a+('\x3ca data-switch-coordinates\x3d"'+b+'" tabindex\x3d"0" href\x3d"#"\x3e'+b+"\x3c/a\x3e")+"\x3c/div\x3e")):a=c.name}else a=c.name;return a},_moreResultsHTML:function(c){var a="",b="",d=this.searchResults,f=this.sources,g=0;if(d){var b=b+('\x3cdiv class\x3d"'+
this.css.searchMoreResultsItem+'"\x3e'),b=b+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+w.widgets.Search.main.showMoreResults+"\x3c/a\x3e"),b=b+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+'"\x3e'),b=b+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),e;for(e in d)if(d[e]){var m=d[e].length;if(m){var l=1===m&&d[e][0]===c;if(1<this._getObjectSize(d)&&!l)var k=this._getSourceName(e),b=b+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+k+
"\x3c/div\x3e");if(m&&!l){b+="\x3cul\x3e";k=f[e].maxResults||this.maxResults;for(l=0;l<m&&l<k;++l)if(d[e][l]!==c){var p=this._getResultName(d[e][l]),b=b+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+l+'" data-source-index\x3d"'+e+'" href\x3d"#"\x3e'+p+"\x3c/a\x3e\x3c/li\x3e");g++}b+="\x3c/ul\x3e"}}}b+="\x3c/div\x3e\x3c/div\x3e"}g&&(a+=b);return a},_validField:function(c,a){return c.getField(a)},_validFields:function(c,a){if(c&&a&&a.length){for(var b=0;b<a.length;b++)if(!this._validField(c,a[b]))return!1;
return!0}return!1},_getCodedName:function(c,a){if(c&&c.length)for(var b=0,d=c.length;b<d;b++){var f=c[b];if(f.code===a)return f.name}},_getCodedValue:function(c,a,b){if(c&&c.length)for(var d=0,f=c.length;d<f;d++){var t=c[d],g=t.name,e=a;b||(g=g.toLowerCase(),e=e.toLowerCase());if(g===e)return t.code}return!1},_whereClause:function(c,a,b,d){var h=null;if(c){var f="";this.reHostedFS.test(a.url)&&this._containsNonLatinCharacter(c)&&(f="N");if(b&&b.length)for(var t=0,g=b.length;t<g;t++){var e="",m=c.replace(/\'/g,
"''"),e=b[t],A=a.getField(e),l=a.getDomain(e);l&&"codedValue"===l.type&&(m=this._getCodedValue(l.codedValues,m,d));!1!==m&&(A=A.type,"esriFieldTypeString"===A||"esriFieldTypeDate"===A?e=d?e+" \x3d "+f+"'"+m+"'":"UPPER("+e+") LIKE "+f+"'%"+m.toUpperCase()+"%'":"esriFieldTypeOID"===A||"esriFieldTypeSmallInteger"===A||"esriFieldTypeInteger"===A||"esriFieldTypeSingle"===A||"esriFieldTypeDouble"===A?(m=parseFloat(m),e=isNaN(m)?!1:e+" \x3d "+m):e=e+" \x3d "+m,e&&(h=h?h+" or ":"",h+=e))}}return h},_suggest:function(c){c||
(c={index:this.activeSourceIndex,text:this.value});var a=new n,b=c.index,h=this.sources[b],f=this.enableSuggestions;h.hasOwnProperty("enableSuggestions")&&(f=h.enableSuggestions);var e=0,g;c.hasOwnProperty("text")&&c.text&&(g=d.trim(c.text),e=c.text.length);c=h.minCharacters||this.minCharacters;if(f&&g&&e>=c&&this._supportsPagination(h)){var m="";h.prefix&&(m+=h.prefix);m+=g;h.suffix&&(m+=h.suffix);var l=this._defaultSR;this.map&&(l=this.map.spatialReference);f={};h.locator?(h.categories&&(f.categories=
h.categories),h.locator.outSpatialReference=l,this.map&&h.localSearchOptions&&h.localSearchOptions.hasOwnProperty("distance")&&h.localSearchOptions.hasOwnProperty("minScale")&&(e=this._getScale(),!h.localSearchOptions.minScale||e&&e<=parseFloat(h.localSearchOptions.minScale))&&(f.location=this.map.extent.getCenter(),f.distance=h.localSearchOptions.distance),f.text=m,h.useMapExtent&&this.map&&this.map.extent&&(f.searchExtent=this.map.extent),h.searchExtent&&(f.searchExtent=h.searchExtent),f.maxSuggestions=
h.maxSuggestions||this.maxSuggestions,h.sourceCountry&&(f.countryCode=h.sourceCountry),h.countryCode&&(f.countryCode=h.countryCode),h.locator.suggestLocations(f).then(d.hitch(this,function(c){a.resolve(c)}),d.hitch(this,function(c){c||(c=this._error("Locator suggestLocations could not be performed."));a.reject(c)}))):h.featureLayer?this._featureLayerLoaded(h.featureLayer).then(d.hitch(this,function(){var c=this._getDisplayField(h),f=h.searchFields||[c],e=[];h.suggestionTemplate?h.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,
function(c,a){e.push(a)}):e=[c];-1===k.indexOf(e,h.featureLayer.objectIdField)&&e.push(h.featureLayer.objectIdField);var c=this._validField(h.featureLayer,c),g=this._validFields(h.featureLayer,e),t=this._validFields(h.featureLayer,f);if(c&&g&&t){c=new R;h.hasOwnProperty("suggestQueryParams")&&d.mixin(c,h.suggestQueryParams);c.outSpatialReference=l;c.returnGeometry=!1;c.num=h.maxSuggestions||this.maxSuggestions;c.outFields=e;h.useMapExtent&&this.map&&this.map.extent&&(c.geometry=this.map.extent);h.searchExtent&&
(c.geometry=h.searchExtent);var v;if(f=this._whereClause(m,h.featureLayer,f,!1))c.where=f,v=!0;v?h.featureLayer.queryFeatures(c,d.hitch(this,function(c){var d;(c=c.features)&&(d=this._hydrateResults(c,b,!0));a.resolve(d)}),d.hitch(this,function(c){c||(c=this._error("FeatureLayer queryFeatures errored with suggestions"));a.reject(c)})):a.resolve()}else a.reject(this._error("Invalid FeatureLayer field"))})):a.reject(this._error("Invalid source"))}else a.resolve();return a.promise},_supportsPagination:function(c){var a;
c.locator?a=!0:c.featureLayer&&c.featureLayer.advancedQueryCapabilities&&c.featureLayer.advancedQueryCapabilities.supportsPagination&&(a=!0);return a},_suggestQueries:function(c){var a=this.sources,b=this.activeSourceIndex,d=[],f;if(b===this._allIndex)for(b=0;b<a.length;b++)f=c,f.index=b,f=this._suggest(f),d.push(f);else c.index=b,f=this._suggest(c),d.push(f);return G(d)},_getPointFromGeometry:function(c){var a;switch(c.type){case "extent":a=c.getCenter();break;case "multipoint":a=c.getPoint(0);break;
case "point":a=c;break;case "polygon":a=c.getCentroid();break;case "polyline":a=c.getPoint(0,0)}return a},_searchQueries:function(c){c.hasOwnProperty("index")||(c.index=this.activeSourceIndex);var a=[],b;if(c.index===this._allIndex)for(var d=this.sources,f=0;f<d.length;f++)b=c,b.index=f,b=this._search(b),a.push(b);else c=this._search(c),a.push(c);return G(a)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.expand(),x.focus(this.inputNode)):(this._cancelSuggest(),this.search())},
_search:function(c){c||(c={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(c.text=null,c[this._objectIdIdentifier]=this.selectedFeatureId);var a,b=new n,f=c.index,e=this.sources[f],g;c.hasOwnProperty("text")&&c.text&&(g=d.trim(c.text));if(e){var m="";e.prefix&&!c.magicKey&&(m+=e.prefix);m+=g;e.suffix&&!c.magicKey&&(m+=e.suffix);var l=this._defaultSR;this.map&&(l=this.map.spatialReference);if(e.locator)if(c.hasOwnProperty("text")&&
g){var k={};e.categories&&(k.categories=e.categories);l&&(e.locator.outSpatialReference=l);if(this.map&&e.localSearchOptions&&e.localSearchOptions.hasOwnProperty("distance")&&e.localSearchOptions.hasOwnProperty("minScale")){var p=this._getScale();if(!e.localSearchOptions.minScale||p&&p<=parseFloat(e.localSearchOptions.minScale))k.location=this.map.extent.getCenter(),k.distance=e.localSearchOptions.distance}k.address={};k.maxLocations=e.maxResults||this.maxResults;e.useMapExtent&&this.map&&this.map.extent&&
(k.searchExtent=this.map.extent);e.searchExtent&&(k.searchExtent=e.searchExtent);e.sourceCountry&&(k.countryCode=e.sourceCountry);e.countryCode&&(k.countryCode=e.countryCode);c.magicKey&&(k.magicKey=c.magicKey);e.singleLineFieldName?k.address[e.singleLineFieldName]=m:k.address["Single Line Input"]=m;e.outFields&&(k.outFields=e.outFields);e.locator.addressToLocations(k).then(d.hitch(this,function(c){c=this._hydrateResults(c,f,!1);b.resolve(c)}),d.hitch(this,function(c){c||(c=this._error("Locator addressToLocations could not be performed"));
b.reject(c)}))}else c.geometry?(a=this._getPointFromGeometry(c.geometry.geometry))?this._reverseGeocodePoint(f,a).then(function(c){b.resolve(c)},function(c){b.reject(c)}):b.reject(this._error("Invalid point to reverse geocode")):c.point?this._reverseGeocodePoint(f,c.point).then(function(c){b.resolve(c)},function(c){b.reject(c)}):c.latlon?(k=new N(c.latlon,this._defaultSR),this._reverseGeocodePoint(f,k).then(function(c){b.resolve(c)},function(c){b.reject(c)})):c.hasOwnProperty("text")&&!g?b.resolve([]):
b.reject(this._error("Invalid query type for Locator"));else e.featureLayer?this._featureLayerLoaded(e.featureLayer).then(d.hitch(this,function(){var h=this._getDisplayField(e),t=e.searchFields||[h],h=this._validField(e.featureLayer,h),k=this._validFields(e.featureLayer,t);if(h&&k){h=new R;e.hasOwnProperty("searchQueryParams")&&d.mixin(h,e.searchQueryParams);l&&(h.outSpatialReference=l,k=this.map&&this.map.getMaxResolution()||1/Q.getUnitValueForSR(l))&&(h.maxAllowableOffset=k);h.returnGeometry=!0;
e.outFields&&(h.outFields=e.outFields);var A;c.hasOwnProperty(this._objectIdIdentifier)||(this._supportsPagination(e)&&(h.num=e.maxResults||this.maxResults),e.useMapExtent&&this.map&&this.map.extent&&(h.geometry=this.map.extent),e.searchExtent&&(h.geometry=e.searchExtent),A=e.exactMatch);c.hasOwnProperty("text")&&g?(t=this._whereClause(m,e.featureLayer,t,A))?(h.where=t,t=!0):t=!1:c.hasOwnProperty(this._objectIdIdentifier)?(h.objectIds=[c[this._objectIdIdentifier]],t=!0):c.geometry?(h.geometry=c.geometry,
t=!0):c.point?(h.geometry=c.point,t=!0):c.latlon?(a=new N(c.latlon,this._defaultSR),h.geometry=a,t=!0):(c.hasOwnProperty("text")&&!g?b.resolve([]):b.reject(this._error("Invalid query type for FeatureLayer")),t=!1);t?e.featureLayer.queryFeatures(h,d.hitch(this,function(c){c=c.features;var a;c&&(a=this._hydrateResults(c,f,!1));b.resolve(a)}),d.hitch(this,function(c){c||(c=this._error("FeatureLayer queryFeatures could not be performed"));b.reject(c)})):b.resolve()}else b.reject(this._error("Invalid FeatureLayer field"))})):
b.reject(this._error("Invalid source"))}else b.reject(this._error("Source is undefined"));return b.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(c,a,b){b={activeSourceIndex:a,value:b,numResults:0,numErrors:0,errors:null,results:null};var d={},f={};if(c)if(a===this._allIndex)for(a=0;a<c.length;a++)c[a]&&(c[a]instanceof Error?(d[a]=c[a],b.numErrors++):(f[a]=c[a],b.numResults+=c[a].length));else c[0]&&(c[0]instanceof Error?(d[a]=c[0],
b.numErrors++):(f[a]=c[0],b.numResults+=c[0].length));b.numErrors&&(b.errors=d);b.numResults&&(b.results=f);return b},_reverseGeocodePoint:function(c,a){var b=new n,f=this.sources[c];if(a&&f){var e=f.locationToAddressDistance||this.locationToAddressDistance;f.locator.outSpatialReference=this._defaultSR;this.map&&(f.locator.outSpatialReference=this.map.spatialReference);f.locator.locationToAddress(a,e,d.hitch(this,function(a){a=this._hydrateResults([a],c,!1);b.resolve(a)}),d.hitch(this,function(c){c||
(c=this._error("Locator locationToAddress could not be performed"));b.reject(c)}))}else b.reject(this._error("No point or source defined for reverse geocoding"));return b.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var c=0;c<this._deferreds.length;c++)this._deferreds[c].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(c){if(c){var a=b("li",this.sourcesNode);c.keyCode===p.UP_ARROW?(c.stopPropagation(),c.preventDefault(),
this._showSourcesMenu(),(c=a.length)&&x.focus(a[c-1])):c.keyCode===p.DOWN_ARROW&&(c.stopPropagation(),c.preventDefault(),this._showSourcesMenu(),a[0]&&x.focus(a[0]))}},_inputKey:function(c){if(c){var a=b("li",this.suggestionsNode),d=this.suggestResults;if(c.keyCode===p.TAB||c.keyCode===p.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(c.keyCode===p.UP_ARROW)c.stopPropagation(),c.preventDefault(),this._cancelSuggest(),d&&this._showSuggestionsMenu(),(c=a.length)&&x.focus(a[c-1]);else if(c.keyCode===
p.DOWN_ARROW)c.stopPropagation(),c.preventDefault(),this._cancelSuggest(),d&&this._showSuggestionsMenu(),a[0]&&x.focus(a[0]);else{if(c.ctrlKey||c.metaKey||c.keyCode===p.copyKey||c.keyCode===p.LEFT_ARROW||c.keyCode===p.RIGHT_ARROW||c.keyCode===p.ENTER)return c;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(d.hitch(this,function(){this.suggest()}),this.suggestionDelay)},
_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(c){return this._sourceNames[c]},_loadSources:function(c){c=k.filter(c,function(c){return!!c.featureLayer});c=k.map(c,function(c){return this._featureLayerLoaded(c.featureLayer)},this);return G(c)},_createSourceNameMap:function(c){return this._loadSources(c).then(d.hitch(this,
function(){var a=k.map(c,function(c){return c.name||c.featureLayer&&c.featureLayer.name||w.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(c,a);return a}))},_getDuplicateSourceNameIndexes:function(c){var a={},b=[];k.forEach(c,function(d,f){a.hasOwnProperty(d)?(-1===b.indexOf(a[d])&&b.push(a[d]),b.push(f)):c.lastIndexOf(d)!==f&&(a[d]=f)});return b},_preventDuplicateSourceNames:function(c,a){if(a&&1<a.length){var b=this._getDuplicateSourceNameIndexes(a);k.forEach(b,function(b){a[b]+=
this._getFieldsString(c[b])},this)}},_getFieldsString:function(c){var a="",b=c.featureLayer;if(b){c=c.searchFields||[this._getDisplayField(c)];for(var d=0;d<c.length;d++)var a=0===d?a+": ":a+", ",f=c[d],e=b.getFieldLabel(f),a=a+(e||f)}return a},_splitResult:function(a,b){var c=g.escapeString(b);return a.replace(new RegExp("(^|)("+c+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(a,b){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();
var c,d=this.sources;if(a){c=u.create("div");for(var f in a)if(a[f]&&a[f].length){var e=this._getSourceName(f);1<d.length&&this.activeSourceIndex===this._allIndex&&u.create("div",{className:this.css.searchMenuHeader,textContent:e},c);for(var e=u.create("ul",{role:"menu"},c),g=d[f].maxSuggestions||this.maxSuggestions,m=0;m<a[f].length&&m<g;++m)for(var l=u.create("li",{"data-index":m,"data-source-index":f,role:"menuitem",tabindex:0},e),k=this._getSuggestionName(a[f][m]),k=this._splitResult(k,b),t=k.length,
p=0;p<t;p++){var n=k[p];n.toLowerCase()===b.toLowerCase()?u.create("strong",{textContent:n},l):(n=document.createTextNode(n),u.place(n,l))}}}c?(u.place(c,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(u.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var c,b,d=this.activeSourceIndex,f=u.create("ul",{role:"menu"});this.enableSearchingAll&&(c="",d===this._allIndex&&(c="active"),u.create("li",{"data-index":this._allIndex,
role:"menuitem",className:c,tabIndex:0,textContent:w.widgets.Search.main.all},f));for(b=0;b<a.length;b++){c="";b===d&&(c=this.css.activeSource);var e=this._getSourceName(b);u.create("li",{"data-index":b,role:"menuitem",className:c,tabIndex:0,textContent:e},f)}m.add(this.containerNode,this.css.hasMultipleSources);u.place(f,this.sourcesNode,"only")}else m.remove(this.containerNode,this.css.hasMultipleSources),u.empty(this.sourcesNode)},_showLoading:function(){m.add(this.containerNode,this.css.searchLoading)},
_hideLoading:function(){m.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(m.add(this.containerNode,this.css.hasValue),f.set(this.clearNode,"title",w.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(a){var c;a&&(c=d.trim(a));var b=u.create("div",{className:this.css.searchNoResultsBody});a&&c?(u.create("div",{className:this.css.searchNoResultsHeader,
textContent:w.widgets.Search.main.noResults},b),u.create("div",{className:this.css.searchNoResultsText,textContent:D.substitute({value:'"'+a+'"'},w.widgets.Search.main.noResultsFound)},b)):(a=u.create("div",{},b),u.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},a),u.create("span",{className:this.css.searchNoValueText,textContent:w.widgets.Search.main.emptyValue},a));u.place(b,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();
this._hideNoResultsMenu()},_hideNoResultsMenu:function(){m.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();m.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){m.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){m.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();m.add(this.containerNode,
this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();m.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();m.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var c=0;c<a.length;c++){var b=a[c];if("esriFieldTypeString"===b.type)return b.name}return""},_getDisplayField:function(a){return a.displayField||
a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validExtent:function(a){return a&&a.xmin&&"NaN"!==a.xmin&&a.ymin&&"NaN"!==a.ymin&&a.xmax&&"NaN"!==a.xmax&&a.ymax&&"NaN"!==a.ymax?!0:!1},_hydrateResult:function(a,b,d){var c={},f=this._defaultSR,e;b=this.sources[b];this.map&&(f=this.map.spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;if(a.hasOwnProperty("geometry"))e=new F(a.toJson()),c.feature=e,(e=c.feature.geometry)&&e.setSpatialReference(f);
else if(a.hasOwnProperty("location")){var g=new N(a.location.x,a.location.y,f);e={};a.hasOwnProperty("attributes")&&(e=a.attributes);a.hasOwnProperty("score")&&(e.score=a.score);c.feature=new F(g,null,e,null)}else c.feature=null;if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))c.extent=new P(a.extent),c.extent.setSpatialReference(f);else if(c.feature&&c.feature.geometry)switch(c.feature.geometry.type){case "extent":c.extent=c.feature.geometry;break;case "multipoint":c.extent=O.getDenormalizedExtent(c.feature.geometry);
break;case "polygon":c.extent=O.getDenormalizedExtent(c.feature.geometry);break;case "polyline":c.extent=O.getDenormalizedExtent(c.feature.geometry);break;case "point":this.map?(f=this.zoomScale,b&&b.zoomScale&&(f=b.zoomScale),this._getScale()>f?c.extent=Q.getExtentForScale(this.map,f).centerAt(c.feature.geometry):c.extent=this.map.extent.centerAt(c.feature.geometry)):c.extent=new P({xmin:c.feature.geometry.x-.25,ymin:c.feature.geometry.y-.25,xmax:c.feature.geometry.x+.25,ymax:c.feature.geometry.y+
.25,spatialReference:this._defaultSR})}else c.extent=null;c.name="";b.featureLayer?b.suggestionTemplate&&d?c.name=D.substitute(a.attributes,b.suggestionTemplate):b.searchTemplate?c.name=D.substitute(a.attributes,b.searchTemplate):(e=this._getDisplayField(b),d=b.featureLayer.getField(e),f=b.featureLayer.getDomain(e),e&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(e)&&(a=a.attributes[e],f&&"codedValue"===f.type?c.name=this._getCodedName(f.codedValues,a):d&&"esriFieldTypeDate"===d.type&&
!isNaN(a)?c.name=S.format(new Date(a)):c.name=a)):a.address&&b.searchTemplate?c.name=D.substitute(a.address,b.searchTemplate):a.hasOwnProperty("name")?c.name=a.name:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.Match_addr?(c.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City&&(c.name+=" - "+a.attributes.StAddr+", "+a.attributes.City)):a.hasOwnProperty("address")&&"string"===typeof a.address?c.name=
a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?a.address.hasOwnProperty("Match_addr")?c.name=a.address.Match_addr:a.address.hasOwnProperty("Address")&&(c.name=a.address.Address):c.feature&&c.feature.geometry&&(c.name=c.feature.geometry.x+","+c.feature.geometry.y);b.featureLayer&&c.feature&&I(c.feature,b.featureLayer);return c},_getScale:function(){var a;this.map&&"function"===typeof this.map.getScale&&(a=this.map.getScale());return a},_hydrateResults:function(a,
b,d,f){f=[];var c=0;if(a&&a.length)for(c;c<a.length;c++){var e=this._hydrateResult(a[c],b,d);f.push(e)}return f},_containsNonLatinCharacter:function(a){for(var c=0;c<a.length;c++)if(255<a.charCodeAt(c))return!0;return!1},_setPlaceholder:function(a){var c="",b=this.sources[a];a===this._allIndex?c=this.allPlaceholder||w.widgets.Search.main.allPlaceholder:b&&b.placeholder&&(c=b.placeholder);var d=w.widgets.Search.main.all;b&&(d=this._getSourceName(a));f.set(this.sourceNameNode,"textContent",d);f.set(this.inputNode,
"placeholder",c);f.set(this.inputNode,"title",c)},_updateActiveSource:function(){var a=this.sources,b=this.activeSourceIndex,d;a&&a[b]&&(d=a[b]);d?this.set("activeSource",d):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(a){a?(m.toggle(this.containerNode,this.css.searchExpanded,this.expanded),m.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),m.add(this.containerNode,this.css.hasButtonMode)):(m.remove(this.containerNode,
this.css.searchExpanded),m.remove(this.containerNode,this.css.searchCollapsed),m.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(a){a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&
(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(a){this._createSourceNameMap(a).then(d.hitch(this,function(c){this._sourceNames=c;this._created&&(this._setDefaultActiveSourceIndex(a),this._hideMenus(),this._insertSources(a))}));this._set("sources",a)},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",
a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&f.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",a);this._created&&(f.set(this.inputNode,"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",
a);this._created&&this._updateButtonMode(a)},_setThemeAttr:function(a){this._created&&(m.remove(this.domNode,this.theme),m.add(this.domNode,a));this._set("theme",a)}});y("extend-esri")&&d.setObject("dijit.Search",e,E);return e})},"esri/promiseList":function(){define(["dojo/_base/array","dojo/Deferred","dojo/when"],function(q,e,d){var k=q.forEach;return function(r){function n(d,e){b[e]=d;a.progress([d,e]);0===--f&&a.resolve(b)}var p,l;r instanceof Array?l=r:r&&"object"===typeof r&&(p=r);var b,q=[];
if(p){l=[];for(var g in p)Object.hasOwnProperty.call(p,g)&&(q.push(g),l.push(p[g]));b={}}else l&&(b=[]);if(!l||!l.length)return(new e).resolve(b);var a=new e;a.promise.always(function(){b=q=null});var f=l.length;k(l,function(a,b){p||q.push(b);d(a,function(a){n(a,q[b])},function(a){n(a,q[b])})});return a.promise}})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),
function(q,e,d,k,r,n,p,l,b,y,g){q=q(y,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(a){this._geocodeHandler=e.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=e.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=e.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},
outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,b,d,e,l){try{var f=a.candidates,m;b=[];var k,p=f.length,n=a.spatialReference,u;for(k=0;k<p;k++){m=f[k];if(u=m.location)u.spatialReference=n;b[k]=new g(m)}this._successHandler([b],"onAddressToLocationsComplete",d,l)}catch(B){this._errorHandler(B,e,l)}},_geocodeAddressesHandler:function(a,b,d,e,l){try{var f=a.locations;b=[];var m,k=f.length,p=a.spatialReference,n;for(m=0;m<k;m++){if(n=
f[m].location)n.spatialReference=p;b[m]=new g(f[m])}this._successHandler([b],"onAddressesToLocationsComplete",d,l)}catch(K){this._errorHandler(K,e,l)}},addressToLocations:function(a,d,g,p,n){var f,m,q,u,z,y,B;a.address&&(p=g,g=d,d=a.outFields,n=a.searchExtent,B=a.countryCode,f=a.magicKey,m=a.distance,y=a.categories,a.location&&this.normalization&&(q=a.location.normalize()),u=a.maxLocations,z=a.forStorage,a=a.address);n&&(n=n.shiftCentralMeridian());var x=this.outSpatialReference;a=this._encode(e.mixin({},
this._url.query,a,{f:"json",outSR:x&&r.toJson(x.toJson()),outFields:d&&d.join(",")||null,searchExtent:n&&r.toJson(n.toJson()),category:y&&y.join(",")||null,countryCode:B||null,magicKey:f||null,distance:m||null,location:q||null,maxLocations:u||null,forStorage:z||null}));var D=this._geocodeHandler,L=this._errorHandler,E=new k(b._dfdCanceller);E._pendingDfd=l({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(a,b){D(a,b,g,p,E)},error:function(a){L(a,p,E)}});
return E},suggestLocations:function(a){var d;d=new k(b._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(e.mixin({},this._url.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&r.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||null,location:a.location||null,distance:a.distance||
null},{f:"json"}));a=l({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});d._pendingDfd=a;a.then(e.hitch(this,function(a){a=a.suggestions||[];this.onSuggestLocationsComplete(a);d.resolve(a)}),e.hitch(this,function(a){this._errorHandler(a);d.reject(a)}));return d},addressesToLocations:function(a,f,g){var m=this.outSpatialReference,n=[],p=a.categories,q=a.countryCode;d.forEach(a.addresses,function(a,b){n.push({attributes:a})});a=this._encode(e.mixin({},this._url.query,{category:p&&
p.join(",")||null,sourceCountry:q||null},{addresses:r.toJson({records:n})},{f:"json",outSR:m&&r.toJson(m.toJson())}));var y=this._geocodeAddressesHandler,J=this._errorHandler,C=new k(b._dfdCanceller);C._pendingDfd=l({url:this._url.path+"/geocodeAddresses",content:a,callbackParamName:"callback",load:function(a,b){y(a,b,f,g,C)},error:function(a){J(a,g,C)}});return C},_reverseGeocodeHandler:function(a,b,d,e,l){try{var f=new g({address:a.address,location:a.location,score:100});this._successHandler([f],
"onLocationToAddressComplete",d,l)}catch(w){this._errorHandler(w,e,l)}},locationToAddress:function(a,d,g,n){a&&this.normalization&&(a=a.normalize());var f=this.outSpatialReference;a=this._encode(e.mixin({},this._url.query,{outSR:f&&r.toJson(f.toJson()),location:a&&r.toJson(a.toJson()),distance:d,f:"json"}));var m=this._reverseGeocodeHandler,p=this._errorHandler,q=new k(b._dfdCanceller);q._pendingDfd=l({url:this._url.path+"/reverseGeocode",content:a,callbackParamName:"callback",load:function(a,b){m(a,
b,g,n,q)},error:function(a){p(a,n,q)}});return q},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});n("extend-esri")&&e.setObject("tasks.Locator",q,p);return q})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(q,e,d,k,r){q=q(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(d){e.mixin(this,
d);this.location=new r(this.location)}});d("extend-esri")&&e.setObject("tasks.AddressCandidate",q,k);return q})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has","../kernel","../Color"],function(q,e,d,k,r){function n(b,a){var d;if(b)switch(d={},d.color=new r(b.color),d.opacity=b.opacity||1,a){case "point":d.outline={color:new r(b.outline.color),width:b.outline.width};d.size=b.size;break;case "line":d.width=b.width;break;case "polygon":d.outline={color:new r(b.outline.color),
width:b.outline.width}}return d}function p(b){"esriGeometryPoint"===b||"esriGeometryMultipoint"===b?b="point":"esriGeometryPolyline"===b?b="line":"esriGeometryPolygon"===b&&(b="polygon");return b}var l={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite",
"hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,1],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[26,26,26,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,
178,178,1],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,1],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,1],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,
128,128,1],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[51,51,51,1],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[51,51,51,1],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,1],width:1},opacity:.8}]}}}},b={};(function(){var d,a,f,e,k,p,n,q;for(d in l)for(e in a=l[d],f=a.basemapGroups,k=b[d]={basemaps:[].concat(f.light).concat(f.dark),point:{},line:{},polygon:{}},f)for(p=f[e],n=0;n<p.length;n++)q=p[n],a.pointSchemes&&(k.point[q]=
a.pointSchemes[e]),a.lineSchemes&&(k.line[q]=a.lineSchemes[e]),a.polygonSchemes&&(k.polygon[q]=a.polygonSchemes[e])})();var y={getAvailableThemes:function(d){var a=[],f,e,g;for(f in l)e=l[f],g=b[f],d&&-1===q.indexOf(g.basemaps,d)||a.push({name:e.name,label:e.label,description:e.description,basemaps:g.basemaps.slice(0)});return a},getSchemes:function(d){var a=d.theme,f=d.basemap,e=p(d.geometryType);d=b[a];var g;(d=(d=d&&d[e])&&d[f])&&(g={primaryScheme:n(d.primary,e),secondarySchemes:q.map(d.secondary,
function(a){return n(a,e)})});return g},cloneScheme:function(b){var a;b&&(a=e.mixin({},b),a.color&&(a.color=new r(a.color)),a.outline&&(a.outline={color:a.outline.color&&new r(a.outline.color),width:a.outline.width}));return a}};d("extend-esri")&&e.setObject("styles.basic",y,k);return y})},"widgets/Bookmark/setting/LayersChooser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dojo/on".split(" "),function(q,
e,d,k,r,n,p,l){return q([n,p,r],{baseClass:"layers-chooser-container set-btn",templateString:"\x3cdiv\x3e\x3c/div\x3e",nls:null,menuBox:{w:75,h:120},layerItems:[],enable:!0,postCreate:function(){this.labelNode=d.create("div",{"class":"label",innerHTML:this.nls.set},this.domNode);this.inherited(arguments)},startup:function(){this.setLayers(this.layers);this.own(l(this.labelNode,"click",e.hitch(this,function(b){this.onBtnClick(b)})));this.enable?this.enableMeun():this.disableMeun();this.inherited(arguments)},
destroy:function(){this.inherited(arguments);this.layerItems=null},getLayers:function(){var b={};k.forEach(this.layerItems,function(e){var g=d.getAttr(e,"data-id");e=d.hasClass(e,"selected");b[g]={visible:e}},this);return b},setLayers:function(b){this.layers=b;this.layerItems=[];this._initMeun()},_initMeun:function(){this.meun&&d.empty(this.meun);this.meun=d.create("div",{"class":"meun-box hide"},this.domNode);d.create("div",{innerHTML:"For test\x3d\x3d\x3e Preview in the main map",style:"background-color: #24B5CC"},
this.meun);for(var b in this.layers)this._createItem(b,this.layers[b])},_createItem:function(b,k){var g=d.create("div",{"class":"layer",innerHTML:b,"data-id":b},this.meun);!0===k.visible?this._selectItem(g,{noEvent:!0}):this._unSelectedItem(g,{noEvent:!0});this.own(l(g,"click",e.hitch(this,this._toggleSelectItme,g)));this.layerItems.push(g)},_toggleSelectItme:function(b){d.hasClass(b,"selected")?this._unSelectedItem(b):this._selectItem(b)},_selectItem:function(b,e){d.addClass(b,"selected");e&&!0===
e.noEvent||this.emit("change",this.getLayers())},_unSelectedItem:function(b,e){d.removeClass(b,"selected");e&&!0===e.noEvent||this.emit("change",this.getLayers())},onBtnClick:function(b){b.stopPropagation();b.preventDefault();d.hasClass(this.meun,"hide")?!1!==this.enable&&(this._setMenuPosition(),this._showMenu()):this._closeMenu()},enableMeun:function(){this.enable=!0;d.addClass(this.labelNode,"enable")},disableMeun:function(){this.enable=!1;d.removeClass(this.labelNode,"enable")},_setMenuPosition:function(){var b=
d.position(this.domNode);0>b.y-this.menuBox.h-2&&d.setStyle(this.meun,{top:"27px",bottom:"auto"});var e=d.getMarginBox(this.domNode);window.isRTL?0>b.x-this.menuBox.w&&d.setStyle(this.meun,{left:0}):b.x+this.menuBox.w>e.w&&d.setStyle(this.meun,{right:0})},_showMenu:function(){d.removeClass(this.meun,"hide");this.emit("open")},_closeMenu:function(){d.addClass(this.meun,"hide");this.emit("close")}})})},"widgets/Bookmark/setting/Import":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/utils ../utils ../ItemNode dojo/text!./Import.html".split(" "),
function(q,e,d,k,r,n,p,l,b,y,g){var a=window.Sortable;return q([p,n],{baseClass:"jimu-Bookmark-Import",templateString:g,bookmarks:[],_selectedBookMarksNumber:0,postCreate:function(){this.inherited(arguments);this.sortableBookMarkerNodes=a.create(this.bookMarkerContainer,{handle:".drag-masker",sort:!1,disabled:!this._init_editing,animation:100});this.bookmarks=b.readBookmarksInWebmap(this.map);this.displayBookmarks(this.bookmarks);this.bookmarks&&0===this.bookmarks.length?d.addClass(this.bookmarksInWebmap,
"hide"):d.addClass(this.noBookmark,"hide");this.own(r(this.all,"change",e.hitch(this,function(){this._selectOrUnselectAll()})))},startup:function(){this.bookmarksInSetting&&this.bookmarksInSetting.forEach(e.hitch(this,function(a){if((a=b.findBookMarkByNameAndExtent(a,this.bookmarks))&&a.bookmark)a.bookmark.itemNode.onSelected()}))},getConfig:function(){var a=[];this.bookmarks.forEach(e.hitch(this,function(b){b.itemNode&&b.itemNode.domNode&&d.hasClass(b.itemNode.domNode,"selected")&&(delete b.itemNode,
b=e.clone(b),a.push(b))}));return a},_isSelectedAll:function(){return this.bookmarks.length===this._selectedBookMarksNumber},_selectOrUnselectAll:function(){this._isSelectedAll()?(this.bookmarks.forEach(e.hitch(this,function(a){a.itemNode&&a.itemNode.domNode&&d.hasClass(a.itemNode.domNode,"selected")&&d.removeClass(a.itemNode.domNode,"selected")})),this._selectedBookMarksNumber=0):this.bookmarks.forEach(e.hitch(this,function(a){a.itemNode&&a.itemNode.domNode&&!1===d.hasClass(a.itemNode.domNode,"selected")&&
(d.addClass(a.itemNode.domNode,"selected"),this._selectedBookMarksNumber++)}))},destroy:function(){k.forEach(this.bookmarks,function(a){a.itemNode&&a.itemNode.destroy()},this);this.bookmarks=[];this.sortableBookMarkerNodes&&(this.sortableBookMarkerNodes.destroy(),this.sortableBookMarkerNodes=null);this.inherited(arguments)},displayBookmarks:function(a){a.reverse();k.forEach(a,function(a,b){var d=this._createBookMarkNode(a,b);a.itemNode=d},this);a.forEach(e.hitch(this,function(a){a.itemNode&&a.itemNode.domNode&&
d.place(a.itemNode.domNode,this.bookMarkerContainer,"first")}))},_createBookMarkNode:function(a,b){var d;d=a.thumbnail||"undefined"!==typeof a.thumbnail&&""!==a.thumbnail?l.processUrlInWidgetConfig(a.thumbnail,this.folderUrl):this.folderUrl+"images/thumbnail_default.png";d=new y({dataId:b,img:d,label:a.displayName||a.name,display:{selectedBtn:!0,editBtn:!1,deleteBtn:!1},nls:this.nls});this.own(r(d,"click",e.hitch(this,e.partial(this._onBookmarkClick,d))));this.own(r(d,"selected",e.hitch(this,e.partial(this._onBookmarkSelected,
d))));this.own(r(d,"unselected",e.hitch(this,e.partial(this._onBookmarkUnSelected,d))));return d},_onBookmarkClick:function(a){a.onSelected()},_onBookmarkSelected:function(){this._selectedBookMarksNumber++;this._isDisableOK()},_onBookmarkUnSelected:function(){this._selectedBookMarksNumber--;this._isDisableOK()},_isDisableOK:function(){this.popup&&(0<this._selectedBookMarksNumber?this.popup.enableButton(0):this.popup.disableButton(0),b.setCheckboxWithoutEvent(this.all,this._isSelectedAll()))}})})},
"widgets/Bookmark/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Bookmark/ItemNode.html":'\x3cdiv class\x3d"jimu-img-node jimu-float-leading clearFix" data-id\x3d""\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"dragMasker" class\x3d"drag-masker"\x3e\x3c/div\x3e\x3c!--for different browsers drag behavior--\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"selectedBtn" class\x3d"selected-btn oper-btns no-user-select hide"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"nodeBox" class\x3d"node-box verticalCenter no-user-select"\x3e\r\n\t\t\x3cimg data-dojo-attach-point\x3d"thumbnail" class\x3d"thumbnail" src\x3d""\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"nodeLabel" data-dojo-type\x3d"dijit/form/ValidationTextBox" required\x3d"true" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"deleteBtn" class\x3d"delete-btn oper-btns no-user-select"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"editBtn" class\x3d"edit-btn oper-btns no-user-select"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"renameBtn" class\x3d"rename-btn oper-btns no-user-select"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"changeImgBtn" class\x3d"change-img-btn oper-btns no-user-select hide"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Layout.html":'\x3cdiv class\x3d"layout"\x3e\r\n  \x3cdiv class\x3d"title"\x3e${nls.displayBookmarksAs}\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"content verticalCenter"\x3e\r\n    \x3cdiv type\x3d"checkbox" checked\x3d"false" class\x3d"checkbox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"layoutCards_checkBox"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"label verticalCenter" data-dojo-attach-point\x3d"layoutCards" title\x3d"${nls.cardsTips}"\x3e\r\n      \x3cdiv class\x3d"layout-btns"\x3e\r\n        \x3cdiv class\x3d"cards"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      ${nls.cards}\r\n      \x3cdiv data-dojo-attach-point\x3d"cardsDefaultSetting" class\x3d"default-setting transparent"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"cards_makeAsDefault" class\x3d"set-default hide" title\x3d"${nls.makeAsDefault}"\x3e${nls.makeAsDefault}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"cards_default" class\x3d"default hide" title\x3d"${nls.default}"\x3e${nls.default}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv type\x3d"checkbox" checked\x3d"false" class\x3d"checkbox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"layoutList_checkBox"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"label verticalCenter" data-dojo-attach-point\x3d"layoutList" title\x3d"${nls.listTips}"\x3e\r\n      \x3cdiv class\x3d"layout-btns"\x3e\r\n        \x3cdiv class\x3d"list"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      ${nls.list}\r\n      \x3cdiv data-dojo-attach-point\x3d"listDefaultSetting" class\x3d"default-setting transparent"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"list_makeAsDefault" class\x3d"set-default hide" title\x3d"${nls.makeAsDefault}"\x3e${nls.makeAsDefault}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"list_default" class\x3d"default hide" title\x3d"${nls.default}"\x3e${nls.default}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Edit.html":'\x3cdiv class\x3d"edit-page jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"info"\x3e\r\n    \x3cdiv class\x3d"image"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"text"\x3e\r\n      \x3cdiv class\x3d"lebel"\x3e\r\n        \x3cspan\x3e${nls.title}\x3c/span\x3e\x3cspan class\x3d"start"\x3e*\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"displayName" required\x3d"true" placeHolder\x3d${nls.title} data-dojo-props\x3d\'style:{width:"100%"}\' class\x3d"title"/\x3e\r\n      \x3cdiv class\x3d"tips"\x3e(${nls.thumbnailHint})\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"options hide"\x3e\r\n    \x3cdiv\x3e${nls.options}\x3c/div\x3e\r\n    \x3cdiv class\x3d"itmes" data-dojo-attach-point\x3d"saveExtent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"itmes btns"\x3e\r\n      \x3cdiv class\x3d"" data-dojo-attach-point\x3d"saveLayers"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"setBtn"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e  \r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"extent-chooser" style\x3d"height: 400px" data-dojo-attach-point\x3d"extentChooserNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Import.html":'\x3cdiv class\x3d"import jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"import-tips"\x3e${nls.importFromWeb}\x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"bookmarksInWebmap" class\x3d"bookmarks-in-webmap"\x3e\r\n    \x3cdiv class\x3d"select-all-cb"\x3e\r\n      \x3cdiv type\x3d"checkbox" checked\x3d"false" id\x3d"all" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"all"\x3e\x3c/div\x3e\r\n      \x3clabel class\x3d"all-label" for\x3d"all"\x3e${nls.selectAll}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"bookMarkerContainer" class\x3d"bookmarker-container editing"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"noBookmark" class\x3d"no-bookmark"\x3e${nls.noBookmarkInWebMap}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Sync.html":'\x3cdiv class\x3d"sync"\x3e\r\n  \x3cdiv class\x3d"sync-setting-item"\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isSyncWebmapNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"marks-table-div web-map" data-dojo-attach-point\x3d"webMapBookMarkerContainer"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"sync-setting-item"\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isSyncCustomNode"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"customBtns" class\x3d"verticalCenter"\x3e\r\n      \x3c!--\x3cdiv class\x3d"custom-btns" data-dojo-attach-point\x3d"importBtn"\x3e${nls.import}\x3c/div\x3e--\x3e\r\n      \x3cdiv class\x3d"custom-btns create" data-dojo-attach-point\x3d"createNewBtn"\x3e${nls.create}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"marks-table-div custom editing" data-dojo-attach-point\x3d"custombookMarkerContainer"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Setting.html":'\x3cdiv class\x3d"jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"layout" data-dojo-attach-point\x3d"layoutContainer"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"editable"\x3e\r\n    \x3c!--\x3cdiv class\x3d"title"\x3e${nls.bookmark}\x3c/div\x3e--\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isEditableNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"" data-dojo-attach-point\x3d"syncContainer"\x3e\x3c/div\x3e\r\n    \x3c!--\r\n    \x3cdiv class\x3d\'bookmark-add jimu-float-leading jimu-leading-margin2\' data-dojo-attach-event\x3d"onclick: onAddBookmarkClick"\x3e\r\n      \x3cdiv class\x3d"add_mark_image"\x3e\x3c/div\x3e\u200b\r\n      \x3cdiv title\x3d"${nls.add}" class\x3d"add_mark_text"\x3e${nls.add}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    --\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/css/style.css":'.jimu-img-node{font-size: 12px; position: relative; float: left; color: #666; overflow: hidden;}.jimu-img-node .node-box{position: relative; border-radius: 4px; overflow: hidden;}.jimu-img-node img{width: 100%; height: 100%; cursor: pointer;}.jimu-img-node .node-label{height: 30px; text-align: center; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxDisabled{opacity: 1;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner {color: #000; opacity: 0.9;}.jimu-widget-bookmark .no-user-select{user-select: none; -moz-user-select: none; -webkit-user-select: none; -ms-user-select: none;}.jimu-widget-bookmark .hide {display: none !important;}.jimu-widget-bookmark .clearFix {*overflow: hidden; *zoom: 1;}.jimu-widget-bookmark .clearFix:after {display: table; content: ""; width: 0; clear: both;}.jimu-widget-bookmark .verticalCenter{display: flex; align-items: center;}.jimu-widget-bookmark .jimu-img-node .node-box{margin: 0 auto; width: 100px; height: 60px;}.jimu-widget-bookmark .cards .jimu-img-node .drag-masker{width: 100px; height: 60px;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox {border: none; width: 100%; background-color: transparent;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxDisabled,.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputField{background-color: transparent; width: 100%; overflow: hidden;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner{white-space: nowrap; text-overflow: ellipsis; text-align: center;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitFocused{border:none !important; box-shadow: none; background-image: none;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitValidationTextBoxFocused{background-image: none;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitFocused .dijitInputInner{box-shadow: none; background: rgba(36, 181, 204, 0.2) !important;}.jimu-img-node .oper-btns{display: none; position: absolute; z-index: 10;}.editing .jimu-img-node .thumbnail{}.jimu-img-node .drag-masker{position: absolute; z-index: 5; top: 0; width: 100%; height: 60px; cursor: pointer;}.jimu-img-node .drag-masker:hover{background-color: transparent}.editing .jimu-img-node .oper-btns{width:20px; height:20px; cursor: pointer; background-color: rgba(0,0,0,0.5);}.editing .jimu-img-node .oper-btns:hover{background-color: rgba(0,0,0,0.7);}.editing .jimu-img-node .selected-btn{background: url("../../images/btns/unselected.svg") no-repeat; left:0; top:0;}.editing .jimu-img-node.selected .selected-btn{background: url("../../images/btns/selected.svg") no-repeat;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .delete-btn{cursor: pointer; top:0;}.jimu-rtl .jimu-widget-bookmark:not(.mobile) .jimu-img-node .delete-btn{right: auto; left: 0;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .delete-btn:before{position: absolute; content: url("../../images/btns/x.svg"); display: block; width: 8px; left: 50%; top: 50%; transform: translate(-50%, -50%);}.editing .jimu-img-node .edit-btn{right: 0; bottom: 30px;}.jimu-rtl .jimu-img-node .edit-btn{right: auto; left: 0;}.editing .jimu-img-node .edit-btn:before{position: absolute; content: url("images/btns/edit.svg"); display: block; width: 9px; height: 11px; left: 50%; top: 50%; transform: translate(-50%, -50%);}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .rename-btn{display: none; top: 0px; left: 0px;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .rename-btn:before{position: absolute; content: url("images/btns/edit.svg"); display: block; width: 9px; height: 12px; left: 50%; top: 50%; transform: translate(-50%, -50%);}.editing .jimu-img-node .change-img-btn{right: calc((100% - 100px)/2); bottom: 30px;}.jimu-rtl .jimu-img-node .change-img-btn{right: auto; left: calc((100% - 100px)/2);}.editing .jimu-img-node .change-img-btn:before{position: absolute; content: url("../../images/btns/change.svg"); display: block; width: 11px; height: 15px; left: 50%; top: 50%; transform: translate(-50%, -50%);}.jimu-widget-bookmark .header {display: flex; align-items: center; justify-content: space-between; height: 30px; margin-bottom: 15px;}.jimu-widget-bookmark .header .editable-btns,.jimu-widget-bookmark .header .common-fun-btns,.jimu-widget-bookmark .header .edit-btns,.jimu-widget-bookmark .header .common-fun-btns .display-mode{display: flex; align-items: center;}.jimu-widget-bookmark .header .common-fun-btns .display-mode {margin: 0 5px;}.jimu-widget-bookmark .header .two-modes .list{background: url("../../images/btns/list.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .list:hover{background: url("../../images/btns/list_selected.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .cards{background: url("../../images/btns/cards.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .cards:hover{background: url("../../images/btns/cards_selected.svg") no-repeat;}.jimu-widget-bookmark .adding .header .add{background: url("../../images/btns/add_selected.svg") no-repeat;}.jimu-widget-bookmark .header .edit{background: url("../../images/btns/edit.svg") no-repeat;}.jimu-widget-bookmark .editing .header .edit{background: url("../../images/btns/edit_selected.svg") no-repeat;}.jimu-widget-bookmark .header .sync-btn{background: url("../../images/btns/sync.svg") no-repeat;}.jimu-widget-bookmark .header .sync-btn.marked{background: url("../../images/btns/sync.svg") no-repeat; background-color: red;}.jimu-widget-bookmark .header .back-to-init{background: url("../../images/btns/backtoinit.svg") no-repeat;}.jimu-widget-bookmark .header .back-to-init.marked{background: url("../../images/btns/backtoinit_selected.svg") no-repeat;}.jimu-widget-bookmark .header .rename{background: url("../../images/btns/rename_selected.svg") no-repeat;}.jimu-widget-bookmark .header .rename.disable{background: url("../../images/btns/rename.svg") no-repeat;}.jimu-widget-bookmark .header .delete{background: url("../../images/btns/delete_selected.svg") no-repeat;}.jimu-widget-bookmark .header .delete.disable{background: url("../../images/btns/delete.svg") no-repeat;}.jimu-widget-bookmark .header .edit-btns{display: none;}.jimu-widget-bookmark .editing .header .edit-btns{display: flex;}.jimu-widget-bookmark .header .common-fun-btns{display: flex;}.jimu-widget-bookmark .editing .header .common-fun-btns{display: none;}.bookmark-notice-popup{font-family: "Avenir Medium"; font-size: 12px;}.bookmark-notice-popup .tips{color: #000000; letter-spacing: 0;}.bookmark-notice-popup .check-box{position: absolute; bottom: 20px;}.bookmark-notice-popup .check-box .jimu-checkbox .label{font-size: 12px; color: #353535; letter-spacing: 0.3px;}.DartTheme .jimu-widget-bookmark .dijitTextBox{border: none !important;}.DartTheme .jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner {color: #FFF !important;}.jimu-widget-bookmark-setting {height: 100%;}.jimu-widget-bookmark-setting .layout,.jimu-widget-bookmark-setting .editable{margin-bottom: 15px;}.jimu-widget-bookmark-setting .editable .tips{font-family: "Avenir Light"; font-size: 12px; color: #898989;}.jimu-widget-bookmark-setting .layout .title,.jimu-widget-bookmark-setting .editable .title{margin-bottom: 15px; font-size: 14px; color: #000000;}.jimu-widget-bookmark-setting .editable .tips{margin-left: 20px;}.jimu-rtl .jimu-widget-bookmark-setting .editable .tips{margin-right: 26px; margin-left: 0;}.jimu-widget-bookmark-setting .layout .content{}.jimu-widget-bookmark-setting .layout .label{margin-right: 40px; cursor: pointer;}.jimu-rtl .jimu-widget-bookmark-setting .layout .label{margin-left: 40px; margin-right: 0;}.jimu-widget-bookmark-setting .transparent{visibility: hidden;}.jimu-widget-bookmark-setting .default-setting{display: flex; align-items: center; justify-content: center; min-width: 100px; height: 20px; margin: 0 5px; cursor: pointer; background-color: #F3F3F3; font-size: 12px; text-align: center;}.jimu-widget-bookmark-setting .default-setting .default{color: #9B9B9B; padding: 2px 6px; cursor: default;}.jimu-widget-bookmark-setting .default-setting .set-default {width: 100%; height: 100%; padding: 0 10px; display: flex; align-items: center; justify-content: center; background-color: #24B5CC; color: #ffffff; cursor: pointer;}.jimu-widget-bookmark-setting .layout .content .checkbox{}.jimu-widget-bookmark-setting .layout .layout-btns{width:30px; height:30px; border: 1px solid #E2E2E2; margin:0 10px;}.jimu-widget-bookmark-setting .layout .layout-btns .cards{width: 16px; height: 16px; margin: 6px; background: url(../../images/btns/cards.svg) no-repeat;}.jimu-widget-bookmark-setting .layout .layout-btns .list{width: 16px; height: 16px; margin: 6px; background: url(../../images/btns/list.svg) no-repeat;}.jimu-widget-bookmark-setting .sync .check{margin-bottom: 15px;}.jimu-widget-bookmark-setting .sync label{font-family: "Avenir Medium"; font-size: 12px; color: #000000; letter-spacing: 0.3px;}.jimu-widget-bookmark-setting .sync .custom-btns{border: 1px solid #D6D6D6; height: 30px; width: 80px; text-align: center; line-height: 30px; cursor: pointer;}.jimu-widget-bookmark-setting .sync .custom-btns:hover{color: #FFF; background-color: #24B5CC;}.jimu-widget-bookmark-setting .sync .custom-btns.create{margin: 0 20px; margin-bottom: 15px;}.jimu-widget-bookmark-setting .bookmark-list{height: 100%; width: 100%; overflow: auto;}.jimu-widget-bookmark-setting .marks-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto; margin: 0 10px;}.jimu-widget-bookmark-setting .marks-table-div.editing{margin-top: 0;}.jimu-widget-bookmark-setting .bookmark-add{position:relative; width:100px; height:60px; padding:3px; text-align:center; color:#999999; font-size:10px; border:1px dotted gray; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background-size:cover; margin-top: 5px; margin-left: 20px\\9;}.jimu-widget-bookmark-setting .bookmark-add .add_mark_image{display: block; position: absolute; left: 43px; top: 5px; width:14px; height:14px; background-position:center center; background-image:url(images/add_mark.png);}.jimu-widget-bookmark-setting .bookmark-add .add_mark_text{display: block; position: absolute; top: 25px; width: 100%; font-size: 12px; white-space: normal; height: 30px; width: 94px; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-bookmark-setting .bookmark-add:hover{cursor: pointer;}.jimu-widget-bookmark-setting .mark-item-div{position:relative; width:100px; height: 90px; font-size: 10px; margin-top: 5px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg{position:relative; width:100%; height:60px; line-height:28px; text-align:center; color:#999999; font-size:13px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-thumbnail{width:100%; height:100%;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg.selected .mark-item-thumbnail{-webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{display: none; position:absolute; width:20px; height:20px; background-color:rgba(0, 0, 0, 0.3); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{right:2px; bottom:2px; background-repeat:no-repeat; background-position:center center; background-image:url(images/edit_mark.png);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon:hover,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon:hover{background-color:rgba(0, 0, 0, 0.6);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-detail-icon,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-delete-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{right:2px; top:2px; background-repeat:no-repeat; background-position:center center; background-image:url(images/delete_mark.png);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-title-wapper{width:100%; text-align:center; color:#333333; font-size:12px; margin-bottom: 25px; overflow: hidden; height: 2.7em; line-height: 16px; padding: 0 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;}.jimu-Bookmark-Edit{height: 100%; overflow-y: auto;}.jimu-Bookmark-Edit .setting-table {margin: 5px 20px; border-spacing: 10px; border-collapse: separate;}.jimu-Bookmark-Edit .setting-table .img-chooser{width: 100px; height: 60px;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .first{width:auto; text-align: left; padding-right:15px; white-space: nowrap; max-width: 108px; overflow: hidden; text-overflow: ellipsis;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .second{width:660px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{right:auto; left: 2px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{right:auto; left: 2px;}.jimu-rtl .jimu-widget-bookmark-setting .bookmark-add{margin-left: auto; margin-right: 20px\\9;}.bookmark-extent-chooser .map{position: relative;}.jimu-widget-bookmark.import {min-height: 300px;}.jimu-widget-bookmark.import .import-tips{font-family: "Avenir Medium"; font-size: 14px; color: #161616;}.jimu-widget-bookmark.import .select-all-cb {margin: 10px 0; display: flex; align-items: center;}.jimu-widget-bookmark.import .all-label {font-size: 12px; color: #000000; letter-spacing: 0.3px; padding: 0 10px;}.jimu-widget-bookmark.import .bookmarker-container{overflow: auto;}.jimu-widget-bookmark.import .no-bookmark{font-size: 12px; color: #000000; letter-spacing: 0.3px; display: flex; min-height: 300px; align-items: center; justify-content: center;}.bookmark-extent-chooser .arcgisSearch{position: absolute; z-index: 1001; right: 5px; top: 5px;}.jimu-rtl .bookmark-extent-chooser .arcgisSearch{right: auto; left: 5px;}.jimu-widget-bookmark-setting .jimu-img-node,.import .jimu-img-node{width: 120px;}.jimu-widget-bookmark-setting .web-map .jimu-img-node .drag-masker{cursor: pointer;}.jimu-widget-bookmark-setting .custom .jimu-img-node .drag-masker{cursor: move;}.jimu-widget-bookmark-setting .jimu-img-node .drag-masker{left: 50%; transform: translate(-50%, 0%);}.jimu-widget-bookmark-setting .jimu-img-node .thumbnail{max-width: 100px; max-height: 60px;}.jimu-widget-bookmark-setting .editing .jimu-img-node .oper-btns{display: none;}.jimu-widget-bookmark-setting .editing .jimu-img-node:hover .oper-btns{display: flex; justify-content: center; align-items: center;}.jimu-widget-bookmark-setting .jimu-img-node .delete-btn{right:calc((100% - 100px)/2); top:0;}.jimu-rtl .jimu-widget-bookmark-setting .jimu-img-node .delete-btn{right: auto; left: calc((100% - 100px)/2);}.jimu-widget-bookmark-setting .jimu-img-node .edit-btn{right: calc((100% - 100px)/2); bottom: 31px;}.jimu-rtl .jimu-widget-bookmark-setting .jimu-img-node .edit-btn{right: auto; left: calc((100% - 100px)/2);}.jimu-widget-bookmark.edit-page {}.jimu-widget-bookmark.edit-page .info{display: flex;}.jimu-widget-bookmark.edit-page .info .image{width: 135px; height: 90px;}.jimu-widget-bookmark.edit-page .info .text{width:265px; margin: 0 10px;}.jimu-widget-bookmark.edit-page .info .text .lebel{font-family: "Avenir Medium"; font-size: 14px; color: #161616;}.jimu-widget-bookmark.edit-page .info .text .start{color: red; padding: 0 10px;}.jimu-widget-bookmark.edit-page .info .text .tips{font-size: 12px; color: #999999;}.jimu-widget-bookmark.edit-page .info .title{margin: 10px 0;}.jimu-widget-bookmark.edit-page .image .jimu-image-chooser{width: 135px; height: 80px;}.jimu-widget-bookmark.edit-page .jimu-image-chooser .hint .display-image{top: auto; left: auto; transform: none; width: 100% !important; height: 100% !important;}.jimu-widget-bookmark.edit-page .options{margin: 20px 0;}.jimu-widget-bookmark.edit-page .options .itmes{display: flex; align-items: center; margin-top: 10px;}.jimu-widget-bookmark.edit-page .options .itmes.btns{justify-content: space-between;}.jimu-widget-bookmark.edit-page .options .set-btn{position: relative; border: 1px solid #D6D6D6; height: 30px; width: 80px; text-align: center; line-height: 30px; cursor: pointer;}.layers-chooser-container .meun-box {position: absolute; z-index: 500; background-color: #fff; border: 1px solid #24B5CC; box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.50);}.layers-chooser-container .label {font-family: Avenir-Medium; font-size: 12px; color: #898989; letter-spacing: 0.33px;}.layers-chooser-container .label.enable {color: #FFF; background-color: #24B5CC;}.layers-chooser-container .selected {background-color: greenyellow;}',
"*now":function(q){q(['dojo/i18n!*preload*widgets/Bookmark/setting/nls/Setting*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin ../utils ./Layout ./Sync jimu/dijit/CheckBox".split(" "),function(q,e,d,k,r,n,p){return q([e,d],{baseClass:"jimu-widget-bookmark-setting",startup:function(){this.inherited(arguments);this.layout=new r({nls:this.nls,config:this.config},this.layoutContainer);this.layout.startup();"undefined"===typeof this.config.editable&&(this.config.editable=!1);this.isEditableCheckBox=new p({label:this.nls.editable},this.isEditableNode);
this.isEditableCheckBox.startup();this.sync=new n({nls:this.nls,folderUrl:this.folderUrl,appConfig:this.appConfig,map:this.map,config:this.config},this.syncContainer);this.sync.startup();this.setConfig(this.config)},setConfig:function(d){this.config=d;this.updateConfigs();this.layout.setConfig(this.config);this.isEditableCheckBox.setValue(d.editable);this.sync.setConfig(this.config)},getConfig:function(){var d=this.sync.getConfig();this.config.syncMode=d.syncMode;this.config.layout=this.layout.getConfig();
this.config.editable=this.isEditableCheckBox.checked;this.config.bookmarks2D=k.stringifyBookmarks(d.bookmarks);this.completeUpdateConfig();return this.config},destroy:function(){this.layout&&this.layout.destroy&&this.layout.destroy();this.sync&&this.layout.destroy&&this.sync.destroy();this.inherited(arguments)},updateConfigs:function(){k.isConfigBefore5_3(this.config)&&k.setDefaultConfigForUpdate(this.config);k.updateBookmarks(this.config.bookmarks2D)},completeUpdateConfig:function(){k.completeUpdateConfig(this.config)}})});