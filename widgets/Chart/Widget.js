// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/StatisticsChart":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/Color dijit/popup dijit/_WidgetBase dijit/TooltipDialog dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/StatisticsChart.html esri/lang esri/graphic esri/graphicsUtils esri/symbols/jsonUtils esri/layers/FeatureLayer jimu/utils jimu/clientStatisticsUtils jimu/dijit/Chart jimu/dijit/_StatisticsChartSettings jimu/dijit/LoadingIndicator".split(" "),
function(t,g,n,h,e,d,l,p,m,c,a,b,f,k,q,C,D,B,v,y,z,A,w,F){return h([a,f,k,g],{baseClass:"jimu-dijit-statistics-chart",templateString:q,theme:"light",noMoreThanOneChartClassName:"no-more-than-one-chart",hasTitleClassName:"has-title",charts:null,paramsDijits:null,tooltipDialogs:null,currentChartIndex:-1,tempGraphics:null,maxPreviewFeaturesCount:20,tooltipColor:"green",floatNumberFieldDecimalPlace:null,popupFieldInfosObj:null,config:null,features:null,featureLayer:null,map:null,fontColor:"#333333",isBigPreview:!1,
showSettingIcon:!1,showZoomIcon:!1,zoomToFeaturesWhenClick:!1,initialChartIndex:0,postMixInProperties:function(){this.nls=window.jimuNls.statisticsChart;this.charts=[];this.paramsDijits=[];this.tooltipDialogs=[];this.isBigPreview&&(this.showZoomIcon=!1)},postCreate:function(){this.inherited(arguments);this.showSettingIcon?this.own(t(document.body,"click",e.hitch(this,this._onDocumentBodyClick))):l.destroy(this.settingsIcon);this.showZoomIcon?this.own(t(this.zoominIcon,"click",e.hitch(this,function(){this.emit("zoomin")}))):
l.destroy(this.zoominIcon);this.isBigPreview&&(this.chartContainer.style.maxHeight="auto",l.addClass(this.domNode,"big-preview"));this.zoominIcon.title=this.nls.enlarge;this.settingsIcon.title=this.nls.setting;l.addClass(this.domNode,this.noMoreThanOneChartClassName)},destroy:function(){this.clear();this.inherited(arguments)},resize:function(a,b){if(0<a||"string"===typeof a&&0<a.length)this.domNode.style.width=a;if(0<b||"string"===typeof b&&0<b.length)this.domNode.style.height=b;this._resize()},resizeByParent:function(){this.domNode.style.width=
"100%";this.domNode.style.height="100%";this._resize()},_resize:function(){this._calculateChartBox();0<=this.currentChartIndex&&this._showChart(this.currentChartIndex)},createServerStatisticsCharts:function(a,b,c){var r=a.fields,f={type:"Table",fields:[]},u=e.clone(c),k=c.mode;"category"===k?(u.valueFields=[],f.fields=d.map(c.valueFields,e.hitch(this,function(a){var b=c.operation;"average"===b&&(b="avg");var r=a+"_"+b;a=a+"_"+b;u.valueFields.push(r);return{name:r,type:"esriFieldTypeDouble",alias:a}})),
d.some(r,e.hitch(this,function(a){return a.name===c.categoryField?(f.fields.push(a),!0):!1}))):"count"===k?(u.mode="feature",u.labelField=c.categoryField,a=a.fields[0].name+"_count",u.valueFields=[a],d.some(r,e.hitch(this,function(a){return a.name===c.categoryField?(f.fields.push(a),!0):!1})),f.fields.push({name:a,type:"esriFieldTypeInteger",alias:this.nls.count})):"field"===k&&(u.valueFields=[],f.fields=d.map(c.valueFields,e.hitch(this,function(a){var b=c.operation;"average"===b&&(b="avg");var r=
a+"_"+b;a=a+"_"+b;u.valueFields.push(r);return{name:r,type:"esriFieldTypeDouble",alias:a}})));return this._getLoadedLayer(f).then(e.hitch(this,function(a){this._createChartsAsync({featureLayer:a,features:b,config:u})}))},createClientCharts:function(a,b,c,f,d){d&&(this.featureLayerForChartSymbologyChart=d);return this._getLoadedLayer(a).then(e.hitch(this,function(a){this._createChartsAsync({featureLayer:a,features:b,config:c,popupFieldInfosObj:f})}))},_getLoadedLayer:function(a){var b=new n,r=null,
r="string"===typeof a?new y(a):"esri.layers.FeatureLayer"===a.declaredClass?a:new y({layerDefinition:e.clone(a),featureSet:null});r.loaded?b.resolve(r):this.own(t(r,"load",e.hitch(this,function(){b.resolve(r)})));return b},_createChartsAsync:function(a){setTimeout(e.hitch(this,function(){this._createCharts(a)}),0)},_createCharts:function(a){try{this.loading.hide();this.clear();var c=!1;a.features&&(c=!!a.features.isSelectedFeatures,a.features=d.filter(a.features,e.hitch(this,function(a){return!!a.attributes})));
this.config=a.config;this.features=a.features;this.featureLayer=a.featureLayer;this.popupFieldInfosObj=a.popupFieldInfosObj?a.popupFieldInfosObj:{};this.config.highLightColor||(this.config.highLightColor=c?"#ff0000":"#00ffff");this._calculateDecimalPlaceForFloatField();this.chartTitle.innerHTML=z.stripHTML(this.config.name||"");this.chartTitle.title=this.chartTitle.innerHTML;this.chartTitle.title?l.addClass(this.domNode,this.hasTitleClassName):l.removeClass(this.domNode,this.hasTitleClassName);1>=
a.config.types.length?l.addClass(this.domNode,this.noMoreThanOneChartClassName):l.removeClass(this.domNode,this.noMoreThanOneChartClassName);var r=this._calculateChartBox(),f=r.w+"px",k=r.h+"px",q=d.map(a.config.types,e.hitch(this,function(a){var b=l.create("div",{"class":"chart-div",style:{width:f,height:k}},this.chartContainer),c=l.toDom("\x3cli class\x3d'paging-li'\x3e\x3ca class\x3d'paging-a'\x3e\x3c/a\x3e\x3c/li\x3e");l.place(c,this.pagingUl);c=a.type;a=a.display;a.backgroundColor||(a.backgroundColor=
"transparent");a.hasOwnProperty("showLegend")||(a.showLegend=!1);a.legendTextColor||(a.legendTextColor=this.fontColor);"pie"===c?(a.hasOwnProperty("showDataLabel")||(a.showDataLabel=!0),a.dataLabelColor||(a.dataLabelColor=this.fontColor)):(a.hasOwnProperty("showHorizontalAxis")||(a.showHorizontalAxis=!0),a.horizontalAxisTextColor||(a.horizontalAxisTextColor=this.fontColor),a.hasOwnProperty("showVerticalAxis")||(a.showVerticalAxis=!0),a.verticalAxisTextColor||(a.verticalAxisTextColor=this.fontColor));
return b})),c=null;"feature"===this.config.mode?c=this._createFeatureModeCharts(a,q):"category"===this.config.mode?c=this._createCategoryModeCharts(a,q):"count"===this.config.mode?c=this._createCountModeCharts(a,q):"field"===this.config.mode&&(c=this._createFieldModeCharts(a,q));this.charts=c.charts;this.paramsDijits=c.paramsDijits;this.tooltipDialogs=d.map(this.paramsDijits,e.hitch(this,function(a){var c=l.create("div");a.placeAt(c);return new b({content:c})}));a=0;0<=this.initialChartIndex&&this.charts.length>=
this.initialChartIndex+1&&(a=this.initialChartIndex);this._showChart(a)}catch(E){console.error(E)}},_calculateChartBox:function(){var a=l.getContentBox(this.domNode),b=a.h;0<this.resultsHeader.clientHeight&&(b=l.getMarginBox(this.resultsHeader),b=a.h-b.h);a=60;b<a&&(a=b);l.setStyle(this.leftArrow,"height",a+"px");l.setStyle(this.rightArrow,"height",a+"px");l.setStyle(this.chartContainer,"height",b+"px");return l.getContentBox(this.chartContainer)},_calculateDecimalPlaceForFloatField:function(){this.floatNumberFieldDecimalPlace=
{};var a=[];this.config.labelField&&a.push(this.config.labelField);this.config.categoryField&&a.push(this.config.categoryField);this.config.valueFields&&(a=a.concat(this.config.valueFields));var b=d.filter(a,e.hitch(this,function(a){return this._isFloatNumberField(a)})),c={};d.forEach(b,e.hitch(this,function(a){c[a]=[]}));(a=this.features)&&0<a.length&&d.forEach(a,e.hitch(this,function(a){var r=a.attributes;r&&d.forEach(b,e.hitch(this,function(a){var b=r[a];"number"===typeof b&&c[a].push(b)}))}));
d.forEach(b,e.hitch(this,function(a){this.floatNumberFieldDecimalPlace[a]=0;var b=c[a];if(0<b.length)try{var r=this._getBestDecimalPlace(b);this.floatNumberFieldDecimalPlace[a]=r}catch(E){this.floatNumberFieldDecimalPlace[a]=0,console.error(E)}this.popupFieldInfosObj&&(b=this.popupFieldInfosObj[a])&&b.format&&0<=b.format.places&&(this.floatNumberFieldDecimalPlace[a]=b.format.places)}))},_onDocumentBodyClick:function(a){if(0<=this.currentChartIndex&&this.tooltipDialogs){var b=this.tooltipDialogs[this.currentChartIndex];
if(b){var c=!!b.isOpendNow;this._hideAllTooltipDialogs();var r=a.target||a.srcElement;r===this.leftArrow||r===this.rightArrow||l.hasClass(r,"paging-a")||l.hasClass(r,"paging-li")||(r===this.settingsIcon?c?this._hideTooltipDialog(b):this._showTooltipDialog(b):(a=r===b.domNode,r=l.isDescendant(r,b.domNode),a||r?c?this._showTooltipDialog(b):this._hideTooltipDialog(b):this._hideTooltipDialog(b)))}else this._hideAllTooltipDialogs()}else this._hideAllTooltipDialogs()},clear:function(){this.featureLayer=
this.features=this.config=null;this.chartTitle.innerHTML="";this.chartTitle.title="";this.currentChartIndex=-1;this.popupFieldInfosObj=this.floatNumberFieldDecimalPlace=null;p("li",this.pagingUl).removeClass("selected");this.charts||(this.charts=[]);this.paramsDijits||(this.paramsDijits=[]);this.tooltipDialogs||(this.tooltipDialogs=[]);for(var a=0;a<this.charts.length;a++)this.charts[a]&&this.charts[a].destroy(),this.charts[a]=null,this.paramsDijits[a]&&this.paramsDijits[a].destroy(),this.paramsDijits[a]=
null,this.tooltipDialogs[a]&&this.tooltipDialogs[a].destroy(),this.tooltipDialogs[a]=null;this.charts=[];this.paramsDijits=[];this.tooltipDialogs=[];l.empty(this.pagingUl);l.empty(this.chartContainer);l.addClass(this.domNode,this.noMoreThanOneChartClassName)},_showChart:function(a){this.currentChartIndex=-1;var b=p(".chart-div",this.chartContainer);b.style({display:"none"});var c=p("li",this.pagingUl);c.removeClass("selected");if(!(0>a)){if(b=b[a])this.currentChartIndex=a,l.setStyle(b,"display","block");
(c=c[a])&&l.addClass(c,"selected");if(!this.isBigPreview&&(c=null,this.charts&&0<this.charts.length&&(c=this.charts[a]))){a=this._calculateChartBox();var f=l.getContentBox(b);if(a.w!==f.w||a.h!==f.h)this.loading.show(),f=a.w+"px",a=a.h+"px",l.setStyle(b,"width",f),l.setStyle(b,"height",a),c.resize(f,a),this.loading.hide()}}},_hideAllTooltipDialogs:function(){this.tooltipDialogs&&0<this.tooltipDialogs.length&&d.forEach(this.tooltipDialogs,e.hitch(this,function(a){this._hideTooltipDialog(a)}))},_hideTooltipDialog:function(a){a&&
(c.close(a),a.isOpendNow=!1)},_showTooltipDialog:function(a){a&&(c.open({popup:a,around:this.settingsIcon}),a.isOpendNow=!0)},_onPagingUlClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=a.target||a.srcElement;if("a"===a.tagName.toLowerCase()){var b=p("a",this.pagingUl);a=d.indexOf(b,a);0<=a&&this._showChart(a)}},_onLeftArrowClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=(this.currentChartIndex-1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},
_onRightArrowClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=(this.currentChartIndex+1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_getHighLightMarkerSymbol:function(){var a=v.fromJson({color:[255,255,255,0],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSSquare",outline:{color:[0,0,128,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}});a.setSize(30);a.outline.setColor(new m(this.config.highLightColor));return a},_getHighLightLineSymbol:function(a){var b=
v.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});b.setColor(new m(a||this.config.highLightColor));return b},_getDefaultHighLightFillSymbol:function(){var a=v.fromJson({color:[0,255,255,128],outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"});a.outline.setColor(new m(this.config.highLightColor));return a},_getHighLightFillSymbol:function(a,b,c){var f=null,d=b.symbol,f=a.renderer;!d&&f&&(d=f.getSymbol(b));
d&&"function"===typeof d.setOutline?(f=v.fromJson(d.toJson()),b=1.5,d.outline&&0<d.outline.width&&(b=d.outline.width+1),c=this._getHighLightLineSymbol(c?"#ff0000":"#00ffff"),c.setWidth(b),f.setOutline(c)):f=this._getDefaultHighLightFillSymbol();return f},_zoomToGraphics:function(a){if(this.map&&this.featureLayer&&this.featureLayer.visible&&a&&0<a.length){var b=null;try{var c=d.filter(a,function(a){return!!a.geometry});0<c.length&&(b=B.graphicsExtent(c))}catch(G){console.error(G)}if(b)this.map.setExtent(b.expand(1.4));
else if(a=(a=a[0])&&a.geometry)b=e.hitch(this,function(a){var b=this.map.getNumLevels(),c=this.map.getLevel();this.map.setLevel(Math.max(c,Math.floor(2*b/3))).then(e.hitch(this,function(){this.map.centerAt(a)}))}),"point"===a.type?b(a):"multipoint"===a.type&&1===a.points.length&&b(a.getPoint(0))}},_removeTempGraphics:function(){if(this.featureLayer&&this.tempGraphics&&0<this.tempGraphics.length)for(;0<this.tempGraphics.length;)this.featureLayer.remove(this.tempGraphics[0]),this.tempGraphics.splice(0,
1);this.tempGraphics=null},_mouseOverChartItem:function(a){this._removeTempGraphics();d.forEach(a,e.hitch(this,function(a){a._originalSymbol=a.symbol}));if(this.featureLayer&&this.featureLayer.getMap()&&this.featureLayer.visible){var b=z.getTypeByGeometryType(this.featureLayer.geometryType),c=null;if("point"===b)c=this._getHighLightMarkerSymbol(),this.tempGraphics=[],d.forEach(a,e.hitch(this,function(a){a=new D(a.geometry,c);this.tempGraphics.push(a);this.featureLayer.add(a)}));else if("polyline"===
b)c=this._getHighLightLineSymbol(),d.forEach(a,e.hitch(this,function(a){a.setSymbol(c)}));else if("polygon"===b){var f=this.featureLayer.getSelectedFeatures()||[];d.forEach(a,e.hitch(this,function(a){var b=0<=f.indexOf(a),b=this._getHighLightFillSymbol(this.featureLayer,a,b);a.setSymbol(b)}));this.features.length!==a.length&&"polygon"===b&&(d.forEach(a,e.hitch(this,function(a){this.featureLayer.remove(a)})),d.forEach(a,e.hitch(this,function(a){this.featureLayer.add(a)})))}}},_mouseOutChartItem:function(a){this._removeTempGraphics();
d.forEach(a,e.hitch(this,function(a){a.setSymbol(a._originalSymbol||null)}))},_isNumber:function(a){return"[object number]"===Object.prototype.toString.call(a).toLowerCase()},_tryLocaleNumber:function(a,b){var c=a;if(C.isDefined(a)&&isFinite(a))try{var f;if(b&&this._isNumberField(b)){var d=this.popupFieldInfosObj[b];f=d&&e.exists("format.places",d)?z.localizeNumberByFieldInfo(a,d):z.localizeNumber(a)}else f=a;"string"===typeof f&&(c=f)}catch(H){console.error(H)}return c+""},_getBestDisplayValue:function(a,
b){var c=this._tryLocaleNumber(b,a);if(this.featureLayer.typeIdField===a){var f=this.featureLayer.types;if(f&&0<f.length&&(f=d.filter(f,e.hitch(this,function(a){return a.id===b})),0<f.length))return c=f[0].name}(f=this._getFieldInfo(a))&&f.domain&&(f=f.domain.codedValues)&&0<f.length&&d.some(f,function(a){return a.code===b?(c=a.name,!0):!1});return c},_getFieldAliasArray:function(a){return d.map(a,e.hitch(this,function(a){return this._getFieldAlias(a)}))},_getFieldAlias:function(a){var b=a;(a=this._getFieldInfo(a))&&
(b=a.alias||b);return b},_getFieldInfo:function(a){if(this.featureLayer)for(var b=this.featureLayer.fields,c=0;c<b.length;c++)if(b[c].name===a)return b[c];return null},_isNumberField:function(a){var b=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return d.some(this.featureLayer.fields,e.hitch(this,function(c){return c.name===a&&0<=b.indexOf(c.type)}))},_isFloatNumberField:function(a){var b=["esriFieldTypeSingle","esriFieldTypeDouble"];return d.some(this.featureLayer.fields,
e.hitch(this,function(c){return c.name===a&&0<=b.indexOf(c.type)}))},_isDateField:function(a){return(a=this._getFieldInfo(a))?"esriFieldTypeDate"===a.type:!1},_getBestDecimalPlace:function(a){var b=0,c={};d.forEach(a,function(a){a=a.toString().split(".");var b=null;1===a.length?b=0:2===a.length&&(b=a[1].length);null!==b&&(c[b]=void 0===c[b]?1:c[b]+1)});a=null;for(var f in c){f=parseInt(f,10);var e=c[f];a?e>a.value&&(a={key:f,value:e}):a={key:f,value:e}}a&&(b=parseInt(a.key,10));return b},_getFloatNumberFieldDecimalPlace:function(a){var b=
0;this.floatNumberFieldDecimalPlace&&(a=this.floatNumberFieldDecimalPlace[a],"number"===typeof a&&(b=a));return b},_getBestValueForFloatNumberField:function(a,b){var c=this._getFloatNumberFieldDecimalPlace(b),c=a.toFixed(c);return parseFloat(c)},_getColors:function(a,b){var c=[],f=e.clone(a);if(2===f.colors.length)c=this._createGradientColors(f.colors[0],f.colors[f.colors.length-1],b);else{for(var d=Math.ceil(b/f.colors.length),k=0;k<d;k++)c=c.concat(f.colors);c=c.slice(0,b)}return c},_createGradientColors:function(a,
b,c){var f=[];a=new m(a);var d=new m(b);b=(d.r-a.r)/c;for(var e=(d.g-a.g)/c,d=(d.b-a.b)/c,k=new m,q=0,r=0,w=0,g=0;g<c;g++)q=parseInt(a.r+b*g,10),r=parseInt(a.g+e*g,10),w=parseInt(a.b+d*g,10),k.setColor([q,r,w]),f.push(k.toHex());return f},_createParamsDijit:function(a,b){return new F({isInWidget:this.map?!0:!1,type:a,config:b})},_createJimuChart:function(a,b,c,f,d){var k=d.type,q=this._createParamsDijit(k,d.display),r=q.getConfig();r&&e.mixin(d.display,r);var g=this._getBasicChartOptionsByStatisticsInfo(b,
c,f,k);this._udpateJimuChartDisplayOptions(g,d);var n=new w({chartDom:a,config:g});n.placeAt(a);this._bindChartEvent(n,b,f);this.showSettingIcon&&this.own(t(q,"change",e.hitch(this,function(){q.showShelter();if(n){var a=q.getConfig();e.mixin(d.display,a);this._udpateJimuChartDisplayOptions(g,d);n.updateConfig(g)}q.hideShelter()})));return[n,q]},_udpateJimuChartDisplayOptions:function(a,b){var c=b.type,f=b.display,k={type:c,dataZoom:["inside","slider"],confine:!0,backgroundColor:f.backgroundColor,
color:f.colors,legend:f.showLegend,theme:this.theme||"light",advanceOption:function(a){f.showLegend&&a.legend&&(a.legend.textStyle||(a.legend.textStyle={}),a.legend.textStyle.color=f.legendTextColor);"pie"===c?a.series&&0<a.series.length&&d.forEach(a.series,e.hitch(this,function(a){"pie"===a.type&&(a.label||(a.label={}),a.label.normal||(a.label.normal={}),a.label.normal.show=f.showDataLabel,a.label.normal.textStyle||(a.label.normal.textStyle={}),a.label.normal.textStyle.color=f.dataLabelColor)})):
(a.xAxis||(a.xAxis={}),a.xAxis.axisLabel||(a.xAxis.axisLabel={}),a.xAxis.axisLabel.textStyle||(a.xAxis.axisLabel.textStyle={}),a.xAxis.axisLabel.textStyle.color=f.horizontalAxisTextColor,a.yAxis||(a.yAxis={}),a.yAxis.axisLabel||(a.yAxis.axisLabel={}),a.yAxis.axisLabel.textStyle||(a.yAxis.axisLabel.textStyle={}),a.yAxis.axisLabel.textStyle.color=f.verticalAxisTextColor)}};"pie"===c&&(k.labelLine=!!f.showDataLabel);e.mixin(a,k);"pie"!==c&&(a.axisPointer=!0,a.scale=!1,a.hidexAxis=!f.showHorizontalAxis,
a.hideyAxis=!f.showVerticalAxis);return a},_getBasicChartOptionsByStatisticsInfo:function(a,b,c,f){return"feature"===a||"category"===a?this._getCategoryModeChartOptionsByStatisticsInfo(b,c,f):"count"===a?this._getCountModeChartOptionsByStatisticsInfo(c,f):"field"===a?this._getFieldModeChartOptionByStatisticsInfo(c,f):null},_bindChartEvent:function(a,b,c){if(this.map&&0!==c.length){var f=e.hitch(this,function(a){if("series"===a.componentType){var f=null;(f="field"===b?this.features:c[a.dataIndex].dataFeatures)&&
("mouseover"===a.type?this._mouseOverChartItem(f):"mouseout"===a.type?this._mouseOutChartItem(f):"click"===a.type&&this.zoomToFeaturesWhenClick&&this._zoomToGraphics(f))}}),k=[{name:"mouseover",callback:f},{name:"mouseout",callback:f}];this.zoomToFeaturesWhenClick&&k.push({name:"click",callback:f});d.forEach(k,e.hitch(this,function(b){a.chart.on(b.name,b.callback)}))}},_createFeatureModeCharts:function(a,b){var c=[],f=[],k=a.config,q={layerDefinition:this.featureLayer,popupFieldInfosObj:this.popupFieldInfosObj,
features:a.features,labelField:k.labelField,valueFields:k.valueFields,sortOrder:k.sortOrder,maxLabels:k.maxLabels,useLayerSymbology:k.useLayerSymbology};this.featureLayerForChartSymbologyChart&&(q.featureLayerForChartSymbologyChart=this.featureLayerForChartSymbologyChart);var r=A.getFeatureModeStatisticsInfo(q);d.forEach(k.types,e.hitch(this,function(a,d){try{var e=this._createJimuChart(b[d],"feature",q,r,a);c.push(e[0]);f.push(e[1])}catch(x){console.error(x)}}));return{charts:c,paramsDijits:f}},
_createCategoryModeCharts:function(a,b){var c=[],f=[],k=a.config,q={layerDefinition:this.featureLayer,popupFieldInfosObj:this.popupFieldInfosObj,features:a.features,categoryField:k.categoryField,valueFields:k.valueFields,operation:a.config.operation,sortOrder:k.sortOrder,dateConfig:k.dateConfig,maxLabels:k.maxLabels,nullValue:k.nullValue,useLayerSymbology:k.useLayerSymbology};this.featureLayerForChartSymbologyChart&&(q.featureLayerForChartSymbologyChart=this.featureLayerForChartSymbologyChart);var r=
A.getCategoryModeStatisticsInfo(q);d.forEach(k.types,e.hitch(this,function(a,d){try{var e=this._createJimuChart(b[d],"category",q,r,a);c.push(e[0]);f.push(e[1])}catch(x){console.error(x)}}));return{charts:c,paramsDijits:f}},_getCategoryModeChartOptionsByStatisticsInfo:function(a,b,c){var f={type:c,labels:[],series:[]};a=this._getFieldAliasArray(a.valueFields);f.series=d.map(a,e.hitch(this,function(a){return{name:a,type:c,data:[]}}));d.forEach(b,e.hitch(this,function(a){f.labels.push(a.category);for(var c=
0;c<a.valueFields.length;c++){var d=a.valueFields[c];this._isAllFalseColor(b)||"undefined"!==typeof a.color&&(d=this._getSerieData(a,d));f.series[c].data.push(d)}}));return f},_isAllFalseColor:function(a){return a.every(function(a){return!a.color})},_getSerieData:function(a,b){a.color||(a.color="transparent",a.borderColor="#939393");var c={value:b,itemStyle:{normal:{color:a.color},emphasis:{color:a.color}}};a.borderColor&&(c.itemStyle.normal.borderColor=a.borderColor,c.itemStyle.emphasis.borderColor=
a.borderColor);return c},_createCountModeCharts:function(a,b){var c=[],f=[],k=a.config,q={layerDefinition:this.featureLayer,popupFieldInfosObj:this.popupFieldInfosObj,features:a.features,categoryField:k.categoryField,sortOrder:k.sortOrder,dateConfig:k.dateConfig,maxLabels:k.maxLabels,useLayerSymbology:k.useLayerSymbology};this.featureLayerForChartSymbologyChart&&(q.featureLayerForChartSymbologyChart=this.featureLayerForChartSymbologyChart);var w=A.getCountModeStatisticsInfo(q);d.forEach(k.types,e.hitch(this,
function(a,d){try{var e=this._createJimuChart(b[d],"count",q,w,a);c.push(e[0]);f.push(e[1])}catch(x){console.error(x)}}));return{charts:c,paramsDijits:f}},_getCountModeChartOptionsByStatisticsInfo:function(a,b){var c={type:b,labels:[],series:[{name:this._legendNls||"Legend",type:b,data:[]}]};d.forEach(a,e.hitch(this,function(b){var f=b.count;c.labels.push(b.fieldValue);this._isAllFalseColor(a)?c.series[0].data.push(f):"undefined"!==typeof b.color?(b=this._getSerieData(b,f),c.series[0].data.push(b)):
c.series[0].data.push(f)}));return c},_createFieldModeCharts:function(a,b){var c=[],f=[],k=a.config,q={layerDefinition:this.featureLayer,features:a.features,valueFields:k.valueFields,operation:k.operation,sortOrder:k.sortOrder,maxLabels:k.maxLabels,nullValue:k.nullValue},w=A.getFieldModeStatisticsInfo(q);d.forEach(k.types,e.hitch(this,function(a,d){try{var e=this._createJimuChart(b[d],"field",q,w,a);c.push(e[0]);f.push(e[1])}catch(x){console.error(x)}}));return{charts:c,paramsDijits:f}},_getFieldModeChartOptionByStatisticsInfo:function(a,
b){var c={type:b,labels:[],series:[{name:this._legendNls||"Legend",type:b,data:[]}]};d.forEach(a,e.hitch(this,function(a){var b=this._getFieldAlias(a.label);c.labels.push(b);c.series[0].data.push(a.value)}));return c}})})},"jimu/clientStatisticsUtils":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/config ./_dateFormat moment/moment jimu/utils esri/lang".split(" "),function(t,g,n,h,e,d,l,p){window.makeTwix(d);var m=t(null,{popupFieldInfosObj:null,constructor:function(c){c&&
n.mixin(this,c);this.popupFieldInfosObj||(this.popupFieldInfosObj={});this.floatNumberFieldDecimalPlace={}},_isNumber:function(c){return"[object number]"===Object.prototype.toString.call(c).toLowerCase()},_tryLocaleNumber:function(c,a){var b=c;if(p.isDefined(c)&&isFinite(c))try{var f;if(a&&this._isNumberField(a)){var d=this.popupFieldInfosObj[a];f=d&&n.exists("format.places",d)?l.localizeNumberByFieldInfo(c,d):l.localizeNumber(c)}else f=c;"string"===typeof f&&(b=f)}catch(q){console.error(q)}return b+
""},_getBestDisplayValue:function(c,a){return a||"number"===typeof a?this._isDateField(c)?this._dateFormatter(c,a):this._valueFormatter(c,a):"null"},_dateFormatter:function(c,a){var b;a:{if(this.popupFieldInfosObj&&p.isDefined(this.popupFieldInfosObj.fieldInfos)){b=0;for(var f=this.popupFieldInfosObj.fieldInfos.length;b<f;b++){var d=this.popupFieldInfosObj.fieldInfos[b];if(d.fieldName===c){b=d.format;break a}}}b=null}return l.fieldFormatter.getFormattedDate(a,b)},_valueFormatter:function(c,a){var b=
this._tryLocaleNumber(a,c);if(this.layerDefinition.typeIdField===c){var f=this.layerDefinition.types;if(f&&0<f.length&&(f=g.filter(f,n.hitch(this,function(b){return b.id===a})),0<f.length))return b=f[0].name}(f=this._getFieldInfo(c))&&f.domain&&(f=f.domain.codedValues)&&0<f.length&&g.some(f,function(c){return c.code===a?(b=c.name,!0):!1});return b},_getFieldAliasArray:function(c){return g.map(c,n.hitch(this,function(a){return this._getFieldAlias(a)}))},_getFieldAlias:function(c){var a=c;(c=this._getFieldInfo(c))&&
(a=c.alias||a);return a},_getFieldInfo:function(c){if(this.layerDefinition)for(var a=this.layerDefinition.fields,b=0;b<a.length;b++)if(a[b].name===c)return a[b];return null},_isNumberField:function(c){var a=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return g.some(this.layerDefinition.fields,n.hitch(this,function(b){return b.name===c&&0<=a.indexOf(b.type)}))},_isFloatNumberField:function(c){var a=["esriFieldTypeSingle","esriFieldTypeDouble"];return g.some(this.layerDefinition.fields,
n.hitch(this,function(b){return b.name===c&&0<=a.indexOf(b.type)}))},_isDateField:function(c){return(c=this._getFieldInfo(c))?"esriFieldTypeDate"===c.type:!1},_getBestDecimalPlace:function(c){var a=0,b={};g.forEach(c,function(a){a=a.toString().split(".");var c=null;1===a.length?c=0:2===a.length&&(c=a[1].length);null!==c&&(b[c]=void 0===b[c]?1:b[c]+1)});c=null;for(var f in b){f=parseInt(f,10);var d=b[f];c?d>c.value&&(c={key:f,value:d}):c={key:f,value:d}}c&&(a=parseInt(c.key,10));return a},_getFloatNumberFieldDecimalPlace:function(c){var a=
0;this.floatNumberFieldDecimalPlace&&(c=this.floatNumberFieldDecimalPlace[c],"number"===typeof c&&(a=c));return a},_getBestValueForFloatNumberField:function(c,a){if(null===c)return c;var b=this._getFloatNumberFieldDecimalPlace(a),b=c.toFixed(b);return parseFloat(b)},_convertToEchartsRbga:function(c){if(!c||"undefined"===typeof c.r)return c;c=JSON.parse(JSON.stringify(c));var a;a="rgba("+(c.r+",");a+=c.g+",";a+=c.b+",";return a+=c.a+")"},_addColorToChartData:function(c,a,b,f){return"feature"===c?this._addColorToFeatruesForFeatureMode(a,
b):"category"!==c&&"count"!==c?f:this._addColorToDataForCategoryCountMode(a,f)},_addColorToDataForCategoryCountMode:function(c,a){var b=c.renderer;return a=a.map(function(a){var c=a.dataFeatures[0];if(c){var f=this._getCategoryColor(b,c),c=null;"undefined"!==typeof f.color&&(a.color=f.color)}else a.color=!1;return a}.bind(this))},_getVisualVariableByType:function(c,a){if(a){var b=g.filter(a,function(a){return a.type===c&&!a.target});if(b.length)return b[0]}return null},_getCategoryColor:function(c,
a){var b=null,f={},b=this._getSymbolByRenderer(c,a),f=this._getColorFromSymbol(f,b),b=null;return f},_getSymbolByRenderer:function(c,a){var b=null,f=this._getVisualVariableByType("colorInfo",c.visualVariables);if(f){if(f=c.getColor(a,{colorInfo:f}))f=this._convertToEchartsRbga(f),b={color:f}}else b=c.getSymbol(a);b||(b={color:!1});return b},_getColorFromSymbol:function(c,a){a&&"undefined"!==typeof a.color&&(c.color=this._convertToEchartsRbga(a.color));return c},_addColorToFeatruesForFeatureMode:function(c,
a){if(!c||!Array.isArray(a))return a;var b=c.renderer;a.forEach(function(a){var c=null,f={};a.symbol&&a.symbol.color?c=a.symbol:b&&(c=this._getSymbolByRenderer(b,a));f=this._getColorFromSymbol(f,c);"undefined"!==typeof f.color&&(a.color=f.color);return a}.bind(this));return a},getFeatureModeStatisticsInfo:function(c){var a=c.features,b=c.labelField,f=c.valueFields,d=c.sortOrder,e=c.maxLabels,l=c.featureLayerForChartSymbologyChart;c=c.useLayerSymbology;var h=[],a=a.filter(function(a){var c=a.attributes[b];
if(c||"number"===typeof c)return!0;h.push(a)}).concat(h);c&&(a=this._addColorToChartData("feature",l,a));a=this._sortStatisticsInfo(a,"feature",d,b);d=[];d=g.map(a,n.hitch(this,function(a){var c=a.attributes,d={category:c[b],valueFields:[],dataFeatures:[a]};"undefined"!==typeof a.color&&(d.color=a.color,a.color=void 0);d.valueFields=g.map(f,n.hitch(this,function(a){return c[a]}));return d}));0<d.length&&d.forEach(n.hitch(this,function(a){a.category=this._getBestDisplayValue(b,a.category)}));return this._getDataForMaxLabels(d,
e)},getCategoryModeStatisticsInfo:function(c){function a(a){var b=[],c=null,k;for(k in a)c=a[k],this._isNumberField(f)&&"number"===typeof k&&p.isDefined(k)&&(k=parseFloat(k)),c.fieldsValues=g.map(d,n.hitch(this,function(a){var b=g.map(c.dataFeatures,n.hitch(this,function(b){return b.attributes[a]})),f;if(0!==b.length){f=0;"max"===e?f=-Infinity:"min"===e&&(f=Infinity);var b=B?b.map(function(a){this._isNumber(a)||(a=0);return a}.bind(this)):b.filter(function(a){return this._isNumber(a)}.bind(this)),
d=0;g.forEach(b,n.hitch(this,function(a){d++;"average"===e||"sum"===e?f+=a:"max"===e?f=Math.max(f,a):"min"===e&&(f=Math.min(f,a))}));0<d?"average"===e&&(f/=d):f=null}else f=null;return{field:a,value:f}})),c.valueFields=g.map(c.fieldsValues,function(a){return a.value}),b.push({originValue:c.originValue,category:k,valueFields:c.valueFields,fieldsValues:c.fieldsValues,dataFeatures:c.dataFeatures});return b}var b=c.features,f=c.categoryField,d=c.valueFields,e=c.operation,l=c.sortOrder,h=c.maxLabels,B=
c.nullValue,v=c.featureLayerForChartSymbologyChart,y=c.useLayerSymbology,m=[],m=this.getCategoryOrCountHashObj(f,b,c.dateConfig);c=m.nullLabelHashObj;m=a.call(this,m.notNullLabelHashObj);c=a.call(this,c);m=m.concat(c);m=this._sortStatisticsInfo(m,"category",l);m=g.filter(m,n.hitch(this,function(a){var b=!1;a=a.category;"number"===typeof a&&(b=isNaN(a));return!b}));"sum"!==e&&"average"!==e||g.forEach(m,n.hitch(this,function(a){g.forEach(d,n.hitch(this,function(b,c){if(this._isFloatNumberField(b)){var f=
a.valueFields[c],f=this._getBestValueForFloatNumberField(f,b);a.valueFields[c]=f}}))}));m=this._getDataForMaxLabels(m,h);y&&(m=this._addColorToChartData("category",v,b,m));return m},getCountModeStatisticsInfo:function(c){function a(a){var b=[],c=null,d;for(d in a)c=a[d],this._isNumberField(f)&&"number"===typeof d&&(d=parseFloat(d)),b.push({originValue:c.originValue,fieldValue:d,count:c.count,dataFeatures:c.dataFeatures});return b}var b=c.features,f=c.categoryField,d=c.sortOrder,e=c.maxLabels,g=c.featureLayerForChartSymbologyChart,
n=c.useLayerSymbology,l=[],l=this.getCategoryOrCountHashObj(f,b,c.dateConfig);c=l.nullLabelHashObj;l=a.call(this,l.notNullLabelHashObj);c=a.call(this,c);l=l.concat(c);l=this._sortStatisticsInfo(l,"count",d);l=this._getDataForMaxLabels(l,e);n&&(l=this._addColorToChartData("count",g,b,l));return l},getFieldModeStatisticsInfo:function(c){var a=c.valueFields,b=c.operation,f=c.sortOrder,d=c.maxLabels,e=c.nullValue,l=g.map(c.features,n.hitch(this,function(a){return a.attributes})),h={};g.forEach(a,n.hitch(this,
function(a){h[a]=0;"max"===b?h[a]=-Infinity:"min"===b&&(h[a]=Infinity);var c=l.map(function(b){return b[a]}),f=0,c=e?c.map(function(a){this._isNumber(a)||(a=0);return a}.bind(this)):c.filter(function(a){return this._isNumber(a)}.bind(this));g.forEach(c,n.hitch(this,function(c){f++;h.hasOwnProperty(a)?"average"===b||"sum"===b?h[a]+=c:"max"===b?h[a]=Math.max(h[a],c):"min"===b&&(h[a]=Math.min(h[a],c)):h[a]=c}));0<f?"average"===b&&(h[a]/=f):h[a]=null}));"sum"!==b&&"average"!==b||g.forEach(a,n.hitch(this,
function(a){h.hasOwnProperty(a)&&this._isFloatNumberField(a)&&(h[a]=this._getBestValueForFloatNumberField(h[a],a))}));c=[];for(var m in h)h.hasOwnProperty(m)&&c.push({label:m,value:h[m]});c=this._sortStatisticsInfo(c,"field",f);return this._getDataForMaxLabels(c,d)},_getDataForMaxLabels:function(c,a){return"number"===typeof a&&0<=a&&a<c.length?c.slice(0,a):c},_sortStatisticsInfo:function(c,a,b,f){function d(a,b,c){var d;"category"===b?c.isLabelAxis?c.isLabelAxis&&(d=a.originValue):c.field||1!==a.fieldsValues.length?
a.fieldsValues.forEach(function(a){c.field===a.field&&(d=a.value)}):d=a.fieldsValues[0].value:"count"===b?(b=a.originValue,d=c.isLabelAxis?b:a.count):"field"===b?d=c.isLabelAxis?a.label:a.value:"feature"===b&&(d=c.isLabelAxis?a.attributes[f]:a.attributes[c.field]);return d}var e=b.isAsc;if(!Array.isArray(c))return c;c.sort(function(c,f){var k=d(c,a,b),q=d(f,a,b);k||"number"===typeof k||(k=Infinity);q||"number"===typeof q||(q=Infinity);var g=0,g=(k>q?e:!e)?1:-1;k===q&&(g=0);return g});return c},_getDateUnit:function(c,
a){var b=a;if("automatic"===a){var f=d(c[0]).local(),e=d(c[1]).local(),f=Math.round(e.diff(f,"minute",!0));0<=f&&1>=f?b="second":1<f&&60>=f?b="minute":60<f&&1440>=f?b="hour":1440<f&&43200>=f?b="day":43200<f&&518400>=f?b="month":518400<f&&(b="year")}return b},_getTimeRange:function(c,a){var b=c.map(n.hitch(this,function(b){return b.attributes[a]})),b=b.filter(function(a){return!!a}),f=Math.min.apply(Math,b),b=Math.max.apply(Math,b);return[f,b]},_getTimeTwixs:function(c,a,b){if(0>"year month day hour minute second automatic".split(" ").indexOf(b))return console.log("Invaild data formatter: "+
b),!1;c=this._getTimeRange(c,a);if(c[0]===c[1])return!1;b=this._getDateUnit(c,b);a=this._getIntegerDateByUnit(c[0],b);a=d(a).local();c=d(c[1]).local();c=a.twix(c).split(1,b);a={startValue:c[c.length-1].end().valueOf(),endValue:Infinity};c.push(a);return{twixs:c,dateUnit:b}},_getIntegerDateByUnit:function(c,a){var b=d(c),f;f=b.year();var e=b.month(),q=b.date(),g=b.hour(),h=b.minute(),b=b.second();switch(a){case "year":f=d({year:f}).valueOf();break;case "month":f=d({year:f,month:e}).valueOf();break;
case "day":f=d({year:f,month:e,day:q}).valueOf();break;case "hour":f=d({year:f,month:e,day:q,hour:g}).valueOf();break;case "minute":f=d({year:f,month:e,day:q,hour:g,minute:h}).valueOf();break;case "second":f=d({year:f,month:e,day:q,hour:g,minute:h,second:b}).valueOf();break;default:f=c}return f},_getDateCategory:function(c,a){return a?this._getFormatteredDate(c,a):c},_getFormatteredDate:function(c,a){var b=this._getDateTemplate(a),f,e;0<=["year","month","day"].indexOf(a)?b=l.localizeDate(new Date(c),
{selector:"date",datePattern:b.date}):(f=l.localizeDate(new Date(c),{selector:"date",datePattern:b.date}),e=d(c).format(b.time),b=f+b.connector+e);return b},_getDateTemplate:function(c){var a=e[h.locale];(a=a||{},a.date)||(a.date={"short":"short"});a&&!a.time&&(a.time={medium:"HH:mm:ss a"});a&&!a.connector&&(a.connector=" ");a&&!a.sNoDay&&(a.sNoDay="MMM, y");var b={};"year"===c?b.date="y":"month"===c?b.date=a.date.sNoDay:"day"===c?b.date=a.date["short"]:"hour"===c?(b.date=a.date["short"],b.time="HH a",
b.connector=a.connector):"minute"===c?(b.date=a.date["short"],b.time="HH:mm a",b.connector=a.connector):"second"===c&&(b.date=a.date["short"],b.time=a.time.medium,b.connector=a.connector);return b},getCategoryOrCountHashObj:function(c,a,b){function f(a,b,c,f){var d=a[0].attributes[b];b="automatic"!==f.minPeriod?this._getDateCategory(d,f.minPeriod):this._getBestDisplayValue(b,d);a={count:1,dataFeatures:a};a.originValue=d;c[b]=a;return c}function d(a,b,c,f){a[b]?(a=a[b],a.count+=f.count,a.dataFeatures=
a.dataFeatures.concat(f.dataFeatures)):(f.originValue=c,a[b]=f)}function e(a,b){var c={};g.forEach(a,n.hitch(this,function(a){var f=a.attributes,d=this._getBestDisplayValue(b,f[b]),e=null;c.hasOwnProperty(d)?(e=c[d],e.dataFeatures.push(a),e.count++):(e={count:1,dataFeatures:[a]},e.originValue=f[b],c[d]=e)}));return c}var h=[],l=a.filter(function(a){var b=a.attributes[c];if(b||"number"===typeof b)return!0;h.push(a)}),m={};a={};if(b)if(1===l.length)m=f.call(this,l,c,m,b);else{if(0!==l.length)if(a=this._getTimeTwixs(l,
c,b.minPeriod)){var p=a.dateUnit;a.twixs.forEach(function(a){var f="undefined"!==typeof a.startValue?a.startValue:a.start().valueOf(),e="undefined"!==typeof a.endValue?a.endValue:a.end().valueOf();a=this._getDateCategory(f,p);var k={count:0,dataFeatures:[]};g.forEach(l,n.hitch(this,function(a){var b=a.attributes[c];b>=f&&b<e&&(k.dataFeatures.push(a),k.count++)}));b.isNeedFilled?d.call(this,m,a,f,k):0<k.count&&d.call(this,m,a,f,k)}.bind(this))}else m=f.call(this,l,c,m,b)}else m=e.call(this,l,c);a=
e.call(this,h,c);return{notNullLabelHashObj:m,nullLabelHashObj:a}}});return{getFeatureModeStatisticsInfo:function(c){return(new m({layerDefinition:c.layerDefinition,popupFieldInfosObj:c.popupFieldInfosObj})).getFeatureModeStatisticsInfo(c)},getCategoryModeStatisticsInfo:function(c){return(new m({layerDefinition:c.layerDefinition,popupFieldInfosObj:c.popupFieldInfosObj})).getCategoryModeStatisticsInfo(c)},getCountModeStatisticsInfo:function(c){return(new m({layerDefinition:c.layerDefinition,popupFieldInfosObj:c.popupFieldInfosObj})).getCountModeStatisticsInfo(c)},
getFieldModeStatisticsInfo:function(c){return(new m({layerDefinition:c.layerDefinition})).getFieldModeStatisticsInfo(c)}}})},"jimu/_dateFormat":function(){define([],function(){return{ar:{date:{"short":"d/M/y",medium:"dd/MM/y","long":"d MMMM. y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"M/y"},time:{"short":"h:mm a",medium:"h:mm:ss a"}},bs:{date:{"short":"d.M.yy.",medium:"d. MMM. y.","long":"d. MMMM y.",onlyDate:"d. MMM.",mNoDay:"MMM. y.",sNoDay:"M.yy"}},cs:{date:{"short":"dd.MM.yy",medium:"d. M. y",onlyDate:"d. M.",
mNoDay:"M. y",sNoDay:"MM.yy"}},da:{date:{"short":"dd/MM/y",medium:"d. MMM y","long":"d. MMMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM/y"}},de:{date:{"short":"dd.MM.yy",medium:"dd.MM.y",onlyDate:"dd.MM."},connector:" , ",mNoDay:"MM.y",sNoDay:"MM.yy"},el:{date:{"short":"d/M/yy",medium:"d MMM y",onlyDate:"d MMM"},connector:" , ",mNoDay:"MMM y",sNoDay:"M/yy"},en:{date:{"short":"M/d/yy",medium:"MMM d, y",onlyDate:"MMM d",mNoDay:"MMM, y",sNoDay:"M/yy"}},es:{date:{"short":"d/M/yy",medium:"d MMM y",
onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"M/yy"}},et:{date:{"short":"d.MM.y",medium:"d. MMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM.y"},time:{"short":"H:mm",medium:"H:mm:ss"}},fi:{date:{"short":"d.M.y",medium:"d.M.y",onlyDate:"d.M.",mNoDay:"M.y",sNoDay:"M.y"},connector:" 'klo' "},fr:{date:{"short":"dd/MM/y",medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM/y"},connector:" '\u00e0' "},he:{date:{"short":"dd/MM/yy",medium:"d '\u05d1'MMM y",onlyDate:"d '\u05d1'MMM",mNoDay:"'\u05d1'MMM y",
sNoDay:"MM/yy"},connector:" , "},hi:{date:{"short":"d/M/yy",medium:"dd/MM/y","long":"d MMMM y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"M/yy"},time:{"short":"h:mm a",medium:"h:mm:ss a",sNoDay:""},connector:" , "},hr:{date:{"short":"d.M.y",medium:"d. MMM y.",onlyDate:"d. MMM",mNoDay:"MMM y.",sNoDay:"M.y"}},id:{"short":"dd/MM/yy",date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM/yy"}},it:{date:{medium:"dd MMM y","long":"d MMMM y",onlyDate:"dd MMM",mNoDay:"MMM y",sNoDay:"MM/yy"},connector:" , "},
ja:{date:{medium:"y/MM/dd",onlyDate:"MM/dd",mNoDay:"y/MM",sNoDay:"y/MM"},time:{"short":"a h:mm",medium:"a h:mm:ss"}},ko:{date:{medium:"y. M. d.",onlyDate:"M. d.",mNoDay:"y. M.",sNoDay:"yy. M."}},lt:{date:{medium:"y-MM-dd","long":"y 'm'. MMMM d 'd'.",onlyDate:"MM-dd",mNoDay:"y-MM",sNoDay:"y-MM"},time:{medium:"HH:mm:ss"}},lv:{date:{"short":"dd.MM.y",medium:"y. 'gada' d. MMM.","long":"y. 'gada' d. MMMM",onlyDate:"d. MMM.",mNoDay:"y. 'gada' MMM.",sNoDay:"MM.y"}},nb:{date:{"short":"dd.MM.y",medium:"d. MMM y",
"long":"d. MMMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM.y"},time:{"short":"HH:mm",medium:"HH:mm:ss"},connector:" , "},nl:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM-yy"}},pl:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"},connector:" , "},"pt-br":{date:{"short":"dd/MM/y",medium:"d 'de' MMM 'de' y",onlyDate:"d 'de' MMM",mNoDay:"MMM 'de' y",sNoDay:"MM/y"}},"pt-pt":{date:{medium:"dd/MM/y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"MM/yy"}},ro:{date:{medium:"d MMM y",
onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"},connector:" , "},ru:{date:{"short":"dd.MM.y",medium:"d MMM y '\u0433.'",onlyDate:"d MMM",mNoDay:"MMM y '\u0433.'",sNoDay:"MM.y"},connector:" , "},sr:{date:{medium:"dd.MM.y.",onlyDate:"dd.MM.",mNoDay:"MM.y.",sNoDay:"M.yy."},time:{"short":"HH:mm",medium:"HH:mm:ss"}},sv:{date:{medium:"d MMM. y",onlyDate:"d MMM.",mNoDay:"MMM. y",sNoDay:"y-MM"}},th:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"M/yy"}},tr:{date:{medium:"d MMM y",onlyDate:"d MMM",
mNoDay:"MMM y",sNoDay:"MM.y"}},vi:{date:{"short":"dd/MM/y",medium:"d MMM, y","long":"'Ng\u00e0y' dd 'th\u00e1ng' MM 'n\u0103m' y",onlyDate:"d MMM",mNoDay:"MMM, y",sNoDay:"MM/y"},time:{"short":"hh:mm a",medium:"hh:mm:ss a"},connector:" , "},"zh-cn":{date:{"short":"y/M/d",medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"y/M"}},"zh-hk":{date:{medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"M/y"}},
"zh-tw":{date:{medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"y/M"}}}})},"jimu/dijit/Chart":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/dom-style dojo/dom-geometry dojo/Evented libs/echarts/echarts jimu/utils ./_chartUtils ./_Gauge libs/echarts/light libs/echarts/dark".split(" "),function(t,g,n,h,e,d,l,p,m,c){return t([g,d],{baseClass:"jimu-dijit-chart",templateString:"\x3cdiv\x3e\x3c/div\x3e",declaredClass:"jimu.dijit.chart",
config:null,validConfig:{type:"column bar line pie radar funnel gauge".split(" "),common:"type title labels legend confine toolbox color theme backgroundColor scale dataZoom events series advanceOption".split(" "),axisChart:["stack","axisPointer","hidexAxis","hideyAxis"],pie:["innerRadius","labelLine"],funnel:["min","max","funnelSort"],gauge:["shape","min","max","gaugeOption"],radar:["radarShape","indicator"]},defaultConfiguration:{series:{pieSeries:[{type:"pie",radius:[0,"70%"],labelLine:{normal:{show:!0,
length:5,length2:5}},data:[]}],funnelSeries:[{type:"funnel",minSize:"0%",maxSize:"100%",sort:"descending",data:[]}]},toolboxs:{dataView:{title:"Data view",readOnly:!1},magicType:{title:{line:"switch to line",bar:"switch to bar",stack:"switch to stack",tiled:"switch to tiled"},type:["line","bar","stack","tiled"]},restore:{title:"restore"},saveAsImage:{title:"save as image"}}},postCreate:function(){this.inherited(arguments);if(this.chartDom){var a=e.getMarginBox(this.chartDom);0===a.w&&(a.w=10);0===
a.h&&(a.h=10);h.set(this.domNode,{width:a.w+"px",height:a.h+"px"})}else console.warn("No valid chart dom!"),h.set(this.domNode,{width:"10px",height:"10px"});this.gauge=new c;this.chart=l.init(this.domNode,this.config.theme||"light");this.gauge.setChart(this.chart);this.setConfig()},updateConfig:function(a){return p.isNotEmptyObject(a)?(n.mixin(this.config,a),a=this._chartFactory(this.config),this.chart.setOption(a),this.config.shape&&"curved"!==this.config.shape&&this.gauge._resetGraphic(this.config),
!0):!1},setConfig:function(a){p.isNotEmptyObject(a)?this.config=a:this.config=this.config||{};if(!this._checkConfig(this.config))return!1;this._customTheme();this.clear();this.chart.setOption(this._chartFactory(this.config));this._resize();return!0},_showInitChart:function(a){var b;b="column"===a.type||"horizontal"===a.shape||"vertical"===a.shape?"bar":a.type;var c={series:[{data:[{name:"0",value:0}]}]};m.isAxisChart(a)&&(c.xAxis={data:["0"]},c.yAxis={});c.series[0].type=b;this.chart.setOption(c,
!1)},_mockChartDataWhenNoData:function(a){a&&Array.isArray(a.labels)&&0===a.labels.length&&(a.labels.push(0),a&&Array.isArray(a.series)&&0<a.series.length&&a.series.forEach(function(a){a&&Array.isArray(a.data)&&0===a.data.length&&a.data.push(0)}));return a},_chartFactory:function(a){a=this._mockChartDataWhenNoData(a);var b=this.chart.getWidth();a=n.clone(a);var c=n.clone(this.defaultConfiguration),d=this.option={},d=this._settingDefaultGrid(d,a),d=this._settingRenderOption(d,a),d=this._settingTitle(d,
a),d=this._settingBackgroundColor(d,a),d=this._settingColor(d,a),d=this._settingToolTip(d,a);m.isAxisChart(a)?(d=this._settingAxisChartAxis(d,a),d=this._settingToolBox(d,a,c),d=this._settingSeries(d,a),d=this._settingStack(d,a),d=this._settingAxisDisplay(d,a)):m.isAxisChart(a)||(d=this._settingToolBox(d,a,c,"magicType"),d=this._settingNoAxisCharts(d,a,c));d=this._settingLegend(d,a);d=this._settingScale(d,a);d=this._handleChartRtl(d,a);d=this._avoidTitleToolBoxOverlap(d,a);d=this._pieChartAvoidLegendLabelOverLap(d,
a);d=this._settingFixedPosition(d,a,b);d=this._settingAdvanceOption(d,a);d=this._avoidAdjoiningColorSameForPie(d,a);this._bindEvents(a);return d},_avoidAdjoiningColorSameForPie:function(a,b){if("pie"!==b.type||!a.color||2>=a.color.length)return a;p.isNotEmptyObject(a.series,!0)&&a.series.forEach(n.hitch(this,function(b){var c=b.data.length;0===(c-1)%a.color.length&&(b=b.data[c-1],b.itemStyle||(b.itemStyle={}),b.itemStyle.normal||(b.itemStyle.normal={}),b.itemStyle.normal.color||(b.itemStyle.normal.color=
a.color[1]))}));return a},_pieChartAvoidLegendLabelOverLap:function(a,b){if("pie"!==b.type)return a;var c=b.labelLine?.75:.85;b.legend&&(c-=.12);a.series[0].radius[1]=100*c+"%";return a},_settingDefaultGrid:function(a,b){m.isAxisChart(b)&&(a.grid={top:20,bottom:10,left:10,right:10,containLabel:!0});return a},_settingRenderOption:function(a,b){if("curved"===b.shape)return a.animationThreshold=99999999,a.hoverLayerThreshold=99999,a.progressiveThreshold=99999,a;a.hoverLayerThreshold=500;a.progressiveThreshold=
500;a.progressive=100;a.animationThreshold=500;return a},clear:function(){this.chart.clear()},resize:function(a,b){h.set(this.domNode,{width:a||"100%",height:b||"100%"});this.chart.resize();this._resize()},_resize:function(){this.config.shape&&"curved"!==this.config.shape&&(this.gauge._resetGrid(this.config),this.gauge._resetGraphic(this.config))},_settingFixedPosition:function(a,b,c){b.shape||this._showInitChart(b);m.isAxisChart(b)&&(a=this._settingDataZoom(a,b,c),a=this._settingGrid(a,b));return a},
destroy:function(){this.chart.clear();p.isNotEmptyObject(this.config.events)&&this.config.events.forEach(n.hitch(this,function(a){this.chart.off(a.name)}));this.inherited(arguments)},_settingAxisDisplay:function(a,b){if(!m.isAxisChart(b))return a;a.xAxis.show=!b.hidexAxis;a.yAxis.show=!b.hideyAxis;a.grid.containLabel=!b.hideyAxis;return a},_handleChartRtl:function(a,b){if(!window.isRTL)return a;if(m.isAxisChart(b)||"vertical"===b.shape||"horizontal"===b.shape)a.xAxis.inverse=!0,a.yAxis.position="right";
return a},_settingTitle:function(a,b){b.title&&(a.title={textStyle:{fontSize:16}},a.title.text=b.title);return a},_settingColor:function(a,b){p.isNotEmptyObject(b.color)&&(a.color=b.color);return a},_settingBackgroundColor:function(a,b){b.backgroundColor&&(a.backgroundColor=b.backgroundColor);return a},_settingToolTip:function(a,b){a.tooltip={};if(b.axisPointer){if(a.tooltip.trigger="axis","column"===b.type||"bar"===b.type)a.tooltip.axisPointer={type:"shadow"}}else a.tooltip.axisPointer={type:""};
return a},_settingAxisChartAxis:function(a,b){a.xAxis={};a.yAxis={};"column"===b.type||"line"===b.type&&b.labels?(a.xAxis.data=b.labels,a.xAxis.type="category"):"bar"===b.type&&b.labels&&(a.yAxis.data=b.labels,a.yAxis.type="category");return a},_settingToolBox:function(a,b,c,d){a.toolbox={};d||(d="");p.isNotEmptyObject(b.toolbox)&&(a.toolbox.feature={},b.toolbox.forEach(function(f){f!==d&&(b.stack&&(c.toolboxs.magicType.type=["line","bar","stack","tiled"]),a.toolbox.feature[f]=c.toolboxs[f])}));return a=
this._handleToolBoxRTL(a,b)},_settingSeries:function(a,b){if(p.isNotEmptyObject(b.series))p.isNotEmptyObject(a.series)||(a.series=b.series);else return console.log("No series!"),a;b.series.forEach(n.hitch(this,function(c,d){var f="",f=c.type?c.type:b.type;c.data=c.data.map(n.hitch(this,function(a,c){this._handleChartBorderWidth(a);if(m.isAxisChart(b))return a;var d={};a||"number"===typeof a?(d.value=a.value?a.value:a,a.itemStyle&&(d.itemStyle=a.itemStyle)):d.value=a;d.name=b.labels[c]||"";return d}));
a.series[d].name=c.name||"";a.series[d].type="column"===f?"bar":f;a.series[d].data=c.data}));return a},_settingNoAxisCharts:function(a,b,c){if("pie"===b.type)a=this._settingPie(a,b,c);else if("funnel"===b.type)a=this._settingFunnel(a,b,c);else if("radar"===b.type)a=this._settingRadar(a,b);else if("gauge"===b.type)return this.gauge._settingGaugeSeries(a,b);return this._settingSeries(a,b)},_settingScale:function(a,b){if(!b.scale)return a;"bar"===b.type?a.xAxis.scale=!0:"line"===b.type||"column"===b.type?
a.yAxis.scale=!0:"radar"===b.type&&(a.radar.scale=!0);return a},_settingAdvanceOption:function(a,b){b.advanceOption&&("object"===typeof b.advanceOption?n.mixin(a,b.advanceOption):"function"===typeof b.advanceOption&&b.advanceOption(a));return a},_bindEvents:function(a){p.isNotEmptyObject(a.events)&&a.events.forEach(n.hitch(this,function(a){this.chart.on(a.name,a.callback)}))},_settingLegend:function(a,b){if(!b.legend)return a;a.legend={type:"scroll",orient:"horizontal",x:"left",pageButtonPosition:"end",
pageTextStyle:{color:"#939393"},bottom:20,y:"bottom",data:[]};m.isAxisChart(b)||"gauge"===b.type?a.series.forEach(function(b){a.legend.data.push(b.name)}):"pie"!==b.type&&"funnel"!==b.type&&"radar"!==b.type||a.series[0].data.forEach(function(b){a.legend.data.push(b.name)});return a=this._handleLegendRTL(a,b)},_handleDataZoomStyle:function(a,b){b.showDataShadow=!1;b.realtime=!1;b.bottom=a.legend?30:"auto";"bar"===a.type&&a.legend&&(b.bottom=50);return b},_showDataZoom:function(a,b,c){c=c||this.chart.getWidth();
var d=b.series[0].data.length*b.series.length,f=m.getAxisZeroPosition.call(this,b);c="bar"!==b.type?window.isRTL?f.left:c-f.left-a.grid.right:f.top;this.showDataZoom=8>c/d;var e=c/(8*d),e=parseFloat(100*e,10).toFixed(3),e=100<e?100:e,e=0===e?.1:e;c=[];var g="bar"===b.type?"xAxis":"yAxis",h="bar"===b.type?"yAxisIndex":"xAxisIndex",l="bar"===b.type?"width":"height";a=this._initAxisOfDataZoom(a,g);c=b.dataZoom.map(n.hitch(this,function(a){a={type:a,start:0,show:this.showDataZoom};a[h]=[0];a[l]=15;a.end=
e;"xAxis"===g&&window.isRTL&&(a.left="10");return a=this._handleDataZoomStyle(b,a)}));a.dataZoom=c;return a},_settingDataZoom:function(a,b,c){if(!p.isNotEmptyObject(b.dataZoom))return{dataZoom:[]};b.dataZoom?a=this._showDataZoom(a,b,c):(this.showDataZoom=!1,a.dataZoom=[]);return a},_avoidTitleToolBoxOverlap:function(a,b){if("gauge"===b.type)return a;var c=10;b.title&&(c+=20);p.isNotEmptyObject(b.toolbox,!0)&&(c+=20);p.isNotEmptyObject(b.toolbox,!0)&&b.title&&(a.toolbox.top=20);m.isAxisChart(b)&&a.grid&&
(a.grid.top=c);return a},_settingGrid:function(a,b){if(!m.isAxisChart(b))return a;var c=10;b.title&&(c+=20);p.isNotEmptyObject(b.toolbox,!0)&&(c+=20);p.isNotEmptyObject(b.toolbox,!0)&&b.title&&(a.toolbox.top=20);a.grid&&(a.grid.top=c);var c=10,d=43;b.hideyAxis&&(c=20,d=63);var e=0,g=10;b.legend&&(e=this.showDataZoom?10:20,g+=20);"line"===b.type&&b.legend&&!this.showDataZoom&&(c+=7);"bar"===b.type?(window.isRTL?a.grid.left=this.showDataZoom?30:10:a.grid.right=this.showDataZoom?30:10,b.hideyAxis&&b.legend&&
(g+=20),a.grid.bottom=g):a.grid.bottom=this.showDataZoom?d+e:c+e;return a},_handleLegendRTL:function(a,b){if(!b.legend)return a;var c={};window.isRTL?(c.x="right",c.pageButtonPosition="start"):(c.x="left",c.pageButtonPosition="end");a.legend=n.mixin(a.legend,c);return a},_handleToolBoxRTL:function(a,b){if(!b.toolbox)return a;var c={top:0};window.isRTL?c.right=0:c.left=0;a.toolbox=n.mixin(a.toolbox,c);return a},_initAxisOfDataZoom:function(a,b){a[b].type="value";a.xAxis.splitLine={show:!0,lineStyle:{type:"dashed"}};
a.yAxis.splitLine={show:!0,lineStyle:{type:"dashed"}};return a},_settingStack:function(a,b){if(!m.isAxisChart(b))return a;a.series=a.series.map(function(a){b.stack&&(a.stack="stack","line"===b.type&&(a.areaStyle={normal:{}},a.smooth=!0));return a});return a},_settingPie:function(a,b,c){if("pie"!==b.type)return a;a.series=c.series.pieSeries;b.innerRadius&&(a.series[0].radius[0]=b.innerRadius);a.series[0].labelLine.normal.show="undefined"===typeof b.labelLine?!0:b.labelLine;return a},_settingFunnel:function(a,
b,c){if("funnel"!==b.type)return a;a.series=c.series.funnelSeries;p.isNotEmptyObject(b.funnel)&&(a.series[0].min=b.min||0,a.series[0].max=b.max||100,a.series[0].sort=b.funnelSort||"descending");return a},_settingRadar:function(a,b){if("radar"!==b.type)return a;a.radar={nameGap:6,radius:"70%"};b.radarShape&&(a.radar.shape=b.radarShape);b.indicator?a.radar.indicator=b.indicator:console.error("No radar indicator");a.series=[{}];a.series[0].label={normal:{show:!0,formatter:function(a){return m.tryLocaleNumber(a.value)}}};
var c=[];b.series[0].data.forEach(function(a,d){c[d]={tooltip:"\x3cspan\x3e"+b.labels[d]+"\x3c/span\x3e"};a.forEach(function(a,f){c[d].tooltip+="\x3cbr/\x3e\x3cspan\x3e"+b.indicator[f].name+"\x3c/span\x3e : \x3cspan\x3e"+a+"\x3c/span\x3e"})});a.tooltip={trigger:"item",formatter:function(a){return'\x3cspan class\x3d"colorEl marginRight5" style\x3d"background-color:'+p.encodeHTML(a.color)+'"\x3e\x3c/span\x3e'+c[a.dataIndex].tooltip}};this.config.confine&&(a.tooltipconfine=!0);return a},_handleChartBorderWidth:function(a){var b=
!1;a&&a.itemStyle&&a.itemStyle.normal&&"undefined"!==typeof a.itemStyle.normal.borderColor&&(b=!0);p.isNotEmptyObject(this.chart._theme)||(this.chart._theme={});a=this.chart._theme;var c=0;b&&(c=.3);a.bar&&a.bar.itemStyle&&(a.bar.itemStyle.normal&&(a.bar.itemStyle.normal.barBorderWidth=c),a.bar.itemStyle.emphasis&&(a.bar.itemStyle.emphasis.barBorderWidth=c));a.pie&&a.pie.itemStyle&&(a.pie.itemStyle.normal&&(a.pie.itemStyle.normal.borderWidth=c),a.pie.itemStyle.emphasis&&(a.pie.itemStyle.emphasis.borderWidth=
c))},_customTheme:function(){p.isNotEmptyObject(this.chart._theme)||(this.chart._theme={});p.isNotEmptyObject(this.config.color)&&(this.chart._theme.color=this.config.color);p.isNotEmptyObject(this.chart._theme.tooltip)||(this.chart._theme.tooltip={});this.config.confine&&(this.chart._theme.tooltip.confine=!0);this.chart._theme.tooltip.axisPointer={type:"cross",label:{show:!0,precision:2,formatter:function(a){return"number"===typeof a.value?(a=parseFloat(a.value).toFixed(2),m.tryLocaleNumber(a)):
a.value}},lineStyle:{color:"#27727B",type:"dashed"},crossStyle:{color:"#27727B"},shadowStyle:{color:"rgba(200,200,200,0.3)"}};this.chart._theme.tooltip.formatter=function(a){return m.handleToolTip(a,null,!0)}.bind(this);p.isNotEmptyObject(this.chart._theme.valueAxis)||(this.chart._theme.valueAxis={});p.isNotEmptyObject(this.chart._theme.valueAxis.axisLabel)||(this.chart._theme.valueAxis.axisLabel={});this.chart._theme.valueAxis.axisLabel.formatter=function(a){return p.localizeNumber(a)}},_checkConfig:function(a){var b=
!0;p.isNotEmptyObject(a)||(console.error("Empty config"),b=!1);if(!a.type||0>this.validConfig.type.indexOf(a.type))console.error("Invaild chart type!"),b=!1;var c=n.clone(this.validConfig),d=c.common,e=[],e="column"===a.type||"bar"===a.type||"line"===a.type?d.concat(c.axisChart):d.concat(c[a.type]);Object.keys(a).forEach(function(a){0>e.indexOf(a)&&(b=!1,console.error("Invalid configuration parameter: "+a))});return b}})})},"jimu/dijit/_chartUtils":function(){define(["jimu/utils","esri/lang","dojo/_base/config"],
function(t,g){return{tryLocaleNumber:function(n){var h=n;if(g.isDefined(n)&&isFinite(n))try{var e=t.localizeNumber(n);"string"===typeof e&&(h=e)}catch(d){console.error(d)}return h+""},isAxisChart:function(g){return"column"===g.type||"bar"===g.type||"line"===g.type},getAxisZeroPosition:function(g){if(!this.chart)return!1;var h={},e=0,d=0;if((t.isNotEmptyObject(g.dataZoom,!0)||g.scale)&&g.series&&g.series[0]&&g.series[0].data){var l=g.series[0].data;t.isNotEmptyObject(l,!0)&&("bar"!==g.type?d=t.getMinOfArray(l):
e=t.getMinOfArray(l))}if(g=this.chart.convertToPixel({xAxisIndex:0,yAxisIndex:0},[e,d]))e=g[1]-5,h.left=g[0]-5,h.top=e;return t.isNotEmptyObject(h)?h:!1},generateToolTip:function(g,h,e){var d="",d=e?'\x3cdiv class\x3d"tooltip-tr reverse"\x3e':'\x3cdiv class\x3d"tooltip-tr"\x3e';e='\x3cdiv class\x3d"colorEl marginRight5" style\x3d"background-color:'+t.encodeHTML(g.color)+'"\x3e\x3c/div\x3e';d+=e;this._isVaildValue(g.seriesName)&&(d+="\x3cdiv\x3e"+g.seriesName+"\x3c/div\x3e\x3cdiv\x3e : \x3c/div\x3e");
d=this._isNotZeroBoolean(h)?d+("\x3cdiv\x3e"+this.tryLocaleNumber(h)+"\x3c/div\x3e"):this._isVaildValue(g.value)?d+("\x3cdiv\x3e"+this.tryLocaleNumber(g.value)+"\x3c/div\x3e"):d+"\x3cdiv\x3enull\x3c/div\x3e";"pie"===g.seriesType&&(d+="\x3cdiv\x3e("+g.percent+"%)\x3c/div\x3e");return d+"\x3c/div\x3e"},handleToolTip:function(g,h,e){var d='\x3cdiv class\x3d"tooltip-div"\x3e';Array.isArray(g)?(this._isVaildValue(g[0].name)&&(d+='\x3cdiv class\x3d"tr"\x3e'+g[0].name+"\x3c/div\x3e"),g.forEach(function(g){d+=
this.generateToolTip(g,h,e)}.bind(this))):(this._isVaildValue(g.name)&&(d+='\x3cdiv class\x3d"tr"\x3e'+g.name+"\x3c/div\x3e"),d+=this.generateToolTip(g,h,e));return d+="\x3c/div\x3e"},_isVaildValue:function(g){var h=!0;"%00-"===encodeURI(g)?h=!1:g||"number"===typeof g||(h=!1);return h},_isNotZeroBoolean:function(g){return 0===g?!0:!!g}}})},"jimu/dijit/_Gauge":function(){define(["dojo/_base/declare","dojo/_base/lang","jimu/utils","./_chartUtils"],function(t,g,n,h){return t([],{curvedGaugeSeries:[{type:"gauge",
center:["50%","60%"],startAngle:200,endAngle:-20,axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#E5E5E5"]]}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{distance:-52,textStyle:{color:"#000"}},pointer:{length:"65%",width:5},itemStyle:{normal:{}},detail:{show:!0,offsetCenter:[0,"60%"],textStyle:{color:"#24B5CC"}},title:{show:!1},data:[{value:0}],animationEasingUpdate:"bounceOut",animationDurationUpdate:500}],horizontalGauge:{grid:{top:"middle",height:90},xAxis:{show:!0,offset:-27,type:"value",
scale:!1,interval:1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},splitLine:{show:!1}},yAxis:{show:!1,type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{normal:{color:"#E5E5E5"}},barGap:"-100%",data:[100],z:1},{type:"bar",barWidth:30,label:{normal:{show:!0,position:"top",offset:[20,0],textStyle:{}}},data:[{value:40,
label:{normal:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}}},itemStyle:{normal:{}}}],itemStyle:{normal:{color:"#24B5CC"}},z:10}]},verticalGauge:{grid:{left:"middle",width:60},yAxis:{show:!0,offset:-10,type:"value",interval:1,scale:!1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",fontWeight:"normal"}},splitLine:{show:!1}},xAxis:{show:!1,type:"category",
data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{normal:{color:"#E5E5E5"}},barGap:"-100%",data:[100],z:1},{type:"bar",barWidth:30,label:{normal:{show:!0,position:"insideTopLeft",offset:[30,-15],textStyle:{}}},data:[{value:40,label:{normal:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}}},itemStyle:{normal:{}}}],itemStyle:{normal:{color:"#24B5CC"}},z:10}]},setChart:function(e){this.chart=e},_settingValueStyle:function(e,
d){if(d.gaugeOption&&n.isNotEmptyObject(d.gaugeOption.valueStyle)){var h=d.gaugeOption.valueStyle,p=h.textStyle,h=h.formatter;"horizontal"===d.shape||"vertical"===d.shape?(g.mixin(e.series[1].data[0].label.normal.textStyle,p),h&&(e.series[1].data[0].label.normal.formatter=h)):"curved"===d.shape&&(g.mixin(e.series[0].detail.textStyle,p),h&&(e.series[0].detail.formatter=h))}return e},_settingLabelColor:function(e,d){var g="#000";d.gaugeOption&&d.gaugeOption.labelColor&&(g=d.gaugeOption.labelColor);
"curved"===d.shape?e.series[0].axisLabel.textStyle.color=g:"horizontal"===d.shape?e.xAxis.axisLabel.textStyle.color=g:"vertical"===d.shape&&(e.yAxis.axisLabel.textStyle.color=g);return e},_settingHorizontalGauge:function(e,d){g.mixin(e,g.clone(this.horizontalGauge));e.grid={top:"middle",height:90,left:"10%",right:"10%"};d.min="undefined"!==typeof d.min&&d.min?d.min:0;d.max="undefined"!==typeof d.max&&d.max?d.max:100;e.xAxis.max=d.max;e.xAxis.min=d.min;e.xAxis.scale=!0;e.series[0].data[0]=d.max;e=
this._handleValue(e,d);d.labels&&d.labels[0]&&(e.series[1].data[0].name=d.labels[0]);e.series[1].name=d.series[0].name;e=this._settingNoCurvedGaugeColor(e,d);return e=this._handleHorizontalGaugeValueRTL(e,d)},_handleHorizontalGaugeValueRTL:function(e,d){if(!window.isRTL||"horizontal"!==d.shape)return e;e.series[1].label.normal.offset=[-20,0];return e},_settingVerticalGauge:function(e,d){g.mixin(e,g.clone(this.verticalGauge));e.grid={left:"middle",width:60,top:"10%",bottom:"10%"};e.grid.left=this._getGridLeftOfVerticalGauge();
d.min="undefined"!==typeof d.min&&d.min?d.min:0;d.max="undefined"!==typeof d.max&&d.max?d.max:100;e.yAxis.max=d.max;e.yAxis.min=d.min;e.series[0].data[0]=d.max;e=this._handleValue(e,d);d.labels&&d.labels[0]&&(e.series[1].data[0].name=d.labels[0]);e.series[1].name=d.series[0].name;e=this._settingNoCurvedGaugeColor(e,d);return e=this._handleVerticalGaugeValueRTL(e,d)},_handleVerticalGaugeValueRTL:function(e,d){if(!window.isRTL||"vertical"!==d.shape)return e;var g=(d.series[0].data[0]+"").length-1;d.gaugeOption&&
d.gaugeOption.valueStyle&&"undefined"!==typeof d.gaugeOption.valueStyle.decimalPlaces&&(g+=d.gaugeOption.valueStyle.decimalPlaces);e.series[1].label.normal.offset=[-17-9*g,-15];return e},_handleValue:function(e,d){var g;g=d.series[0].data[0]<=d.max?d.series[0].data[0]:d.max;e.tooltip.formatter=function(e){return h.handleToolTip(e,d.series[0].data[0],!1)};e.series[1].data[0].value=g;return e},_settingCurvedGauge:function(e,d){e.series=g.clone(this.curvedGaugeSeries);d.min="undefined"!==typeof d.min&&
d.min?d.min:0;d.max="undefined"!==typeof d.max&&d.max?d.max:100;e.series[0].min=d.min;e.series[0].max=d.max;e.tooltip.formatter=function(d){return h.handleToolTip(d,null,!1)};e.series[0].axisLine.lineStyle.color[0][0]=parseFloat(d.series[0].data[0]/d.max).toFixed(2);e.series[0].data[0].value=d.series[0].data[0];d.labels&&d.labels[0]&&(e.series[0].data[0].name=d.labels[0]);d.series[0].name&&(e.series[0].name=d.series[0].name);e.series[0].axisLine.lineStyle.width=30;return e=this._settingCurvedGaugeColor(e,
d)},_settingGaugeSeries:function(e,d){if("gauge"!==d.type)return e;"horizontal"===d.shape?e=this._settingHorizontalGauge(e,d):"vertical"===d.shape?e=this._settingVerticalGauge(e,d):"curved"===d.shape&&(e=this._settingCurvedGauge(e,d));e=this._settingGaugeLabel(e,d);e=this._settingLabelColor(e,d);return e=this._settingValueStyle(e,d)},_resetGraphic:function(e){e=this._settingGraphic(e);this._clearGraphic();this.chart.setOption({graphic:e});this.cacheGraphic=null;this.cacheGraphic=e},_clearGraphic:function(){this.cacheGraphic&&
(this.cacheGraphic.forEach(function(e){e.$action="remove"}),this.chart.setOption({graphic:this.cacheGraphic}))},_resetGrid:function(e){e=this._settingGridLeftOfVerticalGauge(e);n.isNotEmptyObject(e)&&this.chart.setOption({grid:e})},_settingGridLeftOfVerticalGauge:function(e){return"gauge"!==e.type||"vertical"!==e.shape?{}:{left:this._getGridLeftOfVerticalGauge(),width:60,top:"10%",bottom:"10%"}},_settingCurvedGaugeColor:function(e,d){d.gaugeOption&&(d.gaugeOption.bgColor&&(e.series[0].axisLine.lineStyle.color[1][1]=
d.gaugeOption.bgColor),d.gaugeOption.columnColor&&(e.series[0].axisLine.lineStyle.color[0][1]=d.gaugeOption.columnColor));return e},_settingNoCurvedGaugeColor:function(e,d){d.gaugeOption&&(d.gaugeOption.bgColor&&(e.series[0].itemStyle.normal.color=d.gaugeOption.bgColor),d.gaugeOption.columnColor&&(e.series[1].data[0].itemStyle.normal.color=d.gaugeOption.columnColor));return e},_settingGraphic:function(e){var d=[];"gauge"===e.type&&e.gaugeOption&&("horizontal"===e.shape?d=this._settingHorizontalGraphic(e):
"vertical"===e.shape&&(d=this._settingVerticalGraphic(e)));return d},_settingHorizontalGraphic:function(e){var d="#000";e.gaugeOption&&e.gaugeOption.labelColor&&(d=e.gaugeOption.labelColor);var h=[],p=this.chart.convertToPixel({yAxisIndex:0},0),p=parseInt(p,10),p=Number(p)+16;this.cacheCriticalValues=g.clone(this.criticalValues);this.cacheCriticalValues.forEach(g.hitch(this,function(g){var c,a;"object"===typeof g?g.type&&(c=g.type,a=g.value):a=g;g=e.min||0;if(!(a>(e.max||100)||a<g)){g=this._getxAxisValueLeft(a);
var b=6*(a.toString().length-2),f=g;0<b&&(f=g-b);c||h.push({z:10,type:"image",$action:"merge",id:"wab_gid_image-"+n.getRandomString(),left:g,style:{image:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjdweCIgaGVpZ2h0PSI1cHgiIHZpZXdCb3g9IjAgMCA3IDUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkNhcmRXaWRnZXRfTGF5b3V0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg3NS4wMDAwMDAsIC0yOTcuMDAwMDAwKSIgZmlsbD0iIzkzOTM5MyI+DQogICAgICAgICAgICA8ZyBpZD0iQ2FyZDJfSG9yaXpvbnRhbEdhdWdlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3OTIuMDAwMDAwLCAxODEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikhvcml6b250YWxHYXVnZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDY2LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjguNTAwMDAwLCA0Mi41MDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMjguNTAwMDAwLCAtNDIuNTAwMDAwKSB0cmFuc2xhdGUoODYuMDAwMDAwLCAtODYuMDAwMDAwKSIgaWQ9Ik51bWJlcnMrVHJpYW5nbGVzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLjAwMDAwMCwgMC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iVHJpYW5nbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIuNTAwMDAwLCAxNzAuNTQzODAzKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtMi41MDAwMDAsIC0xNzAuNTQzODAzKSAiIHBvaW50cz0iNSAxNzAuNTQzODAzIC0xLjcwNTMwMjU3ZS0xMyAxNzQuMDQzODAzIC0xLjY5NjQyMDc4ZS0xMyAxNjcuMDQzODAzIj48L3BvbHlnb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4\x3d",
width:10,height:10},silent:!0,top:p});h.push({z:10,type:"text",$action:"merge",id:"wab_gid_text-"+n.getRandomString(),left:f,style:{text:a,fill:d,font:"normal 11px sans-serif"},silent:!0,top:p+11})}}));return h},_settingVerticalGraphic:function(e){var d="#000";e.gaugeOption&&e.gaugeOption.labelColor&&(d=e.gaugeOption.labelColor);var h=[],p=this.chart.convertToPixel({xAxisIndex:0},0),p=parseFloat(p,10).toFixed(2),p=Number(p),m="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjVweCIgaGVpZ2h0PSI4cHgiIHZpZXdCb3g9IjAgMCA1IDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkNhcmRXaWRnZXRfTGF5b3V0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg3Ni4wMDAwMDAsIC0zMjQuMDAwMDAwKSIgZmlsbD0iIzkzOTM5MyI+DQogICAgICAgICAgICA8ZyBpZD0iQ2FyZDJfSG9yaXpvbnRhbEdhdWdlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3OTIuMDAwMDAwLCAxODEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikhvcml6b250YWxHYXVnZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDY2LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjguNTAwMDAwLCA0Mi41MDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMjguNTAwMDAwLCAtNDIuNTAwMDAwKSB0cmFuc2xhdGUoODYuMDAwMDAwLCAtODYuMDAwMDAwKSIgaWQ9Ik51bWJlcnMrVHJpYW5nbGVzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLjAwMDAwMCwgMC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iVHJpYW5nbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMwLjYyODk1MiwgMTcwLjQ1ODY1NCkgcm90YXRlKC05MC4wMDAwMDApIHRyYW5zbGF0ZSgtMzAuNjI4OTUyLCAtMTcwLjQ1ODY1NCkgIiBwb2ludHM9IjMzLjEyODk1MjMgMTcwLjQ1ODY1NCAyOC4xMjg5NTIzIDE3My45NTg2NTQgMjguMTI4OTUyMyAxNjYuOTU4NjU0Ij48L3BvbHlnb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4\x3d";
window.isRTL&&(p+=40,m="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjVweCIgaGVpZ2h0PSI3cHgiIHZpZXdCb3g9IjAgMCA1IDciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkFydGJvYXJkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTIxLjAwMDAwMCwgLTQ0Ny4wMDAwMDApIiBmaWxsPSIjOTM5MzkzIj4NCiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJUcmlhbmdsZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIzLjUwMDAwMCwgNDUwLjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTEyMy41MDAwMDAsIC00NTAuNTAwMDAwKSAiIHBvaW50cz0iMTI2IDQ1MC41IDEyMSA0NTQgMTIxIDQ0NyI+PC9wb2x5Z29uPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+");
var c=p-26;this.cacheCriticalValues=g.clone(this.criticalValues);this.cacheCriticalValues.forEach(g.hitch(this,function(a){var b,f;"object"===typeof a?a.type&&(b=a.type,f=a.value):f=a;a=c;a=window.isRTL?c+11:c-11-6*(f.toString().length-1);var g=e.min||0;f>(e.max||100)||f<g||(g=this._getyAxisValueTop(f),g-=2,b||h.push({z:10,type:"image",$action:"merge",id:"wab_gid_image-"+n.getRandomString(),left:c,style:{image:m,width:10,height:10},silent:!0,top:g}),h.push({z:10,type:"text",$action:"merge",id:"wab_gid_text-"+
n.getRandomString(),left:a,style:{text:f,fill:d,font:"normal 11px sans-serif"},silent:!0,top:g-2}))}));return h},_getGridLeftOfVerticalGauge:function(){return this.chart.getWidth()/2-30},_getxAxisValueLeft:function(e){e=this.chart.convertToPixel({xAxisIndex:0},e);return parseFloat(e,10)-4},_getyAxisValueTop:function(e){e=this.chart.convertToPixel({yAxisIndex:0},e);return parseFloat(e,10)},_showSpecialLabel:function(e,d,g){var h=((d.max||100)-(d.min||0))/1E3;g.sort(function(c,a){return c-a});var l=
function(c){var a;g.forEach(function(b){"undefined"===typeof a&&b>=c&&b<c+h&&(a=b)});return a};"curved"===d.shape?e.series[0].axisLabel.formatter=l:"horizontal"===d.shape?e.xAxis.axisLabel.formatter=l:"vertical"===d.shape&&(e.yAxis.axisLabel.formatter=l);return e},_settingGaugeLabel:function(e,d){var h=d.min||0,n=d.max||100,m=[];d.gaugeOption&&d.gaugeOption.showTargetValueLabel&&("curved"===d.shape&&(e.series[0].splitNumber=1E3,e.series[0].axisTick.splitNumber=1,e.series[0].axisTick.show=!1),d.gaugeOption.targetValue&&
d.gaugeOption.targetValue.forEach(function(c){m.push(c)}));this.criticalValues=g.clone(m);d.gaugeOption&&d.gaugeOption.showDataRangeLabel&&(0>m.indexOf(h)&&(m.push(h),this.criticalValues.push({type:"min",value:h})),0>m.indexOf(n)&&(m.push(n),this.criticalValues.push({type:"max",value:n})));return"curved"===d.shape?this._showSpecialLabel(e,d,m):e}})})},"libs/echarts/light":function(){(function(t,g){"function"===typeof define&&define.amd?define(["exports","./echarts"],g):"object"===typeof exports&&
"string"!==typeof exports.nodeName?g(exports,require("./echarts")):g({},t.echarts)})(this,function(t,g){g?g.registerTheme("light",{color:"#2ec7c9 #b6a2de #5ab1ef #ffb980 #d87a80 #8d98b3 #e5cf0d #97b552 #95706d #dc69aa #07a2a4 #9a7fd1 #588dd5 #f5994e #c05050 #59678c #c9ab00 #7eb00a #6f5553 #c14089".split(" "),textStyle:{},title:{textStyle:{color:"#008acd"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{normal:{borderWidth:1}},lineStyle:{normal:{width:"1"}},symbolSize:"10",symbol:"circle",smooth:!1},
radar:{itemStyle:{normal:{borderWidth:1}},lineStyle:{normal:{width:"1"}},symbolSize:"6",symbol:"circle",smooth:!1},bar:{itemStyle:{normal:{barBorderColor:"#ccc"},emphasis:{barBorderColor:"#ccc"}}},pie:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},funnel:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#E5E5E5"]]}},itemStyle:{normal:{color:"#686868"},
emphasis:{color:"#686868"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},splitLine:{show:!0,
lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#2ec7c9"},emphasis:{borderColor:"#18a4a6"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#008acd",width:"1"},crossStyle:{color:"#008acd",width:"1"}}},dataZoom:{backgroundColor:"#F4F4F4",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#E0E0E0",handleColor:"#777777",handleSize:"100%",
borderColor:"#F4F4F4",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"libs/echarts/dark":function(){(function(t,g){"function"===typeof define&&define.amd?define(["exports","./echarts"],g):"object"===typeof exports&&"string"!==typeof exports.nodeName?g(exports,require("./echarts")):g({},t.echarts)})(this,function(t,g){g?g.registerTheme("dark",{color:"#fc97af #87f7cf #f7f494 #72ccff #f7c5a0 #d4a4eb #d2f5a6 #76f2f2".split(" "),
textStyle:{},title:{textStyle:{color:"#ffffff"},subtextStyle:{color:"#dddddd"}},line:{itemStyle:{normal:{borderWidth:"1"}},lineStyle:{normal:{width:"1"}},symbolSize:"10",symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{borderWidth:"1"}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},bar:{itemStyle:{normal:{barBorderColor:"#ccc"},emphasis:{barBorderColor:"#ccc"}}},pie:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},funnel:{itemStyle:{normal:{borderWidth:0,
borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#1E5F6F"]]}},itemStyle:{normal:{color:"#D9D9D9"},emphasis:{color:"#D9D9D9"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},
valueAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",
width:1}}},dataZoom:{backgroundColor:"#525252",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#737373",handleColor:"#BDBDBD",handleSize:"100%",borderColor:"#525252",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"jimu/dijit/_StatisticsChartSettings":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/Color dojo/on dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_StatisticsChartSettings.html dijit/ColorPalette jimu/utils".split(" "),
function(t,g,n,h,e,d,l,p,m,c,a,b,f,k){return t([m,c,a,p],{baseClass:"jimu-dijit-statistics-chart-settings",templateString:b,colors:{c1:"#5d9cd3 #eb7b3a #a5a5a5 #febf29 #4673c2 #72ad4c".split(" "),c2:"#5d9cd3 #a5a5a5 #4673c2 #285f8f #636363 #274577".split(" "),c3:"#eb7b3a #febf29 #72ad4c #9c4618 #987214 44682e".split(" "),c4:"#72ad4c #4673c2 #febf29 #44682e #274577 #987214".split(" "),g1:["#43729b","#c4d5ea"],g2:["#ac5928","#f5ccbf"],g3:["#787878","#d8d8d8"],g4:["#bb8b1b","#fee1be"],g5:["#30538d",
"#c0c9e3"],g6:["#517e36","#c9dbc2"],g7:["#c4d5ea","#43729b"],g8:["#f5ccbf","#ac5928"],g9:["#d8d8d8","#787878"],g10:["#fee1be","#bb8b1b"],g11:["#c0c9e3","#30538d"],g12:["#c9dbc2","#517e36"]},palette:null,defaultSingleColor:"#5d9cd3",multiColorValue:"c1",imagesUrl:window.require.toUrl("jimu/css/images/chart/"),isInWidget:!1,type:"",singleColor:!1,config:null,postMixInProperties:function(){this.nls=window.jimuNls.statisticsChart},postCreate:function(){this.inherited(arguments);this._initSelf();this.isInWidget&&
this._bindEvents();this.own(l(this.multiColorSection,"click",g.hitch(this,function(a){a=a.target||a.srcElement;if(h.hasClass(a,"multi-color")&&!h.hasClass(a,"selected")){var b=this.multiColorValue;this._selectMultiColorDiv(a);b!==a.colorValue&&this.isInWidget&&this._configChange()}})))},_initSelf:function(){this.config=g.clone(this.config);k.combineRadioCheckBoxWithLabel(this.cbxAxisX,this.labelAxisX);k.combineRadioCheckBoxWithLabel(this.cbxAxisY,this.labelAxisY);k.combineRadioCheckBoxWithLabel(this.cbxPieLabel,
this.labelPie);this._setSingleColorForColorDiv(this.defaultSingleColor);this.palette=new f({palette:"7x10",cellClass:"cursor:pointer",style:{width:"220px"},onChange:g.hitch(this,function(a){var b=this._getSingleColorFromColorDiv();this._setSingleColorForColorDiv(a);this.isInWidget&&b!==a&&this._configChange()})});this.palette.placeAt(this.paletteContainer);this.palette.startup();n.forEach(["c1","c2","c3","c4"],g.hitch(this,function(a){h.create("div",{"class":"multi-color colorful "+a},this.colorfulContainer).colorValue=
a}));n.forEach("g1 g2 g3 g4 g5 g6 g7 g8 g9 g10 g11 g12".split(" "),g.hitch(this,function(a){h.create("div",{"class":"multi-color monochromatic "+a},this.monochromaticContainer).colorValue=a}));this._setMultiColorValue("c1");"pie"===this.type?(this.singleColor=!1,h.setStyle(this.divAxisX,"display","none"),h.setStyle(this.divAxisY,"display","none")):h.setStyle(this.divPieLabel,"display","none");this.reset();this.config&&this.setConfig(this.config)},_bindEvents:function(){"pie"===this.type?this.own(l(this.cbxPieLabel,
"change",g.hitch(this,this._configChange))):(this.own(l(this.cbxAxisX,"change",g.hitch(this,this._configChange))),this.own(l(this.cbxAxisY,"change",g.hitch(this,this._configChange))))},setConfig:function(a){this.reset();this.cbxAxisX.checked=!1===a.showHorizontalAxis?!1:!0;this.cbxAxisY.checked=!1===a.showVerticalAxis?!1:!0;this.cbxPieLabel.checked=!1===a.showDataLabel?!1:!0;a=g.clone(a.colors||[]);(this.singleColor=1===a.length&&"pie"!==this.type)?this.showSingleColor(a[0]):this.showMultiColor(a)},
getConfig:function(){var a={colors:[]};"pie"===this.type?(a.colors=this.colors[this._getMultiColorValue()],2===a.colors.length&&(a.colors=this._createHexColors(a.colors[0],a.colors[1],6)),a.showDataLabel=this.cbxPieLabel.checked):(a.showHorizontalAxis=this.cbxAxisX.checked,a.showVerticalAxis=this.cbxAxisY.checked,a.colors=this.singleColor?[this._getSingleColorFromColorDiv()]:this.colors[this._getMultiColorValue()]);return a},_setSingleColorForColorDiv:function(a){h.setStyle(this.colorDiv,"backgroundColor",
a);this.colorDiv.bgHex=a},_getSingleColorFromColorDiv:function(){return this.colorDiv.bgHex},_setMultiColorValue:function(a){(a=e("."+a,this.multiColorSection))&&0<a.length&&this._selectMultiColorDiv(a[0])},_selectMultiColorDiv:function(a){e(".multi-color",this.multiColorSection).removeClass("selected");h.addClass(a,"selected");this.multiColorValue=a.colorValue},_getMultiColorValue:function(){return this.multiColorValue},reset:function(){"pie"===this.type?this.cbxPieLabel.checked=!0:(this.cbxAxisX.checked=
!0,this.cbxAxisY.checked=!0);this.singleColor?this.showSingleColor():this.showMultiColor()},showSingleColor:function(a){"pie"===this.type?this.singleColor=!1:(this.singleColor=!0,h.setStyle(this.singleColorSection,"display","block"),h.setStyle(this.multiColorSection,"display","none"),a&&this._setSingleColorForColorDiv(a))},showMultiColor:function(a){this.singleColor=!1;h.setStyle(this.singleColorSection,"display","none");h.setStyle(this.multiColorSection,"display","block");if(a&&0<a.length){var b=
null,c=!1,f;for(f in this.colors)if(b=this.colors[f],c=!1,b.length===a.length&&(c=n.every(b,g.hitch(this,function(b,c){var f=new d(b),e=new d(a[c]);return f.toHex().toLowerCase()===e.toHex().toLowerCase()})))){this._setMultiColorValue(f);break}}},showShelter:function(){h.setStyle(this.shelter,"display","block")},hideShelter:function(){h.setStyle(this.shelter,"display","none")},_configChange:function(){var a=this.getConfig();this.emit("change",a)},_createHexColors:function(a,b,c){var f=[];a=d.fromHex(a);
var e=d.fromHex(b);b=(e.r-a.r)/(c-1);for(var g=(e.g-a.g)/(c-1),e=(e.b-a.b)/(c-1),h=null,k=0;k<c;k++)h=new d,h.r=Math.floor(a.r+b*k),h.g=Math.floor(a.g+g*k),h.b=Math.floor(a.b+e*k),f.push(h.toHex());return f}})})},"widgets/Chart/Query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred esri/tasks/query esri/tasks/QueryTask jimu/utils jimu/dijit/Message".split(" "),function(t,g,n,h,e,d,l,p){function m(){return{url:"",layerInfo:null,limit:1E4,spatialReference:null,queryType:-1,
objectIdField:"",query:{maxRecordCount:1E3,where:"",geometry:null,relationship:e.SPATIAL_REL_INTERSECTS,outFields:["*"],nextIndex:0,allCount:0,objectIds:[],features:[]}}}t=t(null,{currentAttrs:null,constructor:function(c){this.currentAttrs=m();this.currentAttrs.url=c.url;this.currentAttrs.layerInfo=c.layerInfo;this.currentAttrs.spatialReference=c.spatialReference;this.currentAttrs.query.where=c.where;this.currentAttrs.query.geometry=c.geometry;this.currentAttrs.query.maxRecordCount=c.layerInfo.maxRecordCount||
1E3;this.currentAttrs.queryType=this._getQueryType(c.layerInfo);this.currentAttrs.objectIdField=l.getObjectIdField(c.layerInfo);c.relationship&&(this.currentAttrs.query.relationship=c.relationship);c.outFields&&(this.currentAttrs.query.outFields=c.outFields);if(0<c.limit||c.limit>this.currentAttrs.query.maxRecordCount)this.currentAttrs.limit=c.limit},getFeatures:function(){var c=new h,c=this.currentAttrs.query.where,a=this.currentAttrs.query.geometry,b=this.currentAttrs.query.relationship;return c=
2===this.currentAttrs.queryType?this._getAllFeatures_SupportObjectIds(c,a,b):this._getAllFeatures_NotSupportObjectIds(c,a,b)},_getQueryType:function(c){var a=-1;return a=this._isSupportObjectIds(c)?2:3},_isServiceSupportsOrderBy:function(c){var a=!1;c.advancedQueryCapabilities&&c.advancedQueryCapabilities.supportsOrderBy&&(a=!0);return a},_isServiceSupportsPagination:function(c){var a=!1;c.advancedQueryCapabilities&&c.advancedQueryCapabilities.supportsPagination&&(a=!0);return a},_isSupportObjectIds:function(c){var a=
0;c.currentVersion&&(a=parseFloat(c.currentVersion));return 10<=a||c.hasOwnProperty("typeIdField")},_getAllFeatures_SupportObjectIds:function(c,a,b){return this._queryIds(c,a,b).then(g.hitch(this,function(a){if(!(a&&0<a.length))return this.currentAttrs.query.allCount=0,{status:1,count:0,features:[]};var b=a.length;this.currentAttrs.query.allCount=b;this.currentAttrs.query.objectIds=a;this.currentAttrs.query.nextIndex=0;return b>this.currentAttrs.query.maxRecordCount?this._isContinue().then(g.hitch(this,
function(a){return a?this._onResultsScroll_SupportObjectIds():{status:-1,count:b,features:[]}})):this._onResultsScroll_SupportObjectIds()}))},_isContinue:function(){var c=new h,a=window.jimuNls.queryFeatures,b=new p({message:a.tooManyFeaturesTip+" "+a.askForContinue,buttons:[{label:window.jimuNls.common.continue1,onClick:g.hitch(this,function(){c.resolve(!0);b.close()})},{label:window.jimuNls.common.cancel,onClick:g.hitch(this,function(){c.resolve(!1);b.close()})}]});return c},_onResultsScroll_SupportObjectIds:function(){var c=
new h,a=this.currentAttrs.query.objectIds,b=this.currentAttrs.query.allCount,d=this.currentAttrs.query.nextIndex,e=this.currentAttrs.query.maxRecordCount,l=this.currentAttrs.query.relationship;if(d>=b)return c.resolve({status:1,count:b,features:this.currentAttrs.query.features}),c;a=a.slice(d,d+Math.min(a.length-d,e));return 0===a.length?(c.resolve({status:1,count:b,features:this.currentAttrs.query.features}),c):this._queryByObjectIds(a,!0,l).then(g.hitch(this,function(a){a=a.features;this.currentAttrs.query.nextIndex+=
a.length;this.currentAttrs.query.features=this.currentAttrs.query.features.concat(a);return this._onResultsScroll_SupportObjectIds()}))},_getAllFeatures_NotSupportObjectIds:function(c,a,b){return this._doQuery_NotSupportObjectIds(c,a,b).then(g.hitch(this,function(a){return{status:1,count:a.length,features:a}}))},_doQuery_NotSupportObjectIds:function(c,a,b){var d=new h;this._query(c,a,!0,b).then(g.hitch(this,function(a){a=a.features;this.currentAttrs.query.allCount=a.length;d.resolve(a)}),g.hitch(this,
function(a){console.error(a);d.reject(a)}));return d},_getOutputFields:function(){return["*"]},_query:function(c,a,b,f){var g=new e;g.where=c;a&&(g.geometry=a);g.outSpatialReference=this.currentAttrs.spatialReference;g.returnGeometry=!!b;g.spatialRelationship=f;g.outFields=this._getOutputFields();return(new d(this.currentAttrs.url)).execute(g)},_queryIds:function(c,a,b){var f=new e;f.where=c;a&&(f.geometry=a);f.returnGeometry=!1;f.spatialRelationship=b;f.outSpatialReference=this.currentAttrs.spatialReference;
return(new d(this.currentAttrs.url)).executeForIds(f)},_queryByObjectIds:function(c,a,b){var f=new h,k=new e;k.returnGeometry=!!a;k.outSpatialReference=this.currentAttrs.spatialReference;k.outFields=this._getOutputFields();k.objectIds=c;k.spatialRelationship=b;(new d(this.currentAttrs.url)).execute(k).then(g.hitch(this,function(a){f.resolve(a)}),g.hitch(this,function(d){if(400===d.code){var e=this.currentAttrs.objectIdField,h="",k=c.length;n.forEach(c,g.hitch(this,function(a,b){h+=e+" \x3d "+a;b!==
k-1&&(h+=" OR ")}));this._query(h,null,a,b).then(g.hitch(this,function(a){f.resolve(a)}),g.hitch(this,function(a){f.reject(a)}))}else f.reject(d)}));return f}});t.getCleanCurrentAttrsTemplate=m;return t})},"widgets/Chart/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/StatisticsChart.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"results-header" data-dojo-attach-point\x3d"resultsHeader" style\x3d"margin-bottom:15px;"\x3e\r\n\t\t\x3cdiv class\x3d"chart-title jimu-float-leading" data-dojo-attach-point\x3d"chartTitle"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"paging-section jimu-float-leading"\x3e\r\n\t\t\t\x3cul data-dojo-attach-point\x3d"pagingUl" data-dojo-attach-event\x3d"onclick:_onPagingUlClicked"\x3e\x3c/ul\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"zoomin jimu-float-trailing" data-dojo-attach-point\x3d"zoominIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"settings jimu-float-trailing" data-dojo-attach-point\x3d"settingsIcon"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"chart-section"\x3e\r\n\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%;table-layout:fixed;"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"arrow-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item left-arrow arrow" data-dojo-attach-point\x3d"leftArrow" data-dojo-attach-event\x3d"onclick:_onLeftArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"content-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item chart-container" data-dojo-attach-point\x3d"chartContainer" dir\x3d"ltr"\r\n\t\t\t\t\t\tstyle\x3d"direction:ltr;overflow:hidden;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"arrow-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item right-arrow arrow" data-dojo-attach-point\x3d"rightArrow" data-dojo-attach-event\x3d"onclick:_onRightArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_StatisticsChartSettings.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"divAxisX" class\x3d"setting-item"\x3e\r\n\t\t\x3cinput data-dojo-attach-point\x3d"cbxAxisX" type\x3d"checkbox" /\x3e\r\n\t\t\x3clabel data-dojo-attach-point\x3d"labelAxisX"\x3e${nls.horizontalAxis}\x3c/label\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"divAxisY" class\x3d"setting-item"\x3e\r\n\t\t\x3cinput data-dojo-attach-point\x3d"cbxAxisY" type\x3d"checkbox" /\x3e\r\n\t\t\x3clabel data-dojo-attach-point\x3d"labelAxisY"\x3e${nls.verticalAxis}\x3c/label\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"divPieLabel" class\x3d"setting-item"\x3e\r\n\t\t\x3cinput data-dojo-attach-point\x3d"cbxPieLabel" type\x3d"checkbox" checked /\x3e\r\n\t\t\x3clabel data-dojo-attach-point\x3d"labelPie"\x3e${nls.dataLabels}\x3c/label\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv\x3e\r\n\t\t\x3cdiv class\x3d"color-tip"\x3e${nls.color}\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"singleColorSection" class\x3d"single-color-section"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"colorDiv" class\x3d"single-color-div"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"paletteContainer" class\x3d"palette-container"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"multiColorSection" class\x3d"multi-color-section"\x3e\r\n\t\t\t\x3cdiv class\x3d"colorful-section"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"colorfulContainer"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"monochromatic-section"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monochromaticContainer"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Chart/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"chart-widget-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"chartList" class\x3d"chart-step chart-list"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"chartsNode" class\x3d"charts"\x3e\r\n        \x3cdiv class\x3d"execute-tip"\x3e\r\n          ${nls.executeChartTip}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"charts-table-container"\x3e\r\n          \x3ctable data-dojo-attach-event\x3d"onclick:_onChartListClicked" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"charts-table" onselectstart\x3d"return false;"\x3e\r\n            \x3ccolgroup\x3e\r\n              \x3ccol width\x3d"14px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n            \x3c/colgroup\x3e\r\n            \x3ctbody data-dojo-attach-point\x3d"chartsTbody"\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"invalidConfigNode" class\x3d"invalid-config"\x3e\r\n        \x3cdiv class\x3d"error"\x3e\r\n          ${nls.invalidConfig}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"noChartTipSection" class\x3d"no-chart-tip"\x3e\r\n        ${nls.noneChartTip}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"chartParams" class\x3d"chart-step chart-params"\x3e\r\n      \x3cdiv class\x3d"step-head chart-params-head"\x3e\r\n        \x3cdiv class\x3d"step-title params-title"\x3e${nls.chartParams}\x3c/div\x3e\r\n        \x3cdiv class\x3d"operations"\x3e\r\n          \x3cdiv class\x3d"params-back jimu-float-leading" data-dojo-attach-event\x3d"onclick:_onBtnParamsBackClicked"\x3e\r\n            \x3cdiv class\x3d"back-icon"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"back-tip"\x3e${nls.charts}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"apply jimu-float-trailing" data-dojo-attach-point\x3d"btnApply" data-dojo-attach-event\x3d"onclick:_onBtnApplyClicked"\x3e${nls.apply}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"params-container" data-dojo-attach-point\x3d"paramsContainer"\x3e\r\n        \x3cdiv class\x3d"spatial-section" style\x3d"margin-top:20px; margin-bottom:20px;"\x3e\r\n          \x3cdiv\x3e\r\n            \x3cinput type\x3d"checkbox" checked\x3d"false" data-dojo-attach-point\x3d"cbxUseSpatial" data-dojo-attach-event\x3d"onclick: _onCbxUseSpatialClicked" /\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"labelUseSpatial"\x3e${nls.useSpatialFilter}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"selectSpatialDiv" class\x3d"select-spatial"\x3e\r\n            \x3ctable class\x3d"current-view" valign\x3d"top" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr class\x3d"current-extent-tr"\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput type\x3d"radio" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"cbxUseMapExtent" checked data-dojo-attach-event\x3d"onclick:_onCbxUseMapExtentClicked" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd class\x3d"current-extent-td"\x3e\r\n                    \x3clabel data-dojo-attach-point\x3d"labelUseMapExtent" class\x3d"map-extent-tip"\x3e${nls.useCurrentMapExtent}\x3c/label\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr class\x3d"draw-graphic-tr"\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput type\x3d"radio" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"cbxDrawGraphic" data-dojo-attach-event\x3d"onclick:_onCbxDrawGraphicClicked" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd class\x3d"draw-graphic-td"\x3e\r\n                    \x3clabel data-dojo-attach-point\x3d"labelDrawGraphic" class\x3d"draw-graphic-tip"\x3e${nls.drawGraphicOnMap}\x3c/label\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n            \x3cdiv class\x3d"draw-graphic" data-dojo-attach-point\x3d"drawBoxDiv"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"chartResults" class\x3d"chart-step chart-results"\x3e\r\n      \x3cdiv class\x3d"step-head chart-results-head"\x3e\r\n        \x3cdiv class\x3d"step-title results-title"\x3e${nls.chartResults}\x3c/div\x3e\r\n        \x3cdiv class\x3d"operations"\x3e\r\n          \x3cdiv class\x3d"params-back jimu-float-leading" data-dojo-attach-event\x3d"onclick:_onBtnResultsBackClicked"\x3e\r\n            \x3cdiv class\x3d"back-icon"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"back-tip" data-dojo-attach-point\x3d"btnResultsBack"\x3e${nls.chartParams}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"results-container" data-dojo-attach-point\x3d"resultsContainer"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"btn-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"btnClearAll" data-dojo-attach-event\x3d"onclick:_onBtnClearAllClicked" class\x3d"jimu-btn jimu-priority-secondary btn-clear-all" title\x3d"${nls.clearResults}"\x3e${nls.clearResults}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Chart/css/style.css":".jimu-widget-chart{position: relative; width: 100%; height: 100%; min-width: 222px; min-height: 237px; overflow-x: hidden;}.jimu-widget-chart .chart-widget-content{position: absolute; width: 100%; left: 0; right: 0; height: auto; top: 0; bottom: 60px;}.jimu-widget-chart .btn-section{position: absolute; width: 100%; left: 0; right: 0; bottom: 0; height: auto; text-align: center;}.jimu-widget-chart .btn-section .btn-clear-all{margin-left: auto; margin-right: auto; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-chart .chart-step{position: absolute; width: 100%; height: 100%; top: 0;}.jimu-widget-chart .chart-list{left: 0;}.jimu-widget-chart .chart-list .charts{position: absolute; width: 100%; height: 100%; left: 0; top: 0; overflow-y: auto;}.jimu-widget-chart .chart-list .charts .execute-tip{line-height: 20px;}.jimu-widget-chart .chart-list .charts .charts-table-container{width: 100%; margin-top: 15px;}.jimu-widget-chart .chart-list .charts .charts-table{width: 99%; border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto;}.jimu-widget-chart .chart-list .charts .charts-table td{height: 30px; line-height: 30px; cursor: pointer;}.jimu-widget-chart .chart-list .charts .charts-table tr *{cursor: pointer;}.jimu-widget-chart .chart-list .charts .charts-table .second-td{color: #686868; font-size: 12px;}.jimu-widget-chart .chart-list .charts .charts-table .chart-name-div{width: 100%; overflow: hidden; text-overflow: ellipsis; height: 100%;}.jimu-widget-chart .chart-list .charts .charts-table .third-td .arrow{background-repeat: no-repeat; background-position: center; background-image: url(images/arrow_right1.png); width: 100%; height: 100%;}.jimu-rtl .jimu-widget-chart .chart-list .charts .charts-table .third-td .arrow{background-image: url(images/rtl_arrow_right1.png);}.jimu-widget-chart .charts-table .jimu-table-row.jimu-state-active .third-td .arrow{background-image: url(images/arrow_right2.png);}.jimu-rtl .jimu-widget-chart .charts-table .jimu-table-row.jimu-state-active .third-td .arrow{background-image: url(images/rtl_arrow_right2.png);}.jimu-widget-chart .charts-table .jimu-table-row:hover .third-td .arrow{background-image: url(images/arrow_right2.png);}.jimu-rtl .jimu-widget-chart .charts-table .jimu-table-row:hover .third-td .arrow{background-image: url(images/rtl_arrow_right2.png);}.jimu-widget-chart .chart-list .invalid-config{display: none; position: absolute; width: 100%; height: 100%; left: 0; top: 0;}.jimu-widget-chart .chart-list .no-chart-tip{display: none; line-height: 20px;}.jimu-widget-chart .step-head{position: relative; width: 100%; height: 30px; line-height: 30px;}.jimu-widget-chart .step-title{position: absolute; width: 100%; height: 100%; left: 0; top: 0; text-align: center; font-size: 14px; color: #86909c;}.jimu-widget-chart .step-head .operations{position: absolute; width: 100%; height: 100%; left: 0; right: 0; top: 0;}.jimu-widget-chart .step-head .operations .params-back{color: blue; cursor: pointer; height: 100%; white-space: nowrap;}.jimu-widget-chart .step-head .operations .params-back \x3e *{display: inline-block; vertical-align: middle;}.jimu-widget-chart .step-head .operations .params-back .back-icon{width: 8px; height: 100%; background-repeat: no-repeat; background-position: center center; background-image: url(images/arrow_left.png); margin-right: 5px;}.jimu-rtl .jimu-widget-chart .step-head .operations .params-back .back-icon{background-image: url(images/rtl_arrow_left.png); margin-right: 0; margin-left: 5px;}.jimu-widget-chart .step-head .operations .params-back .back-tip{height: 100%; color: #51b1fe;}.jimu-widget-chart .chart-params{left: 100%;}.jimu-widget-chart .chart-params-head .operations .apply{cursor: pointer; height: 100%; color: #51b1fe;}.jimu-widget-chart .params-container{position: absolute; width: 100%; left: 0; top: 40px; bottom: 0; overflow-y: auto;}.jimu-widget-chart .chart-params table.current-view{width: auto; border-collapse: collapse; margin-top: 10px;}.jimu-widget-chart .chart-params table.current-view td{vertical-align: top;}.jimu-widget-chart .chart-params .draw-graphic{margin-top: 5px;}.jimu-widget-chart .chart-params .select-spatial{margin-left: 7px; margin-top: 7px;}.jimu-rtl .jimu-widget-chart .chart-params .select-spatial{margin-left: 0; margin-right: 7px;}.jimu-widget-chart .chart-params .current-extent-td{padding-left: 8px;}.jimu-rtl .jimu-widget-chart .chart-params .current-extent-td{padding-left: 0; padding-right: 8px;}.jimu-widget-chart .chart-params .draw-graphic-tr td{padding-top: 5px;}.jimu-widget-chart .chart-params .draw-graphic-td{padding-left: 8px;}.jimu-rtl .jimu-widget-chart .chart-params .draw-graphic-td{padding-left: 0; padding-right: 8px;}.jimu-widget-chart .chart-results{left: 200%;}.jimu-widget-chart .chart-results .results-container{position: absolute; width: 100%; left: 0; top: 50px; bottom: 0; overflow-x: hidden; overflow-y: auto;}",
"*now":function(t){t(['dojo/i18n!*preload*widgets/Chart/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/query dojo/_base/html dojo/_base/array dojo/_base/fx dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidget jimu/dijit/Message jimu/dijit/DrawBox jimu/utils jimu/filterUtils esri/layers/FeatureLayer esri/renderers/SimpleRenderer esri/symbols/jsonUtils esri/request esri/graphicsUtils jimu/dijit/StatisticsChart ./Query jimu/LayerInfos/LayerInfos jimu/dijit/Popup jimu/dijit/LoadingShelter".split(" "),function(t,g,n,h,e,d,l,p,m,c,a,b,f,k,q,C,D,B,v,
y,z,A){return t([m,p],{name:"Chart",baseClass:"jimu-widget-chart",isValidConfig:!1,currentAttrs:null,tempResultLayer:null,previewArgs:null,previewPopup:null,layerInfosObj:null,_resetCurrentAttrs:function(){this.currentAttrs={chartTr:null,config:null,layerInfo:null}},postMixInProperties:function(){this.inherited(arguments);this.nls.colorful=this.nls.colorful||"Colorful";this.nls.monochromatic=this.nls.monochromatic||"Monochromatic";this.nls.clearResults=window.jimuNls.drawBox.clear;this.layerInfosObj=
z.getInstanceSync();this.config&&(this._setUrlForConfig(),this._updateConfig())},_updateConfig:function(){this.config&&this.config.charts&&0<this.config.charts.length&&e.forEach(this.config.charts,g.hitch(this,function(a){this._rebuildFilter(a.url,a.filter)}))},_setUrlForConfig:function(){this.config&&this.config.charts&&0<this.config.charts.length&&e.forEach(this.config.charts,g.hitch(this,function(a){if(a.webMapLayerId){var b=this.layerInfosObj.getLayerOrTableInfoById(a.webMapLayerId);b&&(a.url=
b.getUrl())}}))},_rebuildFilter:function(a,c){try{if(c){delete c.expr;var d=new f;d.isHosted=b.isHostedService(a);d.getExprByFilterObj(c)}}catch(u){console.log(u)}},postCreate:function(){this.inherited(arguments);b.combineRadioCheckBoxWithLabel(this.cbxUseSpatial,this.labelUseSpatial);b.combineRadioCheckBoxWithLabel(this.cbxUseMapExtent,this.labelUseMapExtent);b.combineRadioCheckBoxWithLabel(this.cbxDrawGraphic,this.labelDrawGraphic);this._initDrawBox();this._initPreview();this._initSelf()},onOpen:function(){this.tempResultLayer&&
this.tempResultLayer.show()},onDeActive:function(){this.drawBox.deactivate()},onClose:function(){this.tempResultLayer&&this.tempResultLayer.hide();this._hideInfoWindow();this.drawBox.clear();this.inherited(arguments)},resize:function(){var a="BoxTheme"===this.appConfig.theme.name?1100:100;setTimeout(g.hitch(this,function(){this._updatePreviewHeight();this.preview.resize()}),a)},destroy:function(){this._clickClearButton(!0);this.inherited(arguments)},_isConfigValid:function(){return this.config&&"object"===
typeof this.config},_initDrawBox:function(){this.drawBox=new a({types:["point","polyline","polygon"],map:this.map,showClear:!0,keepOneGraphic:!0});this.drawBox.placeAt(this.drawBoxDiv);this.drawBox.startup()},_createBigPreview:function(){if(this.previewArgs){var a=document.body.clientWidth-40,b=document.body.clientHeight-40;if(!(100>a||100>b)){var c=this._getDefaultFontColor(),d=0;this.preview&&0<=this.preview.currentChartIndex&&(d=this.preview.currentChartIndex);var e=new v({map:this.map,fontColor:c,
isBigPreview:!0,showSettingIcon:!0,showZoomIcon:!1,zoomToFeaturesWhenClick:!0,initialChartIndex:d,style:"width:100%;height:100%;"});this.previewPopup=new A({width:a,height:b,titleLabel:this.nls._widgetLabel,content:e,onClose:g.hitch(this,function(){e.destroy();this.previewPopup=e=null})});setTimeout(g.hitch(this,function(){e.createClientCharts(this.preview.featureLayer,this.preview.features,this.preview.config)}),100)}}},_initPreview:function(){var a=this._getDefaultFontColor();this.preview=new v({map:this.map,
fontColor:a,isBigPreview:!1,showSettingIcon:!0,showZoomIcon:!0,zoomToFeaturesWhenClick:!0});this.preview.placeAt(this.resultsContainer);this.preview.startup();this.own(l(this.preview,"zoomin",g.hitch(this,this._createBigPreview)))},_getDefaultFontColor:function(){var a="#333333";"DashboardTheme"!==this.appConfig.theme.name||"default"!==this.appConfig.theme.styles[0]&&"style3"!==this.appConfig.theme.styles[0]?"DartTheme"===this.appConfig.theme.name&&(a="#fff"):a="#fff";return a},_initSelf:function(){var a=
"Chart_"+b.getRandomString();this.cbxUseMapExtent.name=a;this.cbxDrawGraphic.name=a;(this.isValidConfig=this._isConfigValid())?(a=this.config.charts,0===a.length?(h.setStyle(this.chartsNode,"display","none"),h.setStyle(this.noChartTipSection,"display","block")):e.forEach(a,g.hitch(this,function(a,c){var d=a.name,e=h.toDom('\x3ctr class\x3d"single-chart jimu-table-row"\x3e\x3ctd class\x3d"first-td"\x3e\x3c/td\x3e\x3ctd class\x3d"second-td"\x3e\x3cdiv class\x3d"chart-name-div"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd class\x3d"third-td"\x3e\x3cdiv class\x3d"arrow"\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e');
n(".chart-name-div",e)[0].innerHTML=b.stripHTML(d);h.place(e,this.chartsTbody);e.singleConfig=a;0===c%2?h.addClass(e,"even"):h.addClass(e,"odd")}))):(h.setStyle(this.chartsNode,"display","none"),h.setStyle(this.invalidConfigNode,{display:"block",left:0}))},_clickClearButton:function(a){this._hideInfoWindow();this.drawBox.clear();this._removeTempResultLayer();this._clearResultPage();a||this._fromCurrentPageToChartList()},_slide:function(a,b,c){h.setStyle(a,"display","block");h.setStyle(a,"left",b+
"%");d.animateProperty({node:a,properties:{left:{start:b,end:c,units:"%"}},duration:500,onEnd:g.hitch(this,function(){h.setStyle(a,"left",c);0===c?h.setStyle(a,"display","block"):h.setStyle(a,"display","none")})}).play()},_onChartListClicked:function(a){if(a=b.getAncestorDom(a.target||a.srcElement,g.hitch(this,function(a){return h.hasClass(a,"single-chart")}),10)){var c=a.singleConfig;this._resetCurrentAttrs();this.currentAttrs.chartTr=a;this.currentAttrs.config=g.clone(c);this.currentAttrs.layerInfo=
this.currentAttrs.chartTr.layerInfo;n("tr.single-chart",this.chartsTbody).removeClass("jimu-state-active");h.addClass(this.currentAttrs.chartTr,"jimu-state-active");var d=g.hitch(this,function(){this.currentAttrs.layerInfo=this.currentAttrs.chartTr.layerInfo;this._fromChartListToChartParams()});this.currentAttrs.chartTr.layerInfo?d():(a=this.currentAttrs.config.url,this.shelter.show(),D({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(g.hitch(this,function(a){this.domNode&&
(this.shelter.hide(),this.currentAttrs.chartTr.layerInfo=a,this.currentAttrs.layerInfo=this.currentAttrs.chartTr.layerInfo,d())}),g.hitch(this,function(a){console.error(a);if(this.domNode){this.shelter.hide();var b="";a&&403===a.httpCode&&(b=this.nls.noPermissionsMsg);this._showQueryErrorMsg(b)}})))}},_fromCurrentPageToChartList:function(){h.setStyle(this.chartList,"display","block");"block"===h.getStyle(this.chartParams,"display")?(this._slide(this.chartList,-100,0),this._slide(this.chartParams,
0,100)):"block"===h.getStyle(this.chartResults,"display")&&(this._slide(this.chartList,-100,0),this._slide(this.chartResults,0,100))},_onCbxUseSpatialClicked:function(){this.cbxUseSpatial.checked?h.setStyle(this.selectSpatialDiv,"display","block"):h.setStyle(this.selectSpatialDiv,"display","none");this.cbxUseMapExtent.checked?this._onCbxUseMapExtentClicked():this._onCbxDrawGraphicClicked();this._resetDrawBox()},_onCbxUseMapExtentClicked:function(){this.cbxUseMapExtent.checked&&(this._resetDrawBox(),
h.setStyle(this.drawBoxDiv,"display","none"))},_onCbxDrawGraphicClicked:function(){this.cbxDrawGraphic.checked&&h.setStyle(this.drawBoxDiv,"display","block")},_onBtnClearAllClicked:function(){0!==this.chartsTbody.childElementCount&&this._clickClearButton("none"!==this.chartList.style.display)},_resetDrawBox:function(){this.drawBox.deactivate();this.drawBox.clear()},_resetChartParamsPage:function(){this.cbxUseSpatial.checked=!1;this._onCbxUseSpatialClicked();this._resetDrawBox()},_fromChartListToChartParams:function(){this._resetChartParamsPage();
var a=this.chartParams,b=this.chartResults;h.setStyle(this.chartList,{left:0,display:"block"});h.setStyle(a,{left:"100%",display:"block"});h.setStyle(b,"display","none");this._slide(this.chartList,0,-100);this._slide(a,100,0)},_onBtnParamsBackClicked:function(){this._resetDrawBox();h.setStyle(this.chartList,"display","block");h.setStyle(this.chartParams,"display","block");h.setStyle(this.chartResults,"display","none");this._slide(this.chartList,-100,0);this._slide(this.chartParams,0,100)},_onBtnApplyClicked:function(){this._clearResultPage();
var a=this.currentAttrs.config.filter.expr,b=null;if(this.cbxUseSpatial.checked){if(this.cbxUseMapExtent.checked)b=this.map.extent;else{var d=this.drawBox.drawLayer.graphics;0<d.length&&(b=d[0].geometry)}if(!b){new c({message:this.nls.specifySpatialFilterMsg});return}}this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null;this._createChartResultLayer();this._resetDrawBox();h.setStyle(this.chartList,"display","none");h.setStyle(this.chartParams,"display","block");
h.setStyle(this.chartResults,"display","block");this._slide(this.chartParams,0,-100);this._slide(this.chartResults,100,0);var f=this.currentAttrs.config,d=[],k=f.mode;"feature"===k?(d=g.clone(f.valueFields),0>d.indexOf(f.labelField)&&d.push(f.labelField)):"category"===k?(d=g.clone(f.valueFields),0>d.indexOf(f.categoryField)&&d.push(f.categoryField)):"count"===k?d=[f.categoryField]:"field"===k&&(d=g.clone(f.valueFields));this.shelter.show();(k=this._getBaseExpression(this.currentAttrs.config.webMapLayerId))&&
(a="("+k+") AND ("+a+")");this._query(a,d,b).then(g.hitch(this,function(a){if(this.domNode&&(this.shelter.hide(),0<a.status)){var b={featureLayer:this.tempResultLayer,features:a.features,config:f};this.previewArgs=b;this._updatePreviewHeight();this.preview.createClientCharts(b.featureLayer,b.features,b.config);e.forEach(a.features,g.hitch(this,function(a){this.tempResultLayer.add(a)}));this._zoomToLayer(this.tempResultLayer)}}),g.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),
this._removeTempResultLayer())}))},_getBaseExpression:function(a){var b="";if(a){var c=null;(c="Table"===this.currentAttrs.layerInfo.type?this.layerInfosObj.getTableInfoById(a):this.layerInfosObj.getLayerInfoById(a))&&(b=c.getFilter())}return b},_updatePreviewHeight:function(){var a=h.getContentBox(this.domNode);h.setStyle(this.preview.domNode,"height",Math.max(a.h-120,150)+"px")},_createChartResultLayer:function(){this._removeTempResultLayer();var a=g.clone(this.currentAttrs.layerInfo);a.drawingInfo||
(a.drawingInfo={});a.drawingInfo.transparency=0;a.minScale=0;a.maxScale=0;a.effectiveMinScale=0;a.effectiveMaxScale=0;a.defaultVisibility=!0;delete a.extent;this.tempResultLayer=new k({layerDefinition:a,featureSet:null});this.map.addLayer(this.tempResultLayer);a=C.fromJson(this.currentAttrs.config.symbol);a=new q(a);this.tempResultLayer.setRenderer(a)},_removeTempResultLayer:function(){this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null},_query:function(a,b,
c){a||(a="1\x3d1");var d={};d.url=this.currentAttrs.config.url;d.layerInfo=this.currentAttrs.layerInfo;d.limit=1E4;d.spatialReference=this.map.spatialReference;d.where=a;d.geometry=c;d.outFields=b;return(new y(d)).getFeatures()},_clearResultPage:function(){this.previewPopup&&(this.previewPopup.close(),this.previewPopup=null);this.previewArgs=null;this.preview.clear();this._hideInfoWindow()},_zoomToLayer:function(a){try{var b=e.filter(a.graphics,function(a){return!!a.geometry});if(0<b.length){var c=
B.graphicsExtent(b);c&&(c=c.expand(1.4),this.map.setExtent(c))}}catch(u){console.error(u)}},_showQueryErrorMsg:function(a){new c({message:a||this.nls.queryError})},_hideInfoWindow:function(){},_onBtnResultsBackClicked:function(){var a;a=this.chartParams;h.setStyle(this.chartList,"display","none");h.setStyle(a,{display:"block",left:"-100%"});this._slide(a,-100,0);this._slide(this.chartResults,0,100)}})});