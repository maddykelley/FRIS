// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dojo/NodeList":function(){define(["./query"],function(l){return l.NodeList})},"widgets/Filter/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Filter/Widget.html":'\x3cdiv\x3e\r\n  \x3cul class\x3d"filter-list" data-dojo-attach-point\x3d"filterList"\x3e\x3c/ul\x3e\r\n\x3c/div\x3e',"url:widgets/Filter/css/style.css":".jimu-widget-filter {position: relative; width: auto; height: auto; margin: -14px;}.jimu-widget-filter .filter-list,.jimu-widget-filter .filter-list li {margin: 0; padding: 0;}.jimu-widget-filter .filter-list li {list-style: none;}.jimu-widget-filter .filter-list .filter-item{border-bottom: 1px solid #eee; font-size: 12px; overflow: hidden;}.jimu-widget-filter .filter-list .filter-item.config-parameters{background-color: #f3f3f3;}.jimu-widget-filter .filter-list .filter-item.config-parameters + .filter-item.config-parameters{padding-top: 4px; background-clip: content-box;}.jimu-widget-filter .filter-list .filter-item .header{vertical-align: middle; padding: 12px 5px; min-height: 40px; cursor: pointer; position: relative;}.jimu-widget-filter .filter-list .filter-item .header:hover{background-color: #eee;}.jimu-widget-filter .filter-list .filter-item.config-parameters .header .item-title{font-family: 'Avenir Medium', Verdana, Geneva, sans-serif;}.jimu-widget-filter .filter-list .filter-item .body{display: none;}.jimu-widget-filter .filter-list .filter-item.config-parameters .body{display: block;}.jimu-widget-filter .filter-list .filter-item .header\x3e*{display: inline-block; vertical-align: middle; word-break: break-word;}.jimu-widget-filter .filter-list .filter-item .header\x3e.icon{vertical-align: top;}.jimu-widget-filter .filter-list .filter-item .header:after{content: \"\"; height: 100%; min-height: 16px; vertical-align: top; display: inline-block;}.jimu-widget-filter .filter-list .filter-item .header .icon{width: 16px; height: 16px; margin-right: 10px;}.jimu-rtl .jimu-widget-filter .filter-list .filter-item .header .icon{margin-right: 0; margin-left: 10px;}.jimu-widget-filter .filter-list .filter-item .header .icon img{width: 100%; height: 100%;}.jimu-widget-filter .filter-list .filter-item .header .cando{display: block; position: absolute; top: 14px; right: 0; width: 16px; height: 16px; content: ''; border-radius: 50%; text-indent: -9999em; background: none; border: 2px solid #d6d6d6;}.jimu-rtl .jimu-widget-filter .filter-list .filter-item .header .cando{left: 0; right: auto;}.jimu-widget-filter .filter-list .filter-item .header .doing{display: none; position: absolute; top: 14px; right: 0; width: 16px; height: 16px; border-radius: 50%; text-indent: -9999em; background: none; border: 2px solid #d6d6d6; border-left-color: #4A4A4A; -webkit-animation: load8 1.1s infinite linear; -moz-animation: load8 1.1s infinite linear; -ms-animation: load8 1.1s infinite linear; -o-animation: load8 1.1s infinite linear; animation: load8 1.1s infinite linear; -webkit-transform: translateZ(0); -moz-transform: translateZ(0); -ms-transform: translateZ(0); -o-transform: translateZ(0); transform: translateZ(0);}.jimu-rtl .jimu-widget-filter .filter-list .filter-item .header .doing{left: 0; right: auto;}.jimu-widget-filter .filter-list .filter-item .header .done{display: none; position: absolute; top: 14px; right: 0; width: 16px; height: 16px; border-radius: 50%; text-indent: -9999em; background: url('./images/done.svg') no-repeat center;}.jimu-rtl .jimu-widget-filter .filter-list .filter-item .header .done{left: 0; right: auto;}.jimu-widget-filter .filter-list .filter-item.requesting .header .cando,.jimu-widget-filter .filter-list .filter-item.applying .header .cando{display: none;}.jimu-widget-filter .filter-list .filter-item.requesting .header .doing,.jimu-widget-filter .filter-list .filter-item.applying .header .doing{display: block;}.jimu-widget-filter .filter-list .filter-item.requesting .header .done,.jimu-widget-filter .filter-list .filter-item.applying .header .done{display: none;}.jimu-widget-filter .filter-list .filter-item.applied .header .cando{display: none;}.jimu-widget-filter .filter-list .filter-item.applied .header .doing{display: none;}.jimu-widget-filter .filter-list .filter-item.applied .header .done{display: block;}.jimu-widget-filter .filter-list .filter-item .header .arrow{content: ''; border-radius: 50%; width: 16px; height: 16px; top: 12px; text-indent: -9999em; background: url('./images/arrow_normal.svg') no-repeat center; z-index: 10;}.jimu-widget-filter .filter-list .filter-item .header .arrow:hover{background: url('./images/arrow_hover.svg') no-repeat center;}.jimu-widget-filter .filter-list .filter-item.config-parameters .header .arrow{transform: rotate(90deg);}.jimu-widget-filter .filter-list .filter-item.not-has-ask-for-value .header .arrow{background: transparent !important;}.jimu-widget-filter .filter-list .filter-item .body .parameters{margin: 0 30px;}.jimu-widget-filter .filter-list .filter-item .body .jimu-btn{background: #fff; border-radius: 0; width: 82px; border: 1px solid #c7c7c7; color: #000; font-size: 12px; margin-bottom: 15px;}.jimu-widget-filter .filter-list .filter-item .body .jimu-btn:hover{border: 1px solid #000;}.jimu-widget-filter .jimu-loading-shelter .loading-container{width: auto;}.jimu-widget-filter.not-exist-ask-for-value .filter-list .filter-item .arrow{display: none;}@-webkit-keyframes load8 {0% {-webkit-transform: rotate(0deg); transform: rotate(0deg);} 100% {-webkit-transform: rotate(360deg); transform: rotate(360deg);}}@-moz-keyframes load8 {0% {-moz-transform: rotate(0deg); transform: rotate(0deg);} 100% {-moz-transform: rotate(360deg); transform: rotate(360deg);}}@-ms-keyframes load8 {0% {-ms-transform: rotate(0deg); transform: rotate(0deg);} 100% {-ms-transform: rotate(360deg); transform: rotate(360deg);}}@keyframes load8 {0% {-webkit-transform: rotate(0deg); -ms-transform: rotate(0deg); -moz-transform: rotate(0deg); transform: rotate(0deg);} 100% {-webkit-transform: rotate(360deg); -ms-transform: rotate(360deg); -moz-transform: rotate(360deg); transform: rotate(360deg);}}",
"*now":function(l){l(['dojo/i18n!*preload*widgets/Filter/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/_base/lang dojo/query dojo/on dijit/_WidgetsInTemplateMixin jimu/utils jimu/BaseWidget jimu/filterUtils jimu/dijit/FilterParameters jimu/LayerInfos/LayerInfos jimu/FilterManager esri/request dojo/NodeList dojo/NodeList-dom".split(" "),function(l,p,e,f,k,m,q,r,t,u,v,w,x,y){return l([t,q],{name:"Filter",baseClass:"jimu-widget-filter",_itemTemplate:'\x3cli class\x3d"filter-item" data-index\x3d"${index}"\x3e\x3cdiv class\x3d"header" \x3e\x3cspan class\x3d"arrow jimu-float-leading jimu-trailing-margin05" title\x3d"${toggleTip}" \x3e\x3c/span\x3e\x3cspan class\x3d"icon"\x3e\x3cimg src\x3d"${icon}" /\x3e\x3c/span\x3e\x3cspan class\x3d"item-title"\x3e${title}\x3c/span\x3e\x3cspan class\x3d"cando jimu-trailing-margin1"\x3e\x3c/span\x3e\x3cspan class\x3d"doing jimu-trailing-margin1"\x3e\x3c/span\x3e\x3cspan class\x3d"done jimu-trailing-margin1"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"body"\x3e\x3cdiv class\x3d"parameters"\x3e\x3c/div\x3e\x3cspan class\x3d"jimu-btn apply jimu-float-trailing jimu-trailing-margin25"\x3e${apply}\x3c/span\x3e\x3c/div\x3e\x3c/li\x3e',
_store:null,postCreate:function(){this.inherited(arguments);this._store={};this.layerInfosObj=w.getInstanceSync();this.filterUtils=new u;this.filterManager=x.getInstance();var a=!1;p.forEach(this.config.filters,function(b,c){var d=this.filterUtils.isAskForValues(b.filter);d&&(a=!0);var n={icon:b.icon?r.processUrlInWidgetConfig(b.icon,this.folderUrl):this.folderUrl+"/css/images/default_task_icon.png",index:c,title:b.name,toggleTip:this.nls.toggleTip,hasValue:d?window.appInfo.isRunInMobile?"block !important":
"":"none",isAskForValue:d,apply:f.getObject("jimuNls.common.apply",!1,window)||"Apply"};this._store[b.layerId]||(this._store[b.layerId]={mapFilterControls:{}});var h=f.replace(this._itemTemplate,n,/\$\{([^\}]+)\}/ig),g=e.toDom(h);e.place(g,this.filterList);this.own(k(".header",g).on("click",f.hitch(this,"enableFilter",g,b,n)));d?e.addClass(g,"has-ask-for-value"):e.addClass(g,"not-has-ask-for-value");"none"!==n.hasValue&&(this.own(k(".arrow",g).on("click",f.hitch(this,"configFilter",g,b))),this.own(k(".apply",
g).on("click",f.hitch(this,"applyFilterValues",g,b))),e.addClass(g,"requesting"),this.configFilter(g,b,null,f.hitch(this,function(){this.config.collapse&&e.removeClass(g,"config-parameters")})))},this);a||e.addClass(this.domNode,"not-exist-ask-for-value")},startup:function(){this.inherited(arguments);this.resize()},_getPriorityOfMapFilter:function(a){a=f.getObject(a+".mapFilterControls",!1,this._store);var b=0,c;for(c in a){var d=a[c];d.priority>b&&(b=d.priority)}return b},_getMapFilterControl:function(a){a=
f.getObject(a+".mapFilterControls",!1,this._store);var b=!0,c;for(c in a){var d=a[c];0<d.priority&&(b=!!d.enable)}return b},_setItemFilter:function(a,b,c,d){this._store[a]["filter_item_"+b]=c;c=this._getPriorityOfMapFilter(a);f.setObject(a+".mapFilterControls.filter_item_"+b,{enable:d,priority:c+1},this._store)},_removeItemFilter:function(a,b){delete this._store[a]["filter_item_"+b];delete this._store[a].mapFilterControls["filter_item_"+b]},_getExpr:function(a){if(!this._store[a])return null;var b=
[];a=this._store[a];for(var c in a){var d=a[c];d&&"mapFilterControls"!==c&&b.push("("+d+")")}return b.join(" AND ")},_bindMapUpdateEvents:function(a,b){m.once(this.map,"update-start",f.hitch(this,function(){e.addClass(a,"applying");e.removeClass(a,"applied")}));m.once(this.map,"update-end",f.hitch(this,function(){b?e.addClass(a,"applied"):e.removeClass(a,"applied");e.removeClass(a,"applying")}))},enableFilter:function(a,b,c){if(!e.hasClass(a,"config-parameters")||a.filterParams&&a.filterParams.getFilterExpr())if(!c.isAskForValue||
a.filterParams&&a.filterParams.getFilterExpr()){c=b.layerId;var d=e.getAttr(a,"data-index"),f=null,h=this.layerInfosObj.getLayerInfoById(c),f=e.hasClass(a,"applied");h.isShowInMap()&&h.isInScale()?this._bindMapUpdateEvents(a,f?!1:!0):f?e.removeClass(a,"applied"):e.addClass(a,"applied");h=null;f?this._removeItemFilter(c,d):this._setItemFilter(c,d,a.filterParams?a.filterParams.getFilterExpr():b.filter.expr,b.enableMapFilter);f=this._getExpr(c);h=this._getMapFilterControl(c);this.filterManager.applyWidgetFilter(c,
this.id,f,h)}else this.configFilter(a,b)},configFilter:function(a,b,c,d){a.filterParams?(e.hasClass(a,"config-parameters")?(e.removeClass(a,"config-parameters"),this._changeItemTitleWidth(a,window.appInfo.isRunInMobile?60:45)):(e.addClass(a,"config-parameters"),this._changeItemTitleWidth(a,60)),d&&d()):y({url:b.url,content:{f:"json"},handleAs:"json",callbackPrams:"callback"}).then(f.hitch(this,function(c){e.addClass(a,"config-parameters");e.removeClass(a,"requesting");var h=k(".parameters",a)[0];
a.handles=[];a.filterParams=new v;var g=f.clone(b.filter),l=null;b.enableMapFilter&&(l=b.layerId);a.filterParams.build(b.url,c,g,l);this.own(m(a.filterParams,"change",f.hitch(this,function(b){b?(k(".apply",a).removeClass("disable-apply"),a.expr=b):(delete a.expr,k(".apply",a).addClass("disable-apply"))})));a.expr=a.filterParams.getFilterExpr();a.expr?k(".apply",a).removeClass("disable-apply"):(delete a.expr,k(".apply",a).addClass("disable-apply"));a.filterParams.placeAt(h);this._changeItemTitleWidth(a,
60);d&&d()}));c&&c.target&&c.stopPropagation()},applyFilterValues:function(a,b,c){var d=a.filterParams&&(a.expr||a.filterParams.getFilterExpr());if(d){a.expr=d;var d=b.layerId,f=e.getAttr(a,"data-index"),h=this.layerInfosObj.getLayerInfoById(d);h.isShowInMap()&&h.isInScale()?this._bindMapUpdateEvents(a,!0):e.addClass(a,"applied");this._setItemFilter(d,f,a.expr,b.enableMapFilter);a=this._getExpr(d);b=this._getMapFilterControl(d);this.filterManager.applyWidgetFilter(d,this.id,a,b)}c.stopPropagation()},
resize:function(){this.inherited(arguments);this._changeItemTitleWidth(this.domNode,window.appInfo.isRunInMobile?60:45)},_changeItemTitleWidth:function(a,b){b+=30;var c=k(".header",a)[0];c&&(c=e.getContentBox(c).w-b,0<c&&k(".header .item-title",a).style({maxWidth:c+"px"}))},destroy:function(){k(".filter-item",this.filterList).forEach(function(a){delete a.filterParams;delete a.expr});if(this._store)for(var a in this._store)a&&this.filterManager.applyWidgetFilter(a,this.id,"",null);this.inherited(arguments)}})});