// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Filter/setting/SingleFilterSetting":function(){define("dojo/on dojo/query dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SingleFilterSetting.html jimu/utils jimu/dijit/Filter jimu/dijit/Message jimu/dijit/CheckBox jimu/dijit/LayerChooserFromMapWithDropbox ./CustomFeaturelayerChooserFromMap jimu/dijit/ImageChooser dijit/form/ValidationTextBox".split(" "),function(f,l,k,h,d,b,
c,g,u,v,q,a,e,m,y,p){return b([c,g,u,k],{baseClass:"jimu-widget-singlefilter-setting",templateString:v,jimuNls:null,_defaultTaskIcon:null,map:null,nls:null,target:null,layerInfosObj:null,folderUrl:"",appConfig:null,postMixInProperties:function(){this.inherited(arguments);this._defaultTaskIcon=this.folderUrl+"css/images/default_task_icon.png";this.jimuNls=window.jimuNls},postCreate:function(){this.inherited(arguments);this.cbxRemoveMapFilter=new m({label:this.nls.enableMapFilter||""});this.cbxRemoveMapFilter.placeAt(this.tdUseMapFilter);
this.cbxRemoveMapFilter.setValue(!1);this._recreateLayerChooserSelect(!0);this.filter=new a({enableAskForValues:!0,noFilterTip:this.nls.noFilterTip,style:"width:100%;"});this.filter.placeAt(this.filterDiv);this._setDefaultTaskIcon();this.own(f(this.filter,"filter-number-change",h.hitch(this,this.calculateExpsBoxMaxHeight)));this.calculateExpsBoxMaxHeight()},_recreateLayerChooserSelect:function(a){this.layerChooserSelect&&this.layerChooserSelect.destroy();this.layerChooserSelect=null;var b=new p({showLayerFromFeatureSet:!1,
showTable:!1,onlyShowVisible:!1,createMapResponse:this.map.webMapResponse});this.layerChooserSelect=new y({layerChooser:b});this.layerChooserSelect.placeAt(this.layerTd);a&&this._bindEventForLayerChooserSelect(this.layerChooserSelect)},showLayerChooserPopup:function(){this.layerChooserSelect.showLayerChooser()},destroy:function(){this.target=null;this.emit("before-destroy");this.inherited(arguments)},setConfig:function(a){var b=h.clone(a);this._showLoading();this.reset();this._recreateLayerChooserSelect(!1);
var e=h.hitch(this,function(){this.domNode&&(this._bindEventForLayerChooserSelect(this.layerChooserSelect),this._hideLoading())});this.layerInfosObj.getLayerInfoById(b.layerId).getLayerObject().then(h.hitch(this,function(a){this.domNode&&this.layerChooserSelect.setSelectedLayer(a).then(h.hitch(this,function(e){this.domNode&&(this._hideLoading(),e&&(b.icon?this.imageChooser.setDefaultSelfSrc(q.processUrlInWidgetConfig(b.icon,this.folderUrl)):this._setDefaultTaskIcon(),this.cbxRemoveMapFilter.setValue(!b.enableMapFilter),
this.nameTextBox.set("value",b.name),e=this._getLayerDefinitionForFilterDijit(a),this.filter.buildByFilterObj(a.url,b.filter,e),this._bindEventForLayerChooserSelect(this.layerChooserSelect)))}),h.hitch(this,function(a){console.error(a);e()}))}),h.hitch(this,function(a){console.error(a);e()}))},getConfig:function(){var a={layerId:null,url:null,name:null,filter:null,icon:null,enableMapFilter:!this.cbxRemoveMapFilter.getValue()},b=this.layerChooserSelect.getSelectedItem();if(!b)return this._showMessage(this.nls.selectLayerTip),
!1;b=b.layerInfo.layerObject;a.layerId=b.id;a.url=b.url;a.name=this.nameTextBox.get("value");if(!a.name)return this._showMessage(this.nls.setTitleTip),!1;b=this.imageChooser.getImageData();b===this._defaultTaskIcon&&(b="");a.icon=b;a.filter=this.filter.toJson();return a.filter?this.target.singleConfig=a:(this._showMessage(window.jimuNls.filterBuilder.setFilterTip),!1)},calculateExpsBoxMaxHeight:function(){setTimeout(h.hitch(this,function(){if(this.domNode){var a=this.filter.allExpsBox,b=d.position(this.domNode),
e=d.position(a),b=b.h-(e.y-b.y);0<b&&(a.style.maxHeight=b+"px")}}),100)},reset:function(){this._setDefaultTaskIcon();this.cbxRemoveMapFilter.setValue(!1);this.nameTextBox.set("value","");this.filter.reset()},_setDefaultTaskIcon:function(){this.imageChooser.setDefaultSelfSrc(this._defaultTaskIcon)},_onNameTextBoxChanged:function(){var a=l(".label",this.target)[0],b=this.nameTextBox.get("value");a.innerHTML=b;a.title=b},_bindEventForLayerChooserSelect:function(a){a.isBindEvent||(this.own(f(a,"selection-change",
h.hitch(this,this._onLayerChanged))),a.isBindEvent=!0)},_showMessage:function(a){new e({message:a})},_onLayerChanged:function(){this.reset();var a=this.layerChooserSelect.getSelectedItem();if(a){var b=a.layerInfo,a=b.layerObject;this.nameTextBox.set("value",b.title);b=this._getLayerDefinitionForFilterDijit(a);this.filter.buildByExpr(a.url,"1\x3d1",b)}},_getLayerDefinitionForFilterDijit:function(a){var b=null;"esri.layers.FeatureLayer"===a.declaredClass&&(b=q.getFeatureLayerDefinition(a));b||(b={currentVersion:a.currentVersion,
fields:h.clone(a.fields)});return b},_showLoading:function(){this.emit("loading")},_hideLoading:function(){this.emit("unloading")},_onImageChooserDivClicked:function(a){this.imageChooser.mask&&(a=a.target||a.srcElement,a!==this.imageChooser.mask&&a!==this.imageChooser.fileInput&&q.simulateClickEvent(this.imageChooser.mask))}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),
function(f,l,k,h,d,b,c,g,u,v,q){return f([g,u,d],{templateString:v,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,postCreate:function(){this.inherited(arguments);this.layerInfosObj=q.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(h(this.layerChooser,
"tree-click",l.hitch(this,this._onTreeClick)));this.own(h(this.layerChooser,"update",l.hitch(this,this._onLayerChooserUpdate)));this.own(h(document.body,"click",l.hitch(this,this._onBodyClicked)))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var e=new b;if(a){var m=this.layerInfosObj.getLayerInfoById(a.id);m?this.layerChooser.filter(m).then(l.hitch(this,
function(b){b?(this._onSelectNewItem({layerInfo:m,name:m.title,url:a.url}),e.resolve(!0)):e.resolve(!1)}),l.hitch(this,function(){e.resolve(!1)})):e.resolve(!1)}else this._onSelectNewItem(null),e.resolve(!0);return e},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(a){a=a.target||a.srcElement;a===this.domNode||k.isDescendant(a,this.domNode)||a===this.layerChooser.domNode||k.isDescendant(a,this.layerChooser.domNode)||
this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();a.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():this.showLayerChooser()},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){this.layerChooser.domNode.style.width=this.domNode.clientWidth+2+"px";c.open({parent:this,popup:this.layerChooser,around:this.domNode});var a=this.layerChooser.domNode.parentNode;a&&k.addClass(a,"jimu-layer-chooser-from-map-withdropbox-popup");
this._isLayerChooserShow=!0},hideLayerChooser:function(){c.close(this.layerChooser);this._isLayerChooserShow=!1},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var b=l.getObject("layerInfo.id",!1,this._selectedItem)||-1,m=l.getObject("layerInfo.id",!1,a)||-1,b=b!==m;this._selectedItem=a;this.hideLayerChooser();a=l.getObject("layerInfo.title",
!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;a=l.getObject("layerInfo.layerObject",!1,this._selectedItem);b&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"widgets/Filter/setting/CustomFeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","jimu/dijit/LayerChooserFromMap","jimu/dijit/QueryableLayerChooserFromMap"],function(f,l,k,h,d){return f([d],
{postMixInProperties:function(){this.inherited(arguments);this.filter=l.hitch(this,h.andCombineFilters([this.filter,l.hitch(this,this._customFilter)]))},_customFilter:function(b){var c=new k;b.isTable?c.resolve(!1):b.getLayerObject().then(l.hitch(this,function(b){"esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass?c.resolve(10<=b.version):"esri.layers.ArcGISTiledMapServiceLayer"===b.declaredClass?c.resolve(!1):c.resolve(!0)}),l.hitch(this,function(b){console.error(b);c.resolve(!1)}));return c}})})},
"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),function(f,l,k,h,d,b,c,g,u,v,q,a,e,m,y,p,t,B){var r=k([h,d,b,l],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',
_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new B({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=
a.hitch(this,this.basicFilter);this.filter=r.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var b=new g;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new g;a.resolve(!0);return a},getSelectedItems:function(){var b=this.tree.getSelectedItems();return m.map(b,a.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var b=this.tree.getAllItems(),
e=[];m.forEach(b,a.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),e.push(a))}));return e},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(b){this.createMapResponse=b;t.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(a.hitch(this,function(b){this.layerInfosObj=b;this.own(f(this.layerInfosObj,"layerInfosChanged",a.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&
this.own(f(this.layerInfosObj,"layerInfosIsShowInMapChanged",a.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(b){this._clear();e.setStyle(this.errorTipSection,"display","block");var c=[];this.onlyShowWebMapLayers?(c=b.getLayerInfoArrayOfWebmap(),
c=c.concat(b.getTableInfoArrayOfWebmap())):(c=b.getLayerInfoArray(),c=c.concat(b.getTableInfoArray()));0!==c.length&&(e.setStyle(this.errorTipSection,"display","none"),m.forEach(c,a.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(b){b&&b.getLayerObject().then(a.hitch(this,function(){this._addItem("root",b)}),a.hitch(this,function(a){console.error(a)}))},_clear:function(){var b=this._store.query({parent:"root"});m.forEach(b,a.hitch(this,function(a){a&&"root"!==
a.id&&this._store.remove(a.id)}))},_addItem:function(b,e){var c=null,d=e.getLayerType(),g=this.filter(e);q({layerType:d,valid:g}).then(a.hitch(this,function(d){if(d.valid){var g=a.hitch(this,function(a,m){this._id++;c={name:e.title||"",parent:b,layerInfo:e,type:d.layerType,layerClass:e.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,hasChildren:m};this._store.add(c)}),t=e.getSubLayers(),f=0===t.length;f?g(f,!1):(t=m.map(t,a.hitch(this,function(a){return this.filter(a)})),q(t).then(a.hitch(this,
function(a){(a=m.some(a,function(a){return a}))&&g(f,a)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var b=this._getRootItem(),b=new c({data:[b],getChildren:function(a){return this.query({parent:a.id})}});this._store=new u(b);b=new v({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=new p({multiple:this.multiple,model:b,showRoot:!1,isLeafItem:a.hitch(this,this._isLeafItem),
style:{width:"100%"},onOpen:a.hitch(this,function(a,b){"root"!==a.id&&this._onTreeOpen(a,b)}),onClick:a.hitch(this,function(a,b,e){this._onTreeClick(a,b,e);this.emit("tree-click",a,b,e)}),getIconStyle:a.hitch(this,function(a,b){var e=null;if(!a||"root"===a.id)return null;var c={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},m=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),d=this._getIconImageName(a,b);d&&(c.backgroundImage=
"url("+m+"/css/images/"+d+")",e=c);return e})});e.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconImageName:function(a,b){var e="";if("ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type)e=b?"mapserver_open.png":"mapserver_close.png";else if("GroupLayer"===a.type)e=b?"group_layer2.png":"group_layer1.png";else if("FeatureLayer"===a.type){var c=y.getTypeByGeometryType(a.layerInfo.layerObject.geometryType);
"point"===c?e="point_layer1.png":"polyline"===c?e="line_layer1.png":"polygon"===c&&(e="polygon_layer1.png")}else e="Table"===a.type?"table.png":"ArcGISImageServiceLayer"===a.type||"ArcGISImageServiceVectorLayer"===a.type?"image_layer.png":b?"mapserver_open.png":"mapserver_close.png";return e},_onTreeOpen:function(b,e){if("root"!==b.id){var c=[],d=[],c=b.layerInfo.getSubLayers();b.checked||(this.shelter.show(),d=m.map(c,a.hitch(this,function(a){return a.getLayerObject()})),q(d).then(a.hitch(this,function(){this.domNode&&
(m.forEach(c,a.hitch(this,function(a){this._addItem(b.id,a)})),b.checked=!0,this.shelter.hide())}),a.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,b,e){},destroy:function(){this.shelter&&this.shelter.destroy();this.tree&&this.tree.destroy();this.shelter=null;this.tree.destroy();this.inherited(arguments)}});r.createFilterByLayerType=function(b){a.isArrayLike(b)||(b=[]);return function(a){var e=new g;if(0===b.length)e.resolve(!0);else{var c=[];a.traversal(function(a){c.push(a.getLayerType())});
q(c).then(function(a){for(var c=0;c<a.length;c++)for(var m=0;m<b.length;m++)if(a[c]===b[m]){e.resolve(!0);return}e.resolve(!1)},function(a){console.error(a);e.reject(a)})}return e}};r.createFeaturelayerFilter=function(a,b,e,c){var d=["point","polyline","polygon"];a&&0<a.length?(a=m.filter(a,function(a){return 0<=d.indexOf(a)}),0===a.length&&(a=d)):a=d;return function(d){var g=d.getLayerType();d=d.getLayerObject();return q({layerType:g,layerObject:d}).then(function(d){var g=d.layerType;d=d.layerObject;
if("ArcGISDynamicMapServiceLayer"===g||"ArcGISTiledMapServiceLayer"===g||"GroupLayer"===g||"FeatureCollection"===g)return!0;if("FeatureLayer"===g){var g=y.getTypeByGeometryType(d.geometryType),g=0<=m.indexOf(a,g),t=r._shouldPassStatisticsCheck(c,d);return d.url?(d=y.isFeaturelayerUrlSupportQuery(d.url,d.capabilities),g&&d&&t):b&&g}return"Table"===g?(g=y.isFeaturelayerUrlSupportQuery(d.url,d.capabilities),d=r._shouldPassStatisticsCheck(c,d),e&&g&&d):!1})}};r.createImageServiceLayerFilter=function(a,
b){return function(e){var d=e.getLayerType();e=e.getLayerObject();return q({layerType:d,layerObject:e}).then(function(e){var d=e.layerType,c=e.layerObject;return"ArcGISImageServiceLayer"===d||"ArcGISImageServiceVectorLayer"===d?a?y.isImageServiceSupportQuery(e.layerObject.capabilities)?b?r._shouldPassStatisticsCheck(b,c):!0:!1:!0:!1})}};r._shouldPassStatisticsCheck=function(a,b){if(a){var e=!1;return e=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics}return!0};
r.createQueryableLayerFilter=function(a){var b=r.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=r.createImageServiceLayerFilter(!0,a);return r.orCombineFilters([b,a])};r.andCombineFilters=function(a){return r._combineFilters(a,!0)};r.orCombineFilters=function(a){return r._combineFilters(a,!1)};r._combineFilters=function(a,b){return function(e){var d=new g,c=m.map(a,function(a){return a(e)});q(c).then(function(a){var e=!1,e=b?m.every(a,function(a){return a}):m.some(a,function(a){return a});
d.resolve(e)},function(a){console.error(a);d.reject(a)});return d}};return r})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(f,l,k,h,d,b,c){return k("dijit.tree.ObjectStoreModel",c,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(b){d.mixin(this,b);this.childrenCache={}},getRoot:function(c,f){if(this.root)c(this.root);else{var g=this.store.query(this.query);
g.then&&this.own(g);b(g,d.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];c(this.root);g.observe&&g.observe(d.hitch(this,function(a){this.onChange(a)}),!0)}),f)}},mayHaveChildren:function(){return!0},getChildren:function(c,f,h){var g=this.store.getIdentity(c);if(this.childrenCache[g])b(this.childrenCache[g],f,h);else{var a=this.childrenCache[g]=this.store.getChildren(c);a.then&&this.own(a);
a.observe&&this.own(a.observe(d.hitch(this,function(e,m,g){this.onChange(e);m!=g&&b(a,d.hitch(this,"onChildrenChange",c))}),!0));b(a,f,h)}},isItem:function(){return!0},getIdentity:function(b){return this.store.getIdentity(b)},getLabel:function(b){return b[this.labelAttr]},newItem:function(b,d,c,f){return this.store.put(b,{parent:d,before:f})},pasteItem:function(b,c,k,l,a,e){var m=new h;if(c===k&&!l&&!e)return m.resolve(!0),m;c&&!l?this.getChildren(c,d.hitch(this,function(a){a=[].concat(a);var d=f.indexOf(a,
b);a.splice(d,1);this.onChildrenChange(c,a);m.resolve(this.store.put(b,{overwrite:!0,parent:k,oldParent:c,before:e}))})):m.resolve(this.store.put(b,{overwrite:!0,parent:k,oldParent:c,before:e}));return m},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(f,l,k,h,d,b,c,g,u,v,q,a,e,m,y){var p=f([m._TreeNode,a],{templateString:h,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);b.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=b.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=b.toDom('\x3cinput type\x3d"checkbox" /\x3e');b.addClass(this.checkNode,"jimu-tree-check-node");b.place(this.checkNode,this.contentNode,
"first");this.own(q(this.checkNode,"click",d.hitch(this,this._onClick)));this.isLeaf?this.groupId?b.setStyle(this.checkNode,"display","none"):b.setStyle(this.checkNode,"display","inline"):b.setStyle(this.checkNode,"display","none");this.isLeaf?b.addClass(this.domNode,"jimu-tree-leaf-node"):b.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,b.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=
!1,b.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(d.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;
this.inherited(arguments)}});return f([m,a],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+y.getRandomString()},postCreate:function(){this.inherited(arguments);b.addClass(this.domNode,"jimu-tree");this.own(v.before(this,"onClick",d.hitch(this,this._jimuBeforeClick)));this.rootLoadingIndicator&&b.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0},removeItem:function(a){this.model.store.remove(a)},
getAllItems:function(){var a=this.getAllTreeNodeWidgets();return c.map(a,d.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=c.filter(a,d.hitch(this,function(a){return a.checkNode.checked}));return c.map(a,d.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var b=this.getAllTreeNodeWidgets(),b=c.map(b,d.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return c.filter(b,
d.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),c=0;c<b.length;c++){var d=e.byNode(b[c]);if(d.item.id.toString()===a.toString())return d}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return c.filter(a,d.hitch(this,function(a){return a.isLeaf}))},
getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return c.map(a,d.hitch(this,function(a){return e.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return u(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new p(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",
{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,e,c){e.isLeaf&&(b.hasClass(c.target||c.srcElement,"jimu-tree-check-node")||(this.multiple?e.toggleSelect():this.selectNodeWidget(e)));return arguments},_onCheckNodeClick:function(a,b,e){!this.multiple&&b&&this.unselectAllLeafNodeWidgets();g.stop(e);this.focusNode(a);setTimeout(d.hitch(this,function(){b?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,
a,e)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();c.forEach(a,d.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(f,l,k,h,d,b,c,g,u,v,q,a,e,m,y,p,t,B,r,J,D,K,A,E,F,H,I,M,G,L,N,O,R,P,Q){function x(a){return p.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var C=h("dijit._TreeNode",[F,H,I,M,G],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);e("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:N,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";v.set(this.domNode,
"backgroundPosition",b+" 0px");v.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);f.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,n=b.model;b._v10Compat&&a===n.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,e){var n="_"+b+"Class";b+="Node";var w=this[n];this[n]=this.tree["get"+e+"Class"](a,this.isExpanded);g.replace(this[b],this[n]||"",w||"");v.set(this[b],this.tree["get"+e+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;g.toggle(this.domNode,"dijitTreeIsRoot",a);g.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;g.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return x(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");g.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=a.wipeIn({node:this.containerNode,duration:E.defaultDuration}),e=this._expandDeferred=new d(function(){b.stop()});l.after(b,"onEnd",function(){e.resolve(!0)},!0);b.play();return x(e)},collapse:function(){if(this._collapseDeferred)return x(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");g.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=a.wipeOut({node:this.containerNode,duration:E.defaultDuration}),e=this._collapseDeferred=new d(function(){b.stop()});l.after(b,"onEnd",
function(){e.resolve(!0)},!0);b.play();return x(e)},indent:0,setChildItems:function(a){var n=this.tree,e=n.model,d=[],m=n.focusedChild,g=this.getChildren();f.forEach(g,function(a){I.prototype.removeChild.call(this,a)},this);this.defer(function(){f.forEach(g,function(a){if(!a._destroyed&&!a.getParent()){var b=function(a){var c=e.getIdentity(a.item),d=n._itemNodesMap[c];1==d.length?delete n._itemNodesMap[c]:(c=f.indexOf(d,a),-1!=c&&d.splice(c,1));f.forEach(a.getChildren(),b)};n.dndController.removeTreeNode(a);
b(a);if(n.persist){var d=f.map(a.getTreePath(),function(a){return n.model.getIdentity(a)}).join("/"),w;for(w in n._openedNodes)w.substr(0,d.length)==d&&delete n._openedNodes[w];n._saveExpandedNodes()}n.lastFocusedChild&&!c.isDescendant(n.lastFocusedChild.domNode,n.domNode)&&delete n.lastFocusedChild;m&&!c.isDescendant(m.domNode,n.domNode)&&n.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,f.forEach(a,function(a){var b=e.getIdentity(a),c=n._itemNodesMap[b],
w;if(c)for(var m=0;m<c.length;m++)if(c[m]&&!c[m].getParent()){w=c[m];w.set("indent",this.indent+1);break}w||(w=this.tree._createTreeNode({item:a,tree:n,isExpandable:e.mayHaveChildren(a),label:n.getLabel(a),labelType:n.model&&n.model.labelType||"text",tooltip:n.getTooltip(a),ownerDocument:n.ownerDocument,dir:n.dir,lang:n.lang,textDir:n.textDir,indent:this.indent+1}),c?c.push(w):n._itemNodesMap[b]=[w]);this.addChild(w);(this.tree.autoExpand||this.tree._state(w))&&d.push(n._expandNode(w))},this),f.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=b(d);this.tree._startPaint(a);return x(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());f.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");g.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){K.focus(this.focusNode)}});e("dojo-bidi")&&C.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),f.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var z=h("dijit.Tree",[F,L,H,G],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:O,persist:!1,autoExpand:!1,dndController:Q,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){B.publish(this.id,p.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new d;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(t(this.containerNode,
t.selector(".dijitTreeNode",r.enter),function(b){a._onNodeMouseEnter(A.byNode(this),b)}),t(this.containerNode,t.selector(".dijitTreeNode",r.leave),function(b){a._onNodeMouseLeave(A.byNode(this),b)}),t(this.containerNode,t.selector(".dijitTreeRow",D.press),function(b){a._onNodePress(A.getEnclosingWidget(this),b)}),t(this.containerNode,t.selector(".dijitTreeRow",D),function(b){a._onClick(A.getEnclosingWidget(this),b)}),t(this.containerNode,t.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(A.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(l.after(this.model,"onChange",p.hitch(this,"_onItemChange"),!0),l.after(this.model,"onChildrenChange",p.hitch(this,"_onItemChildrenChange"),!0),l.after(this.model,"onDelete",p.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){p.isString(this.dndController)&&(this.dndController=p.getObject(this.dndController));for(var b={},e=0;e<this.dndParams.length;e++)this[this.dndParams[e]]&&(b[this.dndParams[e]]=this[this.dndParams[e]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=x(this.pendingCommandsPromise);this.onLoadDeferred.then(p.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;m.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=p.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=p.hitch(this,function(a,b,e){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,e)}));this.model=new P(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(p.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(p.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),p.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=p.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(p.hitch(this,function(){var e=
f.map(a,function(a){return!a||p.isString(a)?a:b.model.getIdentity(a)}),c=[];f.forEach(e,function(a){c=c.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",c)}))},_setPathAttr:function(a){return a.length?x(this.set("paths",[a]).then(function(a){return a[0]})):x(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function e(a,b){var n=a.shift(),d=f.filter(b,function(a){return a.getIdentity()==n})[0];if(d)return a.length?c._expandNode(d).then(function(){return e(a,
d.getChildren())}):d;throw new z.PathError("Could not expand path at "+n);}var c=this;return x(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return b(f.map(a,function(a){a=f.map(a,function(a){return a&&p.isObject(a)?c.model.getIdentity(a):a});if(a.length)return e(a,[c.rootNode]);throw new z.PathError("Empty path");}))}).then(function(a){c.set("selectedNodes",a);return c.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(c){return e._expandNode(c).then(function(){var e=f.filter(c.getChildren()||[],function(a){return a.isExpandable});return b(f.map(e,a))})}var e=this;return x(a(this.rootNode))},collapseAll:function(){function a(c){var d=f.filter(c.getChildren()||[],function(a){return a.isExpandable}),d=b(f.map(d,a));return!c.isExpanded||c==e.rootNode&&!e.showRoot?d:d.then(function(){return e._collapseNode(c)})}var e=this;return x(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){var e=this._getNext(b);e&&e.isTreeNode&&this.focusNode(e)},_onUpArrow:function(a,b){var e=b.getPreviousSibling();if(e)for(b=e;b.isExpandable&&
b.isExpanded&&b.hasChildren();)e=b.getChildren(),b=e[e.length-1];else if(e=b.getParent(),this.showRoot||e!==this.rootNode)b=e;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){if(b.isExpandable&&b.isExpanded)this._collapseNode(b);else{var e=b.getParent();e&&e.isTreeNode&&(this.showRoot||e!==this.rootNode)&&this.focusNode(e)}},focusLastChild:function(){var a=
this._getLast();a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,
b){return c.isDescendant(a,b.expandoNode)||c.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,e,c){var d=this.isExpandoNode(b.target,a);a.isExpandable&&(e||d)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[c](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,
"onDblClick")},_onExpandoClick:function(a){a=a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){m.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){m.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","",
"2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,e=a.item,c=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new d,b.getChildren(e,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},
function(b){console.error(c,": error loading "+a.label+" children: ",b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(p.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var e=this.getLabel(a),
c=this.getTooltip(a);f.forEach(b,function(b){b.set({item:a,label:e,tooltip:c});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){var e=this.model.getIdentity(a);(e=this._itemNodesMap[e])&&f.forEach(e,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(f.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!c.isDescendant(this.lastFocusedChild.domNode,
this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!c.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=k(this.cookieName);a&&f.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var e=f.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");
if(1===arguments.length)return this._openedNodes[e];b?this._openedNodes[e]=!0:delete this._openedNodes[e];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);k(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!p.isString(this.dndController)&&this.dndController.destroy();
this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&u.setMarginBox(this.domNode,a);this._nodePixelIndent=u.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(p.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),
delete this._adjustWidthsTimer);var b=p.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});J(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new C(a)},
focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});e("dojo-bidi")&&z.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});z.PathError=q("TreePathError");z._TreeNode=C;return z})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(f,l,k,h){return k("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],
newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(d){h.mixin(this,d);this.connects=[];d=this.store;if(!d.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");d.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([l.after(d,"onNew",h.hitch(this,"onNewItem"),!0),l.after(d,"onDelete",h.hitch(this,"onDeleteItem"),!0),l.after(d,"onSet",h.hitch(this,"onSetItem"),
!0)]))},destroy:function(){for(var d;d=this.connects.pop();)d.remove()},getRoot:function(d,b){this.root?d(this.root):this.store.fetch({query:this.query,onComplete:h.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];d(this.root)}),onError:b})},mayHaveChildren:function(d){return f.some(this.childrenAttrs,function(b){return this.store.hasAttribute(d,b)},this)},getChildren:function(d,b,c){var g=
this.store;if(g.isItemLoaded(d)){for(var k=[],l=0;l<this.childrenAttrs.length;l++)var q=g.getValues(d,this.childrenAttrs[l]),k=k.concat(q);var a=0;this.deferItemLoadingUntilExpand||f.forEach(k,function(b){g.isItemLoaded(b)||a++});0==a?b(k):f.forEach(k,function(e,d){g.isItemLoaded(e)||g.loadItem({item:e,onItem:function(e){k[d]=e;0==--a&&b(k)},onError:c})})}else{var e=h.hitch(this,arguments.callee);g.loadItem({item:d,onItem:function(a){e(a,b,c)},onError:c})}},isItem:function(d){return this.store.isItem(d)},
fetchItemByIdentity:function(d){this.store.fetchItemByIdentity(d)},getIdentity:function(d){return this.store.getIdentity(d)},getLabel:function(d){return this.labelAttr?this.store.getValue(d,this.labelAttr):this.store.getLabel(d)},newItem:function(d,b,c){var g={parent:b,attribute:this.childrenAttrs[0]},f;this.newItemIdAttr&&d[this.newItemIdAttr]?this.fetchItemByIdentity({identity:d[this.newItemIdAttr],scope:this,onItem:function(h){h?this.pasteItem(h,null,b,!0,c):(f=this.store.newItem(d,g))&&void 0!=
c&&this.pasteItem(f,b,b,!1,c)}}):(f=this.store.newItem(d,g))&&void 0!=c&&this.pasteItem(f,b,b,!1,c)},pasteItem:function(d,b,c,g,h){var k=this.store,l=this.childrenAttrs[0];b&&f.forEach(this.childrenAttrs,function(a){if(k.containsValue(b,a,d)){if(!g){var e=f.filter(k.getValues(b,a),function(a){return a!=d});k.setValues(b,a,e)}l=a}});if(c)if("number"==typeof h){var a=k.getValues(c,l).slice();a.splice(h,0,d);k.setValues(c,l,a)}else k.setValues(c,l,k.getValues(c,l).concat(d))},onChange:function(){},onChildrenChange:function(){},
onDelete:function(){},onNewItem:function(d,b){b&&this.getChildren(b.item,h.hitch(this,function(c){this.onChildrenChange(b.item,c)}))},onDeleteItem:function(d){this.onDelete(d)},onSetItem:function(d,b){if(-1!=f.indexOf(this.childrenAttrs,b))this.getChildren(d,h.hitch(this,function(b){this.onChildrenChange(d,b)}));else this.onChange(d)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(f,l,
k,h,d){return l("dijit.tree.ForestStoreModel",d,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(b){this.root={store:this,root:!0,id:b.rootId,label:b.rootLabel,children:b.rootChildren}},mayHaveChildren:function(b){return b===this.root||this.inherited(arguments)},getChildren:function(b,c,d){b===this.root?this.root.children?c(this.root.children):this.store.fetch({query:this.query,onComplete:h.hitch(this,function(b){this.root.children=b;c(b)}),onError:d}):this.inherited(arguments)},
isItem:function(b){return b===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(b){if(b.identity==this.root.id){var c=b.scope||k.global;b.onItem&&b.onItem.call(c,this.root)}else this.inherited(arguments)},getIdentity:function(b){return b===this.root?this.root.id:this.inherited(arguments)},getLabel:function(b){return b===this.root?this.root.label:this.inherited(arguments)},newItem:function(b,c,d){return c===this.root?(this.onNewRootItem(b),this.store.newItem(b)):this.inherited(arguments)},
onNewRootItem:function(){},pasteItem:function(b,c,d,f,h){if(c===this.root&&!f)this.onLeaveRoot(b);this.inherited(arguments,[b,c===this.root?null:c,d===this.root?null:d,f,h]);if(d===this.root)this.onAddToRoot(b)},onAddToRoot:function(b){console.log(this,": item ",b," added to root")},onLeaveRoot:function(b){console.log(this,": item ",b," removed from root")},_requeryTop:function(){var b=this.root.children||[];this.store.fetch({query:this.query,onComplete:h.hitch(this,function(c){this.root.children=
c;if(b.length!=c.length||f.some(b,function(b,d){return c[d]!=b}))this.onChildrenChange(this.root,c)})})},onNewItem:function(b,c){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(b){-1!=f.indexOf(this.root.children,b)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(b,c,d,f){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(f,l,k,h,d,b,c,g,u,v,q){return l("dijit.tree._dndSelector",q,{constructor:function(){this.selection={};this.anchor=null;this.events.push(g(this.tree.domNode,u.press,h.hitch(this,"onMouseDown")),g(this.tree.domNode,u.release,h.hitch(this,"onMouseUp")),g(this.tree.domNode,u.move,h.hitch(this,"onMouseMove")),g(this.tree.domNode,v.press,h.hitch(this,"onClickPress")),g(this.tree.domNode,v.release,h.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,
c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(a){var e=f.filter(this.getSelectedTreeNodes(),function(e){return!b.isDescendant(e.domNode,a.domNode)});this.setSelection(e);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var b=this.getSelectedTreeNodes();f.forEach(this._setDifference(b,a),h.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));f.forEach(this._setDifference(a,b),h.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){f.forEach(b,function(a){a.__exclude__=!0});var e=f.filter(a,function(a){return!a.__exclude__});f.forEach(b,function(a){delete a.__exclude__});
return e},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],c=[];f.forEach(a,function(a){var e=a.getTreePath();c.push(a);b.push(e)},this);a=f.map(c,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&c.isLeft(a)&&a.preventDefault();var b="keydown"==a.type?this.tree.focusedChild:this.current;if(b){var m=d.getCopyKeyState(a),f=b.id;this.singular||a.shiftKey||!this.selection[f]?(this._doDeselect=!1,this.userSelect(b,m,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,d.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var e=doc.createRange();e.setStartBefore(a);var c=doc.createRange();c.setStartBefore(b);return e.compareBoundaryPoints(e.END_TO_END,c)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);c=this.anchor;0>b?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNext(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
b){b=b||k.global;for(var e in this.selection)a.call(b,this.getItem(e),e,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(f,l,k,h,d,b){return l("dijit.tree._dndContainer",null,{constructor:function(c,g){this.tree=c;this.node=c.domNode;h.mixin(this,g);this.containerState="";k.add(this.node,"dojoDndContainer");this.events=[d(this.node,b.enter,h.hitch(this,"onOverEvent")),d(this.node,b.leave,
h.hitch(this,"onOutEvent")),f.after(this.tree,"_onNodeMouseEnter",h.hitch(this,"onMouseOver"),!0),f.after(this.tree,"_onNodeMouseLeave",h.hitch(this,"onMouseOut"),!0),d(this.node,"dragstart, selectstart",function(b){b.preventDefault()})]},destroy:function(){for(var b;b=this.events.pop();)b.remove();this.node=this.parent=null},onMouseOver:function(b){this.current=b},onMouseOut:function(){this.current=null},_changeState:function(b,d){var c="dojoDnd"+b,f=b.toLowerCase()+"State";k.replace(this.node,c+
d,c+this[f]);this[f]=d},_addItemClass:function(b,d){k.add(b,"dojoDndItem"+d)},_removeItemClass:function(b,d){k.remove(b,"dojoDndItem"+d)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/QueryableLayerChooserFromMap":function(){define(["dojo/_base/lang","dojo/_base/html","dojo/_base/declare","./LayerChooserFromMap"],function(f,l,k,h){return k([h],{baseClass:"jimu-queryable-layer-chooser-from-map",declaredClass:"jimu.dijit.QueryableLayerChooserFromMap",
showImageLayer:!0,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.filter=this.showImageLayer?h.createQueryableLayerFilter(this.mustSupportStatistics):h.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=h.andCombineFilters([this.filter,f.hitch(this,this._ignoreVirtualLayerFilter)]))},_ignoreVirtualLayerFilter:function(d){return d.getLayerType().then(function(b){return!("ArcGISDynamicMapServiceLayer"===
b||"ArcGISTiledMapServiceLayer"===b||"GroupLayer"===b)})},postCreate:function(){this.inherited(arguments);l.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},getHandledItem:function(d){var b=this.inherited(arguments),c=d&&d.layerInfo,c=c&&c.layerObject;b.url=c&&c.url||"";return b}})})},"widgets/Filter/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Filter/setting/SingleFilterSetting.html":'\x3cdiv\x3e\r\n\t\x3ctable\x3e\r\n\t\t\x3ccolgroup\x3e\r\n\t\t\t\x3ccol width\x3d"100"\x3e\x3c/col\x3e\r\n\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\x3c/colgroup\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e${jimuNls.common.layer}\x3c/td\x3e\r\n\t\t\t\t\x3ctd data-dojo-attach-point\x3d"layerTd"\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e${jimuNls.common.title}\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"nameTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"change:_onNameTextBoxChanged" data-dojo-props\x3d\'required:true,trim:true\' style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e${jimuNls.common.icon}\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"click-picker" data-dojo-attach-event\x3d"click:_onImageChooserDivClicked"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/ImageChooser" data-dojo-attach-point\x3d"imageChooser" data-dojo-props\x3d"cropImage:true,showSelfImg:true,goldenWidth:16,goldenHeight:16,format:[\'image/gif\',\'image/png\',\'image/jpeg\']" class\x3d"jimu-float-leading" style\x3d"width:16px;height:16px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"separator jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8 jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd colspan\x3d"2" data-dojo-attach-point\x3d"tdUseMapFilter"\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv style\x3d"margin-top:10px;"\x3e\r\n\t\t\x3cdiv\x3e${nls.filterExpression}\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"filterDiv"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n  \x3ctable data-dojo-attach-event\x3d"onclick: _onDropDownClick"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Filter/setting/Setting.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e${nls.addTaskTip}\x3c/div\x3e\r\n\t\x3cdiv class\x3d"content"\x3e\r\n\t\t\x3cdiv class\x3d"items-list jimu-not-selectable"\x3e\r\n\t\t\t\x3cdiv class\x3d"add-btn" data-dojo-attach-event\x3d"click:_onBtnAddItemClicked"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"icon"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"tip"\x3e${nls.newFilter}\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"items-list-content" data-dojo-attach-point\x3d"listContent" data-dojo-attach-event\x3d"click:_onListContentClicked"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"separator not-visible" data-dojo-attach-point\x3d"separator"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"single-setting-content" data-dojo-attach-point\x3d"singleSettingContent"\x3e\r\n\t\t\t\x3cdiv class\x3d"no-task-tip" data-dojo-attach-point\x3d"noTaskTip"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"collapse-option"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-float-leading" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCollapseFilters"\x3e\x3c/div\x3e\r\n\t\t\x3cspan class\x3d"jimu-float-leading collapse-tip" data-dojo-attach-point\x3d"collapseFiltersTip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Filter/setting/css/style.css":'.jimu-widget-filter-setting{width: 100%; height: 100%;}.jimu-widget-filter-setting .not-visible{display: none;}.jimu-widget-filter-setting .content{position: absolute; left: 0; right: 0; top: 40px; bottom: 40px;}.jimu-widget-filter-setting .content \x3e div{position: absolute; top: 0; bottom: 0; height: 100%;}.jimu-widget-filter-setting .items-list{left: 0; width: 300px;}.jimu-widget-filter-setting \x3e .content \x3e .separator{left: 320px; width: 1px; background-color: #ccc;}.jimu-widget-filter-setting .single-setting-content{right: 0; width: 610px;}.jimu-rtl .jimu-widget-filter-setting .items-list{left: auto; right: 0;}.jimu-rtl .jimu-widget-filter-setting \x3e .content \x3e .separator{left: auto; right: 320px;}.jimu-rtl .jimu-widget-filter-setting .single-setting-content{right: auto; left: 0;}.jimu-widget-filter-setting .items-list-content{position: absolute; left: 0; right: 0; top: 50px; bottom: 0; overflow: auto;}.jimu-widget-filter-setting .items-list-content .item{position: relative; width: 100%; height: 40px; border-top: 1px solid #F3F3F3; cursor: pointer;}.jimu-widget-filter-setting .items-list-content .item:hover{background-color: #F9F9F9;}.jimu-widget-filter-setting .items-list-content .item.selected{background-color: #F3F3F3 !important; border-left: 4px solid #24B5CC;}.jimu-rtl .jimu-widget-filter-setting .items-list-content .item.selected{border-left: 0; border-right: 4px solid #24B5CC;}.jimu-widget-filter-setting .items-list-content .item \x3e *{cursor: pointer;}.jimu-widget-filter-setting .items-list-content .item:first-child{border-top: 0;}.jimu-widget-filter-setting .items-list-content .item .label{position: absolute; left: 8px; right: 8px; top: 0; bottom: 0; line-height: 40px; font-size: 12px; color: #353535;}.jimu-widget-filter-setting .items-list-content .item.selected .label{font-weight: bold; color: #000;}.jimu-widget-filter-setting .items-list-content .item .actions{position: relative; display: none; height: 100%; overflow: hidden; background-color: #F9F9F9;}.jimu-widget-filter-setting .items-list-content .item:hover .actions{display: block;}.jimu-widget-filter-setting .items-list-content .item.selected .actions{background-color: #F3F3F3 !important;}.jimu-widget-filter-setting .items-list-content .item .action{width: 12px; height: 12px; background-repeat: no-repeat; background-position: center center; position: relative; top: 14px; cursor: pointer; margin: 0 5px;}.jimu-widget-filter-setting .items-list-content .item .action.up{background-image: url("images/up_normal.png");}.jimu-widget-filter-setting .items-list-content .item .action.up:hover{background-image: url("images/up_hover.png");}.jimu-widget-filter-setting .items-list-content .item .action.down{background-image: url("images/down_normal.png");}.jimu-widget-filter-setting .items-list-content .item .action.down:hover{background-image: url("images/down_hover.png");}.jimu-widget-filter-setting .items-list-content .item .action.delete{background-image: url("images/delete_normal.png");}.jimu-widget-filter-setting .items-list-content .item .action.delete:hover{background-image: url("images/delete_hover.png");}.jimu-widget-filter-setting .items-list-content .item:first-child .action.up{display: none;}.jimu-widget-filter-setting .items-list-content .item:last-child .action.down{display: none;}.jimu-widget-filter-setting .add-btn{display: inline-block; width: 100%; height: 32px; background-color: #24B5CC; color: #ffffff; text-align: center; cursor: pointer;}.jimu-widget-filter-setting .add-btn:hover{background-color: #0090A7;}.jimu-widget-filter-setting .add-btn \x3e div{display: inline-block; cursor: pointer; height: 32px; line-height: 32px; font-size: 12px;}.jimu-widget-filter-setting .add-btn .icon{position: relative; top: 1px; width: 12px; height: 12px; background: url("images/add.png") center center no-repeat; background-size: contain;}.jimu-widget-filter-setting .add-btn .tip{margin-left: 8px;}.jimu-rtl .jimu-widget-filter-setting .add-btn .tip{margin-left: 0; margin-right: 8px;}.jimu-widget-filter-setting .collapse-option{position: absolute; left: 0; right: 0; bottom: 5px; height: auto;}.jimu-widget-filter-setting .collapse-option .collapse-tip{margin-left: 5px;}.jimu-rtl .jimu-widget-filter-setting .collapse-option .collapse-tip{margin-left: 0; margin-right: 5px;}html.hr .jimu-widget-filter-setting .items-list{width: 280px;}html.hr .jimu-widget-filter-setting \x3e .content \x3e .separator{left: 295px;}html.hr .jimu-widget-filter-setting .single-setting-content{width: 650px;}.jimu-widget-singlefilter-setting{position: absolute; left: 0; right: 0; top: 0; bottom: 0;}.jimu-widget-singlefilter-setting \x3e table{width: 100%; table-layout: fixed; border-collapse: collapse;}.jimu-widget-singlefilter-setting \x3e table \x3e tbody \x3e tr \x3e td{padding: 5px 0;}.jimu-widget-singlefilter-setting .jimu-filter .allExpsBox{max-height: 270px; overflow: auto;}.jimu-widget-singlefilter-setting .click-picker{display: inline-block; border: 1px solid #D7D7D7; height: 24px; overflow: hidden; padding: 0 4px; cursor: pointer;}.jimu-widget-singlefilter-setting .click-picker .jimu-image-chooser{position: relative; top: 4px;}.jimu-widget-singlefilter-setting .click-picker .separator{position: relative; top: 4px; width: 1px; height: 16px; background-color: #D7D7D7; margin: 0 5px;}.jimu-widget-singlefilter-setting .click-picker .jimu-icon{position: relative; top: 8px;}.jimu-widget-filter-setting .single-setting-content .no-task-tip{position: relative; top: 50%; margin-top: -10px;}.jimu-widget-filter-setting .single-setting-content .no-task-tip span{font-weight: bold;}.jimu-widget-filter-setting .jimu-image-chooser .hint .display-image{width: 100% !important; height: 100% !important;}',
"*now":function(f){f(['dojo/i18n!*preload*widgets/Filter/setting/nls/Setting*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/on dojo/query dojo/_base/html dojo/_base/lang dojo/_base/array dojo/_base/declare dijit/_WidgetsInTemplateMixin esri/lang jimu/utils jimu/BaseWidgetSetting ./SingleFilterSetting jimu/LayerInfos/LayerInfos jimu/dijit/CheckBox jimu/dijit/LoadingShelter".split(" "),function(f,l,k,h,d,b,c,g,u,v,q,a){return b([v,c],{baseClass:"jimu-widget-filter-setting",singleSetting:null,layerChooserSelect:null,layerInfosObj:null,postMixInProperties:function(){this.jimuNls=window.jimuNls;this.layerInfosObj=
a.getInstanceSync();this.config&&(this.config=this._getConfigWithValidDataSource(this.config));this.noTaskNls=this.nls.noTasksTip;this.noTaskNls=g.substitute({newFilter:"\x3cspan\x3e"+this.nls.newFilter+"\x3c/span\x3e"},this.noTaskNls)},_getConfigWithValidDataSource:function(a){var b={collapse:a.collapse,filters:[]};b.filters=d.filter(a.filters,h.hitch(this,function(a){return a.layerId?!!this.layerInfosObj.getLayerInfoById(a.layerId):!0}));return b},postCreate:function(){this.inherited(arguments);
this.noTaskTip.innerHTML=this.noTaskNls;this.collapseFiltersTip.innerHTML=this.nls.collapseFiltersTip||"";this.config&&this.setConfig(this.config)},_onListContentClicked:function(a){a=a.target||a.srcElement;var b=u.getAncestorDom(a,function(a){return k.hasClass(a,"item")},3);b&&(k.hasClass(a,"action")?k.hasClass(a,"up")?b.previousElementSibling&&k.place(b,b.previousElementSibling,"before"):k.hasClass(a,"down")?b.nextElementSibling&&k.place(b,b.nextElementSibling,"after"):k.hasClass(a,"delete")&&(this.singleSetting&&
this.singleSetting.target===b&&(this.singleSetting.destroy(),this.singleSetting=null),k.destroy(b),a=l(".item",this.listContent),0<a.length&&this._createSingleSetting(a[0]),this._updateNoQueryTip()):this.singleSetting?this.singleSetting.target!==b&&this.singleSetting.getConfig()&&(this.singleSetting.destroy(),this.singleSetting=null,this._createSingleSetting(b)):this._createSingleSetting(b))},_onBtnAddItemClicked:function(){if(this.singleSetting)if(this.singleSetting.getConfig())this.singleSetting.destroy(),
this.singleSetting=null;else return;var a=this._createTarget();this._createSingleSetting(a,null)},_createSingleSetting:function(a){l(".item",this.listContent).removeClass("selected");this.singleSetting&&this.singleSetting.destroy();this.singleSetting=null;this.singleSetting=new q({map:this.map,nls:this.nls,target:a,folderUrl:this.folderUrl,layerInfosObj:this.layerInfosObj});this.singleSetting.placeAt(this.singleSettingContent);this.own(f(this.singleSetting,"loading",h.hitch(this,function(){this.shelter.show()})));
this.own(f(this.singleSetting,"unloading",h.hitch(this,function(){this.shelter.hide()})));this.own(f(this.singleSetting,"before-destroy",h.hitch(this,function(){k.addClass(this.separator,"not-visible")})));k.addClass(a,"selected");a.singleConfig?this.singleSetting.setConfig(a.singleConfig):setTimeout(h.hitch(this,function(){this.singleSetting.showLayerChooserPopup()}),50);k.removeClass(this.separator,"not-visible");k.addClass(this.noTaskTip,"not-visible")},_createTarget:function(a){a=a||"";return k.create("div",
{"class":"item",innerHTML:'\x3cdiv class\x3d"label jimu-ellipsis" title\x3d"'+a+'"\x3e'+a+'\x3c/div\x3e\x3cdiv class\x3d"actions jimu-float-trailing"\x3e\x3cdiv class\x3d"delete action jimu-float-trailing"\x3e\x3c/div\x3e\x3cdiv class\x3d"down action jimu-float-trailing"\x3e\x3c/div\x3e\x3cdiv class\x3d"up action jimu-float-trailing"\x3e\x3c/div\x3e\x3c/div\x3e'},this.listContent)},_updateNoQueryTip:function(){0<l(".item",this.listContent).length?k.addClass(this.noTaskTip,"not-visible"):k.removeClass(this.noTaskTip,
"not-visible")},setConfig:function(a){this.cbxCollapseFilters.setValue(!!a.collapse);var b=null;d.forEach(a.filters,h.hitch(this,function(a,c){var d=this._createTarget(a.name);d.singleConfig=a;0===c&&(b=d)}));b&&this._createSingleSetting(b);this._updateNoQueryTip()},getConfig:function(){if(this.singleSetting&&!this.singleSetting.getConfig())return!1;var a=l(".item",this.listContent),b={collapse:this.cbxCollapseFilters.getValue(),filters:[]};b.filters=d.map(a,h.hitch(this,function(a){return a.singleConfig}));
return b},destroy:function(){this.singleSetting&&this.singleSetting.destroy();this.singleSetting=null;this.inherited(arguments)}})});