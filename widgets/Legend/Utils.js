// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["dojo/_base/array","jimu/LayerInfos/LayerInfos"],function(d,g){var f=function(){var b=[],c=g.getInstanceSync().getLayerInfoArray();d.forEach(c,function(a){var e=[];a.getShowLegendOfWebmap()&&(!a.layerObject||"esri.layers.ArcGISDynamicMapServiceLayer"!==a.layerObject.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==a.layerObject.declaredClass||d.forEach(a.layerObject.dynamicLayerInfos||a.layerObject.layerInfos,function(b){var c=null;a.traversal(function(a){if(a.subId===b.id)return a.isLeaf()&&
!a.getShowLegendOfWebmap()&&e.push(a.originOperLayer.mapService.subId),c=a,!0});c||e.push(b.id)}),a.isMapNotesLayerInfo()?d.forEach(a.getSubLayers(),function(a){b.push({layer:a.layerObject,title:"Map Notes - "+a.title})}):b.push({hideLayers:e,layer:a.layerObject,title:a.title}))});return b.reverse()},h=function(b,c){return d.filter(b.layerInfos,function(a){var b=!1;a.id===c&&(b=!0);return b})[0]};return{getLayerInfosParam:function(){return f()},getLayerInfosParamByConfig:function(b){var c=[],a;b.layerInfos&&
b.layerInfos.length&&(a=f(),d.forEach(a,function(a){var d=h(b,a.jimuLayerInfo.id);d&&(a.hideLayers=d.hideLayers,c.push(a))}));return c}}});