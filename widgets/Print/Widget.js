// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Print/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/request esri/lang esri/arcgis/utils dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-style dojo/dom-construct dojo/dom-class dojo/promise/all dojo/Deferred jimu/portalUrlUtils dojo/text!./templates/Print.html dojo/text!./templates/PrintResult.html dojo/aspect dojo/query jimu/LayerInfos/LayerInfos jimu/dijit/LoadingShelter jimu/dijit/Message jimu/utils dojo/on dijit/popup dijit/form/ValidationTextBox dijit/form/Form dijit/form/Select dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton dijit/form/SimpleTextarea esri/IdentityManager dojo/store/Memory".split(" "),
function(f,m,q,u,x,v,d,e,c,b,t,r,k,a,I,E,z,y,K,A,B,F,G,l,L,P,h,N,C,H){A=f([m,q,u],{widgetsInTemplate:!0,templateString:A,map:null,count:1,results:[],authorText:null,copyrightText:null,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("./widgets/Print/images/pdf.png"),imageIcon:require.toUrl("./widgets/Print/images/image.png"),printTaskURL:null,printTask:null,async:!1,_showSettings:!1,_currentTemplateInfo:null,postCreate:function(){this.inherited(arguments);
this.printTask=new x(this.printTaskURL,{async:this.async});this.printparams=new v;this.printparams.map=this.map;this.shelter=new L({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this.titleNode.set("value",this.defaultTitle);this.authorNode.set("value",this.defaultAuthor);this.copyrightNode.set("value",this.defaultCopyright);var a=K.setHttpProtocol(this.printTaskURL),b=K.getNewPrintUrl(this.appConfig.portalUrl);this._isNewPrintUrl=a===b||/sharing\/tools\/newPrint$/.test(a);
a=G("input",this.printWidgetMapScale.domNode)[0];b=G("input",this.printWidgetMapExtent.domNode)[0];h.combineRadioCheckBoxWithLabel(a,this.printWidgetMapScaleLabel);h.combineRadioCheckBoxWithLabel(b,this.printWidgetMapExtentLabel);"MAP_ONLY"===this.defaultLayout?k.setStyle(this.titleTr,"display","none"):k.setStyle(this.titleTr,"display","");this._hasLabelLayer()?(k.setStyle(this.labelsFormDijit.domNode,"display",""),k.setStyle(this.labelsTitleNode,"display","")):(k.setStyle(this.labelsFormDijit.domNode,
"display","none"),k.setStyle(this.labelsTitleNode,"display","none"));l.getInstance(this.map,this.map.itemInfo).then(t.hitch(this,function(n){this.layerInfosObj=n;return z([this._getPrintTaskInfo(),this._getLayerTemplatesInfo()]).then(t.hitch(this,function(g){var n=g[0];(g=g[1])&&!g.error?(g=g&&g.results)&&0<g.length&&(r.some(g,t.hitch(this,function(g){return g&&"Output_JSON"===g.paramName?this.templateInfos=g.value:!1})),this.templateInfos&&0<this.templateInfos.length&&(this.templateNames=r.map(this.templateInfos,
function(g){return g.layoutTemplate}))):console.warn("Get Layout Templates Info Error",g&&g.error);!c.isDefined(n)||n&&n.error?this._handleError(n.error):this._handlePrintInfo(n)}))})).always(t.hitch(this,function(){this.shelter.hide()}));this.printTask._getPrintDefinition&&F.after(this.printTask,"_getPrintDefinition",t.hitch(this,"printDefInspector"),!1);this.printTask._createOperationalLayers&&(F.after(this.printTask,"_createOperationalLayers",t.hitch(this,"_fixInvalidSymbol")),F.after(this.printTask,
"_createOperationalLayers",t.hitch(this,"_excludeInvalidLegend")))},_hasLabelLayer:function(){return r.some(this.map.graphicsLayerIds,function(a){return(a=this.map.getLayer(a))&&"esri.layers.LabelLayer"===a.declaredClass},this)},_getPrintTaskInfo:function(){var a=new y;this._isNewPrintUrl?a.resolve({isGPPrint:!1}):e({url:this.printTaskURL,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(t.hitch(this,function(l){a.resolve({isGPPrint:!0,data:l})}),t.hitch(this,function(l){a.resolve({error:l})}));
return a},_getLayerTemplatesInfo:function(){var a=new y,l=this.printTaskURL.split("/"),n=l.indexOf("GPServer");if(-1<n){var g=null,g=/Utilities\/PrintingTools\/GPServer/.test(this.printTaskURL)?l.slice(0,n+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info Task")+"/execute":l.slice(0,n+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info")+"/execute";e({url:g,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(t.hitch(this,function(g){a.resolve(g)}),
t.hitch(this,function(g){a.resolve({error:g})}))}else a.resolve(null);return a},_fixInvalidSymbol:function(a){r.forEach(a,function(a){"map_graphics"===a.id&&(a=t.getObject("featureCollection.layers",!1,a))&&0<a.length&&r.forEach(a,function(n){n&&n.featureSet&&"esriGeometryPoint"===n.featureSet.geometryType&&r.forEach(n.featureSet.features,function(g){g&&g.symbol&&!g.symbol.style&&(g.symbol.style="esriSMSSquare")})})},this);return a},_excludeInvalidLegend:function(a){function l(g){return r.filter(g.subLayerIds,
t.hitch(this,function(n){return(n=this.layerInfosObj.getLayerInfoById(g.id+"_"+n))&&n.getShowLegendOfWebmap()}))}if(this.printTask.allLayerslegend){for(var n=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),n=r.map(n,function(g){return{id:g.layer.id}}),g=this.printTask.allLayerslegend,w=[],h=0;h<g.length;h++){var c=g[h],e=this.map.getLayer(c.id),C=this.layerInfosObj.getLayerInfoById(c.id),N=e&&e.declaredClass&&"esri.layers.GraphicsLayer"!==e.declaredClass,e=!e.renderer||e.renderer&&!e.renderer.hasVisualVariables(),
C=C&&C.getShowLegendOfWebmap();N&&e&&C&&(c.subLayerIds&&(c.subLayerIds=t.hitch(this,l,c)()),w.push(c))}r.forEach(n,t.hitch(this,function(g){var n=r.some(w,t.hitch(this,function(n){return n.id===g.id})),a=this.layerInfosObj.getLayerInfoById(g.id),a=a&&a.getShowLegendOfWebmap()&&a.isShowInMap();!n&&a&&w.push(g)}));this.printTask.allLayerslegend=w}return a},printDefInspector:function(a){"force"===this.preserve.preserveScale&&(a.mapOptions.scale=this.preserve.forcedScale);return a},_handleError:function(a){console.log("print widget load error: ",
a);new P({message:a.message||a})},onLayoutChange:function(a){var l=this.templateNames&&this.templateNames.indexOf(a);if(-1<l){k.empty(this.customTextElementsTable);a=this._currentTemplateInfo=this.templateInfos[l];if((l=t.getObject("layoutOptions.customTextElements",!1,a))&&0<l.length){var n=[];r.forEach(l,t.hitch(this,function(g){for(var w in g)if(0>n.indexOf(w)){var a=this.customTextElementsTable.insertRow(-1);a.insertCell(-1).appendChild(k.toDom(w+": "));a.insertCell(-1).appendChild((new H({name:w,
trim:!0,required:!1,value:g[w],style:"width:100%"})).domNode);n.push(w)}}))}t.getObject("layoutOptions.hasAuthorText",!1,a)?k.setStyle(this.authorTr,"display",""):k.setStyle(this.authorTr,"display","none");t.getObject("layoutOptions.hasCopyrightText",!1,a)?k.setStyle(this.copyrightTr,"display",""):k.setStyle(this.copyrightTr,"display","none");t.getObject("layoutOptions.hasTitleText",!1,a)?k.setStyle(this.titleTr,"display",""):k.setStyle(this.titleTr,"display","none");t.getObject("layoutOptions.hasLegend",
!1,a)?k.setStyle(this.legendTr,"display",""):k.setStyle(this.legendTr,"display","none")}else"MAP_ONLY"===a?(k.setStyle(this.authorTr,"display","none"),k.setStyle(this.copyrightTr,"display","none"),k.setStyle(this.titleTr,"display","none"),k.setStyle(this.legendTr,"display","none"),this._currentTemplateInfo={layoutOptions:{hasTitleText:!1,hasCopyrightText:!1,hasAuthorText:!1,hasLegend:!1}}):(k.setStyle(this.authorTr,"display",""),k.setStyle(this.copyrightTr,"display",""),k.setStyle(this.titleTr,"display",
""),k.setStyle(this.legendTr,"display",""),this._currentTemplateInfo={layoutOptions:{hasTitleText:!0,hasCopyrightText:!0,hasAuthorText:!0,hasLegend:!0}})},_getMapAttribution:function(){var a=this.map.attribution;return a&&a.domNode?k.getProp(a.domNode,"textContent"):""},showSettings:function(a){a.preventDefault();a.stopPropagation();this._showSettings?(C.close(this.settingsDialog),this._showSettings=!1):(C.open({popup:this.settingsDialog,around:this.advancedButtonDijit}),this._showSettings=!0)},_handlePrintInfo:function(l){if(l.isGPPrint){l=
l.data;a.set(this.layoutDijit.domNode.parentNode.parentNode,"display","");a.set(this.formatDijit.domNode.parentNode.parentNode,"display","");a.set(this.advancedButtonDijit,"display","");this.own(N(document.body,"click",t.hitch(this,function(g){if(this._showSettings){g=g.target||g.srcElement;var n=this.settingsDialog.domNode;g===n||k.isDescendant(g,n)||(C.close(this.settingsDialog),this._showSettings=!1)}})));var b=r.filter(l.parameters,function(g){return"Layout_Template"===g.name});if(0===b.length)console.log('print service parameters name for templates must be "Layout_Template"');
else{var n=r.map(b[0].choiceList,function(g){return{label:g,value:g}});n.sort(function(g,n){return g.label>n.label?1:n.label>g.label?-1:0});this.layoutDijit.addOption(n);this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",b[0].defaultValue);l=r.filter(l.parameters,function(g){return"Format"===g.name});0===l.length?console.log('print service parameters name for format must be "Format"'):(b=r.map(l[0].choiceList,function(g){return{label:g,value:g}}),b.sort(function(g,
n){return g.label>n.label?1:n.label>g.label?-1:0}),this.formatDijit.addOption(b),this.defaultFormat?this.formatDijit.set("value",this.defaultFormat):this.formatDijit.set("value",l[0].defaultValue))}}else a.set(this.layoutDijit.domNode.parentNode.parentNode,"display","none"),a.set(this.formatDijit.domNode.parentNode.parentNode,"display","none"),a.set(this.advancedButtonDijit,"display","none")},print:function(){if(this.printSettingsFormDijit.isValid()){var l=this.printSettingsFormDijit.get("value");
t.mixin(l,this.layoutMetadataDijit.get("value"));t.mixin(l,this.labelsFormDijit.get("value"));this.preserve=this.preserveFormDijit.get("value");t.mixin(l,this.preserve);this.layoutForm=this.layoutFormDijit.get("value");var b=this.mapQualityFormDijit.get("value"),n=this.mapOnlyFormDijit.get("value");t.mixin(n,b);var g=this.customTextElementsDijit.get("value"),b=[],w;for(w in g){var h={};h[w]=g[w];b.push(h)}h=this._currentTemplateInfo;w=t.getObject("layoutOptions.hasAuthorText",!1,h);var g=t.getObject("layoutOptions.hasCopyrightText",
!1,h),h=t.getObject("layoutOptions.hasTitleText",!1,h),c=new d;c.format=l.format;c.layout=l.layout;c.preserveScale="true"===l.preserveScale||"force"===l.preserveScale;c.label=l.title;c.exportOptions=n;c.showLabels=l.showLabels&&l.showLabels[0];c.layoutOptions={authorText:w?l.author:"",copyrightText:g?l.copyright||this._getMapAttribution():"",legendLayers:this._getLegendLayers(),titleText:h?l.title:"",customTextElements:b};this.printparams.template=c;this.printparams.extraParameters={printFlag:!0};
n=this.printTask.execute(this.printparams);(new O({count:this.count.toString(),icon:"PDF"===l.format?this.pdfIcon:this.imageIcon,docName:l.title,title:l.format+", "+l.layout,fileHandle:n,nls:this.nls})).placeAt(this.printResultsNode,"last").startup();a.set(this.clearActionBarNode,"display","block");this.count++}else this.printSettingsFormDijit.validate()},_getLegendLayers:function(){var a=t.getObject("layoutOptions.hasLegend",!1,this._currentTemplateInfo),l=0<this.layoutForm.legend.length&&this.layoutForm.legend[0];
if(this.printTask&&!this.printTask._createOperationalLayers){var n=[];a&&l&&(a=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),n=r.map(a,function(g){return{layerId:g.layer.id}}));return n}return a&&l?null:[]},clearResults:function(){I.empty(this.printResultsNode);a.set(this.clearActionBarNode,"display","none");this.count=1},updateAuthor:function(a){(a=a||"")&&this.authorTB&&this.authorTB.set("value",a)},getCurrentMapScale:function(){this.forceScaleNTB.set("value",this.map.getScale())}});
var O=f([m,q,u],{widgetsInTemplate:!0,templateString:B,url:null,postCreate:function(){this.inherited(arguments);this.progressBar.set("label",this.nls.creatingPrint);this.fileHandle.then(t.hitch(this,"_onPrintComplete"),t.hitch(this,"_onPrintError"))},_onPrintComplete:function(a){a.url?(this.url=a.url,k.setStyle(this.progressBar.domNode,"display","none"),k.setStyle(this.successNode,"display","inline-block"),E.add(this.resultNode,"printResultHover")):this._onPrintError(this.nls.printError)},_onPrintError:function(a){console.log(a);
k.setStyle(this.progressBar.domNode,"display","none");k.setStyle(this.errNode,"display","block");E.add(this.resultNode,"printResultError");k.setAttr(this.domNode,"title",a.details||a.message||"")},_openPrint:function(){null!==this.url&&window.open(this.url)}});return A})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ../urlUtils ./Task ../geometry/Polygon ../renderers/SimpleRenderer ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query dojo/has!extend-esri?./PrintParameters dojo/has!extend-esri?./LegendLayer".split(" "),
function(f,m,q,u,x,v,d,e,c,b,t,r,k,a,I,E,z,y,K,A,B,F,G){f=f(k,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,b){this.url=a;this.printGp=new z(this.url);this._handler=m.hitch(this,this._handler);b&&b.async&&(this.async=b.async);this._colorEvaluator=G("$..color")},_vtlExtent:null,_handler:function(a,b,c,h,e){try{var l;this.async?"esriJobSucceeded"===a.jobStatus&&this.printGp.getResultData(a.jobId,"Output_File",m.hitch(this,function(a){l=a.value;this._successHandler([l],"onComplete",c,
e)})):(l=a[0].value,this._successHandler([l],"onComplete",c,e))}catch(H){this._errorHandler(H,h,e)}},execute:function(a,c,r){var l=this._handler,t=this._errorHandler,C=a.template||new y;C.hasOwnProperty("showLabels")||(C.showLabels=!0);var k=C.exportOptions,d;k&&(d={outputSize:[k.width,k.height],dpi:k.dpi});var k=C.layoutOptions,f,v=[];if(k){this.legendAll=!1;k.legendLayers?q.forEach(k.legendLayers,function(g){var n={};n.id=g.layerId;g.subLayerIds&&(n.subLayerIds=g.subLayerIds);v.push(n)}):this.legendAll=
!0;var n,g;if("Miles"===k.scalebarUnit||"Kilometers"===k.scalebarUnit)n="esriKilometers",g="esriMiles";else if("Meters"===k.scalebarUnit||"Feet"===k.scalebarUnit)n="esriMeters",g="esriFeet";f={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};f={titleText:k.titleText,authorText:k.authorText,copyrightText:k.copyrightText,customTextElements:k.customTextElements,scaleBarOptions:{metricUnit:n,metricLabel:f[n],nonMetricUnit:g,nonMetricLabel:f[g]},legendOptions:{operationalLayers:v}}}n=this._getPrintDefinition(a.map,
C);a.outSpatialReference&&(n.mapOptions.spatialReference=a.outSpatialReference.toJson());a.template&&e.isDefined(a.template.showAttribution)&&(n.mapOptions.showAttribution=a.template.showAttribution);m.mixin(n,{exportOptions:d,layoutOptions:f});this.allLayerslegend&&m.mixin(n.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});if(n.operationalLayers){d=n.operationalLayers;var w,D=function(g){return e.fixJson(m.mixin(g,{type:"esriSLS",cap:void 0,join:void 0,meterLimit:void 0}))};
for(f=0;f<d.length;f++)if(d[f].featureCollection&&d[f].featureCollection.layers)for(g=0;g<d[f].featureCollection.layers.length;g++){var J=d[f].featureCollection.layers[g];J.layerDefinition&&J.layerDefinition.drawingInfo&&J.layerDefinition.drawingInfo.renderer&&J.layerDefinition.drawingInfo.renderer.symbol&&(w=J.layerDefinition.drawingInfo.renderer,"esriCLS"===w.symbol.type?w.symbol=D(w.symbol):w.symbol.outline&&"esriCLS"===w.symbol.outline.type&&(w.symbol.outline=D(w.symbol.outline)));if(J.featureSet&&
J.featureSet.features)for(k=0;k<J.featureSet.features.length;k++)w=J.featureSet.features[k],w.symbol&&("esriCLS"===w.symbol.type?w.symbol=D(w.symbol):w.symbol.outline&&"esriCLS"===w.symbol.outline.type&&(w.symbol.outline=D(w.symbol.outline)))}}C={Web_Map_as_JSON:u.toJson(e.fixJson(n)),Format:C.format,Layout_Template:C.layout};a.extraParameters&&(C=m.mixin(C,a.extraParameters));var L=new x(b._dfdCanceller);a=function(g,n){l(g,n,c,r,L)};n=function(g){t(g,r,L)};L._pendingDfd=this.async?this.printGp.submitJob(C,
a,null,n):this.printGp.execute(C,a,n);return L},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",
geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=v("ie")||!a.path&&"image/svg+xml"!==a.contentType)){var l,b=F.createSurface(A.create("div"),1024,1024);l="image/svg+xml"===a.contentType?
b.createObject(F.Image,{src:"data:image/svg+xml;base64,"+a.imageData,width:B.pt2px(a.width),height:B.pt2px(a.height),x:0,y:0}):b.createObject(F.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in b&&b._render(!0);var h=b.rawNode.getContext("2d"),c=Math.ceil(l.getBoundingBox().width),e=Math.ceil(l.getBoundingBox().height);l=h.getImageData(l.getBoundingBox().x,l.getBoundingBox().y,c,e);h.canvas.width=c;h.canvas.height=e;h.putImageData(l,0,0);h=h.canvas.toDataURL("image/png");a={type:"esriPMS",
imageData:h.substr(22,h.length),angle:a.angle,contentType:"image/png",height:a.size?a.size:B.px2pt(e),width:a.size?c/e*a.size:B.px2pt(c),xoffset:a.xoffset,yoffset:a.yoffset};b.destroy();return a}},_convertSvgRenderer:function(a){"simple"===a.type&&a.symbol&&(a.symbol.path||"image/svg+xml"===a.symbol.contentType)?a.symbol=this._convertSvgSymbol(a.symbol):"uniqueValue"===a.type?(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType)&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),
a.uniqueValueInfos&&q.forEach(a.uniqueValueInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this)):"classBreaks"===a.type&&(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType)&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.classBreakInfos&&q.forEach(a.classBreakInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this))},
_createFeatureCollection:function(b,c,e){var h=this._createPolygonLayer(),l=this._createPolylineLayer(),k=this._createPointLayer(),r=this._createMultipointLayer(),f=this._createPointLayer();f.layerDefinition.name="textLayer";delete f.layerDefinition.drawingInfo;if("esri.layers.FeatureLayer"===b.declaredClass||"esri.layers.StreamLayer"===b.declaredClass)h.layerDefinition.name=l.layerDefinition.name=k.layerDefinition.name=r.layerDefinition.name=m.getObject("arcgisProps.title",!1,b)||b.name||b.id;var t=
b.renderer&&"esri.renderer.SimpleRenderer"===b.renderer.declaredClass;if(!b.renderer||b.renderer.valueExpression||m.isFunction(b.renderer.attributeField))delete h.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo,delete k.layerDefinition.drawingInfo,delete r.layerDefinition.drawingInfo;else{var d=b.renderer.toJson({useLegacyRotationProperties:!0});if("temporal"===d.type){var d={latestObservationRenderer:d.latestObservationRenderer,trackLinesRenderer:d.trackRenderer,observationAger:d.observationAger,
renderer:d.observationRenderer},n={};b._trackIdField&&(n.trackIdField=b._trackIdField);b._startTimeField&&(n.startTimeField=b._startTimeField);b._endTimeField&&(n.endTimeField=b._endTimeField);h.layerDefinition.drawingInfo=d;h.layerDefinition.timeInfo=n;l.layerDefinition.drawingInfo=d;l.layerDefinition.timeInfo=n;k.layerDefinition.drawingInfo=d;k.layerDefinition.timeInfo=n;r.layerDefinition.drawingInfo=d;r.layerDefinition.timeInfo=n}else h.layerDefinition.drawingInfo.renderer=d,l.layerDefinition.drawingInfo.renderer=
d,k.layerDefinition.drawingInfo.renderer=d,r.layerDefinition.drawingInfo.renderer=d}d=b.fields;d||!b.renderer||b.renderer.valueExpression||m.isFunction(b.renderer.attributeField)||("esri.renderer.ClassBreaksRenderer"===b.renderer.declaredClass?(d=[{name:b.renderer.attributeField,type:"esriFieldTypeDouble"}],b.renderer.normalizationField&&d.push({name:b.renderer.normalizationField,type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===b.renderer.declaredClass&&(d=[{name:b.renderer.attributeField,
type:"esriFieldTypeString"}],b.renderer.attributeField2&&d.push({name:b.renderer.attributeField2,type:"esriFieldTypeString"}),b.renderer.attributeField3&&d.push({name:b.renderer.attributeField3,type:"esriFieldTypeString"})));d&&(h.layerDefinition.fields=d,l.layerDefinition.fields=d,k.layerDefinition.fields=d,r.layerDefinition.fields=d);d=b.graphics;b.isFeatureReductionActive&&b.isFeatureReductionActive()&&(d=b.getSingleGraphics());var n=d.length,g,w;for(w=0;w<n;w++){var D=d[w];if(!1!==D.visible&&
D.geometry){g=D.toJson();g.symbol&&g.symbol.outline&&g.symbol.outline.color&&g.symbol.outline.color[3]&&(g.symbol.outline.color[3]=255);if(b.renderer&&!g.symbol&&(m.isFunction(b.renderer.attributeField)||b.renderer.valueExpression||this._isFeatureCollectionRequired(b.renderer,b)||"esri.renderer.DotDensityRenderer"===b.renderer.declaredClass||e)){e=e||b.renderer;var J=null;try{J=e.getSymbol(D)}catch(R){}if(!J)continue;g.symbol=J.toJson();this._isFeatureCollectionRequired(e,b)&&this._applyVisualVariables(g.symbol,
{renderer:e,graphic:D,symbol:J,mapResolution:c&&c.getResolutionInMeters(),mapScale:c&&c.getScale()})}g.symbol&&(g.symbol.path||"image/svg+xml"===g.symbol.contentType?g.symbol=this._convertSvgSymbol(g.symbol):g.symbol.text&&delete g.attributes);switch(D.geometry.type){case "polygon":h.featureSet.features.push(g);break;case "polyline":l.featureSet.features.push(g);break;case "point":g.symbol&&g.symbol.text?f.featureSet.features.push(g):k.featureSet.features.push(g);break;case "multipoint":r.featureSet.features.push(g);
break;case "extent":g.geometry=a.fromExtent(D.geometry).toJson(),h.featureSet.features.push(g)}}}c=[];0<h.featureSet.features.length&&c.push(h);0<l.featureSet.features.length&&c.push(l);0<r.featureSet.features.length&&c.push(r);0<k.featureSet.features.length&&c.push(k);0<f.featureSet.features.length&&c.push(f);if(!c.length)return null;q.forEach(c,function(g){var a=q.every(g.featureSet.features,function(g){return g.symbol});if(t||a)q.forEach(g.featureSet.features,function(g){delete g.attributes}),
delete g.layerDefinition.fields;a&&delete g.layerDefinition.drawingInfo});q.forEach(c,function(g){g.layerDefinition.drawingInfo&&g.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(g.layerDefinition.drawingInfo.renderer)},this);return{id:b.id,opacity:b.opacity,minScale:b.minScale||0,maxScale:b.maxScale||0,featureCollection:{layers:c}}},_getPrintDefinition:function(a,b){var c={operationalLayers:this._createOperationalLayers(a,b)},h=this._vtlExtent||a.extent,l=a.spatialReference;this._vtlExtent=
null;a.spatialReference._isWrappable()&&(h=h._normalize(!0),l=h.spatialReference);h={mapOptions:{showAttribution:a.showAttribution,extent:h.toJson(),spatialReference:l.toJson()}};b.preserveScale&&m.mixin(h.mapOptions,{scale:b.outScale||a.getScale()});a.timeExtent&&m.mixin(h.mapOptions,{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});l={};m.mixin(l,h,c);return l},_createOperationalLayers:function(a,b){var e,h,d,l,k=[],f=0;b.preserveScale&&(f=b.outScale||a.getScale());this.allLayerslegend=
this.legendAll?[]:null;this._vtlExtent=null;var t=q.map(a.layerIds,a.getLayer,a);a._mapImageLyr&&t.push(a._mapImageLyr);for(e=0;e<t.length;e++)if(h=t[e],h.loaded&&h.visible&&(!f||h.isVisibleAtScale(f)))switch(d=h.declaredClass,l={id:h.id,title:m.getObject("arcgisProps.title",!1,h)||h.id,opacity:h.opacity,minScale:h.minScale||0,maxScale:h.maxScale||0},l=m.mixin(l,this._getUrlAndToken(h)),h.getNode()&&K.get(h.getNode(),"data-reference")&&(l._isRefLayer=!0),d){case "esri.layers.ArcGISDynamicMapServiceLayer":var v=
[];d=!!h._params.layers;if(h._params.dynamicLayers)d=u.fromJson(h._params.dynamicLayers),q.forEach(d,function(a){v.push({id:a.id,name:a.name,layerDefinition:a});delete a.id;delete a.name;delete a.maxScale;delete a.minScale}),0===v.length&&(l.visibleLayers=[-1]);else if(h.supportsDynamicLayers){if(d||h.layerDefinitions||h.layerTimeOptions){var n=h.createDynamicLayerInfosFromLayerInfos(),g=null;d&&(g=h.visibleLayers);var g=c._getVisibleLayers(n,g),w=c._getLayersForScale(b.outScale||a.getScale(),n);
q.forEach(n,function(a){if(!a.subLayerIds){var n=a.id;-1<q.indexOf(g,n)&&-1<q.indexOf(w,n)&&(a={source:a.source.toJson()},h.layerDefinitions&&h.layerDefinitions[n]&&(a.definitionExpression=h.layerDefinitions[n]),h.layerTimeOptions&&h.layerTimeOptions[n]&&(a.layerTimeOptions=h.layerTimeOptions[n].toJson()),v.push({id:n,layerDefinition:a}))}});0===v.length&&(l.visibleLayers=[-1])}}else q.forEach(h.layerInfos,function(a){var g={id:a.id,layerDefinition:{}};h.layerDefinitions&&h.layerDefinitions[a.id]&&
(g.layerDefinition.definitionExpression=h.layerDefinitions[a.id]);h.layerTimeOptions&&h.layerTimeOptions[a.id]&&(g.layerDefinition.layerTimeOptions=h.layerTimeOptions[a.id].toJson());(g.layerDefinition.definitionExpression||g.layerDefinition.layerTimeOptions)&&v.push(g)}),d&&(l.visibleLayers=h.visibleLayers);v.length&&(l.layers=v);k.push(l);this.allLayerslegend&&this.allLayerslegend.push({id:h.id,subLayerIds:h.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":l=m.mixin(l,{url:h.url,
bandIds:h.bandIds,compressionQuality:h.compressionQuality,format:h.format,interpolation:h.interpolation});h.mosaicRule&&m.mixin(l,{mosaicRule:h.mosaicRule.toJson()});(h.renderingRule||h.renderer)&&(d=h.getExportImageRenderingRule())&&m.mixin(l,{renderingRule:d.toJson()});k.push(l);this.allLayerslegend&&this.allLayerslegend.push({id:h.id});break;case "esri.layers.WMSLayer":l=m.mixin(l,{url:h.url,title:h.title,type:"wms",version:h.version,transparentBackground:h.imageTransparency,visibleLayers:h.visibleLayers});
k.push(l);this.allLayerslegend&&this.allLayerslegend.push({id:h.id,subLayerIds:h.visibleLayers});break;case "esri.virtualearth.VETiledLayer":d=h.mapStyle;"roadOnDemand"===d?d="Road":"aerialWithLabels"===d&&(d="Hybrid");l=m.mixin(l,{visibility:h.visible,type:"BingMaps"+d,culture:h.culture,key:h.bingMapsKey});k.push(l);break;case "esri.layers.OpenStreetMapLayer":l=m.mixin(l,{credits:h.copyright,type:"OpenStreetMap",url:r.getAbsoluteUrl(h.tileServers[0])});k.push(l);break;case "esri.layers.WMTSLayer":l=
m.mixin(l,{url:h.url,type:"wmts",layer:h._identifier,style:h._style,format:h.format,tileMatrixSet:h._tileMatrixSetId});k.push(l);break;case "esri.layers.MapImageLayer":d=h.getImages();q.forEach(d,function(a,g){a.visible&&a.href&&(l={id:h.id+"_image"+g,type:"image",title:h.id,minScale:h.minScale||0,maxScale:h.maxScale||0,opacity:h.opacity*a.opacity,extent:a.extent.toJson()},"data:image/png;base64,"===a.href.substr(0,22)?l.imageData=a.href.substr(22):l.url=a.href,k.push(l))});break;case "esri.layers.VectorTileLayer":l.type=
"image";l.url&&delete l.url;d=this._vtlExtent||a.extent.offset(0,0);var D=b.exportOptions&&b.exportOptions.dpi||96,n={format:"png",pixelRatio:D/96};"MAP_ONLY"!==b.layout||!b.preserveScale||b.outScale&&b.outScale!==a.getScale()||96!==D||!b.exportOptions||b.exportOptions.width%2===a.width%2&&b.exportOptions.height%2===a.height%2||(n.area={x:0,y:0,width:a.width,height:a.height},b.exportOptions.width%2!==a.width%2&&--n.area.width,b.exportOptions.height%2!==a.height%2&&--n.area.height,this._vtlExtent||
(D=a.toMap({x:n.area.width,y:n.area.height}),d.update(d.xmin,D.y,D.x,d.ymax,d.spatialReference),this._vtlExtent=d));l.extent=d._normalize(!0).toJson();d=h.takeScreenshot(n);d.isResolved()?d.then(function(a){"data:image/png;base64,"===a.dataURL.substr(0,22)&&(l.imageData=a.dataURL.substr(22))}):console.error("PrintTask: VectorTileLayer.takeScreenshot() returned an unresolved Promise");l.imageData&&k.push(l);break;case "esri.layers.WebTiledLayer":d=h.url.replace(/\$\{/g,"{");l=m.mixin(l,{type:"WebTiledLayer",
urlTemplate:d,credits:h.copyright});h.subDomains&&0<h.subDomains.length&&(l.subDomains=h.subDomains);h._wmtsInfo&&(l.wmtsInfo=h._wmtsInfo);delete l.url;k.push(l);break;default:if(h.getTileUrl||h.getImageUrl)l=m.mixin(l,{url:h.url}),k.push(l)}t=q.map(a.graphicsLayerIds,a.getLayer,a);for(e=0;e<t.length;e++)h=t[e],h.isFeatureReductionActive&&h.isFeatureReductionActive()&&(h.getSingleGraphics().length?t.splice(++e,0,h.getFeatureReductionLayer()):t[e]=h.getFeatureReductionLayer());for(e=0;e<t.length;e++)if(h=
t[e],h.loaded&&h.visible&&(!f||h.isVisibleAtScale(f)))switch(d=h.declaredClass,d){case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.CSVLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===d&&!b.showLabels||h.renderer&&"esri.renderer.HeatmapRenderer"===h.renderer.declaredClass)continue;d=null;h.url&&h.renderer&&("esri.renderer.ScaleDependentRenderer"===h.renderer.declaredClass?"scale"===h.renderer.rangeType?d=h.renderer.getRendererInfoByScale(a.getScale())&&
h.renderer.getRendererInfoByScale(a.getScale()).renderer:"zoom"===h.renderer.rangeType&&(d=h.renderer.getRendererInfoByZoom(a.getZoom())&&h.renderer.getRendererInfoByZoom(a.getZoom()).renderer):d=h.renderer);if(d&&("esri.renderer.SimpleRenderer"===d.declaredClass||"esri.renderer.TemporalRenderer"===d.declaredClass||m.isString(d.attributeField)&&h._getField(d.attributeField,!0))&&!d.valueExpression&&!this._isFeatureCollectionRequired(d,h)&&"esri.renderer.DotDensityRenderer"!==d.declaredClass&&"esri.layers.CSVLayer"!==
h.declaredClass&&"esri.layers.StreamLayer"!==h.declaredClass)if(l={id:h.id,title:m.getObject("arcgisProps.title",!1,h)||h.id,opacity:h.opacity,minScale:h.minScale||0,maxScale:h.maxScale||0,layerDefinition:{drawingInfo:{renderer:d.toJson({useLegacyRotationProperties:!0})}}},l=m.mixin(l,this._getUrlAndToken(h)),"esri.renderer.TemporalRenderer"===d.declaredClass&&(n=l.layerDefinition.drawingInfo,n.latestObservationRenderer=n.renderer.latestObservationRenderer,n.trackLinesRenderer=n.renderer.trackRenderer,
n.observationAger=n.renderer.observationAger,n.renderer=n.renderer.observationRenderer,h._trackIdField&&(l.layerDefinition.timeInfo={trackIdField:h._trackIdField})),this._convertSvgRenderer(l.layerDefinition.drawingInfo.renderer),1>h.opacity||"esri.renderer.TemporalRenderer"===d.declaredClass||this._updateLayerOpacity(l))if(h._params.source&&(d=h._params.source.toJson(),m.mixin(l.layerDefinition,{source:d})),h.getDefinitionExpression()&&m.mixin(l.layerDefinition,{definitionExpression:h.getDefinitionExpression()}),
2!==h.mode)0<h.getSelectedFeatures().length&&(d=q.map(h.getSelectedFeatures(),function(a){return a.attributes[h.objectIdField]}),0<d.length&&h.getSelectionSymbol()&&m.mixin(l,{selectionObjectIds:d,selectionSymbol:h.getSelectionSymbol().toJson()}));else{d=q.map(h.getSelectedFeatures(),function(a){return a.attributes[h.objectIdField]});if(0===d.length||!h._params.drawMode)break;m.mixin(l.layerDefinition,{objectIds:d});d=null;h.getSelectionSymbol()&&(d=new I(h.getSelectionSymbol()));m.mixin(l.layerDefinition.drawingInfo,
{renderer:d&&d.toJson()})}else l=this._createFeatureCollection(h,a);else l=d&&(d.valueExpression||this._isFeatureCollectionRequired(d,h)||"esri.renderer.DotDensityRenderer"===d.declaredClass)?this._createFeatureCollection(h,a,d):this._createFeatureCollection(h,a);if(!l)continue;k.push(l);this.allLayerslegend&&this.allLayerslegend.push({id:h.id});break;case "esri.layers._GraphicsLayer":case "esri.layers.GraphicsLayer":case "esri.layers.WFSLayer":if(l=this._createFeatureCollection(h,a))k.push(l),this.allLayerslegend&&
this.allLayerslegend.push({id:h.id})}f&&q.forEach(k,function(a){a.minScale=0;a.maxScale=0});a.graphics&&0<a.graphics.graphics.length&&(l=this._createFeatureCollection(a.graphics,a))&&k.push(l);a._labels&&b.showLabels&&(l=this._createFeatureCollection(a._labels,a))&&k.push(l);q.forEach(k,function(a,g,n){a._isRefLayer&&(delete a._isRefLayer,n.splice(g,1),n.push(a))});return k},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(a){var b=
this._colorEvaluator(a),b=q.filter(b,function(a){return m.isArray(a)&&4===a.length}),c=!0;if(b.length){var d=b[0][3],l;for(l=1;l<b.length;l++)if(d!==b[l][3]){c=!1;break}if(c)for(a.opacity=d/255,l=0;l<b.length;l++)b[l][3]=255}return c},_isFeatureCollectionRequired:function(a,b){if(b&&b.isFeatureReductionActive&&b.isFeatureReductionActive())return!0;var c=!1,d=this._getVariable(a,"rotationInfo",!1);d&&(c=(c=d.field)&&m.isFunction(c)||d.valueExpression);return a.hasVisualVariables("sizeInfo")||a.hasVisualVariables("colorInfo")||
a.hasVisualVariables("opacityInfo")||c},_getVariable:function(a,b,c){var d;a&&(d=(a=a.getVisualVariablesForType(b,c))&&a[0]);return d},_applyVisualVariables:function(a,b){var c=b.renderer,d=b.graphic,l=b.symbol,e=b.mapResolution,k=b.mapScale,r=l.type;if("textsymbol"!==r&&"shieldlabelsymbol"!==r){var f=this._getVariable(c,"sizeInfo",!1),v=this._getVariable(c,"colorInfo",!1),n=this._getVariable(c,"opacityInfo",!1),g=this._getVariable(c,"rotationInfo",!1);l instanceof E&&(f=this._getVariable(c,"sizeInfo",
"outline")||f);e=f?c.getSize(d,{sizeInfo:f,shape:"simplemarkersymbol"===r?l.style:null,resolution:e,scale:k}):d.size;null!=e&&("simplemarkersymbol"===r?a.size=B.px2pt(e):"picturemarkersymbol"===r?(k=l.width/l.height*e,a.width=B.px2pt(k),a.height=B.px2pt(e),0!==l.xoffset&&(a.xoffset=B.px2pt(l.xoffset/l.width*k)),0!==l.yoffset&&(a.yoffset=B.px2pt(l.yoffset/l.height*e))):"simplelinesymbol"===r?a.width=B.px2pt(e):a.outline&&(a.outline.width=B.px2pt(e)));v&&(!(l=c.getColor(d,{colorInfo:v}))||"simplemarkersymbol"!==
r&&"simplelinesymbol"!==r&&"simplefillsymbol"!==r||(a.color=t.toJsonColor(l)));n&&(r=c.getOpacity(d,{opacityInfo:n}),null!=r&&a.color&&(a.color[3]=Math.round(255*r)));g&&(c=c.getRotationAngle(d,{rotationInfo:g}))&&(a.angle=-c)}}});v("extend-esri")&&m.setObject("tasks.PrintTask",f,d);return f})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(f,m,q,u,x,v,d,e,c,b,t,r,k,a,I,E,z,y,K,A,B,F,G){f=f(r,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=m.hitch(this,this._jobUpdateHandler);this._getJobStatus=m.hitch(this,this._getJobStatus);this._getResultDataHandler=
m.hitch(this,this._getResultDataHandler);this._getResultImageHandler=m.hitch(this,this._getResultImageHandler);this._executeHandler=m.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(a,b,c){for(var d in a){var l=a[d];m.isArray(l)?a[d]=x.toJson(q.map(l,function(a){return this._gpEncode({item:a},!0).item},this)):l instanceof Date&&(a[d]=l.getTime())}return this._encode(a,b,c)},_decode:function(a){var b=a.dataType,
c=new A(a);if(-1!==q.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],b))return c;if("GPLinearUnit"===b)c.value=new E(c.value);else if("GPFeatureRecordSetLayer"===b||"GPRecordSet"===b)c.value=new k(c.value);else if("GPDataFile"===b)c.value=new z(c.value);else if("GPDate"===b)a=c.value,m.isString(a)?c.value=new K({date:a}):c.value=new Date(a);else if("GPRasterData"===b||"GPRasterDataLayer"===b)a=a.value.mapImage,c.value=a?new G(a):new y(c.value);else if(-1!==b.indexOf("GPMultiValue:")){var d=b.split(":")[1];
a=c.value;c.value=q.map(a,function(a){return this._decode({paramName:"_name",dataType:d,value:a}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+c.dataType),c=null;return c},submitJob:function(a,b,d,e,k){var h=this._getOutSR(),l=k.assembly;a=this._gpEncode(m.mixin({},this._url.query,{f:"json","env:outSR":h?h.wkid||x.toJson(h.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||x.toJson(this.processSpatialReference.toJson()):
null},a),null,l&&l[0]);var r=this._jobUpdateHandler,f=this._errorHandler;return c({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,n){r(a,n,!1,b,d,k.dfd)},error:function(a){f(a,e,k.dfd)}})},_jobUpdateHandler:function(b,c,d,e,k,r){var h=b.jobId;c=new a(b);this._successHandler([c],"onStatusUpdate",k,d&&r);if(!d)switch(clearTimeout(this._updateTimers[h]),this._updateTimers[h]=null,r&&r.progress(c),b.jobStatus){case a.STATUS_SUBMITTED:case a.STATUS_EXECUTING:case a.STATUS_WAITING:case a.STATUS_NEW:var l=
this._getJobStatus;this._updateTimers[h]=setTimeout(function(){l(h,d,e,k,r)},this.updateDelay);break;default:this._successHandler([c],"onJobComplete",e,r)}},_getJobStatus:function(a,b,d,e,k){var h=this._jobUpdateHandler;c({url:this._url.path+"/jobs/"+a,content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,c){h(a,c,b,d,e,k)},error:this._errorHandler})},_getResultDataHandler:function(a,b,c,d,e){try{var h=this._decode(a);this._successHandler([h],"onGetResultDataComplete",
c,e)}catch(H){this._errorHandler(H,d,e)}},getResultData:function(a,d,e,h){var k=this._getResultDataHandler,l=this._errorHandler,r=new u(b._dfdCanceller);r._pendingDfd=c({url:this._url.path+"/jobs/"+a+"/results/"+d,content:m.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){k(a,b,e,h,r)},error:function(a){l(a,h,r)}});return r},checkJobStatus:function(a,d,e){var h=this._jobUpdateHandler,k=this._errorHandler,l=new u(b._dfdCanceller);l._pendingDfd=
c({url:this._url.path+"/jobs/"+a,content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,b){h(a,b,!0,null,d,l)},error:function(a){k(a,e,l)}});return l},cancelJob:function(a,d,e){var h=this._errorHandler,k=new u(b._dfdCanceller);k._pendingDfd=c({url:this._url.path+"/jobs/"+a+"/cancel",content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:m.hitch(this,function(a,b){this._successHandler([a],"onJobCancel",d,k)}),error:function(a){h(a,e,k)}});
return k},execute:function(a,b,d,e){var k=this._getOutSR(),h=e.assembly;a=this._gpEncode(m.mixin({},this._url.query,{f:"json","env:outSR":k?k.wkid||x.toJson(k.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||x.toJson(this.processSpatialReference.toJson()):null},a),null,h&&h[0]);var l=this._executeHandler,r=this._errorHandler;return c({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,c){l(a,c,b,d,e.dfd)},error:function(a){r(a,
d,e.dfd)}})},_executeHandler:function(a,b,c,d,e){try{var k=a.results,h,l,r=a.messages;h=0;for(l=k.length;h<l;h++)k[h]=this._decode(k[h]);h=0;for(l=r.length;h<l;h++)r[h]=new I(r[h]);this._successHandler([k,r],"onExecuteComplete",c,e)}catch(M){this._errorHandler(M,d,e)}},_getResultImageHandler:function(a,b,c,d,e){try{var k=this._decode(a);this._successHandler([k],"onGetResultImageComplete",c,e)}catch(H){this._errorHandler(H,d,e)}},getResultImage:function(a,d,e,k,r){var h=this._getResultImageHandler,
l=this._errorHandler;e=this._gpEncode(m.mixin({},this._url.query,{f:"json"},e.toJson()));var f=new u(b._dfdCanceller);f._pendingDfd=c({url:this._url.path+"/jobs/"+a+"/results/"+d,content:e,callbackParamName:"callback",load:function(a,b){h(a,b,k,r,f)},error:function(a){l(a,r,f)}});return f},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,b,c,e){if(null==b){var k=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,
k)+"/MapServer/jobs/"+a}else a=this._url.path+"/jobs/"+a+"/results/"+b;this._url.query&&(a+="?"+d.objectToQuery(this._url.query));b=null==b?new F(a,{imageParameters:c}):new B(a,{imageParameters:c},!0);this.onGetResultImageLayerComplete(b);e&&e(b);return b},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});t._createWrappers(f);
v("extend-esri")&&m.setObject("tasks.Geoprocessor",f,e);return f})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(f,m,q,u,x){f=f(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(f){this.messages=[];m.mixin(this,f);f=this.messages;var d,e=f.length;for(d=0;d<e;d++)f[d]=new x(f[d])},jobId:"",jobStatus:""});m.mixin(f,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",
STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});q("extend-esri")&&m.setObject("tasks.JobInfo",f,u);return f})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,m,q,u){f=f(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(f){m.mixin(this,
f)}});m.mixin(f,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});q("extend-esri")&&m.setObject("tasks.GPMessage",f,u);return f})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(f,m,q,u){f=f(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(f){f&&m.mixin(this,f)},distance:0,units:null,toJson:function(){var f={};this.distance&&(f.distance=this.distance);this.units&&(f.units=this.units);return f}});q("extend-esri")&&m.setObject("tasks.LinearUnit",f,u);return f})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,m,q,u){f=f(null,{declaredClass:"esri.tasks.DataFile",
constructor:function(f){f&&m.mixin(this,f)},url:null,itemID:null,toJson:function(){var f={};this.url&&(f.url=this.url);this.itemID&&(f.itemID=this.itemID);return f}});q("extend-esri")&&m.setObject("tasks.DataFile",f,u);return f})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,m,q,u){f=f(null,{declaredClass:"esri.tasks.RasterData",constructor:function(f){f&&m.mixin(this,f)},url:null,format:null,itemID:null,toJson:function(){var f=
{};this.url&&(f.url=this.url);this.format&&(f.format=this.format);this.itemID&&(f.itemID=this.itemID);return f}});q("extend-esri")&&m.setObject("tasks.RasterData",f,u);return f})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(f,m,q,u,x){f=f(null,{declaredClass:"esri.tasks.Date",constructor:function(f){f&&(f.format&&(this.format=f.format),this.date=q.parse(f.date,{selector:"date",datePattern:this.format}))},date:new Date,
format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:q.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}});u("extend-esri")&&m.setObject("tasks.Date",f,x);return f})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,m,q,u){f=f(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(f){m.mixin(this,f)}});q("extend-esri")&&m.setObject("tasks.ParameterValue",f,u);return f})},
"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(f,m,q,u,x,v,d){f=f(d,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(d,c){c&&c.imageParameters&&c.imageParameters.extent&&(this.initialExtent=this.fullExtent=c.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=m.hitch(this,this.getImageUrl);
this.loaded=!0;this.onLoad(this)},getImageUrl:function(d,c,b,f){var e=d.spatialReference.wkid;f(this._url.path+"?"+x.objectToQuery(m.mixin(this._params,{f:"image",bbox:q.toJson(d.toJson()),bboxSR:e,imageSR:e,size:c+","+b})))}});u("extend-esri")&&m.setObject("tasks._GPResultImageLayer",f,v);return f})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,m,q,u){f=f(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,
height:1100,dpi:96},layoutOptions:null,format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,showAttribution:null,showLabels:!0});q("extend-esri")&&m.setObject("tasks.PrintTemplate",f,u);return f})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(f,m,q,u,x,v,d,e,c,b,t,r,k){function a(a,g,b,c,d,e,k,h,f,r){var n,w,l=g.length,
D=0;r?(w=r.l/d,D=r.i):w=g[0]/d;for(;e<k;)e+w>k&&(n={l:(e+w-k)*d,i:D},w=k-e),D%2||(a.beginPath(),a.arc(b,c,d,e,e+w,h),f&&a.stroke()),e+=w,++D,w=g[D%l]/d;return n}function I(a,g,b,c){var n=0,w=0,d,e=0;c?(d=c.l,e=c.i):d=g[0];for(;1>w;)w=k.tAtLength(a,d),1==w&&(n=k.computeLength(a),n={l:d-n,i:e}),a=k.splitBezierAtT(a,w),e%2||b.push(a[0]),a=a[1],++e,d=g[e%g.length];return n}function E(a,g,b,c){var n=[g.last.x,g.last.y].concat(b),w=!(a instanceof Array);b=4===b.length?"quadraticCurveTo":"bezierCurveTo";
var d=[];g=I(n,g.canvasDash,d,c);for(c=0;c<d.length;++c)n=d[c],w?(a.moveTo(n[0],n[1]),a[b].apply(a,n.slice(2))):(a.push("moveTo",[n[0],n[1]]),a.push(b,n.slice(2)));return g}function z(a,g,b,c,d,e,h){var n=0,w=0,f=0,r=k.distance(b,c,d,e),l=0;g=g.canvasDash;var t=b,D=c,v,I=!(a instanceof Array);h?(f=h.l,l=h.i):f+=g[0];for(;.01<Math.abs(1-w);)f>r&&(n={l:f-r,i:l},f=r),w=f/r,h=b+(d-b)*w,v=c+(e-c)*w,l++%2||(I?(a.moveTo(t,D),a.lineTo(h,v)):(a.push("moveTo",[t,D]),a.push("lineTo",[h,v]))),t=h,D=v,f+=g[l%
g.length];return n}var y=f.canvas={},K=null,A=t.multiplyPoint,B=Math.PI,F=2*B,G=B/2;r=m.extend;if(x.global.CanvasRenderingContext2D){x=x.doc.createElement("canvas").getContext("2d");var l="function"==typeof x.setLineDash,L="function"==typeof x.fillText}var P={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};y.Shape=u("dojox.gfx.canvas.Shape",e.Shape,
{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var g=this.canvasTransform;a.translate(g.dx,g.dy);a.rotate(g.angle2);a.scale(g.sx,g.sy);a.rotate(g.angle1)}},_renderShape:function(a){},_renderFill:function(a,g){if("canvasFill"in this){var b=this.fillStyle;
if("canvasFillImage"in this){var n=b.width,c=b.height,d=this.canvasFillImage.width,e=this.canvasFillImage.height,k=Math.min(n==d?1:n/d,c==e?1:c/e),h=(n-k*d)/2,f=(c-k*e)/2;K.width=n;K.height=c;var r=K.getContext("2d");r.clearRect(0,0,n,c);r.drawImage(this.canvasFillImage,0,0,d,e,h,f,k*d,k*e);this.canvasFill=a.createPattern(K,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;g&&("pattern"!==b.type||0===b.x&&0===b.y||a.translate(b.x,b.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},
_renderStroke:function(a,g){var b=this.strokeStyle;b?(a.strokeStyle=b.color.toString(),a.lineWidth=b.width,a.lineCap=b.cap,"number"==typeof b.join?(a.lineJoin="miter",a.miterLimit=b.join):a.lineJoin=b.join,this.canvasDash?l?(a.setLineDash(this.canvasDash),g&&a.stroke()):this._renderDashedStroke(a,g):g&&a.stroke()):g||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,g){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,
setClip:function(a){this.inherited(arguments);var g=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!g)return this;this.canvasClip=a?h(g,a):null;this.parent&&this.parent._makeDirty();return this}});var h=function(a,g){switch(a){case "ellipse":return{canvasEllipse:O({shape:g}),render:function(a){return y.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:m.delegate(g,{r:0}),render:function(a){return y.Rect.prototype._renderShape.call(this,
a)}};case "path":return{canvasPath:N(g),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:g.points,render:function(a){return y.Polyline.prototype._renderShape.call(this,a)}}}return null},N=function(a){var g=new dojox.gfx.canvas.Path;g.canvasPath=[];g._setPath(a.d);return g},C=function(a,g,b){var n=a.prototype[g];a.prototype[g]=b?function(){this.parent&&this.parent._makeDirty();n.apply(this,arguments);b.call(this);return this}:function(){this.parent&&this.parent._makeDirty();
return n.apply(this,arguments)}};C(y.Shape,"setTransform",function(){this.matrix?this.canvasTransform=f.decompose(this.matrix):delete this.canvasTransform});C(y.Shape,"setFill",function(){var a=this.fillStyle,g;if(a){if("object"==typeof a&&"type"in a){var b=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":g="linear"==a.type?b.createLinearGradient(a.x1,a.y1,a.x2,a.y2):b.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);q.forEach(a.colors,function(a){g.addColorStop(a.offset,
f.normalizeColor(a.color).toString())});break;case "pattern":K||(K=document.createElement("canvas")),b=new Image,this.surface.downloadImage(b,a.src),this.canvasFillImage=b}}else g=a.toString();this.canvasFill=g}else delete this.canvasFill});C(y.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var g=this.strokeStyle.style.toLowerCase();g in P&&(g=P[g]);if(g instanceof Array){this.canvasDash=g=g.slice();var b;for(b=0;b<g.length;++b)g[b]*=a.width;if("butt"!=a.cap){for(b=0;b<g.length;b+=2)g[b]-=
a.width,1>g[b]&&(g[b]=1);for(b=1;b<g.length;b+=2)g[b]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!l&&!!this.canvasDash});C(y.Shape,"setShape");y.Group=u("dojox.gfx.canvas.Group",y.Shape,{constructor:function(){e.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var g=0;g<this.children.length;++g)this.children[g]._render(a);a.restore()},destroy:function(){e.Container.clear.call(this,!0);y.Shape.prototype.destroy.apply(this,
arguments)}});y.Rect=u("dojox.gfx.canvas.Rect",[y.Shape,e.Rect],{_renderShape:function(a){var g=this.shape,b=Math.min(g.r,g.height/2,g.width/2),n=g.x,c=n+g.width,d=g.y,g=d+g.height,e=n+b,k=c-b,h=d+b,f=g-b;a.beginPath();a.moveTo(e,d);b?(a.arc(k,h,b,-G,0,!1),a.arc(k,f,b,0,G,!1),a.arc(e,f,b,G,B,!1),a.arc(e,h,b,B,B+G,!1)):(a.lineTo(k,d),a.lineTo(c,f),a.lineTo(e,g),a.lineTo(n,h));a.closePath()},_renderDashedStroke:function(b,g){var c=this.shape,d=Math.min(c.r,c.height/2,c.width/2),n=c.x,e=n+c.width,k=
c.y,h=k+c.height,f=n+d,r=e-d,l=k+d,t=h-d;d?(b.beginPath(),c=z(b,this,f,k,r,k),g&&b.stroke(),c=a(b,this.canvasDash,r,l,d,-G,0,!1,g,c),b.beginPath(),c=z(b,this,e,l,e,t,c),g&&b.stroke(),c=a(b,this.canvasDash,r,t,d,0,G,!1,g,c),b.beginPath(),c=z(b,this,r,h,f,h,c),g&&b.stroke(),c=a(b,this.canvasDash,f,t,d,G,B,!1,g,c),b.beginPath(),c=z(b,this,n,t,n,l,c),g&&b.stroke(),a(b,this.canvasDash,f,l,d,B,B+G,!1,g,c)):(b.beginPath(),c=z(b,this,f,k,r,k),c=z(b,this,r,k,e,t,c),c=z(b,this,e,t,f,h,c),z(b,this,f,h,n,l,c),
g&&b.stroke())}});var H=[];(function(){var a=b.curvePI4;H.push(a.s,a.c1,a.c2,a.e);for(var g=45;360>g;g+=45){var c=t.rotateg(g);H.push(A(c,a.c1),A(c,a.c2),A(c,a.e))}})();var O=function(a){var b,c,d,n=[],e=a.shape,k=t.normalize([t.translate(e.cx,e.cy),t.scale(e.rx,e.ry)]);b=A(k,H[0]);n.push([b.x,b.y]);for(e=1;e<H.length;e+=3)c=A(k,H[e]),d=A(k,H[e+1]),b=A(k,H[e+2]),n.push([c.x,c.y,d.x,d.y,b.x,b.y]);if(a._needsDash){b=[];c=n[0];for(e=1;e<n.length;++e)d=[],I(c.concat(n[e]),a.canvasDash,d),c=[n[e][4],n[e][5]],
b.push(d);a._dashedPoints=b}return n};y.Ellipse=u("dojox.gfx.canvas.Ellipse",[y.Shape,e.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=O(this);return this},setStroke:function(){this.inherited(arguments);l||(this.canvasEllipse=O(this));return this},_renderShape:function(a){var b=this.canvasEllipse,c;a.beginPath();a.moveTo.apply(a,b[0]);for(c=1;c<b.length;++c)a.bezierCurveTo.apply(a,b[c]);a.closePath()},_renderDashedStroke:function(a,b){var g=this._dashedPoints;a.beginPath();
for(var c=0;c<g.length;++c)for(var d=g[c],n=0;n<d.length;++n){var e=d[n];a.moveTo(e[0],e[1]);a.bezierCurveTo(e[2],e[3],e[4],e[5],e[6],e[7])}b&&a.stroke()}});y.Circle=u("dojox.gfx.canvas.Circle",[y.Shape,e.Circle],{_renderShape:function(a){var b=this.shape;a.beginPath();a.arc(b.cx,b.cy,b.r,0,F,1)},_renderDashedStroke:function(a,b){var g=this.shape,c=0,d,n=this.canvasDash.length;for(i=0;c<F;)d=this.canvasDash[i%n]/g.r,i%2||(a.beginPath(),a.arc(g.cx,g.cy,g.r,c,c+d,0),b&&a.stroke()),c+=d,++i}});y.Line=
u("dojox.gfx.canvas.Line",[y.Shape,e.Line],{_renderShape:function(a){var b=this.shape;a.beginPath();a.moveTo(b.x1,b.y1);a.lineTo(b.x2,b.y2)},_renderDashedStroke:function(a,b){var g=this.shape;a.beginPath();z(a,this,g.x1,g.y1,g.x2,g.y2);b&&a.stroke()}});y.Polyline=u("dojox.gfx.canvas.Polyline",[y.Shape,e.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,b=a[0],c,d;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof b)b=a;else for(b=[],d=0;d<a.length;++d)c=
a[d],b.push(c.x,c.y);else b=[];this.canvasPolyline=b;return this},_renderShape:function(a){var b=this.canvasPolyline;if(b.length){a.beginPath();a.moveTo(b[0],b[1]);for(var c=2;c<b.length;c+=2)a.lineTo(b[c],b[c+1])}},_renderDashedStroke:function(a,b){var g=this.canvasPolyline,c=0;a.beginPath();for(var d=0;d<g.length;d+=2)c=z(a,this,g[d],g[d+1],g[d+2],g[d+3],c);b&&a.stroke()}});y.Image=u("dojox.gfx.canvas.Image",[y.Shape,e.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,
this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var b=this.shape;a.drawImage(this.canvasImage,b.x,b.y,b.width,b.height)}});y.Text=u("dojox.gfx.canvas.Text",[y.Shape,e.Text],{_setFont:function(){this.fontStyle?this.canvasFont=f.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,b=0,c;a.text&&(c=this.surface.rawNode.getContext("2d"),c.save(),this._renderTransform(c),this._renderFill(c,!1),this._renderStroke(c,!1),this.canvasFont&&
(c.font=this.canvasFont),b=c.measureText(a.text).width,c.restore());return b},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var b=this.shape;b.text&&(a.textAlign="middle"===b.align?"center":b.align,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(b.text,b.x,b.y),this.strokeStyle&&(a.beginPath(),a.strokeText(b.text,b.x,b.y),a.closePath()))}});C(y.Text,"setFont");L||
y.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var Q={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};y.Path=u("dojox.gfx.canvas.Path",[y.Shape,c.Path],{constructor:function(){this.lastControl=
{}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);l||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var b=m.clone(this.last);this[Q[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=b;this.inherited(arguments)},_renderShape:function(a){var b=this.canvasPath;
a.beginPath();for(var c=0;c<b.length;c+=2)a[b[c]].apply(a,b[c+1])},_renderDashedStroke:l?function(){}:function(a,b){var c=this._dashedPath;a.beginPath();for(var g=0;g<c.length;g+=2)a[c[g]].apply(a,c[g+1]);b&&a.stroke()},_moveToA:function(a,b,c,d){a.push("moveTo",[c[0],c[1]]);d&&d.push("moveTo",[c[0],c[1]]);for(b=2;b<c.length;b+=2)a.push("lineTo",[c[b],c[b+1]]),d&&(this._dashResidue=z(d,this,c[b-2],c[b-1],c[b],c[b+1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl=
{}},_moveToR:function(a,b,c,d){b="x"in this.last?[this.last.x+=c[0],this.last.y+=c[1]]:[this.last.x=c[0],this.last.y=c[1]];a.push("moveTo",b);d&&d.push("moveTo",b);for(b=2;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=z(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,b,c,d){for(b=0;b<c.length;b+=2)d&&(this._dashResidue=z(d,this,this.last.x,this.last.y,c[b],c[b+1],this._dashResidue)),
a.push("lineTo",[c[b],c[b+1]]);this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_lineToR:function(a,b,c,d){for(b=0;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=z(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[c[b],this.last.y]),d&&(this._dashResidue=z(d,this,d[d.length-1][0],d[d.length-1][1],c[b],this.last.y,
this._dashResidue));this.last.x=c[c.length-1];this.lastControl={}},_hLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x+=c[b],this.last.y]),d&&(this._dashResidue=z(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,c[b]]),d&&(this._dashResidue=z(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,c[b],this._dashResidue));this.last.y=c[c.length-
1];this.lastControl={}},_vLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,this.last.y+=c[b]]),d&&(this._dashResidue=z(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",c.slice(b,b+6)),d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=
c[c.length-3];this.lastControl.type="C"},_curveToR:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",[this.last.x+c[b],this.last.y+c[b+1],this.lastControl.x=this.last.x+c[b+2],this.lastControl.y=this.last.y+c[b+3],this.last.x+c[b+4],this.last.y+c[b+5]]),d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+4],this.last.y+=c[b+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4){var g="C"==this.lastControl.type;a.push("bezierCurveTo",
[g?2*this.last.x-this.lastControl.x:this.last.x,g?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1],c[b+2],c[b+3]]);d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=c[b];this.lastControl.y=c[b+1];this.lastControl.type="C"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_smoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4){var g="C"==this.lastControl.type;a.push("bezierCurveTo",[g?2*this.last.x-this.lastControl.x:this.last.x,g?2*this.last.y-this.lastControl.y:
this.last.y,this.last.x+c[b],this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]);d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+c[b];this.lastControl.y=this.last.y+c[b+1];this.lastControl.type="C";this.last.x+=c[b+2];this.last.y+=c[b+3]}},_qCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",c.slice(b,b+4));d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-
1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="Q"},_qCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[b],this.lastControl.y=this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]),d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+2],this.last.y+=c[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;
a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1]]);d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,
this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1]]);d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[b];this.last.y+=c[b+1]}},_arcTo:function(a,c,d,e){c="a"==c;for(var g=0;g<d.length;g+=7){var k=d[g+5],f=d[g+6];c&&(k+=this.last.x,f+=this.last.y);var h=b.arcAsBezier(this.last,d[g],d[g+1],d[g+2],d[g+3]?1:0,d[g+4]?1:0,k,f);q.forEach(h,function(b){a.push("bezierCurveTo",b)});e&&(this._dashResidue=
E(e,this,p,this._dashResidue));this.last.x=k;this.last.y=f}this.lastControl={}},_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=z(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});q.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){C(y.Path,a)});y.TextPath=u("dojox.gfx.canvas.TextPath",[y.Shape,c.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});
y.Surface=u("dojox.gfx.canvas.Surface",e.Surface,{constructor:function(){e.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){e.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=f.normalizedLength(a);this.height=f.normalizedLength(b);if(!this.rawNode)return this;var c=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,c=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,c=!0);c&&
this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender))},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||
"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(m.hitch(this,this._render),0))},downloadImage:function(a,b){var c=m.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},
on:function(){}});y.createSurface=function(a,b,c){if(!b&&!c){var e=v.position(a);b=b||e.w;c=c||e.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");e=new y.Surface;a=d.byId(a);var g=a.ownerDocument.createElement("canvas");g.width=f.normalizedLength(b);g.height=f.normalizedLength(c);a.appendChild(g);e.rawNode=g;e._parent=a;return e.surface=e};var M=e.Container;u={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();
return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return M.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return M.remove.apply(this,arguments)},clear:function(){this._makeDirty();return M.clear.apply(this,arguments)},getBoundingBox:M.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return M._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return M._moveChildToBack.apply(this,
arguments)}};c={createObject:function(a,b){var c=new a;c.surface=this.surface;c.setShape(b);this.add(c);return c}};r(y.Group,u);r(y.Group,e.Creator);r(y.Group,c);r(y.Surface,u);r(y.Surface,e.Creator);r(y.Surface,c);y.fixTarget=function(a,b){return!0};return y})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(f,m,q,u,x,v,d,e,c,b){function t(a,
b){if(!r)return a.splice(b,1);var c=a.length;if(c){for(;b<c;)a[b]=a[b+1],b++;a.length--}}var r=!!x("chrome"),k=f.shape={};k.Shape=q("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(x("gfxRegistry")){var a=k.register(this);this.getUID=function(){return a}}},destroy:function(){x("gfxRegistry")&&k.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=
null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var c=this._getRealMatrix();return[b.multiplyPoint(c,a.x,a.y),b.multiplyPoint(c,a.x+a.width,a.y),
b.multiplyPoint(c,a.x+a.width,a.y+a.height),b.multiplyPoint(c,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=f.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=f.makeParameters(f.defaultLinearGradient,a);break;case "radial":b=f.makeParameters(f.defaultRadialGradient,
a);break;case "pattern":b=f.makeParameters(f.defaultPattern,a)}else b=f.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||m.isArray(a)||a instanceof c)a={color:a};a=this.strokeStyle=f.makeParameters(f.defaultStroke,a);a.color=f.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=b.clone(a?b.normalize(a):b.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=
this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&
this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?b.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,c=this.parent;c;)c.matrix&&(a=b.multiply(c.matrix,a)),c=c.parent;return a}});k._eventsProcessing={on:function(a,b){return v(this.getEventSource(),a,k.fixCallback(this,f.fixTarget,b))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));
return this.on(a,c?m.hitch(b,c):b)},disconnect:function(a){return a.remove()}};k.fixCallback=function(a,b,c,d){d||(d=c,c=null);if(m.isString(d)){c=c||u.global;if(!c[d])throw['dojox.gfx.shape.fixCallback: scope["',d,'"] is null (scope\x3d"',c,'")'].join("");return function(e){return b(e,a)?c[d].apply(c,arguments||[]):void 0}}return c?function(e){return b(e,a)?d.apply(c,arguments||[]):void 0}:function(e){return b(e,a)?d.apply(c,arguments):void 0}};m.extend(k.Shape,k._eventsProcessing);k.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);t(this.children,c);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var a=null;d.forEach(this.children,function(c){var d=c.getBoundingBox();d&&((c=c.getTransform())&&(d=b.multiplyRectangle(c,d)),a?(a.x=Math.min(a.x,d.x),a.y=Math.min(a.y,d.y),a.endX=Math.max(a.endX,d.x+d.width),a.endY=Math.max(a.endY,d.y+d.height)):a={x:d.x,y:d.y,endX:d.x+d.width,endY:d.y+d.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){t(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){t(this.children,b);this.children.unshift(a);break}return this}};k.Surface=q("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){d.forEach(this._nodes,e.destroy);this._nodes=[];d.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;
if(x("ie"))for(;this._parent.lastChild;)e.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var c=m.hitch(a,b);if(this.isLoaded)c(this);else v.once(this,"load",function(a){c(a)})}});m.extend(k.Surface,k._eventsProcessing);k.Rect=q("dojox.gfx.shape.Rect",k.Shape,{constructor:function(a){this.shape=f.getDefault("Rect");this.rawNode=
a},getBoundingBox:function(){return this.shape}});k.Ellipse=q("dojox.gfx.shape.Ellipse",k.Shape,{constructor:function(a){this.shape=f.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});k.Circle=q("dojox.gfx.shape.Circle",k.Shape,{constructor:function(a){this.shape=f.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-
a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});k.Line=q("dojox.gfx.shape.Line",k.Shape,{constructor:function(a){this.shape=f.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});k.Polyline=q("dojox.gfx.shape.Polyline",k.Shape,{constructor:function(a){this.shape=f.getDefault("Polyline");this.rawNode=a},setShape:function(a,
b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],d=0;d<b;d+=2)c.push({x:a[d],y:a[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],d=c.x,e=c.y,k=c.x,f=c.y,r=1;r<b;++r)c=
a[r],d>c.x&&(d=c.x),k<c.x&&(k=c.x),e>c.y&&(e=c.y),f<c.y&&(f=c.y);this.bbox={x:d,y:e,width:k-d,height:f-e}}return this.bbox}});k.Image=q("dojox.gfx.shape.Image",k.Shape,{constructor:function(a){this.shape=f.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});k.Text=q(k.Shape,{constructor:function(a){this.fontStyle=null;this.shape=f.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},
setFont:function(a){this.fontStyle="string"==typeof a?f.splitFontString(a):f.makeParameters(f.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=f._base._computeTextBoundingBox(this));return a}});k.Creator={createShape:function(a){switch(a.type){case f.defaultPath.type:return this.createPath(a);case f.defaultRect.type:return this.createRect(a);case f.defaultCircle.type:return this.createCircle(a);case f.defaultEllipse.type:return this.createEllipse(a);
case f.defaultLine.type:return this.createLine(a);case f.defaultPolyline.type:return this.createPolyline(a);case f.defaultImage.type:return this.createImage(a);case f.defaultText.type:return this.createText(a);case f.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(f.Group)},createRect:function(a){return this.createObject(f.Rect,a)},createEllipse:function(a){return this.createObject(f.Ellipse,a)},createCircle:function(a){return this.createObject(f.Circle,
a)},createLine:function(a){return this.createObject(f.Line,a)},createPolyline:function(a){return this.createObject(f.Polyline,a)},createImage:function(a){return this.createObject(f.Image,a)},createText:function(a){return this.createObject(f.Text,a)},createPath:function(a){return this.createObject(f.Path,a)},createTextPath:function(a){return this.createObject(f.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return k})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/declare","./matrix","./shape"],function(f,m,q,u,x){x=q("dojox.gfx.path.Path",x.Shape,{constructor:function(v){this.shape=m.clone(f.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=v;this.segmented=!1},setAbsoluteMode:function(f){this._confirmSegmented();this.absolute="string"==typeof f?"absolute"==f:f;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&
"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var f=this.bbox,d=this._getRealMatrix();this.bbox=null;for(var e=0,c=this.segments.length;e<c;++e)this._updateWithSegment(this.segments[e],d);d=this.bbox;this.bbox=f;return this.tbbox=d?[{x:d.l,y:d.t},{x:d.r,y:d.t},{x:d.r,y:d.b},{x:d.l,y:d.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in
this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(f,d,e){e&&(d=u.multiplyPoint(e,f,d),f=d.x,d=d.y);this.bbox&&"l"in this.bbox?(this.bbox.l>f&&(this.bbox.l=f),this.bbox.r<f&&(this.bbox.r=f),this.bbox.t>d&&(this.bbox.t=d),this.bbox.b<d&&(this.bbox.b=d)):this.bbox={l:f,b:d,r:f,t:d}},_updateWithSegment:function(v,d){var e=v.args,c=e.length,b;switch(v.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(b=0;b<c;b+=2)this._updateBBox(e[b],
e[b+1],d);this.last.x=e[c-2];this.last.y=e[c-1];this.absolute=!0;break;case "H":for(b=0;b<c;++b)this._updateBBox(e[b],this.last.y,d);this.last.x=e[c-1];this.absolute=!0;break;case "V":for(b=0;b<c;++b)this._updateBBox(this.last.x,e[b],d);this.last.y=e[c-1];this.absolute=!0;break;case "m":b=0;"x"in this.last||(this._updateBBox(this.last.x=e[0],this.last.y=e[1],d),b=2);for(;b<c;b+=2)this._updateBBox(this.last.x+=e[b],this.last.y+=e[b+1],d);this.absolute=!1;break;case "l":case "t":for(b=0;b<c;b+=2)this._updateBBox(this.last.x+=
e[b],this.last.y+=e[b+1],d);this.absolute=!1;break;case "h":for(b=0;b<c;++b)this._updateBBox(this.last.x+=e[b],this.last.y,d);this.absolute=!1;break;case "v":for(b=0;b<c;++b)this._updateBBox(this.last.x,this.last.y+=e[b],d);this.absolute=!1;break;case "c":for(b=0;b<c;b+=6)this._updateBBox(this.last.x+e[b],this.last.y+e[b+1],d),this._updateBBox(this.last.x+e[b+2],this.last.y+e[b+3],d),this._updateBBox(this.last.x+=e[b+4],this.last.y+=e[b+5],d);this.absolute=!1;break;case "s":case "q":for(b=0;b<c;b+=
4)this._updateBBox(this.last.x+e[b],this.last.y+e[b+1],d),this._updateBBox(this.last.x+=e[b+2],this.last.y+=e[b+3],d);this.absolute=!1;break;case "A":for(b=0;b<c;b+=7)this._updateBBox(e[b+5],e[b+6],d);this.last.x=e[c-2];this.last.y=e[c-1];this.absolute=!0;break;case "a":for(b=0;b<c;b+=7)this._updateBBox(this.last.x+=e[b+5],this.last.y+=e[b+6],d);this.absolute=!1}var t=[v.action];for(b=0;b<c;++b)t.push(f.formatNumber(e[b],!0));if("string"==typeof this.shape.path)this.shape.path+=t.join("");else for(b=
0,c=t.length;b<c;++b)this.shape.path.push(t[b])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(f,d){this.tbbox=null;var e=this._validSegments[f.toLowerCase()];"number"==typeof e&&(e?d.length>=e&&(e={action:f,args:d.slice(0,d.length-d.length%e)},this.segments.push(e),this._updateWithSegment(e)):(e={action:f,args:[]},this.segments.push(e),this._updateWithSegment(e)))},_collectArgs:function(f,d){for(var e=0;e<d.length;++e){var c=d[e];"boolean"==typeof c?f.push(c?1:0):
"number"==typeof c?f.push(c):c instanceof Array?this._collectArgs(f,c):"x"in c&&"y"in c&&f.push(c.x,c.y)}},moveTo:function(){this._confirmSegmented();var f=[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?"M":"m",f);return this},lineTo:function(){this._confirmSegmented();var f=[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?"L":"l",f);return this},hLineTo:function(){this._confirmSegmented();var f=[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?
"H":"h",f);return this},vLineTo:function(){this._confirmSegmented();var f=[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?"V":"v",f);return this},curveTo:function(){this._confirmSegmented();var f=[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?"C":"c",f);return this},smoothCurveTo:function(){this._confirmSegmented();var f=[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?"S":"s",f);return this},qCurveTo:function(){this._confirmSegmented();var f=
[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?"Q":"q",f);return this},qSmoothCurveTo:function(){this._confirmSegmented();var f=[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?"T":"t",f);return this},arcTo:function(){this._confirmSegmented();var f=[];this._collectArgs(f,arguments);this._pushSegment(this.absolute?"A":"a",f);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var f=
this.shape.path;this.shape.path=[];this._setPath(f);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(q){q=m.isArray(q)?q:q.match(f.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(q){for(var d="",e=[],c=q.length,b=0;b<c;++b){var t=q[b],r=parseFloat(t);isNaN(r)?(d&&this._pushSegment(d,e),e=[],d=t):e.push(r)}this._pushSegment(d,e)}},setShape:function(q){this.inherited(arguments,["string"==typeof q?{path:q}:q]);this.segmented=!1;this.segments=
[];f.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});q=q("dojox.gfx.path.TextPath",x,{constructor:function(q){"text"in this||(this.text=m.clone(f.defaultTextPath));"fontStyle"in this||(this.fontStyle=m.clone(f.defaultFont))},getText:function(){return this.text},setText:function(q){this.text=f.makeParameters(this.text,"string"==typeof q?{text:q}:q);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(q){this.fontStyle="string"==typeof q?
f.splitFontString(q):f.makeParameters(f.defaultFont,q);this._setFont();return this}});return f.path={Path:x,TextPath:q}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(f,m,q){function u(b){var c=Math.cos(b);b=Math.sin(b);var d={x:c+4/3*(1-c),y:b-4/3*c*(1-c)/b};return{s:{x:c,y:-b},c1:{x:d.x,y:-d.y},c2:d,e:{x:c,y:b}}}var x=2*Math.PI,v=Math.PI/4,d=Math.PI/8,e=v+d,c=u(d);return f.arc={unitArcAsBezier:u,curvePI4:c,arcAsBezier:function(b,f,r,k,a,m,E,z){a=!!a;m=!!m;
var t=q._degToRad(k);k=f*f;var I=r*r,A=q.multiplyPoint(q.rotate(-t),{x:(b.x-E)/2,y:(b.y-z)/2}),B=A.x*A.x,F=A.y*A.y;k=Math.sqrt((k*I-k*F-I*B)/(k*F+I*B));isNaN(k)&&(k=0);k={x:k*f*A.y/r,y:-k*r*A.x/f};a==m&&(k={x:-k.x,y:-k.y});k=q.multiplyPoint([q.translate((b.x+E)/2,(b.y+z)/2),q.rotate(t)],k);f=q.normalize([q.translate(k.x,k.y),q.rotate(t),q.scale(f,r)]);k=q.invert(f);b=q.multiplyPoint(k,b);z=q.multiplyPoint(k,E,z);E=Math.atan2(b.y,b.x);k=E-Math.atan2(z.y,z.x);m&&(k=-k);0>k?k+=x:k>x&&(k-=x);r=d;z=c;
r=m?r:-r;b=[];for(a=k;0<a;a-=v)a<e&&(r=a/2,z=u(r),r=m?r:-r,a=0),A=q.normalize([f,q.rotate(E+r)]),m?(k=q.multiplyPoint(A,z.c1),t=q.multiplyPoint(A,z.c2),A=q.multiplyPoint(A,z.e)):(k=q.multiplyPoint(A,z.c2),t=q.multiplyPoint(A,z.c1),A=q.multiplyPoint(A,z.s)),b.push([k.x,k.y,t.x,t.y,A.x,A.y]),E+=2*r;return b}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(f,m,q){function u(c,b){return Math.abs(c-b)<=1E-6*(Math.abs(c)+Math.abs(b))}function x(c,b,d,e){if(!isFinite(c))return d;
if(!isFinite(d))return c;b=Math.abs(b);e=Math.abs(e);return(b*c+e*d)/(b+e)}function v(c){c=q.normalize(c);var b=-c.xx-c.yy,d=c.xx*c.yy-c.xy*c.yx,e=Math.sqrt(b*b-4*d),b=-(b+(0>b?-e:e))/2,d=d/b,e=c.xy/(b-c.xx),f=1,a=c.xy/(d-c.xx),m=1;u(b,d)&&(e=1,a=f=0,m=1);isFinite(e)||(e=1,f=(b-c.xx)/c.xy,isFinite(f)||(e=(b-c.yy)/c.yx,f=1,isFinite(e)||(e=1,f=c.yx/(b-c.yy))));isFinite(a)||(a=1,m=(d-c.xx)/c.xy,isFinite(m)||(a=(d-c.yy)/c.yx,m=1,isFinite(a)||(a=1,m=c.yx/(d-c.yy))));c=Math.sqrt(e*e+f*f);var v=Math.sqrt(a*
a+m*m);isFinite(e/=c)||(e=0);isFinite(f/=c)||(f=0);isFinite(a/=v)||(a=0);isFinite(m/=v)||(m=0);return{value1:b,value2:d,vector1:{x:e,y:f},vector2:{x:a,y:m}}}function d(c,b){var d=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,e=b.angle1=(Math.atan2(c.yx,c.yy)+Math.atan2(-d*c.xy,d*c.xx))/2,d=Math.cos(e),e=Math.sin(e);b.sx=x(c.xx/d,d,-c.xy/e,e);b.sy=x(c.yy/d,d,c.yx/e,e);return b}function e(c,b){var d=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,e=b.angle2=(Math.atan2(d*c.yx,d*c.xx)+Math.atan2(-c.xy,c.yy))/2,d=Math.cos(e),e=Math.sin(e);
b.sx=x(c.xx/d,d,c.yx/e,e);b.sy=x(c.yy/d,d,-c.xy/e,e);return b}return f.decompose=function(c){var b=q.normalize(c);c={dx:b.dx,dy:b.dy,sx:1,sy:1,angle1:0,angle2:0};if(u(b.xy,0)&&u(b.yx,0))return m.mixin(c,{sx:b.xx,sy:b.yy});if(u(b.xx*b.yx,-b.xy*b.yy))return d(b,c);if(u(b.xx*b.xy,-b.yx*b.yy))return e(b,c);var f,r=new q.Matrix2D(b);f=m.mixin(r,{dx:0,dy:0,xy:r.yx,yx:r.xy});r=v([b,f]);f=v([f,b]);r=new q.Matrix2D({xx:r.vector1.x,xy:r.vector2.x,yx:r.vector1.y,yy:r.vector2.y});f=new q.Matrix2D({xx:f.vector1.x,
xy:f.vector1.y,yx:f.vector2.x,yy:f.vector2.y});b=new q.Matrix2D([q.invert(r),b,q.invert(f)]);d(f,c);b.xx*=c.sx;b.yy*=c.sy;e(r,c);b.xx*=c.sx;b.yy*=c.sy;return m.mixin(c,{sx:b.xx,sy:b.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(f){f=f.bezierutils={};f.tAtLength=function(d,e){var c=0,b=6==d.length,f=0,r=0,k=b?u:v,a=function(m,t){for(var u=0,v=0;v<m.length-2;v+=2)u+=q(m[v],m[v+1],m[v+2],m[v+3]);v=b?q(d[0],d[1],d[4],d[5]):q(d[0],d[1],d[6],d[7]);u-v>t||f+u>e+t?(++r,u=k(m,.5),
a(u[0],t),Math.abs(f-e)<=t||a(u[1],t)):(f+=u,c+=1/(1<<r))};e&&a(d,.5);return c};var m=f.computeLength=function(d){for(var e=6==d.length,c=0,b=0;b<d.length-2;b+=2)c+=q(d[b],d[b+1],d[b+2],d[b+3]);b=e?q(d[0],d[1],d[4],d[5]):q(d[0],d[1],d[6],d[7]);.1<c-b&&(d=e?u(d,.5):x(d,.5),c=m(d[0],e),c+=m(d[1],e));return c},q=f.distance=function(d,e,c,b){return Math.sqrt((c-d)*(c-d)+(b-e)*(b-e))},u=function(d,e){var c=1-e,b=c*c,f=e*e,r=d[0],k=d[1],a=d[2],m=d[3],q=d[4],u=d[5],v=b*r+2*c*e*a+f*q,b=b*k+2*c*e*m+f*u;return[[r,
k,c*r+e*a,c*k+e*m,v,b],[v,b,c*a+e*q,c*m+e*u,q,u]]},x=function(d,e){var c=1-e,b=c*c,f=b*c,r=e*e,k=r*e,a=d[0],m=d[1],q=d[2],u=d[3],v=d[4],x=d[5],A=d[6],B=d[7],F=f*a+3*b*e*q+3*c*r*v+k*A,f=f*m+3*b*e*u+3*c*r*x+k*B;return[[a,m,c*a+e*q,c*m+e*u,b*a+2*c*e*q+r*v,b*m+2*c*e*u+r*x,F,f],[F,f,b*q+2*c*e*v+r*A,b*u+2*c*e*x+r*B,c*v+e*A,c*x+e*B,A,B]]},v=f.splitBezierAtT=function(d,e){return 6==d.length?u(d,e):x(d,e)};return f})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],
function(f,m,q){m.getObject("json",!0,q);q.json._slice=function(f,m,q,d){var e=f.length,c=[];q=q||e;m=0>m?Math.max(0,m+e):Math.min(e,m);for(q=0>q?Math.max(0,q+e):Math.min(e,q);m<q;m+=d)c.push(f[m]);return c};q.json._find=function(f,m){function q(c){m&&(!0!==m||c instanceof Array?c[m]&&d.push(c[m]):d.push(c));for(var b in c){var e=c[b];m?e&&"object"==typeof e&&q(e):d.push(e)}}var d=[];if(m instanceof Array){if(1==m.length)return f[m[0]];for(var e=0;e<m.length;e++)d.push(f[m[e]])}else q(f);return d};
q.json._distinctFilter=function(f,m){for(var q=[],d={},e=0,c=f.length;e<c;++e){var b=f[e];m(b,e,f)&&("object"==typeof b&&b?b.__included||(b.__included=!0,q.push(b)):d[b+typeof b]||(d[b+typeof b]=!0,q.push(b)))}e=0;for(c=q.length;e<c;++e)q[e]&&delete q[e].__included;return q};return q.json.query=function(f,m){function q(b,c,a,d,f,m,q,t){return e[t].match(/[\*\?]/)||"~"==q?"/^"+e[t].substring(1,e[t].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==q?
"$/i":"$/")+".test("+c+")":b}var d=0,e=[];f=f.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(b){d+="["==b?1:"]"==b?-1:0;return"]"==b&&0<d?"`]":'"'==b.charAt(0)||"'"==b.charAt(0)?"`"+(e.push(b)-1):b});var c="";f.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});f=f.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(b){return"."==b.charAt(0)?b:"@"==b?"$obj":(b.match(/:|^(\$|Math|true|false|null)$/)?
"":"$obj.")+b}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(b,d,a){return(d=b.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?(a="",b.match(/^\./)&&(c="dojox.json._find("+c,a=",true)"),c=(d[1].match(/\=/)?"dojo.map":d[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter")+"("+c,a+",function($obj){return "+d[2]+"})"):(d=b.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+d[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,c){return"var av\x3d "+c.replace(/\$obj/,
"a")+",bv\x3d "+c.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:1)+";}\n"})+"return 0;})":(d=b.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(c="dojox.json._slice("+c,","+(d[1]||0)+","+(d[2]||0)+","+(d[3]||1)+")"):b.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(c="dojox.json._find("+c,("."==b.charAt(1)?",'"+a+"'":b.match(/,/)?","+b:"")+")"):b}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,
q).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(b,c,a,d,e,f,m,t){return q(b,d,e,f,m,t,a,c)});f=c+("$"==f.charAt(0)?"":"$")+f.replace(/`([0-9]+|\])/g,function(b,c){return"]"==c?"]":e[c]});for(var b=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+f+"}"),t=0;t<arguments.length-1;t++)arguments[t]=arguments[t+1];return m?b.apply(this,arguments):b}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel"],function(f,m,q,u){f=f(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,extraParameters:null});q("extend-esri")&&m.setObject("tasks.PrintParameters",f,u);return f})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(f,m,q,u,x,v,d,e){return m("dijit.ProgressBar",[v,d],{progress:"0",value:"",
maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:e,_indeterminateHighContrastImagePath:f.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update()},_setDirAttr:function(c){var b=
"rtl"==c.toLowerCase();q.toggle(this.domNode,"dijitProgressBarRtl",b);q.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&b);this.inherited(arguments)},update:function(c){u.mixin(this,c||{});c=this.internalProgress;var b=this.domNode,d=1;this.indeterminate?b.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(d=Math.min(parseFloat(this.progress)/100,1),this.progress=d*this.maximum):(this.progress=Math.min(this.progress,this.maximum),d=this.maximum?this.progress/
this.maximum:0),b.setAttribute("aria-valuenow",this.progress));b.setAttribute("aria-labelledby",this.labelNode.id);b.setAttribute("aria-valuemin",0);b.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(d);q.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);q.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());c.style.width=100*d+"%";this.onChange()},_setValueAttr:function(c){this._set("value",c);Infinity==
c?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:c})},_setLabelAttr:function(c){this._set("label",c);this.update()},_setIndeterminateAttr:function(c){this._set("indeterminate",c);this.update()},report:function(c){return this.label?this.label:this.indeterminate?"\x26#160;":x.format(c,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"widgets/Print/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:widgets/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\r\n    \x3cdiv class\x3d"formContainer"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\r\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                \x3ctr data-dojo-attach-point\x3d"titleTr"\x3e\r\n                    \x3ctd style\x3d"width:65px;"\x3e\r\n                        ${nls.title}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"text" data-dojo-attach-point\x3d"titleNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\'" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.layout}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'layout\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"layoutDijit" data-dojo-attach-event\x3d"Change:onLayoutChange"/\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.format}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'format\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"formatDijit" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"buttonActionBar jimu-align-trailing"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"advancedButtonDijit" style\x3d"display: none"\r\n            data-dojo-attach-event\x3d"onclick:showSettings"\x3e\x3cdiv class\x3d"btn-icon settingsIcon"\x3e\x3c/div\x3e${nls.settings}\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"settingsDialog"\r\n            style\x3d"display: none" class\x3d"gis_PrintDijit"\x3e\r\n            \x3cdiv style\x3d"width:250px;"\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapScaleExtent}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.preserve}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapScale" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'"\r\n                                /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapScaleLabel"\x3e${nls.mapScale}\x3c/label\x3e\r\n                                \x3cbr /\x3e\r\n                                \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapExtent" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'"\r\n                                /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapExtentLabel"\x3e${nls.mapExtent}\x3c/label\x3e\r\n                            \x3c/td\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.forceScale}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'force\',checked:false"/\x3e \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'forcedScale\',required:false,style:\'width:100px;\'" data-dojo-attach-point\x3d"forceScaleNTB"/\x3e \x3ca href\x3d"#" data-dojo-attach-event\x3d"click:getCurrentMapScale"\x3e${nls.getCurrentScale}\x3c/a\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;" data-dojo-attach-point\x3d"labelsTitleNode"\x3e\r\n                    ${nls.labels}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"labelsFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.showLabels}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'showLabels\',value:true,checked:true" /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapMetadata}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutMetadataDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"authorTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.author}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-attach-point\x3d"authorNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'author\',trim:true,required:false,style:\'width:100%;\'" data-dojo-attach-point\x3d"authorTB"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"copyrightTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.copyright}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3ctextarea data-dojo-attach-point\x3d"copyrightNode" name\x3d"copyright"\r\n                                    data-dojo-type\x3d"dijit/form/SimpleTextarea"\r\n                                    style\x3d"width:100%;height:60px;resize:none;"\x3e\x3c/textarea\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"customTextElementsDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5" style\x3d"width:100%;" data-dojo-attach-point\x3d"customTextElementsTable"\x3e\r\n\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"legendTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.lncludeLegend}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapOnlyOptions}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.width}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:670,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.height}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:500,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.printQualityOptions}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.dpi}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:96,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"printButtonDijit"\r\n            data-dojo-attach-event\x3d"onclick:print"\x3e\x3cdiv class\x3d"btn-icon printIcon"\x3e\x3c/div\x3e${nls.print}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- \x3chr calss\x3d"spacer"\x3e --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar"\r\n    style\x3d"display:none;padding:0;"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-event\x3d"onclick:clearResults"\x3e\r\n            \x3cdiv class\x3d"btn-icon clearIcon"\x3e\x3c/div\x3e${nls.clearList}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\r\n  \x3ctable class\x3d"printResultTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd width\x3d"25px"\x3e\r\n        \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd width\x3d"30px"\x3e\r\n        \x3cimg src\x3d"${icon}"\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"progressBar" data-dojo-type\x3d"dijit/ProgressBar" data-dojo-props\x3d\'value:Infinity\'\x3e\x3c/div\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"successNode" class\x3d"bold" style\x3d"display:none;"\x3e${docName}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"errNode" style\x3d"display:none;"\x3e\r\n          \x3cspan class\x3d"bold"\x3e${nls.printError}\x3c/span\x3e\r\n          \x3cdiv class\x3d"jimu-icon jimu-icon-error jimu-float-trailing"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:widgets/Print/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"printNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Print/css/style.css":".jimu-widget-print{width: 100%; height: 100%; position: relative;}.jimu-widget-print .dijitSelect{height: 20px; width: 100%;}.gis_PrintDijit {width: 100%;}.gis_PrintDijit .printResult {height: 28px; margin-bottom: -1px; width: 100%;}.gis_PrintDijit .printResult .printResultTable {width: 100%;}.gis_PrintDijit .printResult .bold {font-weight: bold;}.gis_PrintDijit .printResultError {font-weight: bold; color: red; cursor: help;}.gis_PrintDijit .printResultHover table:hover {background-color: #D4E7F8; cursor: pointer;}.gis_PrintDijit .buttonActionBar {padding: 3px 0px 2px 0px; width: 100%;}.gis_PrintDijit .formContainer {margin-bottom: -1px; width: 100%;}.gis_PrintDijit .resultsContainer {width: 100%; margin-top: 10px;}.gis_PrintDijit .btn-icon {width: 16px; height: 16px; display: inline-block; vertical-align: text-top; margin-right: 10px;}.gis_PrintDijit .printIcon {background-image: url(../images/print.png);}.gis_PrintDijit .clearIcon {background-image: url(../images/clear.png);}.gis_PrintDijit .settingsIcon {background-image: url(../images/settings.png); width: 16px; height: 16px;}.gis_PrintDijit .dijitArrowButtonContainer{width: 17px;}",
"*now":function(f){f(['dojo/i18n!*preload*widgets/Print/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget jimu/portalUtils dojo/_base/lang dojo/Deferred jimu/dijit/Message jimu/dijit/LoadingShelter ./Print esri/request jimu/portalUrlUtils".split(" "),function(f,m,q,u,x,v,d,e,c,b){return f([m],{baseClass:"jimu-widget-print",name:"Print",className:"esri.widgets.Print",_portalPrintTaskURL:null,postCreate:function(){this.inherited(arguments);this.shelter=new d({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup()},startup:function(){this.inherited(arguments);
this.shelter.show();this._initPrinter()},_initPrinter:function(){this._getPrintTaskURL(this.appConfig.portalUrl).then(u.hitch(this,function(b){this.shelter.show();this.isAsync(b).then(u.hitch(this,function(c){this.print=new e({map:this.map,appConfig:this.appConfig,printTaskURL:b,defaultAuthor:this.config.defaultAuthor,defaultCopyright:this.config.defaultCopyright,defaultTitle:this.config.defaultTitle,defaultFormat:this.config.defaultFormat,defaultLayout:this.config.defaultLayout,nls:this.nls,async:c});
this.print.placeAt(this.printNode);this.print.startup()}),u.hitch(this,function(b){new v({message:b.message})})).always(u.hitch(this,function(){this.shelter.hide()}))}),u.hitch(this,function(b){new v({message:b});console.error(b);this.shelter.hide()}))},_getPrintTaskURL:function(b){var c=new x;if(this.config&&this.config.serviceURL)return c.resolve(this.config.serviceURL),c;q.getPortalSelfInfo(b).then(u.hitch(this,function(b){(b=b&&b.helperServices&&b.helperServices.printTask&&b.helperServices.printTask.url)?
c.resolve(b):c.reject("error")}),u.hitch(this,function(b){new v({message:this.nls.portalConnectionError});c.reject("error");console.error(b)}));return c},isAsync:function(d){var e=new x,f=b.setHttpProtocol(d),a=b.getNewPrintUrl(this.appConfig.portalUrl);f===a||/sharing\/tools\/newPrint$/.test(f)?e.resolve(!1):c({url:d,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4,load:u.hitch(this,function(a){"esriExecutionTypeAsynchronous"===a.executionType?e.resolve(!0):e.resolve(!1)}),
error:u.hitch(this,function(a){e.reject(a)})});return e},onSignIn:function(b){b=b||{};b.userId&&this.print&&this.print.updateAuthor(b.userId)}})});